<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>已老实，求放过</title>
      <link href="/posts/5966195/"/>
      <url>/posts/5966195/</url>
      
        <content type="html"><![CDATA[<p>事情的起因来源于一封简单的邮件</p><p><img src="/../img/5966195/20240725212852.jpg" alt="vercel邮件"></p><p>我的vercel部署的网站函数总使用量已经到75%了！一般来说，我的网站一个月超过一般的函数访问量已经算高了，这次直接超过75%了，登录vercel一看，好家伙，有人在频繁访问我的接口！</p><div class="tabs" id="test2"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test2-1">网站访问总量统计</button></li><li class="tab"><button type="button" data-href="#test2-2">近期项目访问总量统计</button></li><li class="tab"><button type="button" data-href="#test2-3">接口访问</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test2-1"><p><strong><img src="/../img/5966195/a2.jpg" alt="网站访问总量统计"></strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test2-2"><p><img src="/../img/5966195/a3.jpg" alt="近期项目访问总量统计"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test2-3"><p><img src="/../img/5966195/a4.jpg" alt="接口访问总量统计"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>这是我的一个小项目<a href="https://github.com/flow2000/bing-wallpaper-api">bing-wallpaper-api</a>，能够利用Atcions每天存储必应壁纸的链接并做成API接口，我只是因为每天更新一张的必应壁纸蛮好看的，想做一个接口玩玩而已，没想到这也有人攻击啊，况且我还是用vercel免费部署的网站，我也没用服务器啊。</p><p><strong>已老实，求放过，不要再刷我的免费资源了，我还想用verlcel的服务啊！！</strong></p><p>频繁被访问的接口为<a href="https://api.bimg.cc/random">https://api.bimg.cc/random</a>，这个接口的作用是会重定向到随机一张必应壁纸的图片地址，</p><p>我真的不想做限流啊，限流我自己访问都觉得难受。</p><p>还是先加上吧，撑过这个月刷新用量再说</p><p><img src="/../img/5966195/a5.jpg" alt="限流代码"></p>]]></content>
      
      
      <categories>
          
          <category> 生活杂谈 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 闲聊 </tag>
            
            <tag> 必应壁纸 </tag>
            
            <tag> Vercel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记录自建git服务器遇到问题以及解决方法</title>
      <link href="/posts/d2851e0b/"/>
      <url>/posts/d2851e0b/</url>
      
        <content type="html"><![CDATA[<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>一台拥有linux操作系统的服务器，虚拟机也得</p><p>连接其服务器的终端软件，例如<a href="https://www.xshell.com/zh/xshell/">Xshell</a></p><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>步骤我不分步讲了，网上有教程</p><div class="tabs" id="tab1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab1-1">安装git</button></li><li class="tab"><button type="button" data-href="#tab1-2">添加git用户</button></li><li class="tab"><button type="button" data-href="#tab1-3">创建git仓库</button></li><li class="tab"><button type="button" data-href="#tab1-4">创建密钥</button></li><li class="tab"><button type="button" data-href="#tab1-5">更改所属人</button></li><li class="tab"><button type="button" data-href="#tab1-6">修改sshd配置</button></li><li class="tab"><button type="button" data-href="#tab1-7">测试</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab1-1"><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install git -y</span><br></pre></td></tr></table></figure><p>-y代表默认同意后续的安装请求</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-2"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">useradd git</span><br><span class="line">passwd git</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-3"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /home/git/test</span><br><span class="line">git init --bare /home/git/test</span><br></pre></td></tr></table></figure><p>-p 代表递归创建文件夹</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-4"><p>创建.ssh文件夹：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /home/git/.ssh</span><br></pre></td></tr></table></figure><p>创建authorized_keys文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch /home/git/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><p>本地执行ssh-keygen生成一对密钥对（<strong>id_rsa.pub</strong>和<strong>id_rsa</strong>）：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh<span class="literal">-keygen</span></span><br></pre></td></tr></table></figure><p>将<strong>id_rsa.pub</strong>的内容复制到 <strong>&#x2F;home&#x2F;git&#x2F;.ssh&#x2F;authorized_keys</strong> 文件中</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-5"><p>更改所有者：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R /home/git</span><br></pre></td></tr></table></figure><p>-R 代表包含子目录授权</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-6"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure><p>找到以下三个配置，如被注释，取消注释：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RSAAuthentication yes</span><br><span class="line">PubkeyAuthentication yes</span><br><span class="line">AuthorizedKeysFile .ssh/authorized_keys</span><br></pre></td></tr></table></figure><p>重启sshd服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart sshd</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-7"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@your_ip:/home/git/test</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><h3 id="please-make-sure-you-have-the-correct-access-rights-and-the-repository-exists"><a href="#please-make-sure-you-have-the-correct-access-rights-and-the-repository-exists" class="headerlink" title="please make sure you have the correct access rights and the repository exists."></a>please make sure you have the correct access rights and the repository exists.</h3><p><img src="/./img/b/d2851e0b/20231205190904.png" alt="please make sure you have the correct access rights and the repository exists."></p><p>有两种情况：</p><p>第一种情况是没将密钥放到指定位置或者没放。一般我们使用的用户为git，所以要将<strong>id_rsa.pub</strong>的内容复制到 <strong>&#x2F;home&#x2F;git&#x2F;.ssh&#x2F;authorized_keys</strong> 文件中，并且要更改所有者为git</p><p>第二种情况是sshd_config配置没有设置密钥登录。</p><p>需要找到以下三个配置，如被注释，取消注释：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RSAAuthentication yes</span><br><span class="line">PubkeyAuthentication yes</span><br><span class="line">AuthorizedKeysFile .ssh/authorized_keys</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git,服务器,shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用dns_dp自动申请证书时，出现invalid domain</title>
      <link href="/posts/209a0ada/"/>
      <url>/posts/209a0ada/</url>
      
        <content type="html"><![CDATA[<h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>起因是我想在本地使用acme.sh申请一个临时的SSL证书,但是一直报错，报错信息是</p><p> <strong>invalid domain</strong></p><p> <strong>Error add txt for domain:_acme-challenge.b2.aqcoder.cn</strong></p><p><img src="/./img/b/209a0ada/20231112210752.png" alt="报错截图"></p><p>一开始我以为是dnspod的id和密钥写错了，就去重新申请复制粘贴：</p><p><img src="/./img/b/209a0ada/20231112211120.png" alt="dnspod密钥截图"></p><p>后来也是不行，还去了腾讯云的访问管理那里找来了有着dns全读写权限的子用户的密钥：</p><p><img src="/./img/b/209a0ada/20231112211258.png" alt="子用户密钥截图"></p><p>结果还是报错，只能使用搜索大法了，把报错信息丢给必应：</p><p><img src="/./img/b/209a0ada/20231112212248.png" alt="搜索截图"></p><p>找不到多少有用的信息，只能去acme.sh的<a href="https://github.com/acmesh-official/acme.sh/issues">issues</a>里找了，因为我用的dns是腾讯云的pod，所以我的搜索词是acme.sh命令的<strong>dns_dp</strong>（使用invalid domain也是有相关性的）：</p><p><img src="/./img/b/209a0ada/20231112212950.png" alt="github的issues截图"></p><p>然后我找那些题目比较符合且有比较多对话的（从右边的对话数可以看出），最后找到这个比较符合我出现的问题：<a href="https://github.com/acmesh-official/acme.sh/issues/2806">#2806</a></p><p><img src="/./img/b/209a0ada/20231112213203.png" alt="#2806！！"></p><p>仔细查看他们的对话，可以从中找到一些收获：</p><p><img src="/./img/b/209a0ada/20231112213354.png" alt="找到问题了！"></p><p><strong><a href="https://github.com/stone-stones">stone-stones</a></strong> 说 第二个token，腾讯云那边的api密钥不能直接使用，你需要在 DNSPod 开启密钥token，token页面包含一个id和token信息</p><h2 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h2><p>这就是我想要的信息，原来不能直接用API密钥得使用Token对应得id就是<strong>DP_Id</strong>，token就是<strong>DP_Key</strong>。重新申请一个token，记住值后重新执行一遍：</p><p><img src="/./img/b/209a0ada/20231112214045.png" alt="执行过程截图"></p><h2 id="问题总结"><a href="#问题总结" class="headerlink" title="问题总结"></a>问题总结</h2><p>一份从出现问题，寻找问题，找到问题，搜索问题，解决问题的过程就这样完成了，期间花费了大概半个钟搜索问题，其余时间都花费很少。其实，如果熟悉debug，能想到问题的根源解决报错是最快捷的方式，但是在不熟悉debug，通过查看日志判断问题的根源的情况下，搜索相似问题成了目前我们大多数时候最常用的办法。</p><h2 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h2><p><a href="https://github.com/acmesh-official/acme.sh/issues/2806">使用DNSPOD.cn自动申请证书时，出现invalid domain · Issue #2806 · acmesh-official&#x2F;acme.sh</a></p><p><a href="https://github.com/acmesh-official/acme.sh">acmesh-official&#x2F;acme.sh: A pure Unix shell script implementing ACME client protocol</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 证书 </tag>
            
            <tag> shell </tag>
            
            <tag> 错误总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscode快捷键操作记录</title>
      <link href="/posts/a956f319/"/>
      <url>/posts/a956f319/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>作为编程老手，除了Java项目在idea上编程，其他语言我都喜欢在vscode上编程，主打一个轻便快捷。而快捷键更是帮助我们进行快速编程的工具。接下来我会介绍一下我平常使用的一些快捷键</p><h3 id="全选、复制、粘贴、剪切、撤回、搜索"><a href="#全选、复制、粘贴、剪切、撤回、搜索" class="headerlink" title="全选、复制、粘贴、剪切、撤回、搜索"></a>全选、复制、粘贴、剪切、撤回、搜索</h3><p>Ctrl+A、Ctrl+C、Ctrl+V、Ctrl+X、Ctrl+Z、Ctrl+F，这几个占了我绝大部分快捷键使用频率，特别是Ctrl+C、Ctrl+V</p><h3 id="跳到变量的前面或后面"><a href="#跳到变量的前面或后面" class="headerlink" title="跳到变量的前面或后面"></a>跳到变量的前面或后面</h3><p>Ctrl+←、Ctrl+→，不用鼠标移动光标的好帮手</p><h3 id="依次找出文中所有的当前选中的单词"><a href="#依次找出文中所有的当前选中的单词" class="headerlink" title="依次找出文中所有的当前选中的单词"></a>依次找出文中所有的当前选中的单词</h3><p>Ctrl + D，这个快捷键在一起选中几个相同的字符串时特别有效</p><h3 id="同时选择上一行或下一行的相同位置："><a href="#同时选择上一行或下一行的相同位置：" class="headerlink" title="同时选择上一行或下一行的相同位置："></a>同时选择上一行或下一行的相同位置：</h3><p> Ctrl + Alt + Up 、Ctrl + Alt + Down，这两个我一般会混合Ctrl+←和Ctrl+→一起使用，可以给一些字符串批量添加引号</p><h3 id="一次性展开-x2F-收缩全部函数"><a href="#一次性展开-x2F-收缩全部函数" class="headerlink" title="一次性展开&#x2F;收缩全部函数"></a>一次性展开&#x2F;收缩全部函数</h3><p>Ctrl+K+Ctrl+1、Ctrl+K+Ctrl+K，想看清整个代码的生命周期以及函数全貌，可以试试它</p><h3 id="匹配到结果时一次性全部选中"><a href="#匹配到结果时一次性全部选中" class="headerlink" title="匹配到结果时一次性全部选中"></a>匹配到结果时一次性全部选中</h3><p>Ctrl+F搜索时，Alt+Enter，可以将匹配到的字符串全部选中</p><h3 id="同时使用多个光标"><a href="#同时使用多个光标" class="headerlink" title="同时使用多个光标"></a>同时使用多个光标</h3><p>Alt + Click，这个快捷键刚刚学会，有使用场景就补充上去</p><h3 id="在上方复制一行，在下方复制一行"><a href="#在上方复制一行，在下方复制一行" class="headerlink" title="在上方复制一行，在下方复制一行"></a>在上方复制一行，在下方复制一行</h3><p>Shift + Alt + Up、Shift + Alt + Down，这个快捷键刚刚学会，有使用场景就补充上去</p><p>未完待续……</p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 快捷命令 </tag>
            
            <tag> Java </tag>
            
            <tag> 编程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>不折腾服务器了</title>
      <link href="/posts/ae6fc3da/"/>
      <url>/posts/ae6fc3da/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>服务器4天就过期了，还想着看看有没有便宜的服务器继续弄弄，但工作后就没多少时间继续折腾服务器了，这个想法也就搁置下来了，现在已经把服务器上的数据全部迁移到本地了，等哪天有兴趣再把数据上云了。</p><p><img src="/./img/b/ae6fc3da/20230923140653.jpg" alt="服务器"></p><h2 id="目前的博客构建路径"><a href="#目前的博客构建路径" class="headerlink" title="目前的博客构建路径"></a>目前的博客构建路径</h2><p>目前博客源码在github私人仓库里，提交触发Action构建静态网页，将dist推送到Github公共仓库，使用托管网站<a href="https://app.netlify.com/">netlify</a>构建部署，绑定了自己的域名。图片之前使用lskypro+cdn（有服务器），现在使用了腾讯云的cos+cdn方案（无服务器），目前网站速度情况还行：</p><p><img src="/./img/b/ae6fc3da/20230923140421.png" alt="网站速度情况"></p><p>其他的接口也使用vercel平替了，数据库用云的mongodb，暂时够用</p><p>在docker备份了数据，全部删除了docker容器</p><p><img src="/./img/b/ae6fc3da/20230923135735.jpg" alt="docker"></p><p>lskypro的数据库也备份下来了，图片全部备份下来，用腾讯云的cos+cdn给无缝迁移过去了</p><p>博客主题就不折腾了，有时间就写写博客就行了</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂谈 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 闲聊 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记录：执行shell脚本&#39;source /etc/profile&#39;重载配置文件不生效的问题</title>
      <link href="/posts/e62374d9/"/>
      <url>/posts/e62374d9/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在折腾服务器时我会自己安装一些环境，例如jdk,mysql,redis,node,docker等，这些环境我一般是自己制作一个脚本来执行它，例如node环境安装脚本：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">yum install -y tar make</span><br><span class="line">if type node &gt;/dev/null 2&gt;&amp;1; then</span><br><span class="line">  echo &#x27;node 已安装&#x27;</span><br><span class="line">else</span><br><span class="line">  echo &#x27;node 未安装&#x27;</span><br><span class="line">fi</span><br><span class="line">echo &quot;----------------------------------start yum install node -----------------------------&quot;</span><br><span class="line">wget https://nodejs.org/dist/v16.14.0/node-v16.14.0-linux-x64.tar.gz</span><br><span class="line">tar -xvf node-v16.14.0-linux-x64.tar.gz</span><br><span class="line">mv node-v16.14.0-linux-x64 /usr/local/node</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除配置文件中原有的环境变量</span></span><br><span class="line">sed -ie &#x27;/NODE_HOME/d&#x27; /etc/profile</span><br><span class="line">sed -ie &#x27;/cnpm/d&#x27; /etc/profile</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">修改node的环境变量，直接写入配置文件</span></span><br><span class="line">echo &quot;export NODE_HOME=/usr/local/node&quot; &gt;&gt;/etc/profile</span><br><span class="line">echo &quot;export PATH=\$NODE_HOME/bin:\$PATH&quot; &gt;&gt;/etc/profile</span><br><span class="line"></span><br><span class="line">source /etc/profile</span><br><span class="line"></span><br><span class="line">npm install -g cnpm</span><br><span class="line">echo &quot;export PATH=/usr/local/node/lib/node_moudles/cnpm/bin:$PATH&quot; &gt;&gt;/etc/profile</span><br><span class="line">source /etc/profile</span><br><span class="line"></span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br><span class="line">cnpm -v</span><br><span class="line">echo &quot;----------------------------------yum install node success -----------------------------&quot;</span><br></pre></td></tr></table></figure><p>每次执行完也都能看到node的版本，但自己手动<code>node -v</code>就不能执行成功提示<code>-bash: node: command not found</code>，每次都要检查脚本是否有问题，误打误撞运行了source &#x2F;etc&#x2F;profile，就又成功安装环境，显示版本号了，后面也就不理了。这些天又出现这样的问题，我想是时候找一找根源了。</p><h2 id="搜索问题"><a href="#搜索问题" class="headerlink" title="搜索问题"></a>搜索问题</h2><p>我在必应上搜索了：为什么sh脚本修改的配置文件不能source，回车就看到了类似问题的答案了：</p><p><img src="/./img/b/e62374d9/64f3356998c2d.png" alt="为什么sh脚本修改的配置文件不能source"></p><p>原文：<a href="https://cloud.tencent.com/developer/article/2161545">解决shell脚本中”source &#x2F;etc&#x2F;profile”重载配置文件不生效的问题-腾讯云开发者社区-腾讯云</a></p><h2 id="找到原因了"><a href="#找到原因了" class="headerlink" title="找到原因了"></a>找到原因了</h2><p>是因为我使用了<code>sh install-node.sh</code>来执行脚本，这样当前shell进程会分出一个子shell进行来执行node环境安装脚本</p><p><strong>子shell只能继承父shell环境变量，不能修改父shell的环境变量</strong></p><p>这也是为什么我可以在<code>sh install-node.sh</code>能看到<code>node -v </code>的版本号，而自己打<code>node -v</code> 提示 <code>command not found</code></p><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><p><strong>source install-node.sh</strong></p><p>凡是脚本中使用<code>source /etc/profile</code>，就要使用命令<strong>source install-node.sh</strong>执行</p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://cloud.tencent.com/developer/article/2161545">解决shell脚本中”source &#x2F;etc&#x2F;profile”重载配置文件不生效的问题-腾讯云开发者社区-腾讯云</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>这断更的三个月我干了什么</title>
      <link href="/posts/fca2c9db/"/>
      <url>/posts/fca2c9db/</url>
      
        <content type="html"><![CDATA[<p>这三个月来都没写过博客，只因为学业和工作要忙。</p><p>我是一个刚刚大学毕业的，即将走上新的人生旅途的新人，</p><p>我想分享这三个月的所见所闻所感</p><h2 id="五月"><a href="#五月" class="headerlink" title="五月"></a>五月</h2><p>五月，一个烦热的季节，但随着毕业季的到来，我还是可以和宿舍的几个一起聚聚的，虽然还是要带着一点焦虑，但大多数时候还是快乐的。</p><p>都说毕业要来一个毕业旅行，但是我觉得在一个自己熟知的城市和几个熟悉的朋友去一些未熟知的地方也是一种毕业旅行</p><div class="fj-gallery"><img src="./img/b/fca2c9db/64cfaf7f87886.jpg" alt="5.1 人民公园到此一游"><img src="./img/b/fca2c9db/64cfb0414f28f.jpg" alt="5.2 美丽南方到此一游"><img src="./img/b/fca2c9db/64cfb040b9675.jpg" alt="5.2 美丽南方到此一游"><img src="./img/b/fca2c9db/64cfb040f2566.jpg" alt="5.2 美丽南方到此一游（骑着哈啰去的）"><img src="./img/b/fca2c9db/64cfb256e74a6.jpg" alt="5.4 15块一盘酸笋炒肉/豆角炒肉/香菇炒肉真香"><img src="./img/b/fca2c9db/64cfb34c61bb4.jpg" alt="5.5 和老宋一起挑战20公里（最后16公里累倒结束）"><img src="./img/b/fca2c9db/64cfb3d264607.jpg" alt="5.5 和老宋一起挑战20公里（最后16公里累倒结束）"><img src="./img/b/fca2c9db/64cfabca91bd1.jpg" alt="5.8 邕江公园骑行"><img src="./img/b/fca2c9db/64cfabcaca6e4.jpg" alt="5.8 邕江公园骑行"><img src="./img/b/fca2c9db/64cfae5bd9c96.jpg" alt="5.8 农院路还是这么多人"><img src="./img/b/fca2c9db/64cfa4c239d58.jpg" alt="5.8 骑行后去鸡公煲奖励自己"><img src="./img/b/fca2c9db/64cfb596c43ce.jpg" alt="5.14 去出租屋看望看老同志（有人在摸鱼打游戏）"><img src="./img/b/fca2c9db/64cfb5954ae16.jpg" alt="5.14 去出租屋看望看老同志（有人在炒菜）"><img src="./img/b/fca2c9db/64cfb59583cfe.jpg" alt="5.14 去出租屋看望看老同志（厨师成果展示）"><img src="./img/b/fca2c9db/64cfa4c1a6451.jpg" alt="5.14 去出租屋看望看老同志（尬拍一下）"><img src="./img/b/fca2c9db/64cfb70861477.jpg" alt="5.17 自己去骑行（人慢慢变少了，现在就我一个了）"><img src="./img/b/fca2c9db/64cfb74ce9f5c.jpg" alt="5.17 自己去骑行（孤独感一下子上来了）"><img src="./img/b/fca2c9db/64cfb775dcbba.jpg" alt="5.17 自己去骑行（差点emo了，买两个瓜奖励自己）"><img src="./img/b/fca2c9db/64cfb777c91fc.jpg" alt="5.17 自己去骑行（虽然没骑多少）"><img src="./img/b/fca2c9db/64cfb827c9431.jpg" alt="5.20 参加优秀答辩"><img src="./img/b/fca2c9db/64cfbe9319563.jpg" alt="5.21 骑行石埠街市（独自一人）"><img src="./img/b/fca2c9db/64cfbeea51c5b.jpg" alt="5.21 骑行石埠街市（路过美丽南方）"><img src="./img/b/fca2c9db/64cfbf079711b.jpg" alt="5.21 骑行石埠街市（逛了一下，嗦个粉就回宿舍了）"><img src="./img/b/fca2c9db/64cfc056a21c7.jpg" alt="5.30 招聘会"><img src="./img/b/fca2c9db/64cfc0557ca46.jpg" alt="5.30 招聘会"><img src="./img/b/fca2c9db/64cfc055d4cc7.jpg" alt="5.30 招聘会"><img src="./img/b/fca2c9db/64cfc056a21c7.jpg" alt="5.30 招聘会">          </div><h2 id="六月"><a href="#六月" class="headerlink" title="六月"></a>六月</h2><p>焦虑的是一份工作还没找着，小公司看不上，大公司没人要，双非学校的校招令人叹息，招聘软件的简历投了一个又一个；毕业论文改了一遍又一遍，打印店去了不下十次，学业和工作的烦恼令我焦虑</p><p><img src="/./img/b/fca2c9db/64cfa1c9af1b8.png" alt="毕业论文检查"></p><p>焦虑之余，还是要好好“放松”的</p><div class="fj-gallery"><img src="./img/b/fca2c9db/64cfc281ec7db.jpg" alt="6.6 骑行完闲逛，逛到了中山路美食街"><img src="./img/b/fca2c9db/64cfc2833a68e.jpg" alt="6.6 骑行完闲逛，逛到了中山路美食街（原来在南宁市第一人民医院附近）"><img src="./img/b/fca2c9db/64cfc28470a5e.jpg" alt="6.6 骑行完闲逛，逛到了中山路美食街（物价好贵，只能吃碗鸭肉粉）"><img src="./img/b/fca2c9db/64cfc2841baee.jpg" alt="6.6 骑行完闲逛，逛到了中山路美食街（地铁站）"><img src="./img/b/fca2c9db/64d24b448f1f6.jpg" alt="6.14 相思小镇">          </div><p>当然，期间我还收到了电信的线上面试邀约（6.16），在一阵“吹水”下拿到了线下二面邀约（6.21），然后又一阵线下自信“吹水”下拿到了offer（6.27）。体检合格后寄送三方材料，后面就签合同啦。</p><p>tips:之前老早就在运营商官网投递了简历，等了好几个月</p><h2 id="七月"><a href="#七月" class="headerlink" title="七月"></a>七月</h2><p>轻松</p><p>因为被捞上岸了，前些日子的焦虑、苦闷全部一扫而空，浑身轻松自在……</p><p>月中去集体培训了（培训了半个月），那里的伙食是相当不错，培训也有意思，还可以和很多来自广西各个地市的小伙伴一起做上课、练操、拉练……总之这次培训很有意义</p><h2 id="新的征程"><a href="#新的征程" class="headerlink" title="新的征程"></a>新的征程</h2><p>回到公司，要开始轮岗以确定自己适合什么岗位，每个部门都轮一遍，确定岗位后才是正式开始工作！</p><p>七八月份的照片就不放出来了，不过朋友圈有，欢迎大家一起交流</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂谈 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 闲聊 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>onlyoffice用Nginx反向代理遇到的大坑</title>
      <link href="/posts/614f4f28/"/>
      <url>/posts/614f4f28/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近想用一下云文件管理系统试试上传其他格式的云文件，想跳过兰空图床只能上传图片的限制，在网上找到了一些的看着还不错的开源项目：</p><p><a href="https://github.com/cloudreve/Cloudreve">Cloudreve</a></p><p><a href="https://github.com/nextcloud/docker">nextcloud</a></p><p><a href="https://github.com/cloudreve/Cloudreve">Cloudreve</a>之前部署过，后面没有需求就不用了，现在又想试试了，有经验就先试试这个</p><h2 id="Cloudreve介绍"><a href="#Cloudreve介绍" class="headerlink" title="Cloudreve介绍"></a>Cloudreve介绍</h2><p>Cloudreve 可以让您快速搭建起公私兼备的网盘系统。Cloudreve 在底层支持不同的云存储平台，用户在实际使用时无须关心物理存储方式。你可以使用 Cloudreve 搭建个人用网盘、文件分享系统，亦或是针对大小团体的公有云系统。</p><p>截图</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">首页</button></li><li class="tab"><button type="button" data-href="#tab-1-2">pdf</button></li><li class="tab"><button type="button" data-href="#tab-1-3">ppt</button></li><li class="tab"><button type="button" data-href="#tab-1-4">excel</button></li><li class="tab"><button type="button" data-href="#tab-1-5">word</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/./img/b/614f4f28/645c975281f3a.jpg" alt="首页"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/./img/b/614f4f28/645c99b42fce0.jpg" alt="pdf"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><img src="/./img/b/614f4f28/645c99b498485.jpg" alt="ppt"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p><img src="/./img/b/614f4f28/645c99b52456b.jpg" alt="excel"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p><img src="/./img/b/614f4f28/645c99b57e4d4.jpg" alt="word"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>先放出我的docker命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mkdir -vp /www/cloudreve/&#123;uploads,avatar&#125; \</span><br><span class="line">&amp;&amp; touch /www/cloudreve/conf.ini \</span><br><span class="line">&amp;&amp; touch /www/cloudreve/cloudreve.db</span><br><span class="line"></span><br><span class="line">docker run -d \</span><br><span class="line">--name cloudreve --restart=always \</span><br><span class="line">-p 9112:5212 \</span><br><span class="line">--mount type=bind,source=/www/cloudreve/conf.ini,target=/cloudreve/conf.ini \</span><br><span class="line">--mount type=bind,source=/www/cloudreve/cloudreve.db,target=/cloudreve/cloudreve.db \</span><br><span class="line">-v /www/cloudreve/uploads:/cloudreve/uploads \</span><br><span class="line">-v /www/cloudreve/avatar:/cloudreve/avatar \</span><br><span class="line">cloudreve/cloudreve:latest</span><br><span class="line"></span><br><span class="line">docker logs cloudreve</span><br></pre></td></tr></table></figure><p>账号密码就在docker打印出来的日志里面</p><p>docker跑完后访问<strong>ip:端口</strong></p><h2 id="Cloudreve预览office三件套"><a href="#Cloudreve预览office三件套" class="headerlink" title="Cloudreve预览office三件套"></a>Cloudreve预览office三件套</h2><p>由于微软的预览时不时发癫，无法预览，所以得设置wopi（在管理面板-&gt;参数设置-&gt;图像与预览-&gt;WOPI 客户端）</p><p>我先照着Cloudreve官方试着部署了<a href="https://docs.cloudreve.org/use/wopi#onlyoffice">onlyoffice</a></p><h2 id="onlyoffice的nginx代理"><a href="#onlyoffice的nginx代理" class="headerlink" title="onlyoffice的nginx代理"></a>onlyoffice的nginx代理</h2><p>由于onlyoffice是http的（可以搞https，但是我不会），需要https，所以需要nginx监听https并代理http，配置如下：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#view.aqcoder.cn</span></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> view.aqcoder.cn;</span><br><span class="line">    <span class="attribute">rewrite</span><span class="regexp"> ^(.*)$</span> https://<span class="variable">$host</span><span class="variable">$request_uri</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl;</span><br><span class="line">    <span class="attribute">server_name</span> view.aqcoder.cn;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_certificate</span> /etc/ssl/aqcoder.cn/aqcoder.cn.cer;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span> /etc/ssl/aqcoder.cn/aqcoder.cn.key;</span><br><span class="line">    <span class="attribute">ssl_session_cache</span>    shared:SSL:<span class="number">4m</span>;</span><br><span class="line">    <span class="attribute">ssl_session_timeout</span>  <span class="number">10m</span>;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span>  HIGH:!aNULL:!MD5;</span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span>  <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">charset</span> utf-<span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://127.0.0.1:9170;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>按照cloudreve的<a href="https://docs.cloudreve.org/use/wopi#onlyoffice">教程</a>弄完后，发现用不了：</p><p><img src="/./img/b/614f4f28/645c9e7d42f7f.jpg" alt="error"></p><p>一查网络，好家伙，访问到本地了：</p><p><img src="/./img/b/614f4f28/645c9ed93f24b.jpg" alt="本地Ip"></p><p>折腾了好久，搜到网上这篇文章：<a href="https://www.jianshu.com/p/3f99d45fb4b8">https://www.jianshu.com/p/3f99d45fb4b8</a></p><p>代理配置搞错了！</p><p>同时官方也有对应的<a href="https://helpcenter.onlyoffice.com/installation/docs-community-proxy.aspx">场景</a>：</p><p><img src="/./img/b/614f4f28/645ca09338205.jpg" alt="onlyoffice"></p><p>示例配置也给了，可以根据以上教程</p><p>得出正确的代理：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">upstream</span> docservice &#123;</span><br><span class="line">  <span class="attribute">server</span> <span class="number">127.0.0.1:9170</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="attribute">map</span> <span class="variable">$http_host</span> <span class="variable">$this_host</span> &#123;</span><br><span class="line">    &quot;&quot; $host;</span><br><span class="line">    <span class="attribute">default</span> <span class="variable">$http_host</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="attribute">map</span> <span class="variable">$http_x_forwarded_proto</span> <span class="variable">$the_scheme</span> &#123;</span><br><span class="line">     <span class="attribute">default</span> <span class="variable">$http_x_forwarded_proto</span>;</span><br><span class="line">     &quot;&quot; $scheme;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="attribute">map</span> <span class="variable">$http_x_forwarded_host</span> <span class="variable">$the_host</span> &#123;</span><br><span class="line">    <span class="attribute">default</span> <span class="variable">$http_x_forwarded_host</span>;</span><br><span class="line">    &quot;&quot; $this_host;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="attribute">map</span> <span class="variable">$http_upgrade</span> <span class="variable">$proxy_connection</span> &#123;</span><br><span class="line">  <span class="attribute">default</span> upgrade;</span><br><span class="line">  &quot;&quot; close;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#view.aqcoder.cn</span></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> view.aqcoder.cn;</span><br><span class="line">    <span class="attribute">rewrite</span><span class="regexp"> ^(.*)$</span> https://<span class="variable">$host</span><span class="variable">$request_uri</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl;</span><br><span class="line">    <span class="attribute">server_name</span> view.aqcoder.cn;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_certificate</span> /etc/ssl/aqcoder.cn/aqcoder.cn.cer;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span> /etc/ssl/aqcoder.cn/aqcoder.cn.key;</span><br><span class="line">    <span class="attribute">ssl_session_cache</span>    shared:SSL:<span class="number">4m</span>;</span><br><span class="line">    <span class="attribute">ssl_session_timeout</span>  <span class="number">10m</span>;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span>  HIGH:!aNULL:!MD5;</span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span>  <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">charset</span> utf-<span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">proxy_set_header</span> Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Connection <span class="variable">$proxy_connection</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> X-Forwarded-Host <span class="variable">$the_host</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> X-Forwarded-Proto <span class="variable">$the_scheme</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://127.0.0.1:9170;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>访问<a href="https://view.aqcoder.cn/hosting/discovery%E4%B9%9F%E8%BF%94%E5%9B%9E%E9%A2%84%E6%9C%9F%E7%9A%84">https://view.aqcoder.cn/hosting/discovery也返回预期的</a> XML 响应</p><p>不过Cloudreve官方也说了:</p><div class="note warning simple"><p>OnlyOffice 不支持过滤 WOPI 请求来源，如果你有对公使用需求，请通过外部应用防火墙检查预览页面请求中 <code>wopisrc</code> 参数是否为预期的 Cloudreve 站点。</p></div><h2 id="Collabora-Online的nginx代理"><a href="#Collabora-Online的nginx代理" class="headerlink" title="Collabora Online的nginx代理"></a>Collabora Online的nginx代理</h2><p>Collabora Online 部署的时候也遇到了一样的问题</p><p>原docker部署命令:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -t -d -p 9980:9980 \</span><br><span class="line">           -e &quot;aliasgroup1=xxxxxx:443&quot; \</span><br><span class="line">           -e &quot;username=xxxxx&quot; \</span><br><span class="line">           -e &quot;password=xxxxx&quot; \</span><br><span class="line">           --cap-add MKNOD \</span><br><span class="line">           --name code --restart always collabora/code</span><br></pre></td></tr></table></figure><p>原nginx的代理配置:</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#view1.aqcoder.cn</span></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> view1.aqcoder.cn;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">rewrite</span><span class="regexp"> ^(.*)$</span> https://<span class="variable">$host</span><span class="variable">$request_uri</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl;</span><br><span class="line">    <span class="attribute">server_name</span> view1.aqcoder.cn;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_certificate</span> /etc/ssl/aqcoder.cn/aqcoder.cn.cer;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span> /etc/ssl/aqcoder.cn/aqcoder.cn.key;</span><br><span class="line">    <span class="attribute">ssl_session_cache</span>    shared:SSL:<span class="number">4m</span>;</span><br><span class="line">    <span class="attribute">ssl_session_timeout</span>  <span class="number">10m</span>;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span>  HIGH:!aNULL:!MD5;</span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span>  <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">charset</span> utf-<span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># static files</span></span><br><span class="line">    <span class="section">location</span><span class="regexp"> ^~</span> /browser &#123;</span><br><span class="line">    <span class="attribute">proxy_pass</span> https://127.0.0.1:9980;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Host <span class="variable">$http_host</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># WOPI discovery URL</span></span><br><span class="line">    <span class="section">location</span><span class="regexp"> ^~</span> /hosting/discovery &#123;</span><br><span class="line">    <span class="attribute">proxy_pass</span> https://127.0.0.1:9980;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Host <span class="variable">$http_host</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Capabilities</span></span><br><span class="line">    <span class="section">location</span><span class="regexp"> ^~</span> /hosting/capabilities &#123;</span><br><span class="line">    <span class="attribute">proxy_pass</span> https://127.0.0.1:9980;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Host <span class="variable">$http_host</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># main websocket</span></span><br><span class="line">    <span class="section">location</span> <span class="regexp">~ ^/cool/(.*)/ws$</span> &#123;</span><br><span class="line">    <span class="attribute">proxy_pass</span> https://127.0.0.1:9980;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Connection <span class="string">&quot;Upgrade&quot;</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Host <span class="variable">$http_host</span>;</span><br><span class="line">    <span class="attribute">proxy_read_timeout</span> <span class="number">36000s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># download, presentation and image upload</span></span><br><span class="line">    <span class="section">location</span> <span class="regexp">~ ^/(c|l)ool</span> &#123;</span><br><span class="line">    <span class="attribute">proxy_pass</span> https://127.0.0.1:9980;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Host <span class="variable">$http_host</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Admin Console websocket</span></span><br><span class="line">    <span class="section">location</span><span class="regexp"> ^~</span> /cool/adminws &#123;</span><br><span class="line">    <span class="attribute">proxy_pass</span> https://127.0.0.1:9980;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Connection <span class="string">&quot;Upgrade&quot;</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Host <span class="variable">$http_host</span>;</span><br><span class="line">    <span class="attribute">proxy_read_timeout</span> <span class="number">36000s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>后来也是借着<a href="https://docs.cloudreve.org/use/wopi#collabora-online-libreoffice-online">cloudreve官方文档</a>查到了<a href="https://sdk.collaboraonline.com/docs/installation/CODE_Docker_image.html#how-to-configure-docker-image">collaboraonline官方文档</a></p><p><a href="https://sdk.collaboraonline.com/docs/installation/CODE_Docker_image.html#how-to-configure-docker-image">collaboraonline官方文档</a>有一处配置<code>server_name</code>,解释是:CODE没有为websocket连接提供正确的主机，如果在它前面有一个代理。</p><p><img src="/./img/b/614f4f28/645ca3a0b9a14.jpg" alt="server_name"></p><p>简单来说呢,就是可以设置主机名</p><p>所以正确的docker部署命令应该是:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -t -d -p 9980:9980 \</span><br><span class="line">           -e &quot;aliasgroup1=https://file.aqcoder.cn:443&quot; \</span><br><span class="line">           -e &quot;username=xxx&quot; \</span><br><span class="line">           -e &quot;password=xxxx&quot; \</span><br><span class="line">           -e &quot;server_name=view1.aqcoder.cn&quot; \</span><br><span class="line">           --cap-add MKNOD \</span><br><span class="line">           --name code --restart always collabora/code</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>多看文档</p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://www.jianshu.com/p/3f99d45fb4b8">onlyoffice配置ssl证书并进行Nginx反向代理遇到的坑，docker 安装onlyoffice Nginx SSL</a></p><p><a href="https://helpcenter.onlyoffice.com/installation/docs-community-proxy.aspx">在代理后使用 ONLYOFFICE Docs - ONLYOFFICE</a></p><p><a href="https://sdk.collaboraonline.com/docs/installation/CODE_Docker_image.html#how-to-configure-docker-image">CODE Docker image — SDK</a></p><p><a href="https://docs.cloudreve.org/use/wopi#onlyoffice">扩展文档预览&#x2F;编辑 - Cloudreve</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> 云文件管理系统 </tag>
            
            <tag> Cloudreve </tag>
            
            <tag> Nginx代理 </tag>
            
            <tag> 预览office </tag>
            
            <tag> Onlyoffice </tag>
            
            <tag> CollaboraOnline </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ffmpeg常用命令</title>
      <link href="/posts/3c4e255/"/>
      <url>/posts/3c4e255/</url>
      
        <content type="html"><![CDATA[<p>ffmpeg是一款跨平台的音视频处理工具，可以实现多种格式的音视频编码、解码、转换和编辑。</p><h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><h3 id="查看版本信息"><a href="#查看版本信息" class="headerlink" title="查看版本信息"></a>查看版本信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -version</span><br></pre></td></tr></table></figure><h3 id="查看支持的编解码器"><a href="#查看支持的编解码器" class="headerlink" title="查看支持的编解码器"></a>查看支持的编解码器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -codecs</span><br></pre></td></tr></table></figure><h3 id="查看支持的格式"><a href="#查看支持的格式" class="headerlink" title="查看支持的格式"></a>查看支持的格式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -formats</span><br></pre></td></tr></table></figure><h3 id="视频转码"><a href="#视频转码" class="headerlink" title="视频转码"></a>视频转码</h3><p>将视频文件从一种格式转换为另一种格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 output.avi</span><br></pre></td></tr></table></figure><ul><li>压缩参数讲解</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-r 20 #帧率20</span><br><span class="line">-s 1280x720 #设置分辨率</span><br><span class="line">-vf scale=iw*0.75:ih*0.75 #设置分辨率为原来的0.75，与-s互斥使用</span><br><span class="line">-b:v 500k #视频的码率为500k</span><br><span class="line">libx264 #使用libx264编码库编码</span><br></pre></td></tr></table></figure><h3 id="音频转码"><a href="#音频转码" class="headerlink" title="音频转码"></a>音频转码</h3><p>将音频文件从一种格式转换为另一种格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp3 output.wav</span><br></pre></td></tr></table></figure><h3 id="视频裁剪"><a href="#视频裁剪" class="headerlink" title="视频裁剪"></a>视频裁剪</h3><p>将视频文件裁剪为指定长度：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -ss 00:00:10 -t 00:00:30 -i input.mp4 -c:v copy -c:a copy output.mp4</span><br></pre></td></tr></table></figure><p>其中，<code>-ss</code>表示起始时间，<code>-t</code>表示时长，也可指定剪辑结束时间 <code>-to</code>(与<code>-t</code>互斥)</p><h3 id="视频截图"><a href="#视频截图" class="headerlink" title="视频截图"></a>视频截图</h3><p>对视频文件进行截图：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -ss 00:00:10 -vframes 1 output.jpg</span><br></pre></td></tr></table></figure><p>其中，<code>-vframes</code>表示帧数，这里设置为1，即截取一张图片。</p><h3 id="提取音频"><a href="#提取音频" class="headerlink" title="提取音频"></a>提取音频</h3><p>从视频中提取音频：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -vn -acodec copy output.aac</span><br></pre></td></tr></table></figure><p>其中，<code>-vn</code>表示不需要视频流，<code>-acodec</code>表示音频编解码器。</p><h3 id="添加水印"><a href="#添加水印" class="headerlink" title="添加水印"></a>添加水印</h3><p>给视频添加水印：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -i watermark.png -filter_complex &quot;overlay=10:10&quot; output.mp4</span><br></pre></td></tr></table></figure><p>其中，<code>-i</code>表示输入文件，<code>-filter_complex</code>表示复合滤镜。<code>overlay</code>表示叠加效果，这里将水印放在左上角，坐标为(10,10)。</p><h3 id="去除水印"><a href="#去除水印" class="headerlink" title="去除水印"></a>去除水印</h3><p>查看视频帧信息</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffprobe <span class="literal">-v</span> error <span class="literal">-select_streams</span> v:<span class="number">0</span> <span class="literal">-show_entries</span> stream=width,height <span class="literal">-of</span> csv=s=x:p=<span class="number">0</span> input.mp4</span><br></pre></td></tr></table></figure><p>去除水印</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg <span class="literal">-i</span> input.mp4 <span class="literal">-filter_complex</span> <span class="string">&quot;delogo=x=10:y=H-h-10:w=100:h=100:show=0&quot;</span> <span class="literal">-c</span>:a <span class="built_in">copy</span> output.mp4</span><br></pre></td></tr></table></figure><p><code>H</code> 表示视频帧的高度，而 <code>h</code> 表示要删除的矩形区域的高度。因此，<code>H-h</code> 的结果是视频帧顶部到要删除的区域底部的距离。</p><h2 id="高级操作"><a href="#高级操作" class="headerlink" title="高级操作"></a>高级操作</h2><h3 id="视频拼接"><a href="#视频拼接" class="headerlink" title="视频拼接"></a>视频拼接</h3><p>将多个视频文件拼接成一个文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i &quot;concat:input1.mp4|input2.mp4|input3.mp4&quot; -c copy output.mp4</span><br></pre></td></tr></table></figure><p>其中，<code>-i</code>指定输入文件，使用<code>concat</code>协议拼接三个文件。</p><h3 id="视频加速"><a href="#视频加速" class="headerlink" title="视频加速"></a>视频加速</h3><p>将视频文件加速播放：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -filter:v &quot;setpts=0.5*PTS&quot; output.mp4</span><br></pre></td></tr></table></figure><p>其中，<code>-filter:v</code>表示视频滤镜，<code>setpts</code>表示设置帧时间戳，这里将帧时间戳减半，即加速为原来的两倍。</p><h3 id="音频混音"><a href="#音频混音" class="headerlink" title="音频混音"></a>音频混音</h3><p>将多个音频文件混合为一个文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input1.mp3 -i input2.mp3 -filter_complex amix=inputs=2:duration=first output.mp3</span><br></pre></td></tr></table></figure><p>其中，<code>amix</code>表示音频混音效果，<code>inputs</code>表示输入音频数，这里为2；<code>duration</code>表示以第一个输入音频为准，以其时长为混合后音频的时长。</p><h2 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h2><h3 id="文件夹内所有指定后缀文件操作"><a href="#文件夹内所有指定后缀文件操作" class="headerlink" title="文件夹内所有指定后缀文件操作"></a>文件夹内所有指定后缀文件操作</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /<span class="built_in">r</span> %i <span class="keyword">in</span> (*.flac) <span class="keyword">do</span> some orders</span><br></pre></td></tr></table></figure><p>例如，将文件夹内所有的flac文件转mp3文件：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /<span class="built_in">r</span> %i <span class="keyword">in</span> (*.flac) <span class="keyword">do</span> ffmpeg <span class="literal">-i</span> <span class="string">&quot;%i&quot;</span> <span class="literal">-ab</span> <span class="number">320</span>k <span class="literal">-map_metadata</span> <span class="number">0</span> <span class="literal">-id3v2_version</span> <span class="number">3</span> <span class="string">&quot;%~dpni.mp3&quot;</span></span><br></pre></td></tr></table></figure><p><code>%~dpni</code> 是一个批处理脚本中获取文件名的语法格式，用于提取文件路径和文件名（去掉扩展名）。</p><ul><li><code>%i</code> 为循环变量，代表当前循环到的文件。</li><li><code>%d</code> 提取驱动器号码，例如 C:\</li><li><code>%p</code> 提取文件路径，不包括驱动器号码，例如 \Music\FLAC\</li><li><code>%n</code> 提取不带扩展名的文件名，例如 example</li><li><code>%i</code> 提取完整文件名，例如 example.flac</li></ul><p>所以 <code>%~dpni.mp3</code> 将会把 <code>%i</code> 中的文件通过 FFmpeg 转换成 MP3 文件，并将其放在与原始文件相同的目录下，文件名也将与原始文件名相同，只是文件扩展名更改为 <code>.mp3</code>。</p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>这里只是列举了ffmpeg常用的一些命令及其使用方法，更多详细内容请参考<a href="https://ffmpeg.org/ffmpeg.html">ffmpeg官方文档</a>。</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ffmpeg </tag>
            
            <tag> 音视频处理 </tag>
            
            <tag> 命令行工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>阿里云新建用户并授予指定权限</title>
      <link href="/posts/eeb9c508/"/>
      <url>/posts/eeb9c508/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>在使用阿里云系列产品，需要用到账户密钥时，为确保安全，一般只是使用只有某种权限的用户，以保证泄露密钥后不会危及到其他产品系列的资源，达到损失可控，本教程旨在如何创建用户并授予指定权限，最后并拿到AccessKey安全使用API。</p><h2 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h2><p>登录阿里云：<a href="https://www.aliyun.com/">https://www.aliyun.com/</a></p><p>创建用户：<a href="https://ram.console.aliyun.com/users/">https://ram.console.aliyun.com/users/</a></p><p>图解：</p><p><img src="/./img/b/eeb9c508/6400bedfcb2f4.png" alt="创建用户-1"></p><p>创建用户需要注意：如果只用于访问API，则访问方式只选择OpenAPI调用访问</p><p><img src="/./img/b/eeb9c508/6400bf4aa8406.png" alt="创建用户-2"></p><p>创建成功记得复制<code>AccessKey ID</code>和<code>AccessKey Secret</code></p><p><img src="/./img/b/eeb9c508/6400bfd0994cc.png" alt="创建成功"></p><p>然后选择该用户，添加权限：</p><p><img src="/./img/b/eeb9c508/6400c0198c71d.png" alt="添加权限"></p><p>授权用户访问CDN系列产品，则搜索cdn，选择管理xxxx的权限即可，一般第一个权限是拥有产品系列全部权限的选项，例如CDN全部权限（如上图）。</p><p>如果想授权DNS系列产品的权限，则添加以下权限：</p><p><img src="/./img/b/eeb9c508/6400c0d20d7ed.png" alt="dns"></p><h2 id="获取AccessKey"><a href="#获取AccessKey" class="headerlink" title="获取AccessKey"></a>获取AccessKey</h2><p>上一步成功创建用户时已经拿到了AccessKey，如果忘记了点进用户详情重新生成即可。</p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 阿里云 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>腾讯云新建用户并授予指定权限</title>
      <link href="/posts/338bc34e/"/>
      <url>/posts/338bc34e/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>在使用腾讯云系列产品，需要用到账户密钥时，为确保安全，一般只是使用只有某种权限的用户，以保证泄露密钥后不会危及到其他产品系列的资源，达到损失可控，本教程旨在如何创建用户并授予指定权限，最后并拿到AccessKey安全使用API。</p><h2 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h2><p>登录腾讯云：<a href="https://cloud.tencent.com/">https://cloud.tencent.com/</a></p><p>创建用户：<a href="https://console.cloud.tencent.com/cam/user/userType">https://console.cloud.tencent.com/cam/user/userType</a></p><p>图解：</p><p>访问方式选择编程访问</p><p><img src="/./img/b/338bc34e/6400c4d3b55cd.png" alt="创建用户"></p><p>用户权限如果选择DNS系列产品则选择<code>DNSPod全读写访问权限</code>：</p><p><img src="/./img/b/338bc34e/6400c5114b935.png" alt="DNSPod全读写访问权限"></p><p>如果选择DNS系列产品则选择<code>内容分发网络（CDN）全读写访问权限</code>：</p><p><img src="/./img/b/338bc34e/6400c50378eb6.png" alt="内容分发网络（CDN）全读写访问权限"></p><p>创建成功即可获取到<code>SecretId</code>和<code>SecretKey</code>：</p><p><img src="/./img/b/338bc34e/6400c5d4a72c2.png" alt="创建成功"></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 腾讯云 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>给你的域名申请一个泛域名证书吧</title>
      <link href="/posts/84609bb0/"/>
      <url>/posts/84609bb0/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>你还在为个人域名的证书而烦恼嘛？试试Let’s Encrypt吧，它能提供免费的泛域名证书，让你的子域名都能有一个安全的小锁头，非常适合因国内云计算厂商ssl证书数量限制而困扰的小伙伴，快来试试吧。</p><p>先介绍一下这次主角：<a href="https://letsencrypt.org/">letsencrypt.org</a> , 是一个免费的、自动化的、开放的证书颁发机构。截至2018年9月，它的全球SSL证书市场份额已超过50%，得到主流浏览器和厂商的认可与支持。Let’s Encrypt证书提供免费的申请，但每次申请到的SSL证书有效期只有90天，可以通过脚本实现提前自动续约达到自动化永久免费使用的目的。</p><p>利用Let’s Encrypt免费提供泛域名证书的申请，我们可以借助服务器脚本实现到期续签，自动刷新过期时间。</p><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>一个域名</p><p>一台服务器（用于申请证书以及运行续签脚本）</p><p>本教程以申请aqcoder.cn（腾讯云）以及notifyou.top（阿里云）的泛域名证书为例</p><h2 id="下载仓库"><a href="#下载仓库" class="headerlink" title="下载仓库"></a>下载仓库</h2><p>下载仓库：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/acmesh-official/acme.sh.git </span><br></pre></td></tr></table></figure><p>下载仓库(加速)：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://gitclone.com/github.com/acmesh-official/acme.sh.git </span><br></pre></td></tr></table></figure><h2 id="上传acme-sh"><a href="#上传acme-sh" class="headerlink" title="上传acme.sh"></a>上传acme.sh</h2><p>上传acme.sh到服务器<code>/root</code>目录，使用<code>root</code>用户执行后面的命令（acme.sh也有说明可以使用其他用户运行，但为确保一些权限问题，先使用root用户运行成功，再尝试使用其他用户）。</p><h2 id="执行安装命令"><a href="#执行安装命令" class="headerlink" title="执行安装命令"></a>执行安装命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh acme.sh --install</span><br></pre></td></tr></table></figure><h2 id="配置SecretKey和SecretId"><a href="#配置SecretKey和SecretId" class="headerlink" title="配置SecretKey和SecretId"></a>配置SecretKey和SecretId</h2><p>域名服务商申请SecretId和SecretKey，阿里云的查看<a href="/posts/eeb9c508/">这里</a>，腾讯云的查看<a href="/posts/338bc34e/">这里</a></p><p>将上述的<code>SecretKey</code>和<code>SecretId</code>写到<code>~/..bash_profile</code>，保存方法：<a href="https://github.com/acmesh-official/acme.sh/wiki/dnsapi">https://github.com/acmesh-official/acme.sh/wiki/dnsapi</a></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .bash_profile</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># Get the aliases and functions</span></span><br><span class="line"><span class="attr">if</span> <span class="string">[ -f ~/.bashrc ]; then</span></span><br><span class="line"><span class="attr">.</span> <span class="string">~/.bashrc</span></span><br><span class="line"><span class="attr">fi</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># User specific environment and startup programs</span></span><br><span class="line"></span><br><span class="line"><span class="attr">PATH</span>=<span class="string">$PATH:$HOME/bin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#腾讯云</span></span><br><span class="line"><span class="attr">export</span> <span class="string">DP_Id=&quot;A1111111111111111s&quot;</span></span><br><span class="line"><span class="attr">export</span> <span class="string">DP_Key=&quot;F11111111111111111b&quot;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#阿里云</span></span><br><span class="line"><span class="attr">export</span> <span class="string">Ali_Key=&quot;L1111111111111111111t&quot;</span></span><br><span class="line"><span class="attr">export</span> <span class="string">Ali_Secret=&quot;p1111111111111111C&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">export</span> <span class="string">PATH</span></span><br></pre></td></tr></table></figure><h2 id="申请证书"><a href="#申请证书" class="headerlink" title="申请证书"></a>申请证书</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">腾讯云</span></span><br><span class="line">sh acme.sh --issue --dns dns_dp -d aqcoder.cn  -d *.aqcoder.cn</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">阿里云</span></span><br><span class="line">sh acme.sh --issue --dns dns_ali -d aqcoder.cn  -d *.aqcoder.cn</span><br></pre></td></tr></table></figure><p>出现错误是因为还没有通过<a href="https://letsencrypt.org/">Let’s Encrypt</a>验证，而<a href="https://letsencrypt.org/">Let’s Encrypt</a>提供两种方式验证，一个是HTTP文件验证，一个是DNS-API验证，这里推荐使用DNS-API验证</p><p><img src="/./img/b/84609bb0/6400c7e95e4e1.png" alt="出现错误"></p><h2 id="添加解析"><a href="#添加解析" class="headerlink" title="添加解析"></a>添加解析</h2><p>阿里云添加TXT解析，<a href="https://dns.console.aliyun.com/">位置</a>：</p><p><img src="/./img/b/84609bb0/6400c90951415.png" alt="阿里云添加TXT解析"></p><p>腾讯云添加TXT解析，<a href="https://console.cloud.tencent.com/cns">位置</a>：</p><p><img src="/./img/b/84609bb0/6400c95f6242c.png" alt="腾讯云添加TXT解析"></p><h2 id="重新运行"><a href="#重新运行" class="headerlink" title="重新运行"></a>重新运行</h2><p>稍等片刻重新运行，记得添加<code>--renew</code>参数</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">腾讯云</span></span><br><span class="line">sh acme.sh --issue --dns dns_dp -d aqcoder.cn  -d *.aqcoder.cn --renew</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">阿里云</span></span><br><span class="line">sh acme.sh --issue --dns dns_ali -d aqcoder.cn  -d *.aqcoder.cn --renew</span><br></pre></td></tr></table></figure><p><img src="/./img/b/84609bb0/6400ca9e3f138.png" alt="成功申请泛域名证书"></p><h2 id="查看定时任务"><a href="#查看定时任务" class="headerlink" title="查看定时任务"></a>查看定时任务</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure><p>可以看到，acme.sh已经生成一个定时任务了</p><p><img src="/./img/b/84609bb0/6400cb4ab9473.png" alt="查看定时任务"></p><h2 id="拷贝证书"><a href="#拷贝证书" class="headerlink" title="拷贝证书"></a>拷贝证书</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sh acme.sh --install-cert -d aqcoder.cn \ </span><br><span class="line">--key-file /etc/ssl/aqcoder.cn/aqcoder.cn.key  \</span><br><span class="line">--fullchain-file /etc/ssl/aqcoder.cn/aqcoder.cn.cer  \</span><br><span class="line">--reloadcmd &#x27;service nginx force-reload&#x27;</span><br></pre></td></tr></table></figure><p>拷贝证书可以让acme.sh申请到的证书复制到指定目录，执行后拷贝证书的操作也会在定时任务中。</p><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="添加解析-1"><a href="#添加解析-1" class="headerlink" title="添加解析"></a>添加解析</h3><p><img src="/./img/b/84609bb0/6400cc6f00cf4.png" alt="腾讯云添加解析"></p><p><img src="/./img/b/84609bb0/6400cc6ca7cbc.png" alt="阿里云添加解析"></p><h3 id="nginx配置"><a href="#nginx配置" class="headerlink" title="nginx配置"></a>nginx配置</h3><p>aqcoder.cn</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#test.aqcoder.cn</span><br><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name test.aqcoder.cn;</span><br><span class="line"></span><br><span class="line">    rewrite ^(.*)$ https://$host$request_uri;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl;</span><br><span class="line">    server_name test.aqcoder.cn;</span><br><span class="line"></span><br><span class="line">    ssl_certificate /etc/ssl/aqcoder.cn/aqcoder.cn.cer;</span><br><span class="line">    ssl_certificate_key /etc/ssl/aqcoder.cn/aqcoder.cn.key;</span><br><span class="line">    ssl_session_cache    shared:SSL:4m;</span><br><span class="line">    ssl_session_timeout  10m;</span><br><span class="line">    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    ssl_prefer_server_ciphers  on;</span><br><span class="line">    charset utf-8;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:5704;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>notifyou.top</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">test.notifyou.top</span></span><br><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name test.notifyou.top;</span><br><span class="line"></span><br><span class="line">    rewrite ^(.*)$ https://$host$request_uri;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl;</span><br><span class="line">    server_name test.notifyou.top;</span><br><span class="line"></span><br><span class="line">    ssl_certificate /etc/ssl/notifyou.top/notifyou.top.cer;</span><br><span class="line">    ssl_certificate_key /etc/ssl/notifyou.top/notifyou.top.key;</span><br><span class="line">    ssl_session_cache    shared:SSL:4m;</span><br><span class="line">    ssl_session_timeout  10m;</span><br><span class="line">    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    ssl_prefer_server_ciphers  on;</span><br><span class="line">    charset utf-8;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:9121;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="访问成功，出现https安全小锁头"><a href="#访问成功，出现https安全小锁头" class="headerlink" title="访问成功，出现https安全小锁头"></a>访问成功，出现https安全小锁头</h3><p><img src="/./img/b/84609bb0/6400cd0164883.png" alt="test.aqcoder.cn"></p><p><img src="/./img/b/84609bb0/6400cd9e62ad8.png" alt="test.notifyou.top"></p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>现如今计算云厂商对单域名证书的数量有着严格限制，这对于我的多子域名的需求极其不友好，一个免费泛域名证书可以完美解决，既省去了泛域名证书高昂的费用，也实现了自动化续期，达到无限期使用泛域名证书的目的，当然了，如果要使用在一些商用业务，建议还是购买云计算厂商的证书或者自建CA，确保业务安全。</p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://juejin.cn/post/7136001093720342542">Let’s Encrypt免费泛域名SSL证书申请及自动续签</a></p><p><a href="https://blog.csdn.net/qq_33317586/article/details/84842398">第一次使用acme.sh 手动生成证书</a></p><p><a href="https://cloud.tencent.com/developer/article/1736866">acme从letsencrypt 生成免费通配符&#x2F;泛域名SSL证书并自动续期</a></p><p><a href="https://github.com/acmesh-official/acme.sh/wiki/dnsapi">dnsapi · acmesh-official&#x2F;acme.sh Wiki</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 证书 </tag>
            
            <tag> 域名 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>watchtower-一个用于自动更新Docker容器镜像的实用工具</title>
      <link href="/posts/299c5c1e/"/>
      <url>/posts/299c5c1e/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>watchtower是一个用于自动更新Docker容器镜像的实用工具，它能够自动监控指定容器的更新，能够自动拉取最新镜像并实现平滑部署。</p><p>github地址：<a href="https://github.com/containrrr/watchtower">https://github.com/containrrr/watchtower</a></p><p>官网：<a href="https://containrrr.dev/watchtower/">https://containrrr.dev/watchtower/</a></p><h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><p>服务器执行标准启动命令，watchtower会以每5分钟检查docker所有容器是否已达到最新版本，如不是，则拉取最新镜像，停止运行容器，以最初的启动命令重新启动容器</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">--name watchtower \</span><br><span class="line">-v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">containrrr/watchtower</span><br></pre></td></tr></table></figure><p>可通过<code>--cleanup</code>删除旧版本镜像</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">--name watchtower \</span><br><span class="line">-v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">containrrr/watchtower \</span><br><span class="line">--cleanup</span><br></pre></td></tr></table></figure><h2 id="指定容器更新"><a href="#指定容器更新" class="headerlink" title="指定容器更新"></a>指定容器更新</h2><p>可在标准启动命令后加上指定容器名，便可指定容器更新</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">--name watchtower \</span><br><span class="line">-v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">containrrr/watchtower 容器名 \</span><br><span class="line">--cleanup</span><br></pre></td></tr></table></figure><p>容器名指的是启动容器时设置<code>--name</code>参数的名称，比如我的<a href="https://alist.nn.ci/zh/">alist</a>启动命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd \</span><br><span class="line">--name alist \</span><br><span class="line">-p 9125:5244 \</span><br><span class="line">-v /www/alist:/opt/alist/data \</span><br><span class="line">--restart=always xhofe/alist:latest</span><br></pre></td></tr></table></figure><p>则alist容器名为alist，更新alist时我只需要运行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">--name watchtower \</span><br><span class="line">-v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">containrrr/watchtower alist \</span><br><span class="line">--cleanup</span><br></pre></td></tr></table></figure><h2 id="自动更新频率"><a href="#自动更新频率" class="headerlink" title="自动更新频率"></a>自动更新频率</h2><p>可通过<code>--interval</code>（简写<code>-i</code>）参数, 配置更新周期,默认300秒</p><p>或者<code>--schedule</code>,（简写<code>-s</code>） 配置定时更新,使用<code>Cron表达式</code>,例如<code>&quot;0 0 1 * * *&quot;</code>.即每天凌晨1点更新</p><div class="note warning simple"><p>配置了自动更新频率需要确定时区为<code>Asia</code></p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">--name watchtower \</span><br><span class="line">-e TZ=Asia/Shanghai \</span><br><span class="line">-v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">containrrr/watchtower -i 1200 容器名 \</span><br><span class="line">--cleanup</span><br></pre></td></tr></table></figure><h2 id="手动更新"><a href="#手动更新" class="headerlink" title="手动更新"></a>手动更新</h2><p>可以通过<code>--run-once</code>实现运行watchtower容器更新后停止运行，即运行一次</p><p>还可添加<code>--rm</code>删除watchtower镜像。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run --rm -d \</span><br><span class="line">--name watchtower \</span><br><span class="line">-e TZ=Asia/Shanghai \</span><br><span class="line">-v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">containrrr/watchtower -i 1200 容器名 \</span><br><span class="line">--cleanup --run-once</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>虽然可以通过停止容器，拉取镜像，重新运行容器这三步操作来实现watchtower的功能，但是它能够简化命令，减少重新部署容器的运行参数错误，定时更新等等，是一个高效率的更新容器方式。</p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://www.ioiox.com/archives/84.html">https://www.ioiox.com/archives/84.html</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> watchtower </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022年总结回顾</title>
      <link href="/posts/800c9b83/"/>
      <url>/posts/800c9b83/</url>
      
        <content type="html"><![CDATA[<h2 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h2><p>8月份开始弄的博客，现在有4个多月了，搭建的博客也有了60篇的文章，每一篇都又自己的精力付出和自身感悟</p><p><img src="/./img/b/800c9b83/63b05a3c6f020.png" alt="文章数"></p><p>10多个站点，一半都是<a href="https://vercel.com/">vercel</a>和<a href="https://app.netlify.com/">netlify</a>支楞起来的</p><p><img src="/./img/b/800c9b83/63b05a850b869.png" alt="站点数"></p><p>20多个vercel服务，不得不说<code>vercel</code>嘎嘎香</p><p><img src="/./img/b/800c9b83/63b05ae53f137.png" alt="vercel项目数"></p><p>1000多次的github提交，在这4个月里活跃了许久，希望未来也是如此</p><p><img src="/./img/b/800c9b83/63b05b52b6ab7.png" alt="github提交日历"></p><p><img src="/./img/b/800c9b83/63b05ee097952.png" alt="github统计数据"></p><p>虽然只有几个stars，但最起码迈开了步伐，拥有了在编程领域走下去的勇气</p><p><img src="/./img/b/800c9b83/63b0610285021.png" alt="stars"></p><h2 id="自省"><a href="#自省" class="headerlink" title="自省"></a>自省</h2><p>回顾2022年，发现了自身的拖延、没有方向感、懒惰等问题，希望2023的一年能正视自我，不再摆烂。</p><h2 id="寄语"><a href="#寄语" class="headerlink" title="寄语"></a>寄语</h2><p>最后送给2023的自己几句话，也送给看到这里的读者：</p><p>吾生也有涯，而知也无涯。以有涯随无涯，殆已！已而为知者，殆而已矣！</p><p>能在2023年健康地活着！</p><p>不摆烂就是努力了</p>]]></content>
      
      
      <categories>
          
          <category> 博客总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 年度总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记一次误操作删除了mysql容器以及后续的补救措施</title>
      <link href="/posts/acf7fe48/"/>
      <url>/posts/acf7fe48/</url>
      
        <content type="html"><![CDATA[<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p> 前几天想配置一下mysql容器的载挂目录，查了下资料后也照着做了，删除容器，运行容器，一切就这么自然而然，唯独没有备份数据。直到两天后我登不上图床那一刻我才发现数据库没了！</p><h2 id="补救"><a href="#补救" class="headerlink" title="补救"></a>补救</h2><p>先看看<a href="https://github.com/lsky-org/lsky-pro/issues?page=2&q=%E6%95%B0%E6%8D%AE%E5%BA%93">issues</a>有没有类似情况的，哦没有</p><p>找一下<a href="https://juejin.cn/post/6960543146874765320">掘金</a>上的文章，和我的情况大抵相同，也是删除了容器，尝试了下，找到了被我的删除的数据卷：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /var/lib/docker/volumes</span><br><span class="line">du -sh *</span><br></pre></td></tr></table></figure><p><img src="/./img/b/acf7fe48/63aede4b925e2.png" alt="volumes数据卷.png"></p><p>寻找和删除时间相似且大小比较大的数据卷：</p><p><img src="/./img/b/acf7fe48/63aede9dc846e.png" alt="寻找有价值的数据.png"></p><p>最后锁定了af5开头的，后面照着操作新建一个目录，创建一个容器并载挂新建目录上，再将sf5开头的数据卷复制到新建目录上：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -r /var/lib/docker/volumes/af50bb0f2381c8051c125b0510f78a34fe2d60fa3d5a1e718f400a213c31a66b/_data/* ./</span><br></pre></td></tr></table></figure><p>复制的时候一直提示覆盖，需要临时禁用别名：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unalias cp</span><br></pre></td></tr></table></figure><p>最后用<code>docker exec -it xxx /bin/bash</code>命令进到容器，连接mysql后能找到<code>lsky</code>数据库，就是<code>show tables;</code>的时候提示没有权限。</p><p><img src="/./img/b/acf7fe48/63aee018ce0c3.png" alt="权限不足.png"></p><p>用命令<code>chown -R mysql:mysql /var/lin/mysql</code>加了权限后，查询数据时提示说表不存在：</p><p><img src="/./img/b/acf7fe48/63aedf4434b2c.png" alt="恢复失败.png"></p><p>后来我想到是不是应该将数据卷的拥有者和组一起复制进新建目录的，毕竟网上说改成<code>mysql</code>可能过时了，我也是兜兜转转了好久才明白权限的问题：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -rp /var/lib/docker/volumes/af50bb0f2381c8051c125b0510f78a34fe2d60fa3d5a1e718f400a213c31a66b/_data/* ./</span><br></pre></td></tr></table></figure><p><code>-p</code>选项是除复制文件的内容外，还把修改时间和访问权限也复制到新文件中。</p><p>最后查询数据成功：</p><p><img src="/./img/b/acf7fe48/63aee31f95be7.png" alt="查询数据成功.png"></p><p>用navicat导出了表结构和数据，重新导入了最新创建的mysql，登录图床成功：</p><p><img src="/./img/b/acf7fe48/63aee38db9af9.png" alt="登录成功.png"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>删除容器前请再好好想想，有没有较为重要的数据没有备份好，特别是数据库方面的，一定要做好备份，毕竟数据无价。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂谈 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python的网络请求库requests简单使用</title>
      <link href="/posts/39604062/"/>
      <url>/posts/39604062/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><a href="https://github.com/psf/requests">requests</a>库是python中一个最常用的网络请求库，在爬虫时使用甚多。它请求的方式简单，只需简单地调用其内置地get、post等方法即可发送请求。本文章从面向对象的角度来介绍其使用方法以及源码解析。</p><p><a href="https://github.com/psf/requests">requests</a>库使用了<a href="https://restfulapi.cn/">restful</a>风格设计的api，即<code>get</code>，<code>post</code>，<code>put</code>，<code>patch</code>，<code>delete</code>五种 HTTP 方法，对应了 <code>CRUD</code> 操作。</p><h3 id="Requests请求对象"><a href="#Requests请求对象" class="headerlink" title="Requests请求对象"></a>Requests请求对象</h3><p>在<a href="https://github.com/psf/requests">requests</a>中，这几个<a href="https://github.com/psf/requests/blob/main/requests/api.py">api</a>入参后会构造一个<a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/models.py#L230">Requests</a>对象：</p><ul><li><code>method</code>：请求方法，默认<code>get</code>，可选择的有：<code>get</code>，<code>post</code>，<code>put</code>，<code>patch</code>，<code>delete</code>，<code>head</code>，<code>options</code>，例如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">requests.request(method=<span class="string">&#x27;get&#x27;</span>,url=<span class="string">&#x27;https://api.bimg.cc/all&#x27;</span>)</span><br></pre></td></tr></table></figure><p>这种写法有些冗余，所以一般不使用<code>request</code>方法，而是直接使用<a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/api.py#L62">requests.get</a>，<a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/api.py#L103">requests.post</a>，<a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/api.py#L118">requests.put</a>，<a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/api.py#L133">requests.patch</a>，<a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/api.py#L148">requests.delete</a>，<a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/api.py#L88">requests.head</a>，<a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/api.py#L76">requests.options</a>，例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">requests.get(<span class="string">&#x27;https://api.github.com&#x27;</span>)</span><br><span class="line">requests.post(<span class="string">&#x27;https://httpbin.org/post&#x27;</span>, data=&#123;<span class="string">&#x27;key&#x27;</span>:<span class="string">&#x27;value&#x27;</span>&#125;)</span><br><span class="line">requests.put(<span class="string">&#x27;https://httpbin.org/put&#x27;</span>, data=&#123;<span class="string">&#x27;key&#x27;</span>:<span class="string">&#x27;value&#x27;</span>&#125;)</span><br><span class="line">requests.delete(<span class="string">&#x27;https://httpbin.org/delete&#x27;</span>)</span><br></pre></td></tr></table></figure><ul><li><code>url</code>：请求地址，必选，例如<a href="https://api.bimg.cc/">https://api.bimg.cc</a></li><li><code>headers</code>：请求头，例如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">requests.get(<span class="string">&#x27;https://api.bimg.cc/all&#x27;</span>,headers=&#123;<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>:<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;Access-Control-Allow-Headers&#x27;</span>:<span class="string">&#x27;Content-Type&#x27;</span>,<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>:<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&#x27;application/json;charset=utf-8&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><ul><li><code>files</code>：文件列表，上传文件，<a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/api.py#L26">详情</a></li><li><code>params</code>：请求参数，在<code>get</code>方法中，可以用<code>?key=value</code>来作为请求参数，也可使用<code>params=&#123;&#39;key&#39;:&#39;value&#125;</code>的形式来请求参数，例如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">response = requests.get(<span class="string">&#x27;https://api.bimg.cc/all&#x27;</span>,params=&#123;<span class="string">&#x27;page&#x27;</span>: <span class="string">&#x27;2&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(response.json())</span><br></pre></td></tr></table></figure><ul><li><code>data</code>：请求参数，在<code>post</code>等方法中，如果是表单请求（即请求内容是<code>application/x-www-form-urlencoded</code>），可使用<code>data=&#123;&#39;key&#39;:&#39;value&#39;&#125;</code>的形式发送请求参数，例如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">requests.post(<span class="string">&#x27;https://httpbin.org/post&#x27;</span>, data=&#123;<span class="string">&#x27;key&#x27;</span>:<span class="string">&#x27;value&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><ul><li><code>json</code>：请求参数，在<code>post</code>等方法中，如果是发送<code>json</code>数据（即请求内容是<code>application/json</code>），可使用<code>json=&#123;&#39;key&#39;:&#39;value&#39;&#125;</code>的形式发送请求参数，例如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">requests.post(<span class="string">&#x27;https://httpbin.org/post&#x27;</span>, json=&#123;<span class="string">&#x27;key&#x27;</span>:<span class="string">&#x27;value&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><ul><li><code>cookies</code>：cookie，保存服务器的一些数据，发送请求时携带在请求头上，<code>headers=&#123;&#39;cookie&#39;:&#39;xxxx&#39;&#125;</code>，或者用以下方法也可携带cookie：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">requests.post(<span class="string">&#x27;https://httpbin.org/post&#x27;</span>, cookies=&#123;<span class="string">&#x27;key&#x27;</span>:<span class="string">&#x27;value&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><ul><li><p><code>auth</code>：认证，等同于在请求头加上<code>&#123;&#39;Authorization&#39;:&#39;xxxxxxxxxxx&#39;&#125;</code>，不常用</p></li><li><p><code>hooks</code>：回调方法</p></li></ul><p><code>requests.get(url, params=None, **kwargs)</code>也设置了一些参数来辅助构造<a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/models.py#L230">Requests</a>对象：</p><ul><li><code>timeout</code> 超时时间(秒)，可整数&#x2F;浮点数，如果请求在规定时间内还未响应，则抛出一个<a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/exceptions.py#L61">exception</a>，也可传入一个包含两个简单浮点数的元组，用来分别设置请求超时时间和读取超时时间，例如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">requests.post(<span class="string">&#x27;https://httpbin.org/post&#x27;</span>, timeout=<span class="number">3</span>)</span><br><span class="line">requests.post(<span class="string">&#x27;https://httpbin.org/post&#x27;</span>, timeout=(<span class="number">2</span>,<span class="number">5</span>))</span><br></pre></td></tr></table></figure><ul><li><code>stream</code>，是否以流的方式传输，默认情况下<code>stream=False</code>，当请求到服务器资源后，它会立即开始下载文件并存放到内存当中，如果文件过大就会导致内存不足的情况，如果以流的方式传输，则请求会先下载响应头，数据内容还未下载，例如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">r = requests.get(<span class="string">&#x27;https://blog.aqcoder.cn/code/txt/version/news.txt&#x27;</span>, stream=<span class="literal">True</span>)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;news.txt&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line"></span><br><span class="line">max_size=<span class="number">10</span>*<span class="number">1024</span>*<span class="number">1024</span> <span class="comment">#文件下载的最大值</span></span><br><span class="line">current_size=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> chunk <span class="keyword">in</span> r.iter_content(chunk_size=<span class="number">512</span>):    <span class="comment"># 按照块的大小读取</span></span><br><span class="line"><span class="comment"># for chunk in r.iter_lines():    # 按照一行一行的读取</span></span><br><span class="line">    <span class="keyword">if</span> chunk <span class="keyword">and</span> current_size&lt;max_size:</span><br><span class="line">        current_size=current_size+<span class="number">512</span></span><br><span class="line">        f.write(chunk)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;no no no&quot;</span>)</span><br></pre></td></tr></table></figure><ul><li><code>proxies</code>，设置代理</li><li><code>verify</code>，是否验证请求地址的证书，默认<code>True</code></li><li><code>cert</code>，证书，如果是<code>String</code>类型，表示.pem文件路径，如果是<code>Tuple</code>类型，表示<code>(&#39;cert&#39;, &#39;key&#39;)</code></li></ul><h3 id="Response响应对象"><a href="#Response响应对象" class="headerlink" title="Response响应对象"></a>Response响应对象</h3><p>在<a href="https://github.com/psf/requests">requests</a>中，这几个<a href="https://github.com/psf/requests/blob/main/requests/api.py">api</a>的返回值是一个<a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/models.py#L641">Response</a>对象：</p><ul><li><code>status_code</code>，<a href="https://github.com/psf/requests/blob/main/requests/status_codes.py">状态码</a>，例如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">response = requests.get(<span class="string">&#x27;https://api.bimg.cc/all&#x27;</span>,params=&#123;<span class="string">&#x27;page&#x27;</span>: <span class="string">&#x27;2&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(response.status_code)</span><br></pre></td></tr></table></figure><ul><li><code>headers</code>，<a href="https://github.com/psf/requests/blob/main/requests/models.py#L649">响应头</a>，例如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">response = requests.get(<span class="string">&#x27;https://api.bimg.cc/all&#x27;</span>,params=&#123;<span class="string">&#x27;page&#x27;</span>: <span class="string">&#x27;2&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(response.headers)</span><br></pre></td></tr></table></figure><ul><li><code>url</code>，请求地址</li><li><code>encoding</code>，编码</li><li><code>cookies</code>，cooike</li></ul><p><a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/models.py#L641">更多参数</a></p><p><a href="https://github.com/psf/requests">requests</a>也设置了一些参数来辅助构造<a href="https://github.com/psf/requests/blob/ec553c275fe915ab8c179a530907b564892d2922/requests/models.py#L641">Response</a>对象：</p><ul><li><code>text</code>，返回响应的内容，unicode类型数据，例如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">response = requests.get(<span class="string">&#x27;https://baidu.com&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure><ul><li><code>content</code>，返回响应的内容，以字节为单位，例如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">response = requests.get(<span class="string">&#x27;https://api.bimg.cc/all&#x27;</span>,params=&#123;<span class="string">&#x27;page&#x27;</span>: <span class="string">&#x27;2&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure><ul><li><code>json()</code>，返回响应的 JSON 对象 ，例如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">response = requests.get(<span class="string">&#x27;https://api.bimg.cc/all&#x27;</span>,params=&#123;<span class="string">&#x27;page&#x27;</span>: <span class="string">&#x27;2&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(response.json())</span><br></pre></td></tr></table></figure><ul><li><code>ok</code>，检查 “status_code” 的值，如果小于400，则返回 True，如果不小于 400，则返回 False，例如：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">response = requests.get(<span class="string">&#x27;https://api.bimg.cc/all&#x27;</span>,params=&#123;<span class="string">&#x27;page&#x27;</span>: <span class="string">&#x27;2&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(response.ok)</span><br></pre></td></tr></table></figure><h2 id="源码解析"><a href="#源码解析" class="headerlink" title="源码解析"></a>源码解析</h2><p>待完善……</p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://realpython.com/python-requests/">https://realpython.com/python-requests/</a></p><p><a href="https://restfulapi.cn/">https://restfulapi.cn/</a></p><p><a href="https://github.com/psf/requests">https://github.com/psf/requests</a></p><p><a href="https://www.runoob.com/python3/python-requests.html">https://www.runoob.com/python3/python-requests.html</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Python内置模块 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>lookbusy一款用于Linux系统的虚拟负载生成器</title>
      <link href="/posts/5e251ac0/"/>
      <url>/posts/5e251ac0/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>lookbusy，可以虚拟产生系统CPU、内存、磁盘等负载，给人造成一种系统繁忙的错觉，在一些需要系统负载达标的场景中非常有用</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">CPU Usage</button></li><li class="tab"><button type="button" data-href="#tab-1-2">Memory Usage</button></li><li class="tab"><button type="button" data-href="#tab-1-3">Disk Usage</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/./img/b/5e251ac0/63a8115a600a8.png" alt="CPU Usage"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/./img/b/5e251ac0/63a81219284db.png" alt="Memory Usage"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><img src="/./img/b/5e251ac0/63a8130288694.png" alt="Disk Usage"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>仓库：<a href="https://github.com/flow2000/lookbusy">https://github.com/flow2000/lookbusy</a></p><p>通过git下载：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/flow2000/lookbusy</span><br></pre></td></tr></table></figure><p>或者下载压缩包：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/flow2000/lookbusy/archive/refs/heads/master.zip</span><br><span class="line">unzip master.zip</span><br></pre></td></tr></table></figure><p>或者通过代理下载：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://ghproxy.com/https://github.com/flow2000/lookbusy/archive/refs/heads/master.zip</span><br><span class="line">unzip master.zip</span><br></pre></td></tr></table></figure><p>最后编译安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd lookbusy</span><br><span class="line"></span><br><span class="line">chmod a+x configure</span><br><span class="line"></span><br><span class="line">./configure</span><br><span class="line"></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h2 id="CPU使用选项"><a href="#CPU使用选项" class="headerlink" title="CPU使用选项"></a>CPU使用选项</h2><ul><li>-c、 每个cpu的期望利用率，以百分比为单位（默认 50 ）。若选择<code>curve</code>CPU使用模式，则应给出MIN-MAX形式的范围。</li><li>-n、保持忙碌的CPU数量（默认值：自动检测出的全部核心数）</li><li>-r、 第一种模式：<code>fixed</code>，试图保持指定百分比的CPU利用率，第二种模式：<code>curve</code>，产生的利用率水平随给定间隔内上下浮动。</li><li>-p、  曲线内峰值利用率的偏移量，默认单位是秒，可以添加 m、h、d 作为其他单位</li><li>-P、 曲线内峰值利用率的偏移量，可以添加 m、h、d 作为其他单位</li></ul><p>例子:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lookbusy -c 50 # 占用所有 CPU 核心各 50%</span><br><span class="line"></span><br><span class="line">lookbusy -c 50 -n 2 # 占用两个 CPU 核心各 50%</span><br><span class="line"></span><br><span class="line">lookbusy -c 50-80 -r curve # 占用所有 CPU 核心在 50%-80% 左右浮动</span><br></pre></td></tr></table></figure><h2 id="内存使用选项"><a href="#内存使用选项" class="headerlink" title="内存使用选项"></a>内存使用选项</h2><ul><li>-m、 以字节为单位，后面是KB、MB或GB（其他单位）</li><li>-M、 单位为毫秒（默认值为1000）</li></ul><p>例子:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lookbusy -m 128MB -M 1000 # 每 1000 毫秒，循环释放并分配 128MB 内存</span><br></pre></td></tr></table></figure><h2 id="磁盘使用选项"><a href="#磁盘使用选项" class="headerlink" title="磁盘使用选项"></a>磁盘使用选项</h2><ul><li>-d、用于磁盘流失的文件大小（以字节为单位，后跟KB、MB、GB或TB（其他单位））</li><li>-b、用于I&#x2F;O的块大小（以字节为单位，后跟KB、MB或GB）</li><li>-D、迭代之间的休眠时间，以毫秒为单位（默认值为100）</li><li>-f、 要用作缓冲区的文件&#x2F;目录的路径（默认&#x2F;tmp）</li></ul><p>例子:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lookbusy -d 1GB -b 1MB -D 10 # 每 10 毫秒，循环进行 1MB 磁盘写入，临时文件不超过 1GB</span><br></pre></td></tr></table></figure><h2 id="后台运行"><a href="#后台运行" class="headerlink" title="后台运行"></a>后台运行</h2><p>如果你需要在后台运行lookbusy，你可以使用<code>nohup</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup lookbusy -c 50 &gt; /dev/null 2&gt;&amp;1 &amp; #占用所有 CPU 核心各 50%，且后台运行，不记录日志</span><br></pre></td></tr></table></figure><p>关闭<code> lookbusy</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep lookbusy | grep -v grep</span><br></pre></td></tr></table></figure><p>杀死进程：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -9 &lt;pid&gt;</span><br></pre></td></tr></table></figure><p>图例：</p><p><img src="/./img/b/5e251ac0/646c2a43bfa86.png" alt="后台运行"></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 效率工具 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记一次js引入属性defer的坑</title>
      <link href="/posts/ed9358a/"/>
      <url>/posts/ed9358a/</url>
      
        <content type="html"><![CDATA[<h2 id="省流"><a href="#省流" class="headerlink" title="省流"></a>省流</h2><p><code>defer</code>属性规定当页面已完成加载后，才会执行脚本。</p><p><code>defer</code> 属性仅适用于外部脚本（只有在使用 src 属性时）</p><p>有多种执行外部脚本的方法：</p><ul><li>如果 async&#x3D;”async”：脚本相对于页面的其余部分异步地执行（当页面继续进行解析时，脚本将被执行）</li><li>如果不使用 <code>async</code> 且 defer&#x3D;”defer”：脚本将在页面完成解析时执行</li><li>如果既不使用 <code>async </code>也不使用<code>defer</code>：在浏览器继续解析页面之前，立即读取并执行脚本</li></ul><h2 id="bug产生"><a href="#bug产生" class="headerlink" title="bug产生"></a>bug产生</h2><p>在使用 <a href="https://github.com/notiflix/Notiflix">Notiflix</a> js库时，遇到了一个奇怪的问题：在使用命令：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Notiflix</span>.<span class="property">Notify</span>.<span class="title function_">warning</span>(<span class="string">&#x27;正在请求最新数据...&#x27;</span>);</span><br></pre></td></tr></table></figure><p>刷新后通知并没有出来，而且控制台一直报错：<code>Uncaught ReferenceError: Notiflix is not defined</code>，没有实例化？，但是我已经引入了呀，很奇怪，先是在用关键词找找错误：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Notiflix Uncaught ReferenceError: Notiflix is not defined</span><br></pre></td></tr></table></figure><p>可能是用的人少，没什么记录，正巧看到<a href="https://developer.mozilla.org/zh-CN/">MDN</a>，有篇文章说了<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Errors/Not_defined">ReferenceError: “x” is not defined</a>这种未实例化的通用原因，但还是没有头绪。</p><p>复现demo：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">defer</span> <span class="attr">src</span>=<span class="string">&quot;https://jsd.onmicrosoft.cn/npm/notiflix@3.2.5/dist/notiflix-notify-aio-3.2.5.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">Notiflix</span>.<span class="property">Notify</span>.<span class="title function_">warning</span>(<span class="string">&#x27;正在请求最新数据...&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/./img/b/ed9358a/63a6f1a14ca50.png" alt="报错"></p><h2 id="解决过程"><a href="#解决过程" class="headerlink" title="解决过程"></a>解决过程</h2><p>后来筛选了官方的 <a href="https://github.com/notiflix/Notiflix/issues">issues</a> 也没找到什么原因，再后来找了官方的<a href="https://github.com/notiflix/Notiflix/blob/main/docs/test.html">样例</a>，一步一步对着看，终于，在引入<code>notiflix-notify-aio-3.2.5.min.js</code>的时候和官方有点不一样，出现问题的demo多了个<code>defer</code>，后来一查，噗！js加载顺序的字段。删去<code>defer</code>属性就运行成功了。</p><p>PS：裂了，基础不打好，什么bug都来找你，你却不知道它是谁。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://jsd.onmicrosoft.cn/npm/notiflix@3.2.5/dist/notiflix-notify-aio-3.2.5.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">Notiflix</span>.<span class="property">Notify</span>.<span class="title function_">warning</span>(<span class="string">&#x27;正在请求最新数据...&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/./img/b/ed9358a/63a6f8eb77629.png" alt="解决"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>js加载顺序一般是：</p><p>1、<code>&lt;head&gt;xxx&lt;/head&gt;</code>，网页主体(body)还未加载，这里适合放一些最先执行的函数，比如一些网页监控脚本，</p><p>2、<code>&lt;body&gt;xxx&lt;/body&gt;</code>，这里适合放一些需要和网页元素互动的脚本，例如获取p标签的值，但是脚本必须放在标签的后面</p><p>3、<code>&lt;/body&gt;xxx&lt;html&gt;</code>，网页主体已经渲染完成，这里适合需要立即执行的命令</p><p>一般加载方式是把脚本元素放在文档体的底端（<code>&lt;/body&gt;</code> 标签之前，与之相邻），这样脚本就可以在 HTML 解析完毕后加载了。此方案的问题是：只有在所有 HTML DOM 加载完成后才开始脚本的加载&#x2F;解析过程。对于有大量 JavaScript 代码的大型网站，可能会带来显著的性能损耗。这也是 <code>async</code> 属性诞生的初衷。</p><p>浏览器遇到 <code>async</code> 脚本时不会阻塞页面渲染，而是直接下载然后运行。这样脚本的运行次序就无法控制，只是脚本不会阻止剩余页面的显示。当页面的脚本之间彼此独立，且不依赖于本页面的其它任何脚本时，<code>async</code> 是最理想的选择。</p><p><code>defer </code>属性规定当页面已完成加载后，才会执行脚本。</p><p>例子：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">&quot;js/script2.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/vendor/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">defer</span> <span class="attr">src</span>=<span class="string">&quot;js/script3.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>浏览器先按照从上往下的顺序加载脚本，先遇到<code>async</code>，不会阻塞页面渲染，直接让子线程下载并运行该脚本，再遇到第二个加载脚本命令，没有属性，则阻塞页面渲染，下载并运行该脚本，最后等待页面加载完成，浏览器才下载运行第三个脚本。</p><h2 id="脚本调用策略小结："><a href="#脚本调用策略小结：" class="headerlink" title="脚本调用策略小结："></a>脚本调用策略小结：</h2><ul><li>如果脚本无需等待页面解析，且无依赖独立运行，那么应使用 <code>async</code>。</li><li>如果脚本需要等待页面解析，且依赖于其它脚本，调用这些脚本时应使用 <code>defer</code>，将关联的脚本按所需顺序置于 HTML 中。</li></ul><h2 id="引用文章"><a href="#引用文章" class="headerlink" title="引用文章"></a>引用文章</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/First_steps/What_is_JavaScript">https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/First_steps/What_is_JavaScript</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Errors/Not_defined">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Errors/Not_defined</a></p><p><a href="https://www.runoob.com/tags/att-script-defer.html">https://www.runoob.com/tags/att-script-defer.html</a></p>]]></content>
      
      
      <categories>
          
          <category> 敲敲代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>可一键部署vercel的每日新闻</title>
      <link href="/posts/f6d9d29a/"/>
      <url>/posts/f6d9d29a/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>好早之前在github闲逛看到 <a href="https://icodeq.com/">zkeq</a> 的 <a href="https://github.com/zkeq/news">news</a>，每日早报，还可以直接部署到vercel，本着白嫖精神也去试了试，看样式感觉还不错，就加了个二级域名解析。后来借着 <a href="https://blog.leonus.cn/">leonus</a> 的微博热搜接口和自己捣鼓的<a href="https://news.aqcoder.cn/bili">B站热搜接口</a> 想了一下，何不也把这两个接口解析进去，还有url链接可以跳转过去，随后就花了两天对代码进行了重构。js部分全改了，接口为了适应新接入的两个接口也全改了。</p><h2 id="成果"><a href="#成果" class="headerlink" title="成果"></a>成果</h2><p>网址：<a href="https://news.aqcoder.cn/">https://news.aqcoder.cn</a></p><p>git地址：<a href="https://github.com/flow2000/news">https://github.com/flow2000/news</a></p><p>swagger文档：<a href="https://news.aqcoder.cn/docs">https://news.aqcoder.cn/docs</a></p><h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h2><h3 id="v1"><a href="#v1" class="headerlink" title="v1"></a>v1</h3><ul><li>通过接口获取新闻数据</li><li>底部更换每日微语</li><li>支持浏览三天前的新闻</li><li>支持docker部署</li></ul><h3 id="v2"><a href="#v2" class="headerlink" title="v2"></a>v2</h3><ul><li>新增壁纸功能</li><li>支持切换新闻源</li></ul><p>每日早报的接口是在知乎的<a href="https://www.zhihu.com/api/v4/columns/c_1261258401923026944/items?limit=10&offset=0">接口</a>拿的</p><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">v1</button></li><li class="tab"><button type="button" data-href="#tab-1-2">v2</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/./img/b/sites/63a68e1c41693.png" alt="v1"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/./img/b/sites/63a6b4a47be5e.png" alt="v2"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><h3 id="Vercel-一键部署（推荐）"><a href="#Vercel-一键部署（推荐）" class="headerlink" title="Vercel 一键部署（推荐）"></a>Vercel 一键部署（推荐）</h3><h4 id="v1-1"><a href="#v1-1" class="headerlink" title="v1"></a>v1</h4><p>v1版本简洁干净<br><a href="https://vercel.com/new/clone?repository-url=https://github.com/flow2000/news/tree/v1"><img src="https://vercel.com/button" alt="Deploy with Vercel"></a></p><h4 id="v2-1"><a href="#v2-1" class="headerlink" title="v2"></a>v2</h4><p>v2版本功能更丰富<br><a href="https://vercel.com/new/clone?repository-url=https://github.com/flow2000/news/tree/v2"><img src="https://vercel.com/button" alt="Deploy with Vercel"></a></p><h3 id="Docker-一键部署"><a href="#Docker-一键部署" class="headerlink" title="Docker 一键部署"></a>Docker 一键部署</h3><h4 id="v1-2"><a href="#v1-2" class="headerlink" title="v1"></a>v1</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name=news --restart=always -p 9134:8888 flow2000/news:1.0.0</span><br></pre></td></tr></table></figure><h4 id="v2-2"><a href="#v2-2" class="headerlink" title="v2"></a>v2</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name=news --restart=always -p 9134:8888 flow2000/news:2.0.0</span><br></pre></td></tr></table></figure><h2 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h2><p>这两天收获蛮多的，踩了几个无知的坑😑……</p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Vercel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>分享一款用于服务器上的TUI图形活动监视器——gotop</title>
      <link href="/posts/54cfe3e/"/>
      <url>/posts/54cfe3e/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>在Linux中，有一个命令可以用于提供运行中的进程的动态实时信息，即top命令，但是top展示的信息是纯文字，不够明显地展示动态信息，而今天要分享的工具——gotop，它是由top命令构建出图形前端的TUI图形活动监视器，我们通过使用gotop命令来清晰地了解到服务器当前的带宽、磁盘、内存、CPU使用情况。</p><p><img src="/./img/b/54cfe3e/6394a36307a95.png" alt="gotop界面"></p><h2 id="安装-Gotop"><a href="#安装-Gotop" class="headerlink" title="安装 Gotop"></a>安装 Gotop</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone --depth 1 https://gitee.com/pgh1038/gotop /tmp/gotop</span><br><span class="line">sh /tmp/gotop/scripts/download.sh</span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>可以不用安装golang语言环境</p></div><p>将gotop添加至环境变量目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp gotop /usr/local/bin</span><br></pre></td></tr></table></figure><p>修改gotop权限</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /usr/local/bin/gotop</span><br></pre></td></tr></table></figure><p>运行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gotop</span><br></pre></td></tr></table></figure><h2 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h2><p>使用终端运行命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gotop</span><br></pre></td></tr></table></figure><p>可以使用以下键盘快捷键对进程表进行排序。</p><ul><li><code>c</code> – CPU</li><li><code>m</code> – 内存</li><li><code>p</code> – PID</li></ul><p>对于进程浏览，请使用以下键。</p><ul><li><code>上/下</code> 箭头或者 <code>j/k</code> 键用于上移下移。</li><li><code>Ctrl-d</code> 和 <code>Ctrl-u</code> – 上移和下移半页。</li><li><code>Ctrl-f</code> 和 <code>Ctrl-b</code> – 上移和下移整页。</li><li><code>gg</code> 和 <code>G</code> – 跳转顶部和底部。</li></ul><p>按下 <code>TAB</code> 切换进程分组。请输入 <code>dd</code>杀死选定的进程或进程组。要选择一个进程，只需点击它。要向下&#x2F;向上滚动，请使用鼠标滚动按钮。要放大和缩小 CPU 和内存的图形，请使用 <code>h</code> 和 <code>l</code>。要显示帮助菜单，只需按 <code>?</code>。</p><p><img src="/./img/b/54cfe3e/6394aaf142593.png" alt="帮助菜单"></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java中初始化List集合的几种方式</title>
      <link href="/posts/6b37b1c3/"/>
      <url>/posts/6b37b1c3/</url>
      
        <content type="html"><![CDATA[<h2 id="1、常规方式"><a href="#1、常规方式" class="headerlink" title="1、常规方式"></a>1、常规方式</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">list.add(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;4&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;5&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="2、匿名内部类方式"><a href="#2、匿名内部类方式" class="headerlink" title="2、匿名内部类方式"></a>2、匿名内部类方式</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;() &#123;&#123;</span><br><span class="line">    add(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">    add(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">    add(<span class="string">&quot;4&quot;</span>);</span><br><span class="line">    add(<span class="string">&quot;5&quot;</span>);</span><br><span class="line">&#125;&#125;;</span><br></pre></td></tr></table></figure><h2 id="3、数组方式"><a href="#3、数组方式" class="headerlink" title="3、数组方式"></a>3、数组方式</h2><p>返回可变列表</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(Arrays.asList(<span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;5&quot;</span>));</span><br></pre></td></tr></table></figure><h2 id="4、Stream-流方式"><a href="#4、Stream-流方式" class="headerlink" title="4、Stream 流方式"></a>4、Stream 流方式</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = Stream.of(<span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;5&quot;</span>).collect(Collectors.toList());</span><br></pre></td></tr></table></figure><p>使用之前需要先引用 guava 依赖包：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.guava<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>guava<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>30.1.1-jre<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="5、JDK-9-List-of"><a href="#5、JDK-9-List-of" class="headerlink" title="5、JDK 9 List.of"></a>5、JDK 9 List.of</h2><p>JDK9以上才有这个方法，而且返回的是不可变列表</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = List.of(<span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;5&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="6、Collections-工具类"><a href="#6、Collections-工具类" class="headerlink" title="6、Collections 工具类"></a>6、Collections 工具类</h2><p>用于返回由指定对象的 n 个副本组成的不可变列表，因为列表不可变，所以只用于一些固定元素的场景</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = Collections.nCopies(<span class="number">3</span>, <span class="string">&quot;2&quot;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 敲敲代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>springboot全局异常处理中拦截器重复拦截/error问题</title>
      <link href="/posts/ddd5162a/"/>
      <url>/posts/ddd5162a/</url>
      
        <content type="html"><![CDATA[<h3 id="问题复现"><a href="#问题复现" class="headerlink" title="问题复现"></a>问题复现</h3><p><img src="/./img/b/ddd5162a/638c6af6ac64a.png" alt="问题复现"></p><p>发送了一个请求，但拦截器拦截了两个请求，打断点一看</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">第一次请求</button></li><li class="tab"><button type="button" data-href="#tab-1-2">第二次请求</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/./img/b/ddd5162a/638c6af55d11b.png" alt="第一次请求"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/./img/b/ddd5162a/638c6af5d6eba.png" alt="第二次请求"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>好家伙，还拦截了<code>/error</code>，查资料才发现：</p><p>SpringBoot 默认提供了一个全局的 handler 来处理所有的 HTTP 错误, 并把它映射为 &#x2F;error。当发生一个错误，例如系统异常抛出了<code>Exception</code>，SpringBoot会将页面重定向到 <code>/error</code> 中。</p><p>所以当请求&#x2F;user&#x2F;generate时，拦截器拦截该请求，处理请求时发生错误，默认全局的 handler把它映射为&#x2F;error，因此拦截器会再次拦截<code>/error</code>请求。这会多进行一次系统处理，消耗了宝贵的系统资源。</p><h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><p>需要关闭工程中的资源文件建立映射</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">properties配置文件</button></li><li class="tab"><button type="button" data-href="#tab-1-2">yml配置文件</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.resources.add-mappings</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">    <span class="attr">add-mappings:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p>只log.error了一次图中所示的内容</p><p><img src="/./img/b/ddd5162a/638c6af63e127.png" alt="效果"></p><h3 id="问题代码"><a href="#问题代码" class="headerlink" title="问题代码"></a>问题代码</h3><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">全局拦截器GlobalInterceptor.java</button></li><li class="tab"><button type="button" data-href="#tab-1-2">全局异常处理GlobalExceptionHandler.java</button></li><li class="tab"><button type="button" data-href="#tab-1-3">权限校验异常类AccessDeniedException.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gxmzu.score.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gxmzu.score.domain.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.gxmzu.score.exception.AccessDeniedException;</span><br><span class="line"><span class="keyword">import</span> com.gxmzu.score.service.TokenService;</span><br><span class="line"><span class="keyword">import</span> com.gxmzu.score.service.VerifyUser;</span><br><span class="line"><span class="keyword">import</span> com.gxmzu.score.utils.HttpStatus;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: https://github.com/gxmzu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2022/11/10/21:00</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 全局拦截器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(GlobalInterceptor.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> TokenService tokenService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> VerifyUser verifyUser;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 拦截所有请求，只有符合要求才放行</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> com.gxmzu.score.config.SpringMvcConfig&#125; 设置匿名访问</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> com.gxmzu.score.service.VerifyUser&#125;查看对应的角色接口权限</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request  请求</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response 响应</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> handler  处理器</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回true表示通过该请求</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception 异常处理</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> tokenService.getUser(request);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> request.getRequestURI();</span><br><span class="line">        <span class="keyword">if</span> (user == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">AccessDeniedException</span>(<span class="string">&quot;未认证&quot;</span>, HttpStatus.UNAUTHENTICATED);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//验证用户请求有效性，只有所属的角色才可以使用对应的接口</span></span><br><span class="line">        <span class="keyword">if</span> (!verifyUser.verify(url, user)) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;用户：&#123;&quot;</span> + user.getUserName() + <span class="string">&quot;&#125;请求越权接口&quot;</span>);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">AccessDeniedException</span>(<span class="string">&quot;未授权&quot;</span>, HttpStatus.UNAUTHORIZED);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 验证令牌有效期，只有离过期还差20分钟内查刷新token</span></span><br><span class="line">        tokenService.verifyToken(user);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gxmzu.score.exception;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gxmzu.score.domain.AjaxResult;</span><br><span class="line"><span class="keyword">import</span> com.gxmzu.score.utils.HttpStatus;</span><br><span class="line"><span class="keyword">import</span> com.gxmzu.score.utils.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.BindException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.HttpRequestMethodNotSupportedException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.MethodArgumentNotValidException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: https://github.com/gxmzu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2022/11/24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 全局异常处理</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(GlobalExceptionHandler.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 权限校验异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(AccessDeniedException.class)</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">handleAccessDeniedException</span><span class="params">(AccessDeniedException e, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">requestURI</span> <span class="operator">=</span> request.getRequestURI();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">code</span> <span class="operator">=</span> e.getCode();</span><br><span class="line">        log.error(<span class="string">&quot;请求地址&#x27;&#123;&#125;&#x27;,权限校验失败&#x27;&#123;&#125;&#x27;&quot;</span>, requestURI, e.getMessage());</span><br><span class="line">        <span class="keyword">return</span> StringUtils.isNotNull(code) ? AjaxResult.error(code, e.getMessage()) : AjaxResult.error(HttpStatus.ERROR, e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 请求方式不支持</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(HttpRequestMethodNotSupportedException.class)</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">handleHttpRequestMethodNotSupported</span><span class="params">(HttpRequestMethodNotSupportedException e,</span></span><br><span class="line"><span class="params">                                                          HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">requestURI</span> <span class="operator">=</span> request.getRequestURI();</span><br><span class="line">        log.error(<span class="string">&quot;请求地址&#x27;&#123;&#125;&#x27;,不支持&#x27;&#123;&#125;&#x27;请求&quot;</span>, requestURI, e.getMethod());</span><br><span class="line">        <span class="keyword">return</span> AjaxResult.error(HttpStatus.NO_SUPPORT_REQUEST_METHOD, e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 业务异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(ServiceException.class)</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">handleServiceException</span><span class="params">(ServiceException e, HttpServletRequest request)</span> &#123;</span><br><span class="line">        log.error(e.getMessage(), e);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">code</span> <span class="operator">=</span> e.getCode();</span><br><span class="line">        <span class="keyword">return</span> StringUtils.isNotNull(code) ? AjaxResult.error(code, e.getMessage()) : AjaxResult.error(HttpStatus.ERROR, e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 拦截未知的运行时异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(RuntimeException.class)</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">handleRuntimeException</span><span class="params">(RuntimeException e, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">requestURI</span> <span class="operator">=</span> request.getRequestURI();</span><br><span class="line">        log.error(<span class="string">&quot;请求地址&#x27;&#123;&#125;&#x27;,发生未知异常.&quot;</span>, requestURI, e);</span><br><span class="line">        <span class="keyword">return</span> AjaxResult.error(HttpStatus.ERROR, e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 系统异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">handleException</span><span class="params">(Exception e, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">requestURI</span> <span class="operator">=</span> request.getRequestURI();</span><br><span class="line">        log.error(<span class="string">&quot;请求地址&#x27;&#123;&#125;&#x27;,发生系统异常.&quot;</span>, requestURI, e);</span><br><span class="line">        <span class="keyword">return</span> AjaxResult.error(HttpStatus.ERROR, e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 自定义验证异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(BindException.class)</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">handleBindException</span><span class="params">(BindException e)</span> &#123;</span><br><span class="line">        log.error(e.getMessage(), e);</span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> e.getAllErrors().get(<span class="number">0</span>).getDefaultMessage();</span><br><span class="line">        <span class="keyword">return</span> AjaxResult.error(HttpStatus.ERROR, message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 自定义验证异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(MethodArgumentNotValidException.class)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">handleMethodArgumentNotValidException</span><span class="params">(MethodArgumentNotValidException e)</span> &#123;</span><br><span class="line">        log.error(e.getMessage(), e);</span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> e.getBindingResult().getFieldError().getDefaultMessage();</span><br><span class="line">        <span class="keyword">return</span> AjaxResult.error(HttpStatus.ERROR, message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gxmzu.score.exception;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: https://github.com/gxmzu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2022/11/13</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 权限校验异常类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccessDeniedException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 错误码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 错误提示</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AccessDeniedException</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AccessDeniedException</span><span class="params">(String msg, Integer code)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.message = msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCode</span><span class="params">(Integer code)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMessage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p><a href="https://blog.csdn.net/qq_35890572/article/details/106529428">springboot全局异常处理中的404的&#x2F;error重复拦截问题</a></p>]]></content>
      
      
      <categories>
          
          <category> 敲敲代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>分享2009-至今的必应壁纸</title>
      <link href="/posts/6b5b8616/"/>
      <url>/posts/6b5b8616/</url>
      
        <content type="html"><![CDATA[<h2 id="阿里云盘"><a href="#阿里云盘" class="headerlink" title="阿里云盘"></a>阿里云盘</h2><p>2009-2023 持续更新</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.aliyundrive.com/s/VF4HskqwXMk</span><br></pre></td></tr></table></figure><h2 id="百度云盘"><a href="#百度云盘" class="headerlink" title="百度云盘"></a>百度云盘</h2><p>2009~2023</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://pan.baidu.com/s/12UdBXXgQSfMo4rLjzZrzYg?pwd=6666 </span><br></pre></td></tr></table></figure><h2 id="天翼云盘"><a href="#天翼云盘" class="headerlink" title="天翼云盘"></a>天翼云盘</h2><p>2009-2023</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://cloud.189.cn/t/f6fuiuEzmARf （访问码：jt5r）</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 必应壁纸 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux常用命令-自用</title>
      <link href="/posts/d0edc1ed/"/>
      <url>/posts/d0edc1ed/</url>
      
        <content type="html"><![CDATA[<h2 id="Linux常用命令"><a href="#Linux常用命令" class="headerlink" title="Linux常用命令"></a>Linux常用命令</h2><h3 id="系统信息"><a href="#系统信息" class="headerlink" title="系统信息"></a>系统信息</h3><p><code>uname -s</code>：显示当前系统类型</p><p><code>uname -a</code>：完整地显示系统信息</p><p><code>hostname</code>：显示当前主机名</p><p><code>du -h --max-depth=1</code>：计算当前目录的文件占用磁盘空间大小，<code>-h</code>代表以人们可读的形式显示大小，例如：K、M、G，<code>--max-depth</code>代表控制文件目录深度，<code>--max-depth=1</code>代表只计算当前目录下的文件或文件夹大小</p><h3 id="关机-x2F-重启"><a href="#关机-x2F-重启" class="headerlink" title="关机&#x2F;重启"></a>关机&#x2F;重启</h3><p><code>shutdown</code>：关机</p><p><code>reboot</code>：重启</p><h3 id="文件-x2F-目录"><a href="#文件-x2F-目录" class="headerlink" title="文件&#x2F;目录"></a>文件&#x2F;目录</h3><p><code>pwd</code>：显示当前所在目录</p><p><code>cd ..</code>：切换上一级目录</p><p><code>cd /home</code>：切换其他目录</p><p><code>cd ~</code>：切换当前登录用户目录(<code>/home/xxx</code>)</p><p><code>ls</code>：列出当前目录的文件&#x2F;目录</p><p><code>ll</code>：是<code>ls -l</code>的别名，列出当前目录文件或目录的详细信息，包含时间、权限、大小、时间等信息</p><p><code>cp aaa bbb -f</code>：复制文件或目录aaa到bbb目录下，<code>-f</code>是force（强制），代表覆盖复制而不询问用户</p><p><code>mv aaa bbb -f</code>：移动文件或目录aaa到bbb目录下，<code>-f</code>是force（强制），代表覆盖复制而不询问用户</p><p><code>mkdir aaa/bbb -p</code>：新建文件夹，<code>-p</code>是parents，代表创建父目录</p><p><code>rename</code>：重命名文件夹</p><p><code>find -name &quot;*.py&quot;</code>：搜索当前目录下的python类型文件</p><p><code>wehereis python</code>：模糊搜索含有<code>python</code>路径的二进制文件</p><p><code>cat a.txt</code>：打印<code>a.txt</code>的文件内容</p><p><code>vi/vim</code>：编辑文件内容</p><p><code>rm -rf xxx</code>：删除文件或文件夹，<code>r</code>代表递归删除，<code>f</code>代表强制删除而不询问用户</p><h3 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h3><p><code>useradd xxx</code>：添加用户xxx</p><p><code>groupadd xxx</code>：添加用户组xxx</p><p><code>su</code>：切换用户</p><h3 id="权限"><a href="#权限" class="headerlink" title="权限"></a>权限</h3><p><code>chown -R 33:r www</code>：递归地赋予文件或目录xxx文件所属者为33以及用户组r</p><p><code>chmod -R 755 xxx</code>：递归地赋予文件或目录xxx文件权限755</p><h3 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h3><p><code>ifconfig</code>：显示当前网络信息</p><h3 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h3><p><code>top</code>：查看进程排行</p><p><code>ps -ef | grep java</code>：查看名称含有java的进程</p><p><code>kill -9 21431</code>：杀死进程id为21431的进程</p><p><code>nohup xxx &amp;</code>：后台执行命令xxx</p><p>更新中……</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IDEA提高效率小技巧，常用插件分享</title>
      <link href="/posts/2147de6f/"/>
      <url>/posts/2147de6f/</url>
      
        <content type="html"><![CDATA[<h2 id="软件简介"><a href="#软件简介" class="headerlink" title="软件简介"></a>软件简介</h2><p>​IDEA 全称 IntelliJ IDEA，是java编程语言的集成开发环境。IntelliJ在业界被公认为最好的Java开发工具，尤其在智能代码助手、代码自动提示、重构、JavaEE支持、各类版本工具(git、svn等)、JUnit、CVS整合、代码分析、 创新的GUI设计等方面的功能可以说是超常的。IDEA是JetBrains公司的产品，这家公司总部位于捷克共和国的首都布拉格，开发人员以严谨著称的东欧程序员为主。它的旗舰版还支持HTML，CSS，PHP，MySQL，Python等。免费版只支持Java,Kotlin等少数语言。</p><h2 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a>软件安装</h2><p>推荐教程：<a href="https://mp.weixin.qq.com/s?__biz=MzA3NjY1NTg4Mg==&mid=2247502531&idx=1&sn=f29268d55d48f3cb77badc7ed903d93a">IDEA2019（英文版） 软件指导教程</a></p><p>PS：他们家提供的安装教程堪称保姆级别，推荐装软件到：<a href="https://mp.weixin.qq.com/s/Qh59ahNx1ikGdI_m31nV8w">Win软件大全</a></p><h2 id="配置构建工具"><a href="#配置构建工具" class="headerlink" title="配置构建工具"></a>配置构建工具</h2><p><a href="https://blog.csdn.net/qq_42057154/article/details/106114515">IDEA配置Maven</a></p><h2 id="常用快捷键"><a href="#常用快捷键" class="headerlink" title="常用快捷键"></a>常用快捷键</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">#一键格式化代码</span></span><br><span class="line">Ctrl+Alt+L</span><br><span class="line"><span class="section">#一键生成getter、setter等方法，需要先定义实体属性</span></span><br><span class="line">Alt+Insert</span><br><span class="line"><span class="section">#自动生成User user = new User()</span></span><br><span class="line">new User().var+回车</span><br></pre></td></tr></table></figure><h2 id="插件分享"><a href="#插件分享" class="headerlink" title="插件分享"></a>插件分享</h2><h3 id="插件总览"><a href="#插件总览" class="headerlink" title="插件总览"></a>插件总览</h3><p><img src="/./img/b/2147de6f/636f17da5f27c.png" alt="插件总览"></p><h3 id="Alibaba代码规范提示"><a href="#Alibaba代码规范提示" class="headerlink" title="Alibaba代码规范提示"></a>Alibaba代码规范提示</h3><p>开发代码时，为了以后的可读性以及可维护性，我们需要规范自己的代码文档，Alibaba研发一套代码规范来帮助我们规范自己的代码，idea插件市场已经上线，使用提示也很好：</p><p><img src="/./img/b/2147de6f/636f15c73d18b.png" alt="Alibaba代码规范提示"></p><p>File-&gt;Settings-&gt;Plugins搜索<code>Alibaba Java Coding Guidelines</code>安装即可</p><h3 id="Translation翻译插件"><a href="#Translation翻译插件" class="headerlink" title="Translation翻译插件"></a>Translation翻译插件</h3><p>这对英语不好的人尤其是我极其友好，只需要鼠标滑动选择，按住Ctrl+Shift+Y，即可翻译：</p><p><img src="/./img/b/2147de6f/636f17335f036.png" alt="Translation翻译插件"></p><p>File-&gt;Settings-&gt;Plugins搜索<code>Translation</code>安装即可</p><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="添加文件头部注解"><a href="#添加文件头部注解" class="headerlink" title="添加文件头部注解"></a>添加文件头部注解</h3><p><img src="/./img/b/2147de6f/636f13f2b84b3.png" alt="添加文件头部注解"></p><p>Java规范说明有每个类文件应该有一个Javadoc表示文件的主要功能，我们可以在File-&gt;Settings-&gt;Editor-&gt;File and Code Templates设置，没有<code>File Header</code>新建即可：</p><p><img src="/./img/b/2147de6f/636f146851cca.png" alt="设置头文件注解"></p><p><code>File Header</code>内容：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: https://github.com/gxmzu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: $&#123;YEAR&#125;-$&#123;MONTH&#125;-$&#123;DAY&#125; $&#123;TIME&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: </span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 效率工具 </tag>
            
            <tag> 快捷命令 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github Action自动部署博客：推送到Github公共仓库+服务器私有仓库+刷新腾讯云CDN</title>
      <link href="/posts/a24c5846/"/>
      <url>/posts/a24c5846/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>随着博客文章数越来越多，hexo三连的时间越来越长，导致等待时间过长，加上可能发生的网络波动造成推送失败，为此，亲身试验Github Action自动部署博客，效果不错，值得一试。本教程改动博客较少，步骤简单，请放心食用。另外感谢大佬<a href="https://anzhiy.cn/">安知鱼</a>提供的Action思路，本博客已按照本教程实现自动化部署。</p><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>利用Github Action构建仓库代码的特性，可以将仓库代码构建出制品，将制品推送到公开仓库或者服务器，达到自动化部署的效果。</p><p>大概讲解一下本方法的网络拓扑图</p><p><img src="/./img/b/a24c5846/6368957a407f1.png" alt="网络拓扑图"></p><h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><ul><li><p>需要提前删除<code>.deploy_git</code>、<code>themes/butterfly/.git</code>文件夹，因为多个<code>.git</code>文件夹不会被识别成项目文件，从而无法上传仓库。</p></li><li><p>本次教程使用的环境为：centos 7.6，<strong>root</strong>用户</p></li></ul><h2 id="添加屏蔽项"><a href="#添加屏蔽项" class="headerlink" title="添加屏蔽项"></a>添加屏蔽项</h2><p>编辑<code>.gitignore</code>：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.DS_Store</span><br><span class="line">Thumbs.db</span><br><span class="line">db.json</span><br><span class="line">*.log</span><br><span class="line">node_modules/</span><br><span class="line">public/</span><br><span class="line">.deploy*/</span><br><span class="line">_multiconfig.yml</span><br><span class="line"></span><br><span class="line">.deploy_git</span><br><span class="line">*.bat</span><br><span class="line">package-lock.json</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/./img/b/a24c5846/63685c1c952cb.png" alt="添加屏蔽项"></p><p>只需保证上传仓库的文件夹有<code>.github</code>、<code>scaffolds</code>、<code>source</code>、<code>themes</code>、<code>_config.butterfly.yml</code>、<code>_config.yml</code>、<code>.gitinore</code>、<code>package.json</code>。<code>cdn.py</code>是用来刷新腾讯云cdn的代码。</p><h2 id="新建腾讯云刷新url代码"><a href="#新建腾讯云刷新url代码" class="headerlink" title="新建腾讯云刷新url代码"></a>新建腾讯云刷新url代码</h2><p>新建cdn.py，添加以下代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> tencentcloud.common <span class="keyword">import</span> credential</span><br><span class="line"><span class="keyword">from</span> tencentcloud.common.profile.client_profile <span class="keyword">import</span> ClientProfile</span><br><span class="line"><span class="keyword">from</span> tencentcloud.common.profile.http_profile <span class="keyword">import</span> HttpProfile</span><br><span class="line"><span class="keyword">from</span> tencentcloud.common.exception.tencent_cloud_sdk_exception <span class="keyword">import</span> TencentCloudSDKException</span><br><span class="line"><span class="keyword">from</span> tencentcloud.cdn.v20180606 <span class="keyword">import</span> cdn_client, models</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># 实例化一个认证对象，入参需要传入腾讯云账户secretId，secretKey,此处还需注意密钥对的保密</span></span><br><span class="line">    <span class="comment"># 密钥可前往https://console.cloud.tencent.com/cam/capi网站进行获取</span></span><br><span class="line">    cred = credential.Credential(<span class="string">&quot;SecretId&quot;</span>, <span class="string">&quot;SecretKey&quot;</span>)</span><br><span class="line">    <span class="comment"># 实例化一个http选项，可选的，没有特殊需求可以跳过</span></span><br><span class="line">    httpProfile = HttpProfile()</span><br><span class="line">    httpProfile.endpoint = <span class="string">&quot;cdn.tencentcloudapi.com&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 实例化一个client选项，可选的，没有特殊需求可以跳过</span></span><br><span class="line">    clientProfile = ClientProfile()</span><br><span class="line">    clientProfile.httpProfile = httpProfile</span><br><span class="line">    <span class="comment"># 实例化要请求产品的client对象,clientProfile是可选的</span></span><br><span class="line">    client = cdn_client.CdnClient(cred, <span class="string">&quot;&quot;</span>, clientProfile)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 实例化一个请求对象,每个接口都会对应一个request对象</span></span><br><span class="line">    req = models.PurgePathCacheRequest()</span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">&quot;Paths&quot;</span>: [ <span class="string">&quot;https://blog.aqcoder.cn&quot;</span> ],</span><br><span class="line">        <span class="string">&quot;FlushType&quot;</span>: <span class="string">&quot;delete&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    req.from_json_string(json.dumps(params))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 返回的resp是一个PurgePathCacheResponse的实例，与请求对象对应</span></span><br><span class="line">    resp = client.PurgePathCache(req)</span><br><span class="line">    <span class="comment"># 输出json格式的字符串回包</span></span><br><span class="line">    <span class="built_in">print</span>(resp.to_json_string())</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> TencentCloudSDKException <span class="keyword">as</span> err:</span><br><span class="line">    <span class="built_in">print</span>(err)</span><br></pre></td></tr></table></figure><p>其中<code>Paths</code>里面填写cdn加速域名，我这里已经添加了cdn域名，添加CDN域名教程参考我的博客教程：<a href="https://blog.aqcoder.cn/posts/a154400e/">使用CDN加速你的博客吧</a></p><p><code>FlushType</code>可填写<code>flush</code>（刷新变更资源）、<code>delete</code>（刷新全部资源）</p><p><code>secretId</code>、<code>secretKey</code>可到腾讯云添加子用户，使用子用户的密钥，保证安全性：</p><p>到<a href="https://console.cloud.tencent.com/cam/user/userType">https://console.cloud.tencent.com/cam/user/userType</a></p><p>腾讯云创建用户并授权CDN访问</p><div class="tabs" id="tab1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab1-1">快速创建用户</button></li><li class="tab"><button type="button" data-href="#tab1-2">填写用户名</button></li><li class="tab"><button type="button" data-href="#tab1-3">选择编程访问</button></li><li class="tab"><button type="button" data-href="#tab1-4">选择CDN全读写访问权限</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab1-1"><p><img src="/./img/b/a24c5846/63685f4ba3f0e.png" alt="快速创建用户"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-2"><p><img src="/./img/b/a24c5846/63685fe53e6e4.png" alt="填写用户名"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-3"><p><img src="/./img/b/a24c5846/63685fd045963.png" alt="选择编程访问"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-4"><p><img src="/./img/b/a24c5846/63685ffb5bd10.png" alt="选择CDN全读写访问权限"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="新建Action"><a href="#新建Action" class="headerlink" title="新建Action"></a>新建Action</h2><p>在<code>博客根目录</code>新建一个<code>.github</code>文件夹，在<code>.github</code>文件夹新建<code>workflows</code>文件夹，新建一个<code>master.yml</code>，复制以下内容：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">自动任务</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [<span class="string">master</span>]</span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="number">1</span><span class="string">.</span> <span class="string">检出分支</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v3</span></span><br><span class="line">        </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="number">2</span><span class="string">.</span> <span class="string">安装</span> <span class="string">Node</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="number">16</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="number">3</span><span class="string">.</span> <span class="string">安装</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          export TZ=&#x27;Asia/Shanghai&#x27;</span></span><br><span class="line"><span class="string">          npm install hexo-cli -g</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="number">4</span><span class="string">.</span> <span class="string">缓存</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/cache@v1</span></span><br><span class="line">        <span class="attr">id:</span> <span class="string">cache</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">node_modules</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">$&#123;&#123;runner.OS&#125;&#125;-$&#123;&#123;hashFiles(&#x27;package.json&#x27;)&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="number">5</span><span class="string">.</span> <span class="string">安装依赖</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">steps.cache.outputs.cache-hit</span> <span class="type">!=</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          npm install --save</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="number">6</span><span class="string">.</span> <span class="string">生成静态文件</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          hexo clean</span></span><br><span class="line"><span class="string">          hexo generate</span></span><br><span class="line"><span class="string">          hexo algolia</span></span><br><span class="line"><span class="string"></span>          </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="number">7</span><span class="string">.</span> <span class="string">推送到github公共仓库</span></span><br><span class="line">        <span class="attr">working-directory:</span> <span class="string">./public</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          git init</span></span><br><span class="line"><span class="string">          git checkout -b master</span></span><br><span class="line"><span class="string">          git add .</span></span><br><span class="line"><span class="string">          git -c user.name=&#x27;flow2000&#x27; -c user.email=&#x27;1982989137@qq.com&#x27; commit -m &#x27;提交博客源码&#x27;</span></span><br><span class="line"><span class="string">          git remote add origin https://$&#123;&#123;secrets.HUB_ACCESS_TOKEN&#125;&#125;@github.com/flow2000/flow2000.github.io.git</span></span><br><span class="line"><span class="string">          git push origin master -f -q</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="number">8</span><span class="string">.</span> <span class="string">推送到服务器私有仓库</span> <span class="comment">#没有使用服务器可删除该步骤</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">easingthemes/ssh-deploy@v2.0.7</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="attr">SSH_PRIVATE_KEY:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.SERVER_ACCESS_TOKEN</span> <span class="string">&#125;&#125;</span> <span class="comment">#服务器生成的私钥，例如 -----BEGIN RSA PRIVATE KEY-----xxxx-----END RSA PRIVATE KEY-----</span></span><br><span class="line">          <span class="attr">ARGS:</span> <span class="string">&quot;-avz --delete&quot;</span> <span class="comment"># rsync参数</span></span><br><span class="line">          <span class="attr">SOURCE:</span> <span class="string">&quot;public/&quot;</span></span><br><span class="line">          <span class="attr">REMOTE_HOST:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.SERVER_HOST</span> <span class="string">&#125;&#125;</span> <span class="comment">#服务器ip地址，例如 1.2.3.4</span></span><br><span class="line">          <span class="attr">REMOTE_USER:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.SERVER_USER</span> <span class="string">&#125;&#125;</span> <span class="comment">#登录用户，例如 root</span></span><br><span class="line">          <span class="attr">TARGET:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.SERVER_TARGET</span> <span class="string">&#125;&#125;</span>    <span class="comment">#服务器目录，例如 /www/blog.aqcoder.cn</span></span><br><span class="line">          <span class="attr">EXCLUDE:</span> <span class="string">&quot;.git/&quot;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="number">9</span><span class="string">.</span> <span class="string">安装</span> <span class="string">Python</span> <span class="comment">#没有使用腾讯云cdn可删除该步骤</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-python@v1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">python-version:</span> <span class="number">3.8</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="number">10</span><span class="string">.</span> <span class="string">安装依赖</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          pip install --upgrade pip</span></span><br><span class="line"><span class="string">          pip install tencentcloud-sdk-python</span></span><br><span class="line"><span class="string">          pip install tencentcloud-sdk-python-cdn</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="number">11</span><span class="string">.</span> <span class="string">刷新腾讯云cdn</span> <span class="comment">#没有使用腾讯云cdn可删除该步骤</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line">          <span class="string">python</span> <span class="string">cdn.py</span></span><br></pre></td></tr></table></figure><p>第7步注意修改成自己的公开博客仓库地址</p><p>第8、9、10步可根据需求使用</p><p>第8步的<code>ARGS</code>参数可参考<a href="http://c.biancheng.net/view/6121.html">Linux rsync命令用法详解</a></p><h2 id="新建私有仓库"><a href="#新建私有仓库" class="headerlink" title="新建私有仓库"></a>新建私有仓库</h2><p>到<a href="https://github.com/">github</a>新建一个<code>Private</code>仓库。</p><p><img src="/./img/b/a24c5846/63685b173b108.png" alt="新建私有仓库"></p><h2 id="生成token"><a href="#生成token" class="headerlink" title="生成token"></a>生成token</h2><p>前往<a href="https://github.com/settings/tokens/new">github settings</a>生成token，权限需要有<code>repo</code>、<code>workflow</code>：</p><p><img src="/./img/b/a24c5846/63685d2a892cc.png" alt="生成token"></p><h2 id="添加secrets"><a href="#添加secrets" class="headerlink" title="添加secrets"></a>添加secrets</h2><p>服务器上执行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 2048</span><br></pre></td></tr></table></figure><p>则按提示按完回车后</p><p>如果是<strong>root</strong>用户执行该命令，则：</p><p>将<code>/root/.ssh/id_rsa.pub</code>的内容复制到<code>/root/.ssh/authorized_keys</code>中</p><p>服务器私钥则在<code>/root/.ssh/id_rsa</code>，将<code>/root/.ssh/id_rsa</code>内容复制到仓库的<code>secrets</code>环境变量<code>SERVER_ACCESS_TOKEN</code>中即可</p><p>如果是其他用户执行该命令（例如<code>git</code>用户）则：</p><p>将<code>/home/git/.ssh/id_rsa.pub</code>的内容复制到<code>/home/git/.ssh/authorized_keys</code>中</p><p>服务器私钥则在<code>/home/git/.ssh/id_rsa</code>，将<code>/home/git/.ssh/id_rsa</code>内容复制到仓库的<code>secrets</code>环境变量<code>SERVER_ACCESS_TOKEN</code>中即可</p><p><img src="/./img/b/a24c5846/63685dd7f2828.png" alt="添加secrets"></p><h2 id="创建腾讯云CDN加速网站"><a href="#创建腾讯云CDN加速网站" class="headerlink" title="创建腾讯云CDN加速网站"></a>创建腾讯云CDN加速网站</h2><p>访问：<a href="https://console.cloud.tencent.com/cdn/domains">https://console.cloud.tencent.com/cdn/domains</a></p><div class="tabs" id="tab1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab1-1">添加域名</button></li><li class="tab"><button type="button" data-href="#tab1-2">推荐配置</button></li><li class="tab"><button type="button" data-href="#tab1-3">验证CDN加速域名</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab1-1"><p>输入已备案的博客域名，选择加速类型为CDN网页小文件，源站配置选择自有源，回源协议选择http，源站地址选择服务器ip，第二个框加上端口</p><p><img src="/./img/b/a24c5846/20240121144019.png" alt="添加域名"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-2"><p>推荐配置一直选择下一步即可，到最后一步HTTPS配置需要添加一下证书，证书需要到证书管理那里申请一个</p><p><img src="/./img/b/a24c5846/20240121144450.png" alt="推荐配置"></p><p><img src="/./img/b/a24c5846/20240121144544.png" alt="提交配置"></p><p>配置好HTTPS访问和HTTPS证书后，点击提交所有配置</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-3"><p>到域名解析那里填加CNAME记录即可验证CDN加速域名</p><p><img src="/./img/b/a24c5846/20240121144830.png" alt="提交配置"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="将文章推送到私有仓库"><a href="#将文章推送到私有仓库" class="headerlink" title="将文章推送到私有仓库"></a>将文章推送到私有仓库</h2><p>博客根目录执行命令：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git remote add origin git@github.com:flow2000/hexo<span class="literal">-butterfly-flow2000</span>.git</span><br></pre></td></tr></table></figure><p>每次写完博客，发布网站可执行以下命令：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit <span class="literal">-m</span> <span class="string">&quot;推送私有仓库&quot;</span></span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure><p>嫌麻烦可制作bat脚本，在博客根目录下新建<code>push.bat</code>，复制以下内容即可：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">git add .</span><br><span class="line">git commit <span class="literal">-m</span> <span class="string">&quot;推送私有仓库&quot;</span></span><br><span class="line">git push origin master</span><br><span class="line">pause</span><br></pre></td></tr></table></figure><p>使用时双击脚本即可自动执行命令。</p><p>查看Action执行情况：</p><p><img src="/./img/b/a24c5846/6368930ba0d89.png" alt="Action详情"></p><p>静待片刻，即可看到文章已部署在博客。</p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://cloud.tencent.com/developer/article/1720500">使用GithubActions自动部署应用到自己的服务器</a></p><p><a href="https://anzhiy.cn/posts/asdx.html">使用 Github Action 自动部署</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> Action </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Docker快速安装Thingsboard</title>
      <link href="/posts/4d148e3d/"/>
      <url>/posts/4d148e3d/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>最近学习物联网，实验课需要我们安装<a href="https://thingsboard.io/">Thingsboard</a>，查资料发现可以使用docker安装，果断选择docker安装，但是docker安装也有一些坑，故记录安装过程以防后人踩坑。</p><p>ThingsBoard是一个开源物联网平台，主要用于数据收集、处理、可视化和设备管理，但是安装部署却是我们新手入门的一个大难题，使用docker安装可让我们省略环境配置的苦恼，节省安装时间。</p><blockquote><p>ThingsBoard is an open-source IoT platform that enables rapid development, management, and scaling of IoT projects. Our goal is to provide the out-of-the-box IoT cloud or on-premises solution that will enable server-side infrastructure for your IoT applications. </p><footer><strong>官方解释</strong><cite><a href="https://thingsboard.io/docs/getting-started-guides/what-is-thingsboard/">thingsboard.io/docs/getting-started-guides/what-is-thingsboard</a></cite></footer></blockquote><h2 id="Docker安装Thingsboard"><a href="#Docker安装Thingsboard" class="headerlink" title="Docker安装Thingsboard"></a>Docker安装Thingsboard</h2><div class="note warning icon-padding flat"><i class="note-icon falt"></i><p>需要拥有一台操作系统为<code>CentOS7.6</code>的服务器</p><p>已安装docker，安装docker命令：<code>yum install -y docker</code></p><p>已安装nginx，一键安装nginx脚本参考我的博客：<a href="https://blog.aqcoder.cn/posts/9651/">Linux服务器开发环境配置</a></p></div><p>前往<a href="http://www.ithingsboard.com/docs/user-guide/install/docker/">Thingsboard中文网</a>选择docker镜像，这里选择<a href="https://hub.docker.com/r/thingsboard/tb-postgres/">thingsboard&#x2F;tb-postgres</a></p><p>在docker官方镜像<a href="thingsboard/tb-postgres">thingsboard&#x2F;tb-postgres</a>可以找到详细安装教程（推荐看这个）</p><p><img src="/./img/b/4d148e3d/6364d8fdc4f9b.png" alt="docker官方安装教程"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/.mytb-data &amp;&amp; sudo chown -R 799:799 ~/.mytb-data</span><br><span class="line">mkdir -p ~/.mytb-logs &amp;&amp; sudo chown -R 799:799 ~/.mytb-logs</span><br><span class="line">docker run -it -p 9090:9090 -p 7070:7070 -p 1883:1883 -p 5683-5688:5683-5688/udp -v ~/.mytb-data:/data \</span><br><span class="line">-v ~/.mytb-logs:/var/log/thingsboard --name mytb --restart always thingsboard/tb-postgres</span><br></pre></td></tr></table></figure><p>如果更换安装位置需要替换<code>~/.</code>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /www/mytb/mytb-data &amp;&amp; sudo chown -R 799:799 /www/mytb/mytb-data</span><br><span class="line">mkdir -p /www/mytb/mytb-logs &amp;&amp; sudo chown -R 799:799 /www/mytb/mytb-logs</span><br><span class="line">docker run -itd -p 9090:9090 -p 1883:1883 -p 7070:7070 -p 5683-5688:5683-5688/udp -v /www/mytb/mytb-data:/data -v /www/mytb/mytb-logs:/var/log/thingsboard --name mytb --restart always thingsboard/tb-postgres</span><br></pre></td></tr></table></figure><p>安装好后，此时还不能使用外网连接，因为Thingsboard默认内网连接，官方原话：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">These commands install ThingsBoard and load demo data and accounts.</span><br><span class="line">ThingsBoard UI will be available using the URL: http://localhost:8080. You may use username tenant@thingsboard.org and password tenant. More info about demo accounts is available here.</span><br></pre></td></tr></table></figure><p>此时我们需使用<code>Nginx</code>做端口映射：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">9136</span>;</span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_http_version</span> <span class="number">1</span>.<span class="number">1</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        <span class="attribute">proxy_read_timeout</span> <span class="number">120s</span>;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">proxy_set_header</span> Upgrade websocket;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Connection Upgrade;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://127.0.0.1:9090;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>访问<a href="http://ip:9136即可">http://ip:9136即可</a></p><p>服务器没有nginx可参考我的博客：<a href="https://blog.aqcoder.cn/posts/9651/">Linux服务器开发环境配置</a>使用一键安装脚本</p><h2 id="登录Thingsboard"><a href="#登录Thingsboard" class="headerlink" title="登录Thingsboard"></a>登录Thingsboard</h2><p>在docker官方教程也给出Thingsboard默认账号：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Systen Administrator: sysadmin@thingsboard.org / sysadmin</span><br><span class="line">Tenant Administrator: tenant@thingsboard.org / tenant</span><br><span class="line">Customer User: customer@thingsboard.org / customer</span><br></pre></td></tr></table></figure><p><img src="/./img/b/4d148e3d/6364db4f41abf.png" alt="登录Thingsboard"></p><h2 id="Docker升级Thingsboard"><a href="#Docker升级Thingsboard" class="headerlink" title="Docker升级Thingsboard"></a>Docker升级Thingsboard</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker pull thingsboard/tb-postgres</span><br><span class="line">docker stop mytb</span><br><span class="line">docker run -it -v ~/.mytb-data:/data --rm thingsboard/tb-postgres upgrade-tb.sh</span><br><span class="line">docker rm mytb</span><br><span class="line">docker run -it -p 9090:9090 -p 1883:1883 -p 7070:7070 -p 5683-5688:5683-5688/udp -v ~/.mytb-data:/data -v ~/.mytb-logs:/var/log/thingsboard --name mytb --restart always thingsboard/tb-postgres</span><br></pre></td></tr></table></figure><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p>1、<code>[0.001s][error][logging] Error opening log file &#39;/var/log/thingsboard/gc.log&#39;: Permission denied</code></p><p>还没有创建目录，并且未授权，需要执行命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/.mytb-data &amp;&amp; sudo chown -R 799:799 ~/.mytb-data</span><br><span class="line">mkdir -p ~/.mytb-logs &amp;&amp; sudo chown -R 799:799 ~/.mytb-logs</span><br></pre></td></tr></table></figure><p>2、无法访问</p><p>需要做端口映射：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">9136</span>;</span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_http_version</span> <span class="number">1</span>.<span class="number">1</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        <span class="attribute">proxy_read_timeout</span> <span class="number">120s</span>;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">proxy_set_header</span> Upgrade websocket;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Connection Upgrade;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://127.0.0.1:9090;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>访问<a href="http://ip:9136即可">http://ip:9136即可</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> Thingsboard </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>十月份小结：暂停博客优化，开始项目实战</title>
      <link href="/posts/9da9bdcd/"/>
      <url>/posts/9da9bdcd/</url>
      
        <content type="html"><![CDATA[<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>这个月因为实习耽误不少事情，不过博客也保持了每月15篇的产出，也开始转向魔改主题的路线进发，<del>虽然屎山css代码看得很痛苦</del>，</p><p>这个月也取得一点成绩，<a href="https://blog.aqcoder.cn/posts/a154400e/">文章</a>收录进去了<a href="https://butterfly.zhheo.com/">Butterfly魔改教程</a>🥰，向前端大佬学习。<del>虽然但是</del>，这个月开始要做项目了，不能再继续优化博客，但是文章还是会继续更新，争取百篇文章。也快建站100天了，该回顾一下自己的收获了~</p><p>一句话总结：优化看心情，项目看实力</p><h2 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h2><ul><li>魔改博客</li><li>制作若干个<a href="https://hub.docker.com/search?q=flow2000">docker镜像</a>并应用于博客运行</li><li>更换必应壁纸网站：<a href="https://bimg.cc/">https://bimg.cc/</a></li><li>新增<a href="/links/">友链</a>若干</li></ul><h2 id="困难"><a href="#困难" class="headerlink" title="困难"></a>困难</h2><ol><li><del>git部署钩子因为用户权限的问题整得晕头转向</del>，解决方法：<a href="https://blog.leonus.cn/2022/hexodeployer.html">将hexo部署到自己的云服务器 | Leonus</a></li><li>docker部署数据库真的不稳定，建议别用这种方式</li><li>服务器真的崩不住了，需要<a href="/posts/e8346cb5/">开机自启方案</a></li></ol><h2 id="计划"><a href="#计划" class="headerlink" title="计划"></a>计划</h2><ol><li>保持每月十篇文章的产出</li><li>专注个人提升</li><li>项目实战</li><li>到群里多交流（吹水）</li></ol>]]></content>
      
      
      <categories>
          
          <category> 博客总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 月度总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginx在Linux系统下设置开机自启</title>
      <link href="/posts/e8346cb5/"/>
      <url>/posts/e8346cb5/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>平时我们使用服务器时会遇到服务不可用的情况，大概率是遇到了死锁导致服务器无法及时响应我们的请求，这时候需要重启解决服务不可用的问题，而且还要排查原因防止再次发生，不过一般情况下个人使用可以省略此步骤（好吧，是不会排查），但重启后需要手动启动应用恢复服务，所以我们需要设置一些脚本让服务器开机自启应用，今天设置如何重启nginx</p><h2 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h2><p>Linux系统启动后，会调用<code>/etc/rc.d/rc.local</code>执行用户脚本，所以我们可以在此设置nginx的启动，编辑<code>/etc/rc.d/rc.local</code>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">THIS FILE IS ADDED FOR COMPATIBILITY PURPOSES</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># It is highly advisable to create own systemd services or udev rules</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">to run scripts during boot instead of using this file.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># In contrast to previous versions due to parallel execution during boot</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">this script will NOT be run after all other services.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Please note that you must run &#x27;chmod +x /etc/rc.d/rc.local&#x27; to ensure</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">that this script will be executed during boot.</span></span><br><span class="line"></span><br><span class="line">/usr/local/nginx/sbin/nginx</span><br></pre></td></tr></table></figure><p>执行命令<code>chmod +x /etc/rc.d/rc.local</code>以确保启动时能够正常执行</p><p>另附linux启动流程：</p><p><img src="/./img/b/e8346cb5/635fc142bf2c3.jpg" alt="2-1Q02310563a22.jpg"></p><h2 id="加入systemd服务"><a href="#加入systemd服务" class="headerlink" title="加入systemd服务"></a>加入systemd服务</h2><blockquote><p><code>systemd</code>是所有进程之母，负责将 Linux 主机启动到可以做生产性任务的状态。</p><footer><strong>知乎</strong><cite><a href="https://zhuanlan.zhihu.com/p/140273445">学会爱上 systemd | Linux 中国</a></cite></footer></blockquote><p>另一种方法是将nginx加入到systemd服务</p><p><code>cd /lib/systemd/system/</code>，新建<code>nginx.service</code>，添加以下内容：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=nginx service</span><br><span class="line">After=network.target </span><br><span class="line">   </span><br><span class="line">[Service] </span><br><span class="line">Type=forking </span><br><span class="line">ExecStart=/usr/local/nginx/sbin/nginx</span><br><span class="line">ExecReload=/usr/local/nginx/sbin/nginx -s reload</span><br><span class="line">ExecStop=/usr/local/nginx/sbin/nginx -s quit</span><br><span class="line">PrivateTmp=true </span><br><span class="line">   </span><br><span class="line">[Install] </span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><p>服务运行参数说明</p><table><thead><tr><th align="center">参数</th><th align="center">解释</th></tr></thead><tbody><tr><td align="center">[Unit]</td><td align="center">服务的说明</td></tr><tr><td align="center">Description</td><td align="center">描述服务</td></tr><tr><td align="center">After</td><td align="center">描述服务类别</td></tr><tr><td align="center">[Service]</td><td align="center">服务运行参数的设置</td></tr><tr><td align="center">Type</td><td align="center">forking是后台运行的形式</td></tr><tr><td align="center">ExecStart</td><td align="center">服务的具体运行命令</td></tr><tr><td align="center">ExecReload</td><td align="center">重启命令</td></tr><tr><td align="center">ExecStop</td><td align="center">停止命令</td></tr><tr><td align="center">PrivateTmp</td><td align="center">True表示给服务分配独立的临时空间</td></tr></tbody></table><p>注意：[Service]的启动、重启、停止命令全部要求使用绝对路径<br>[Install]运行级别下服务安装的相关设置，可设置为多用户，即系统运行级别为3</p><p>加入开机自启动</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable nginx</span><br></pre></td></tr></table></figure><p>取消开机自启动</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl disable nginx</span><br></pre></td></tr></table></figure><p>服务的启动&#x2F;停止&#x2F;刷新配置文件&#x2F;查看状态</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">systemctl start nginx.service　         启动nginx服务</span><br><span class="line">systemctl stop nginx.service　          停止服务</span><br><span class="line">systemctl restart nginx.service　       重新启动服务</span><br><span class="line">systemctl list-units --type=service     查看所有已启动的服务</span><br><span class="line">systemctl status nginx.service          查看服务当前状态</span><br><span class="line">systemctl enable nginx.service          设置开机自启动</span><br><span class="line">systemctl disable nginx.service         停止开机自启动</span><br></pre></td></tr></table></figure><h2 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h2><p>根据上述方法，可以制作其他应用的自启动方案，只需提供应用的绝对路径即可</p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="http://c.biancheng.net/view/1023.html">Linux &#x2F;etc&#x2F;rc.d&#x2F;rc.local配置文件用法</a></p><p><a href="https://www.cnblogs.com/shuangxingxitong/p/14812492.html">Linux设置nginx开机自启动 - 星宇黑雨 - 博客园</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记录一次生活杂谈</title>
      <link href="/posts/8fb71ab5/"/>
      <url>/posts/8fb71ab5/</url>
      
        <content type="html"><![CDATA[<p>分享库存呀</p><p>实习路上总要经过这条路：</p><p><img src="/./img/b/8fb71ab5/635b57e6ce29d.png" alt="日常实习路上"></p><p>国庆小活动</p><p><img src="/./img/b/8fb71ab5/635b58cb7b574.png" alt="国庆活动"></p><p>灌水文，分类不够数了，纯属占分类的</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂谈 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 闲聊 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记录一次因为pjax导致js无法生效以及解决方案</title>
      <link href="/posts/6e665e82/"/>
      <url>/posts/6e665e82/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>pjax是一个jQuery插件，它通过拦截链接事件，然后包装成一个ajax请求，实现只刷新部分更新的页面，避免重复请求，以达到节省服务器带宽消耗的效果。在魔改分类的时候发现有时候js&#x2F;css不生效，很奇怪，后来找了许久才找到是pjax的问题，根据洪哥的pjax解决方案来完美解决失效问题。</p><h2 id="发现问题"><a href="#发现问题" class="headerlink" title="发现问题"></a>发现问题</h2><p>魔改分类&#x2F;标签时发现横向滚动死活不生效：</p><p><img src="/./img/b/6e665e82/635b3d154aa1a.gif" alt="横向滚动不生效"></p><h2 id="解决过程"><a href="#解决过程" class="headerlink" title="解决过程"></a>解决过程</h2><p>没办法用笨方法查看js是否生效：</p><p><img src="/./img/b/6e665e82/635b3dc4a4478.png" alt="js是否生效"></p><p>控制台没有打印：</p><p><img src="/./img/b/6e665e82/635b3e3f67d82.png" alt="控制台没有打印"></p><p>后来想到pjax无刷的效果，猜想是否就是因为pjax的原因，关掉pjax后还是不行，看看大佬是怎么解决，巧了洪哥刚好写了</p><p>解决方案：<a href="https://blog.zhheo.com/p/3e567fa7.html">pjax无法生效解决办法，butterfly主题维护你的pjax | 张洪Heo</a></p><p><img src="/./img/b/6e665e82/635b3f3484e90.png" alt="引入data-pjax=&quot;&quot; defer=&quot;&quot;"></p><p>莫名其妙地解决了离离原上谱</p><p>哦对了，css不用引入<code>data-pjax=&quot;&quot; defer=&quot;&quot;</code><img src="/./img/b/6e665e82/635b405a36c6b.jpg" alt="img"></p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://blog.zhheo.com/p/3e567fa7.html">pjax无法生效解决办法，butterfly主题维护你的pjax | 张洪Heo</a></p><p><a href="https://zhuanlan.zhihu.com/p/31122494">Pjax是什么以及为什么推荐大家用（转） - 知乎</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Aligo定时备份服务器文件</title>
      <link href="/posts/cbb5481/"/>
      <url>/posts/cbb5481/</url>
      
        <content type="html"><![CDATA[<details class="toggle" ><summary class="toggle-button" style="">点击查看更新记录</summary><div class="toggle-content"><div class="timeline undefined"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>10-22</p></div></div><div class='timeline-item-content'><p>制作备份服务器文件定时任务，实现：</p><ul><li>多目录备份</li><li>上传阿里云盘</li><li>定时备份</li><li>保存文件指定天数</li></ul></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>11-01</p></div></div><div class='timeline-item-content'><p>修改删除备份文件的逻辑，避免因为隔天备份而无法删除旧备份文件</p></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>11-11</p></div></div><div class='timeline-item-content'><p>以日期作为文件夹名称来保存服务器数据</p></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>11-21</p></div></div><div class='timeline-item-content'><p>删除旧文件方式改为删除旧文件夹</p></div></div></div></div></details><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>在现在的互联网时代，数据显得尤为重要，我们的服务器中也有一些重要数据，如果服务器被攻击或者过期忘记取回数据，那造成的后果难以想象，所以要做好定时备份的习惯，但是人又懒怎么办呢，今天给出一个Aligo定时备份文件的解决方案。</p><h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p>使用python3.8压缩备份文件，使用第三方库<code>aligo</code>来上传到阿里云盘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> aligo <span class="keyword">import</span> Aligo</span><br><span class="line"><span class="keyword">import</span> time </span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"></span><br><span class="line"><span class="comment"># 备份目录路径数组</span></span><br><span class="line">backup_dir_list = [</span><br><span class="line">    <span class="string">&#x27;/www/lskypro/storage/app/uploads&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;/www/shinie.top&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;/www/bot&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;/www/bimg.cc&#x27;</span></span><br><span class="line">]</span><br><span class="line"><span class="comment"># 压缩包路径</span></span><br><span class="line">compress_dir = <span class="string">&#x27;/www/aligo/backup&#x27;</span></span><br><span class="line"><span class="comment"># 压缩包文件名数组，可添加文件夹</span></span><br><span class="line">compress_name_list = [</span><br><span class="line">    <span class="string">&#x27;lskypro.zip&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;shinie.top.zip&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;bot.zip&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;bimg.cc.zip&#x27;</span></span><br><span class="line">]</span><br><span class="line"><span class="comment"># 阿里云盘上传路径</span></span><br><span class="line">upload_dir = <span class="string">&#x27;服务器数据备份&#x27;</span></span><br><span class="line"><span class="comment"># 压缩包保存多少天</span></span><br><span class="line">day=<span class="number">7</span></span><br><span class="line"><span class="comment"># 接收登录二维码邮件</span></span><br><span class="line">email=<span class="string">&#x27;1982989137@qq.com&#x27;</span></span><br><span class="line"><span class="comment"># 防伪字符串</span></span><br><span class="line">security_str=<span class="string">&#x27;backup-server-file&#x27;</span></span><br><span class="line"></span><br><span class="line">t=time.strftime(<span class="string">&quot;%Y-%m-%d&quot;</span>,time.localtime())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ali = Aligo(email=(<span class="string">&#x27;1982989137@qq.com&#x27;</span>, <span class="string">&#x27;haivhisaofwu1920u90du90w&#x27;</span>))</span><br><span class="line">    <span class="comment"># 遍历备份目录</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(backup_dir_list)):</span><br><span class="line">        remote_folder = ali.get_folder_by_path(upload_dir)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 遍历压缩目录</span></span><br><span class="line">        <span class="keyword">for</span> zip_file <span class="keyword">in</span> os.listdir(compress_dir):</span><br><span class="line">            t_be=zip_file[<span class="number">0</span>:<span class="number">10</span>]</span><br><span class="line">            start = datetime.datetime.strptime(t_be, <span class="string">&quot;%Y-%m-%d&quot;</span>)</span><br><span class="line">            end = datetime.datetime.strptime(t, <span class="string">&quot;%Y-%m-%d&quot;</span>)</span><br><span class="line">            days = (end-start).days <span class="comment">#计算天数差</span></span><br><span class="line">            old_zip_file=compress_dir+<span class="string">&#x27;/&#x27;</span>+t_be</span><br><span class="line">            <span class="comment"># 删除过期文件</span></span><br><span class="line">            <span class="keyword">if</span> days&gt;day:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;旧文件：&quot;</span>+old_zip_file+<span class="string">&quot;已过期&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;即将删除本地压缩文件：&quot;</span>+old_zip_file)</span><br><span class="line">                <span class="keyword">if</span> os.path.exists(old_zip_file):</span><br><span class="line">                    shutil.rmtree(old_zip_file)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 创建压缩包完整目录 /www/backup/2022-11-11/</span></span><br><span class="line">        compress_pull_dir=compress_dir+<span class="string">&#x27;/&#x27;</span>+t+<span class="string">&quot;/&quot;</span> </span><br><span class="line">        <span class="keyword">if</span> os.path.exists(compress_pull_dir)==<span class="literal">False</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;创建压缩包完整目录：&quot;</span>+compress_pull_dir)</span><br><span class="line">            os.makedirs(compress_pull_dir)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 压缩</span></span><br><span class="line">        zip_file=compress_pull_dir+compress_name_list[i]</span><br><span class="line">        <span class="built_in">zip</span> = zipfile.ZipFile(zip_file, <span class="string">&#x27;w&#x27;</span>, zipfile.ZIP_DEFLATED)</span><br><span class="line">        <span class="keyword">for</span> root,dirs,files <span class="keyword">in</span> os.walk(backup_dir_list[i]):    <span class="comment">#遍历统计</span></span><br><span class="line">            <span class="keyword">for</span> each <span class="keyword">in</span> files:</span><br><span class="line">                <span class="keyword">if</span> os.path.exists(root+<span class="string">&quot;/&quot;</span>+each):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;压缩：&quot;</span>+root+<span class="string">&quot;/&quot;</span>+each)</span><br><span class="line">                    <span class="built_in">zip</span>.write(root+<span class="string">&quot;/&quot;</span>+each)</span><br><span class="line">        <span class="built_in">zip</span>.close()</span><br><span class="line">        <span class="comment"># 同步文件夹（以本地文件为主）</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;同步文件夹……&quot;</span>)</span><br><span class="line">        ali.sync_folder(local_folder=compress_dir, remote_folder=remote_folder.file_id,flag=<span class="literal">True</span>,follow_delete=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>参数解释：</p><table><thead><tr><th align="center">参数</th><th align="center">解释</th><th align="center">参考值</th></tr></thead><tbody><tr><td align="center">backup_dir_list</td><td align="center">备份目录路径数组，可选择备份服务器的文件路径（必要）</td><td align="center">[‘&#x2F;www&#x2F;lskypro&#x2F;storage&#x2F;app&#x2F;uploads’,’&#x2F;www&#x2F;shinie.top’]</td></tr><tr><td align="center">compress_dir</td><td align="center">压缩包存放的目录，可与备份路径不一样（必要）</td><td align="center">‘&#x2F;www&#x2F;aligo&#x2F;backup’</td></tr><tr><td align="center">compress_name_list</td><td align="center">压缩包文件名数组，需和backup_dir_list长度一致，且一一对应（必要）</td><td align="center">[    ‘lskypro.zip’,    ‘shinie.top.zip’]</td></tr><tr><td align="center">upload_dir</td><td align="center">阿里云盘上传路径（必要）</td><td align="center">‘AList&#x2F;服务器数据备份’</td></tr><tr><td align="center">day</td><td align="center">压缩包保存天数（必要）</td><td align="center">7</td></tr><tr><td align="center">email</td><td align="center">接收登录二维码邮件（必要）</td><td align="center">‘<a href="mailto:&#49;&#57;&#x38;&#x32;&#57;&#56;&#57;&#49;&#51;&#55;&#x40;&#113;&#113;&#46;&#99;&#x6f;&#109;">&#49;&#57;&#x38;&#x32;&#57;&#56;&#57;&#49;&#51;&#55;&#x40;&#113;&#113;&#46;&#99;&#x6f;&#109;</a>‘</td></tr><tr><td align="center">security_str</td><td align="center">防伪字符串</td><td align="center">‘backup-server-file’</td></tr></tbody></table><p>先运行一遍（记得改邮箱）登录阿里云盘，获取token</p><p>编辑<code>/etc/crontab</code>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2 0 * * * root /www/python3.8.6/bin/python3.8 /www/aligo/upload.py</span><br></pre></td></tr></table></figure><p>不是root用户运行程序的话需要先修改.py文件权限：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 /www/aligo/upload.py</span><br></pre></td></tr></table></figure><p>python需要自行安装：<a href="https://blog.aqcoder.cn/posts/d5f4/">Linux常用工具安装：python3.8.5 | aqcoder</a></p><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p><img src="/./img/b/cbb5481/636dc94bc0db2.png" alt="阿里云盘保存服务器数据"></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>兰空图床使用体验以及图床迁移解决方案</title>
      <link href="/posts/d71ca461/"/>
      <url>/posts/d71ca461/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>最近因为图片数开始变多，仓库体积太大，部署开始变慢，想做迁移图床的打算，无独有偶，搜到国内的一个开源云上相册——兰空图床，便开始捣鼓……</p><h2 id="使用体验"><a href="#使用体验" class="headerlink" title="使用体验"></a>使用体验</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>安装要求：</p><p>固定ip服务器一台+连接工具<a href="https://www.xshell.com/zh/xshell/">xshell</a>、<a href="https://www.xshell.com/zh/xftp/">xftp</a></p><p>兰空图床访问域名（可选）</p><p>CDN访问域名（使用兰空图床访问域名也可以，此访问域名起到CDN加速效果，推荐使用）</p><p>typora</p><p>picgo</p><p>因为之前装了好几次的php都以失败告终，安装兰空图床不可能再用本地安装了，所以我找到了它的docker版本：<a href="wbsu2003/lskypro">wbsu2003&#x2F;lskypro</a>，尝试了下使用还不错，但是picgo上传失败了，请教博主<a href="https://zhangshier.vip/">张时贰</a>才知道版本不对，<a href="wbsu2003/lskypro">wbsu2003&#x2F;lskypro</a>的版本最新只是v1.6.4而已，源码都2.x了，所以我又找了个docker部署的版本：<a href="https://hub.docker.com/r/halcyonazure/lsky-pro-docker">halcyonazure&#x2F;lsky-pro-docker</a>，这个版本会定时拉取<a href="https://github.com/lsky-org/lsky-pro">兰空图床</a>最新源码并构建推送到官方镜像源。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --restart=always --name=lskypro -p 9110:80 -v /www/lskypro:/var/www/html halcyonazure/lsky-pro-docker</span><br></pre></td></tr></table></figure><p>里面已经有构建好的php环境，不用再安装php，但是还是需要安装数据库，docker安装可参考我的一篇文章：<a href="https://blog.aqcoder.cn/posts/11000000000/">Docker 搭建 Mysql 环境并允许远程访问</a>，本地安装可以使用我的一键安装脚本：<a href="https://blog.aqcoder.cn/code/shell/install-mysql-5.7.sh">install-mysql-5.7.sh</a></p><table><thead><tr><th align="center">参数</th><th align="center">解释</th></tr></thead><tbody><tr><td align="center">-itd</td><td align="center">-i以交互式运行容器，-t分配一个伪输入终端，-d后台运行</td></tr><tr><td align="center">–restart</td><td align="center">always表示重启docker时自动启动容器</td></tr><tr><td align="center">-p</td><td align="center">指定端口，格式为 主机(宿主)端口:容器端口</td></tr><tr><td align="center">-v</td><td align="center">目录挂载到其他盘，格式主机(宿主)目录:容器目录</td></tr><tr><td align="center">–name</td><td align="center">重命名容器名字</td></tr></tbody></table><h3 id="设置Https反代"><a href="#设置Https反代" class="headerlink" title="设置Https反代"></a>设置Https反代</h3><p>因为nginx是安装在服务器的，方便管理，这里也提供一键安装脚本：<a href="https://blog.aqcoder.cn/code/shell/install-nginx-1.21.3.sh">install-nginx-1.21.3.sh</a></p><p>在<code>/usr/local/nginx/conf/nginx.conf</code>添加以下代码：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#监听kl.shinie.top</span></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> kl.shinie.top;</span><br><span class="line">    <span class="attribute">rewrite</span> <span class="regexp"> ^(.*)$</span>  https://<span class="variable">$&#123;server_name&#125;</span><span class="variable">$1</span>  <span class="literal">permanent</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">443</span> ssl;</span><br><span class="line">    <span class="attribute">ssl_certificate</span> /etc/ssl/kl.shinie.top/kl.shinie.top.pem; <span class="comment">#证书位置</span></span><br><span class="line">    <span class="attribute">ssl_certificate_key</span> /etc/ssl/kl.shinie.top/kl.shinie.top.key; <span class="comment">#证书位置</span></span><br><span class="line">    <span class="attribute">ssl_session_cache</span>    shared:SSL:<span class="number">4m</span>;</span><br><span class="line">    <span class="attribute">ssl_session_timeout</span>  <span class="number">10m</span>;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span>  HIGH:!aNULL:!MD5;</span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">server_name</span>  kl.shinie.top;</span><br><span class="line">    <span class="section">location</span> /&#123;</span><br><span class="line"><span class="attribute">proxy_http_version</span> <span class="number">1</span>.<span class="number">1</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> Connection <span class="string">&quot;upgrade&quot;</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>:<span class="variable">$server_port</span>;<span class="comment">#主要这一行添加$server_port</span></span><br><span class="line"><span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> X-Forwarded-Host <span class="variable">$http_host</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> X-Forwarded-Port <span class="variable">$server_port</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line"><span class="attribute">proxy_pass</span> http://127.0.0.1:9110/;</span><br><span class="line"><span class="attribute">client_max_body_size</span> <span class="number">20000m</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>设置好后我遇到了一个资源无法加载的问题：<a href="https://blog.aqcoder.cn/posts/4d46b8c5/">使用兰空图床时无法加载谷歌字体以及解决方法</a></p><p>访问域名</p><p><img src="/./img/b/d71ca461/63537e08c59a1.png" alt="安装兰空图床"></p><p>设置数据库和管理员账号密码</p><p><img src="/./img/b/d71ca461/63537e4102941.png" alt="设置数据库和管理员账号密码"></p><p>安装完成</p><p><img src="/./img/b/d71ca461/63537e9edaa2e.png" alt="安装完成"></p><h3 id="获取token"><a href="#获取token" class="headerlink" title="获取token"></a>获取token</h3><p><img src="/./img/b/d71ca461/63538098a98d9.png" alt="获取token"></p><p>首先我们需要获取token才能上传图片，可使用curl来发送post请求获取token：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -H &quot;Content-Type: application/json&quot; -X POST -d &#x27;&#123;&quot;email&quot;: &quot;管理员邮箱&quot;, &quot;password&quot;:&quot;管理员密码&quot; &#125;&#x27; &quot;你的域名/api/v1/tokens&quot;</span><br></pre></td></tr></table></figure><h3 id="配置picgo"><a href="#配置picgo" class="headerlink" title="配置picgo"></a>配置picgo</h3><p>需要先安装picgo插件</p><p><img src="/./img/b/d71ca461/635382539e904.png" alt="安装picgo插件"></p><p>Server填入域名，Auth token填写上一步获取的token</p><p><img src="/./img/b/d71ca461/635382a8e0b1e.png" alt="配置兰空图床"></p><h3 id="配置typora"><a href="#配置typora" class="headerlink" title="配置typora"></a>配置typora</h3><p>软件链接:<a href="https://pan.baidu.com/s/18ZXyZmf3Oj4avrIf15jZwA?pwd=6666">https://pan.baidu.com/s/18ZXyZmf3Oj4avrIf15jZwA?pwd=6666</a> 提取码:6666 </p><p>在文件-&gt;偏好设置设置picgo程序:</p><p><img src="/./img/b/d71ca461/6353850db00c5.png" alt="配置typora"></p><p>粘贴图片进去时会提示上传图片</p><p><img src="/./img/b/d71ca461/63538561c8b2d.png" alt="粘贴图片"></p><h3 id="设置CDN"><a href="#设置CDN" class="headerlink" title="设置CDN"></a>设置CDN</h3><p>在源站信息配置图床的ip和端口</p><p><img src="/./img/b/d71ca461/63538622eee1d.png" alt="设置CDN"></p><p>在储存策略修改访问网址：</p><p><img src="/./img/b/d71ca461/63538749d6b6e.png" alt="修改访问网址"></p><p>一个简单的图床就配置好了</p><h2 id="图床迁移解决方案"><a href="#图床迁移解决方案" class="headerlink" title="图床迁移解决方案"></a>图床迁移解决方案</h2><h3 id="原方案"><a href="#原方案" class="headerlink" title="原方案"></a>原方案</h3><p>原来使用本地图片，存放在<code>ButterflyBoot/source/img</code>，每<code>hexo new</code>一篇文章出来就在<code>ButterflyBoot/source/img</code>新建一个文件夹，文件夹名称使用<code>hexo-abbrlink</code>生成的永久链接，链接的时候使用<code>../img/xxxx/xxx.png</code>格式，既能在typora编辑器上看到，也能在部署后看到图片，但是这样有一个缺陷：仓库体积会因为图片而变得很大，于是才有后面的图床迁移方案。</p><h3 id="兰空图床迁移方案"><a href="#兰空图床迁移方案" class="headerlink" title="兰空图床迁移方案"></a>兰空图床迁移方案</h3><p>首先在<code>/www/lskypro/storage/app/uploads</code>上传本地的<code>img</code>文件夹</p><p><img src="/./img/b/d71ca461/6353890680e97.png" alt="上传本地img文件夹"></p><p>修改文件夹所有者以及文件权限：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chown -R 33 /www/lskypro/storage/app/uploads/img/</span><br><span class="line">chmod -R 700 /www/lskypro/storage/app/uploads/img/</span><br></pre></td></tr></table></figure><p>创建一个储存策略，其中储存路径是<code>/var/www/html/storage/app/uploads/img</code>，<code>img</code>就是上传服务器的图片文件夹名称</p><p><img src="/./img/b/d71ca461/635389ab96b36.png" alt="创建储存策略"></p><p>测试访问</p><p><img src="/./img/b/d71ca461/63538a52a0c51.png" alt="测试访问"></p><p>在vscode一键替换这些图片链接即可</p><p><img src="/./img/b/d71ca461/63538aa766ed7.png" alt="vscode一键替换"></p><p>新建文章时可在角色组编辑上传路径为文章链接，如果CDN没了或者链接失效，可以立即回滚到原方案</p><p><img src="/./img/b/d71ca461/63538c2547b22.png" alt="角色组编辑"></p><h3 id="评价"><a href="#评价" class="headerlink" title="评价"></a>评价</h3><p>这次适配可以完美替换本地链接，减少仓库体积，而且不用每次处理图片时都要去<a href="https://tinypng.com/">tinypng</a>压缩一遍图片再上传</p><p>可以看出，本地图片和图床链接区别不大，vscode的一键替换就可以完成，容错率高。</p><p><img src="/./img/b/d71ca461/63538cf72a977.png" alt="本地图片和图床链接区别"></p><p>总体来说，此次图床迁移方案非常nice。</p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 兰空图床 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用兰空图床时无法加载谷歌字体以及解决方法</title>
      <link href="/posts/4d46b8c5/"/>
      <url>/posts/4d46b8c5/</url>
      
        <content type="html"><![CDATA[<h2 id="发现问题"><a href="#发现问题" class="headerlink" title="发现问题"></a>发现问题</h2><p>在使用兰空图床2.1版本时，做Https反代后访问域名突然一直卡住，通过控制台发现有一个资源无法访问了，查询原因后是谷歌字体加载不出来了，可能是被墙了，追溯源码后发现兰空在三处地方使用了这一资源</p><p><img src="/./img/b/4d46b8c5/63536375b8654.png" alt="谷歌字体资源加载失败"></p><p><a href="https://github.com/lsky-org/lsky-pro/blob/bb37a11bfbd5e072d7e0bec234e9220d434396c0/resources/views/layouts/app.blade.php#L13">https://github.com/lsky-org/lsky-pro/blob/bb37a11bfbd5e072d7e0bec234e9220d434396c0/resources/views/layouts/app.blade.php#L13</a></p><p><a href="https://github.com/lsky-org/lsky-pro/blob/bb37a11bfbd5e072d7e0bec234e9220d434396c0/resources/views/layouts/guest.blade.php#L13">https://github.com/lsky-org/lsky-pro/blob/bb37a11bfbd5e072d7e0bec234e9220d434396c0/resources/views/layouts/guest.blade.php#L13</a></p><p><a href="https://github.com/lsky-org/lsky-pro/blob/bb37a11bfbd5e072d7e0bec234e9220d434396c0/resources/views/install.blade.php#L10">https://github.com/lsky-org/lsky-pro/blob/bb37a11bfbd5e072d7e0bec234e9220d434396c0/resources/views/install.blade.php#L10</a></p><h2 id="解决过程"><a href="#解决过程" class="headerlink" title="解决过程"></a>解决过程</h2><p>我是用兰空图床的docker版本进行部署的：<a href="https://github.com/cold-pig/LskyPro-Docker">cold-pig&#x2F;LskyPro-Docker: ☁️兰空图床(Lsky Pro) - Docker自动构建</a>，这样部署的好处是可以借助Action将兰空图床的最新版本推送到docker官方库上，使用到最新版本的功能。</p><p>我加上了Https反代：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#监听kl.shinie.top</span></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> kl.shinie.top;</span><br><span class="line">    <span class="attribute">rewrite</span> <span class="regexp"> ^(.*)$</span>  https://<span class="variable">$&#123;server_name&#125;</span><span class="variable">$1</span>  <span class="literal">permanent</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">443</span> ssl;</span><br><span class="line">    <span class="attribute">ssl_certificate</span> /etc/ssl/kl.shinie.top/kl.shinie.top.pem;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span> /etc/ssl/kl.shinie.top/kl.shinie.top.key;</span><br><span class="line">    <span class="attribute">ssl_session_cache</span>    shared:SSL:<span class="number">4m</span>;</span><br><span class="line">    <span class="attribute">ssl_session_timeout</span>  <span class="number">10m</span>;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span>  HIGH:!aNULL:!MD5;</span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">server_name</span>  kl.shinie.top;</span><br><span class="line">    <span class="section">location</span> /&#123;</span><br><span class="line"><span class="attribute">proxy_http_version</span> <span class="number">1</span>.<span class="number">1</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> Connection <span class="string">&quot;upgrade&quot;</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>:<span class="variable">$server_port</span>;<span class="comment">#主要这一行添加$server_port</span></span><br><span class="line"><span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> X-Forwarded-Host <span class="variable">$http_host</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> X-Forwarded-Port <span class="variable">$server_port</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line"><span class="attribute">proxy_pass</span> http://127.0.0.1:9110/;</span><br><span class="line"><span class="attribute">client_max_body_size</span> <span class="number">20000m</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>出现这一问题的时候我先浏览器访问了一下谷歌字体：<a href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap">https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&amp;display=swap</a></p><p>发现无法访问，排除是反代造成的问题</p><p><img src="/./img/b/4d46b8c5/6353703fdb760.png" alt="无法获取谷歌字体"></p><p>后面尝试换浏览器、重装图床等方法还是无法解决问题。最后妥协了：不用这个字体了。因为是在docker部署，可以使用以下命令删除使用谷歌字体的代码：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it lskypro sed -ie &#x27;/fonts.googleapis.com/d&#x27; /var/www/html/resources/views/install.blade.php</span><br><span class="line"></span><br><span class="line">docker exec -it lskypro sed -ie &#x27;/fonts.googleapis.com/d&#x27; /var/www/html/resources/views/layouts/app.blade.php</span><br><span class="line"></span><br><span class="line">docker exec -it lskypro sed -ie &#x27;/fonts.googleapis.com/d&#x27; /var/www/html/resources/views/layouts/guest.blade.php</span><br></pre></td></tr></table></figure><p>如果不是docker部署，可以在兰空图床安装目录下找到以下三个文件删除谷歌字体链接即可：</p><p><code>resources/views/install.blade.php</code></p><p><code>resources/views/layouts/app.blade.php</code></p><p><code>resources/views/layouts/guest.blade.php</code></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 兰空图床 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用CDN加速你的兰空图床吧</title>
      <link href="/posts/a303e957/"/>
      <url>/posts/a303e957/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>兰空图床是一款非常不错的云上相册，但是图片的资源只能由服务器来承担，如果是个人购买了国内服务器，那带宽速度绝对会让我们怀疑图床的作用，所以本教程介绍如何使用cdn来加速兰空图床上的图片。</p><h2 id="添加源站"><a href="#添加源站" class="headerlink" title="添加源站"></a>添加源站</h2><p>在cdn配置下添加源站。由于cdn的缓存规则是：先查看有没有缓存，没有再从源站获取资源并缓存下来，所以不必担心上传的图片没有即时访问到。</p><p><img src="/./img/a303e957/20221020234913492.png" alt="添加源站"></p><p>CDN的具体使用方法查看另一篇博客介绍：<a href="https://blog.aqcoder.cn/posts/a154400e/">使用 CDN 加速你的博客吧</a></p><h2 id="修改存储策略"><a href="#修改存储策略" class="headerlink" title="修改存储策略"></a>修改存储策略</h2><p>最后修改存储策略即可</p><p><img src="/./img/a303e957/20221020235245781.png" alt="修改存储策略"></p><p>附上兰空图床的CDN网络拓扑图</p><p><img src="/./img/a303e957/4172937812912.png" alt="网络拓扑图 "></p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> CDN </tag>
            
            <tag> 图床 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Docker快速搭建自己的图床-兰空图床</title>
      <link href="/posts/d7bbb1e6/"/>
      <url>/posts/d7bbb1e6/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><a href="https://www.lsky.pro/">兰空图床</a>是一个使用PHP构建的云上相册，支持本地等多种第三方云储存，，多种方式上传图片，灵活多样的存储策略，支持通过接口上传。但是兰空图床的环境安装对小白可能不太友好，所以本教程使用docker快速部署兰空图床。</p><h2 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y docker</span><br></pre></td></tr></table></figure><h2 id="安装Mysql数据库"><a href="#安装Mysql数据库" class="headerlink" title="安装Mysql数据库"></a>安装Mysql数据库</h2><p>兰空图床需要配置数据库，可以查看我的这篇文章进行安装：<a href="https://blog.aqcoder.cn/posts/11000000000/">Docker 搭建 Mysql 环境并允许远程访问</a></p><h2 id="部署兰空图床"><a href="#部署兰空图床" class="headerlink" title="部署兰空图床"></a>部署兰空图床</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --restart=always --name=lskypro -p 9124:80 -v /www/lskypro:/var/www/html wbsu2003/lskypro</span><br></pre></td></tr></table></figure><p>注：wbsu2003&#x2F;lskypro最新版本是v1.6.4，不是最新的</p><p>如果想使用最新版本还需更换镜像：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --restart=always --name=lskypro -p 9124:80 -v /www/lskypro:/var/www/html halcyonazure/lsky-pro-docker</span><br></pre></td></tr></table></figure><h2 id="配置兰空数据库"><a href="#配置兰空数据库" class="headerlink" title="配置兰空数据库"></a>配置兰空数据库</h2><p><img src="/./img/d7bbb1e6/20221020224721553.png" alt="配置兰空数据库"></p><h2 id="配置管理员"><a href="#配置管理员" class="headerlink" title="配置管理员"></a>配置管理员</h2><p><img src="/./img/d7bbb1e6/20221020224915273.png" alt="配置管理员"></p><h2 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h2><p><img src="/./img/d7bbb1e6/20221020225114895.png" alt="登录"></p><h2 id="上传图片"><a href="#上传图片" class="headerlink" title="上传图片"></a>上传图片</h2><p><img src="/./img/d7bbb1e6/20221020225300081.png" alt="上传图片"></p><h2 id="配置Https"><a href="#配置Https" class="headerlink" title="配置Https"></a>配置Https</h2><p>此步骤可选</p><h3 id="Nginx配置"><a href="#Nginx配置" class="headerlink" title="Nginx配置"></a>Nginx配置</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> kl.shinie.top;</span><br><span class="line">    <span class="attribute">rewrite</span> <span class="regexp"> ^(.*)$</span>  https://<span class="variable">$&#123;server_name&#125;</span><span class="variable">$1</span> <span class="literal">permanent</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">443</span> ssl;</span><br><span class="line">    <span class="attribute">ssl_certificate</span> /etc/ssl/kl.shinie.top/kl.shinie.top.pem;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span> /etc/ssl/kl.shinie.top/kl.shinie.top.key;</span><br><span class="line">    <span class="attribute">ssl_session_cache</span>    shared:SSL:<span class="number">4m</span>;</span><br><span class="line">    <span class="attribute">ssl_session_timeout</span>  <span class="number">10m</span>;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span>  HIGH:!aNULL:!MD5;</span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">server_name</span>  kl.shinie.top;</span><br><span class="line">    <span class="section">location</span> /&#123;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$http_host</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Range <span class="variable">$http_range</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> If-Range <span class="variable">$http_if_range</span>;</span><br><span class="line">        <span class="attribute">proxy_redirect</span> <span class="literal">off</span>;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://127.0.0.1:9124/;</span><br><span class="line">        <span class="comment"># the max size of file to upload</span></span><br><span class="line">        <span class="attribute">client_max_body_size</span> <span class="number">20000m</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="修改存储策略"><a href="#修改存储策略" class="headerlink" title="修改存储策略"></a>修改存储策略</h3><p><img src="/./img/d7bbb1e6/20221020231533702.png" alt="修改存储策略"></p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> 兰空图床 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker常用命令</title>
      <link href="/posts/29dc6fe8/"/>
      <url>/posts/29dc6fe8/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Docker是一个开源的应用容器引擎，它让开发者可以打包他们的应用以及依赖包到一个可移植的镜像中，然后发布到任何流行的 Linux或Windows操作系统的机器上，也可以实现虚拟化。现记录docker的常用命令，以备查询自用。持续更新中……</p><h2 id="Docker安装命令"><a href="#Docker安装命令" class="headerlink" title="Docker安装命令"></a>Docker安装命令</h2><p>一键安装命令（低版本）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install docker -y</span><br></pre></td></tr></table></figure><p>安装最新版本命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum remove docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-engine</span><br><span class="line">yum install -y yum-utils</span><br><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line">yum install -y docker-ce docker-ce-cli containerd.io</span><br><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure><h2 id="Docker生命周期命令"><a href="#Docker生命周期命令" class="headerlink" title="Docker生命周期命令"></a>Docker生命周期命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">yum install -y docker    #安装docker</span><br><span class="line">systemctl start docker   #启动docker</span><br><span class="line">systemctl status docker  #查看docker状态</span><br><span class="line">systemctl stop docker    #停止docker</span><br><span class="line">systemctl restart docker #重启docker</span><br><span class="line">systemctl daemon-reload  #重载docker配置</span><br><span class="line">docker version           #docker版本</span><br><span class="line">docker info              #docker系统级信息</span><br><span class="line">yum remove docker</span><br></pre></td></tr></table></figure><p><code>-y</code>参数：出现是否继续安装的选项时默认允许安装</p><h2 id="Docler镜像命令"><a href="#Docler镜像命令" class="headerlink" title="Docler镜像命令"></a>Docler镜像命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br><span class="line">docker search tomcat</span><br><span class="line">docker pull tomcat[:version]</span><br><span class="line">docker tag flow2000/news:latest flow2000/news:1.0.0</span><br><span class="line">docker rmi tomcat[:version]</span><br><span class="line">docker rmi -f 镜像ID</span><br><span class="line">docker rmi -f 镜像名1:TAG 镜像名2:TAG </span><br><span class="line">docker images -qa</span><br><span class="line">docker rmi -f $(docker images -qa)</span><br></pre></td></tr></table></figure><h2 id="Docler容器命令"><a href="#Docler容器命令" class="headerlink" title="Docler容器命令"></a>Docler容器命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker run [options] image [command] [arg...]</span><br><span class="line">docker ps</span><br><span class="line">docker start 容器ID或容器name</span><br><span class="line">docker restart 容器ID或容器name</span><br><span class="line">docker stop 容器ID或容器name</span><br><span class="line">docker kill 容器ID或容器name</span><br><span class="line">docker rm 容器ID或容器name </span><br><span class="line">docker rm -f  容器ID或容器name </span><br><span class="line">docker rm -f $(docker ps -qa)</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">-d: 后台运行容器,并返回容器ID</span><br><span class="line"></span><br><span class="line">-i: 以交互式运行容器,通常与-t同时使用</span><br><span class="line"></span><br><span class="line">-p: 端口映射,格式为 主机(宿主)端口:容器端口</span><br><span class="line"></span><br><span class="line">-t: 为容器重新分配一个伪输入终端,通常与-i同时使用</span><br><span class="line"></span><br><span class="line">-v: 目录挂载,格式为 主机(宿主)目录/文件:容器目录/文件</span><br><span class="line"></span><br><span class="line">--name=&quot;name&quot;: 为容器指定一个名称</span><br><span class="line"></span><br><span class="line">--dns 8.8.8.8: 为容器指定一个dns服务器,默认与宿主一致</span><br><span class="line"></span><br><span class="line">--dns-search domain:为容器指定一个DNS域名,默认与宿主一致</span><br><span class="line"></span><br><span class="line">-h &quot;hostname&quot;: 指定容器的hostname</span><br><span class="line"></span><br><span class="line">-e arg=&quot;value&quot;: 设置环境变量</span><br><span class="line"></span><br><span class="line">-env-file=[]:从指定文件读入环境变量</span><br><span class="line"></span><br><span class="line">--cpuset=&quot;0-2&quot; or --cpuset=&quot;0,1,2&quot;: 绑定容器到指定的cpu运行</span><br><span class="line"></span><br><span class="line">-m: 设置容器使用内存最大值</span><br><span class="line"></span><br><span class="line">--net=&quot;bridge&quot;: 指定容器的网络连接类型,支持bridge/host/none/container四种类型</span><br><span class="line"></span><br><span class="line">--link=[]:添加链接到另外一个容器</span><br><span class="line"></span><br><span class="line">--expose=[]:开放一个端口或一组端口,宿主机使用随机端口映射到开放的端口</span><br></pre></td></tr></table></figure><h2 id="Docker网络命令"><a href="#Docker网络命令" class="headerlink" title="Docker网络命令"></a>Docker网络命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker network COMMAND</span><br><span class="line"></span><br><span class="line">docker network connect 网络ID或网络name 容器ID或容器name</span><br><span class="line">docker network create 容器ID或容器name</span><br><span class="line">docker network disconnect 容器ID或容器name</span><br><span class="line">docker network inspect 容器ID或容器name</span><br><span class="line">docker network ls </span><br><span class="line">docker network prune 容器ID或容器name</span><br><span class="line">docker network rm 容器ID或容器name</span><br></pre></td></tr></table></figure><h2 id="Docker日志命令"><a href="#Docker日志命令" class="headerlink" title="Docker日志命令"></a>Docker日志命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f -t --tail 10 容器ID或容器名称</span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 加入时间戳</span></span><br><span class="line">-t</span><br><span class="line"><span class="section"># 跟随最新的日志打印</span></span><br><span class="line">-f</span><br><span class="line"><span class="section"># 输出最后几行的日志</span></span><br><span class="line">--tail 行数</span><br></pre></td></tr></table></figure><h2 id="小技巧"><a href="#小技巧" class="headerlink" title="小技巧"></a>小技巧</h2><h3 id="更新容器"><a href="#更新容器" class="headerlink" title="更新容器"></a>更新容器</h3><p>针对<code>yum install dokcer -y</code> 的用户</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --rm -v /var/run/docker.sock:/var/run/docker.sock containrrr/watchtower -c -R 容器名</span><br></pre></td></tr></table></figure><h2 id="Docker常见问题"><a href="#Docker常见问题" class="headerlink" title="Docker常见问题"></a>Docker常见问题</h2><p>1、[Linux]File “&#x2F;bin&#x2F;yum-config-manager“, line 135 except yum.Errors.RepoError, e:</p><p>解决：</p><p>yum采用Python作为命令解释器，而我们将Python升级为Python3之后,由于python版本之间兼容性不太好，使得2.X版本与3.0版本之间存在语法不一致问题,CentOS 7自带的yum采用的是python2.7，当系统将python升级到3.7后，出现语法解释错误</p><p>需要到指定文件添加2.7版本的注明：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/bin/yum-config-manager</span><br></pre></td></tr></table></figure><p><img src="/./img/b/29dc6fe8/63ed8b6208dd1.png" alt="修改python版本"></p><p>2、docker镜像无法删除 Error：No such image：xxxxxx</p><p>​解决：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /var/lib/docker/image/overlay2/imagedb/content/sha256</span><br></pre></td></tr></table></figure><p><img src="/./img/b/29dc6fe8/63ed8d304d783.png" alt="进入到docker存储对应镜像的文件夹"></p><p>找到对应镜像删除即可</p><p>3、Error response from daemon: Unknown runtime specified docker-runc Error: failed to start containers: xxxx</p><p>原因：当不兼容的版本升级docker并且升级后无法启动docker容器时会出现这种情况</p><p>解决：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep -rl &#x27;docker-runc&#x27; /var/lib/docker/containers/ | xargs sed -i &#x27;s/docker-runc/runc/g</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><h2 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h2><p><a href="https://docs.docker.com/engine/reference/commandline/run/">docker run | Docker Documentation</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Docker部署Mongodb实现私有化部署</title>
      <link href="/posts/c497232c/"/>
      <url>/posts/c497232c/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>MongoDB是一个文档数据库，它类似于JSON对象，我们可以使用MongoDB存储我们的博客数据，比如用户评论，友链文章信息等等，虽然我们前面提到可以申请一个永久免费的Mongodb数据库，但由于是免费的，速度总会比私有部署的慢得多，所以本次教程使用私有化部署Mongodb。</p><h2 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y docker</span><br></pre></td></tr></table></figure><h2 id="运行Mongodb"><a href="#运行Mongodb" class="headerlink" title="运行Mongodb"></a>运行Mongodb</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --restart=always -p 9126:27017 -v /www/data/mongodb/data:/data/db --name mongodb mongo</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">参数</th><th align="center">解释</th></tr></thead><tbody><tr><td align="center">-itd</td><td align="center">-i以交互式运行容器，-t分配一个伪输入终端，-d后台运行</td></tr><tr><td align="center">–restart&#x3D;always</td><td align="center">重启docker时自动启动容器</td></tr><tr><td align="center">-p</td><td align="center">指定端口，格式为 主机(宿主)端口:容器端口</td></tr><tr><td align="center">-v</td><td align="center">目录挂载到其他盘，格式主机(宿主)目录:容器目录</td></tr><tr><td align="center">–name</td><td align="center">重命名容器名字</td></tr></tbody></table><p>mongo表示启动名字为mongo的镜像，如果本地没有，则尝试拉取<a href="https://hub.docker.com/">hub.docker.com</a>的镜像</p><p>由于安装的mongodb默认无验证登录，所以为了防止在互联网上裸奔，我们需要添加用户密码</p><h2 id="创建数据库用户"><a href="#创建数据库用户" class="headerlink" title="创建数据库用户"></a>创建数据库用户</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it mongodb mongo admin</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.createUser(&#123; user: &#x27;admin&#x27;, pwd: &#x27;123456&#x27;, roles: [ &#123; role: &quot;root&quot;, db: &quot;admin&quot; &#125; ] &#125;);</span><br></pre></td></tr></table></figure><p>我试了一下报错：<code>rpc error: code = 2 desc = oci runtime error: exec failed: container_linux.go:290: starting container process caused &quot;exec: \&quot;mongo\&quot;: executable file not found in $PATH&quot;</code>，查资料得知是bash没有找到，换种命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it /bin/sh mongodb mongo admin</span><br></pre></td></tr></table></figure><p>报错：<code>/bin/sh: 0: Can&#39;t open mongo</code>，换种思路：</p><p>使用官方软件连接</p><p><img src="/./img/c497232c/20221018215736852.png" alt="使用官方软件连接"></p><p>打开终端创建用户</p><p><img src="/./img/c497232c/20221018215952317.png" alt="打开终端"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.createUser(&#123; user: &#x27;admin&#x27;, pwd: &#x27;123456&#x27;, roles: [ &#123; role: &quot;root&quot;, db: &quot;admin&quot; &#125; ] &#125;);</span><br></pre></td></tr></table></figure><p>停止刚刚的mongodb</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm -f mongodb</span><br></pre></td></tr></table></figure><p>重新启动，<code>--auth</code>表示需要验证登录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --restart=always -p 9126:27017 -v /www/data/mongodb/data:/data/db --name mongodb mongo --auth</span><br></pre></td></tr></table></figure><p>Compass用户密码连接</p><p><img src="/./img/c497232c/20221018220730791.png" alt="Compass用户密码连接"></p><p>Mongodb内置角色介绍</p><table><thead><tr><th align="center">角色</th><th align="center">值</th></tr></thead><tbody><tr><td align="center">数据库用户角色</td><td align="center">read、readWrite</td></tr><tr><td align="center">数据库管理角色</td><td align="center">dbAdmin、dbOwner、userAdmin；</td></tr><tr><td align="center">集群管理角色</td><td align="center">clusterAdmin、clusterManager、clusterMonitor、hostManager</td></tr><tr><td align="center">备份恢复角色</td><td align="center">backup、restore</td></tr><tr><td align="center">所有数据库角色</td><td align="center">readAnyDatabase、readWriteAnyDatabase、userAdminAnyDatabase、dbAdminAnyDatabase</td></tr><tr><td align="center">超级用户角色</td><td align="center">root</td></tr></tbody></table><p>以上，我们实现了私有化部署Mongodb，支持用户密码登录，感谢查阅。</p><h2 id="推荐文章"><a href="#推荐文章" class="headerlink" title="推荐文章"></a>推荐文章</h2><p><a href="https://blog.aqcoder.cn/posts/b267/">如何申请一个永久免费的 Mongodb 数据库 - 详细版</a></p><p><a href="https://zhuanlan.zhihu.com/p/411605768">腾讯云轻量服务器开放端口方法教程</a></p><p><a href="https://developer.aliyun.com/article/767328">阿里云服务器开放端口教程</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> Mongodb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Vercel托管你的博客吧</title>
      <link href="/posts/bd7009f0/"/>
      <url>/posts/bd7009f0/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><a href="https://vercel.com/">vercel</a>是国外一家网站托管服务，它不仅能够像github page一样托管静态网站，还能部署serverless接口，这代表前后端服务vercel都能部署，<a href="https://vercel.com/">vercel</a>还支持自动配置https，只需在域名服托管商添加vercel的解析就能免费部署https，免去部署证书的麻烦。本教程向大家展示如何使用<a href="https://vercel.com/">vercel</a>部署自己的博客，更多<a href="https://vercel.com/">vercel</a>功能待博客更新。</p><p>本教程需要：</p><p>注册<a href="https://github.com/">Github</a></p><p>一个已备案好的国内域名（比较省事）</p><p>使用<a href="https://hexo.io/">hexo</a>框架下的<a href="https://butterfly.js.org/">butterfly</a>主题并上传代码到github</p><h2 id="注册Vercel"><a href="#注册Vercel" class="headerlink" title="注册Vercel"></a>注册Vercel</h2><p>官网：<a href="https://vercel.com/">https://vercel.com/</a></p><p><img src="/./img/bd7009f0/20221011220331658.png" alt="注册"></p><p>Vercel支持使用github登录，只需使用github授权给vercel即可。</p><h2 id="添加项目"><a href="#添加项目" class="headerlink" title="添加项目"></a>添加项目</h2><p><img src="/./img/bd7009f0/20221011220606928.png" alt="添加项目"></p><p>点击右上角的<code>Add New...</code> ，点击Project添加项目，选择Continue  with Github，导入在github托管的博客仓库</p><p>这里导入我的仓库<code>flow2000.github.io</code>，import，deploy即可。</p><p><img src="/./img/bd7009f0/20221011220823050.png" alt="导入项目"></p><h2 id="添加自定义域名"><a href="#添加自定义域名" class="headerlink" title="添加自定义域名"></a>添加自定义域名</h2><p>由于*.vercel.app被墙了，需要添加自定义域名才能访问，我们可以添加自己域名或者子域名给vecel解析。</p><p>去到刚刚部署的项目中，点击Settings，进入到Domains，添加自己的域名&#x2F;子域名。</p><p><img src="/./img/bd7009f0/20221011221828962.png" alt="添加域名"></p><p>此时，只需在域名托管商添加一个CNAME记录即可，然后等待一会刷新验证成功，Vercel就能帮你部署SSL证书并提供用户访问，你的博客就正式托管在Vercel上了！</p><p>这次成功部署的域名：<a href="https://blog.shinie.top/">https://blog.shinie.top/</a></p><p>另附添加域名解析官方文档：</p><p><a href="https://help.aliyun.com/document_detail/29725.html">阿里云添加域名解析</a></p><p><a href="https://cloud.tencent.com/document/product/302/38661">腾讯云添加域名解析</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用CDN加速你的博客吧</title>
      <link href="/posts/a154400e/"/>
      <url>/posts/a154400e/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>CDN，即内容分发网络，它使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率。我们可以借助CDN来加速我们的网站以达到提高用户访问速度以及隐蔽真实ip的效果。</p><p>首先我们需要拥有一台有固定ip的服务器，一个备案域名（最好是在腾讯云的），CDN资源（腾讯云CDN首单3块，<a href="https://cloud.tencent.com/act/pro/CDN-">点击这里</a>，不是打广告呀）</p><p><img src="/./img/a154400e/20221010234155.png" alt="服务器"></p><h2 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h2><h3 id="静态资源映射"><a href="#静态资源映射" class="headerlink" title="静态资源映射"></a>静态资源映射</h3><p>服务器需要有nginx静态资源映射，主要配置如下：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">8097</span>;</span><br><span class="line">    <span class="attribute">server_name</span> <span class="number">119.91.232.147</span>;</span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">root</span>   /www/blog.aqcoder.cn;</span><br><span class="line">        <span class="attribute">try_files</span> <span class="variable">$uri</span> <span class="variable">$uri</span>/ /index.html;</span><br><span class="line">        <span class="attribute">index</span>  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样我们可以使用ip+端口访问博客：<a href="http://119.91.232.147:8097/">http://119.91.232.147:8097/</a></p><p><img src="/./img/a154400e/20221010234909.png" alt="ip+端口访问博客"></p><h3 id="添加域名"><a href="#添加域名" class="headerlink" title="添加域名"></a>添加域名</h3><p>在腾讯云的控制台的cdn模块，添加域名，该域名是博客域名</p><p><img src="/./img/a154400e/20221010235437204.png" alt="添加域名"></p><h3 id="源站配置"><a href="#源站配置" class="headerlink" title="源站配置"></a>源站配置</h3><p>源站配置为我们上一步的ip+端口访问方式，确认添加即可</p><p><img src="/./img/a154400e/20221010235537946.png" alt="源站配置"></p><h3 id="配置CNAME"><a href="#配置CNAME" class="headerlink" title="配置CNAME"></a>配置CNAME</h3><p>到第三步配置CNAME时，如果是腾讯云下的域名可一键配置，不是也不要紧，只需添加一个CNAME记录即可</p><p><img src="/./img/a154400e/20221010235724633.png" alt="配置CNAME"></p><p><img src="/./img/a154400e/20221010235915951.png" alt="添加域名解析"></p><p>如果是子域名可按照以下方式去配：</p><p><img src="/./img/a154400e/20221011000609610.png" alt="添加子域名解析"></p><p>稍等片刻，部署完毕就会有两个绿标：</p><p><img src="/./img/a154400e/20221011000900427.png" alt="部署完毕"></p><p><a href="https://help.aliyun.com/document_detail/29725.html">阿里云添加域名解析</a></p><p><a href="https://cloud.tencent.com/document/product/302/38661">腾讯云添加域名解析</a></p><h3 id="配置证书"><a href="#配置证书" class="headerlink" title="配置证书"></a>配置证书</h3><p>最后配置证书即可</p><p><img src="/./img/a154400e/20221011000827203.png" alt="配置证书"></p><p>如果是腾讯云的证书可一键配置</p><p><img src="/./img/a154400e/20221011001123235.png" alt="一键配置证书"></p><p>配置完成：<a href="https://blog.shinie.top/">https://blog.shinie.top/</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> CDN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker搭建Mysql环境并允许远程访问</title>
      <link href="/posts/11000000000/"/>
      <url>/posts/11000000000/</url>
      
        <content type="html"><![CDATA[<h2 id="创建目录"><a href="#创建目录" class="headerlink" title="创建目录"></a>创建目录</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /www/mysql/conf</span><br><span class="line">mkdir -p /www/mysql/data</span><br><span class="line">mkdir -p /www/mysql/logs</span><br></pre></td></tr></table></figure><p>在<code>/www/mysql/conf</code>目录下新建<code>my.cnf</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"># Copyright (c) 2014, 2016, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line">#</span><br><span class="line"># This program is free software; you can redistribute it and/or modify</span><br><span class="line"># it under the terms of the GNU General Public License as published by</span><br><span class="line"># the Free Software Foundation; version 2 of the License.</span><br><span class="line">#</span><br><span class="line"># This program is distributed in the hope that it will be useful,</span><br><span class="line"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br><span class="line"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span><br><span class="line"># GNU General Public License for more details.</span><br><span class="line">#</span><br><span class="line"># You should have received a copy of the GNU General Public License</span><br><span class="line"># along with this program; if not, write to the Free Software</span><br><span class="line"># Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># The MySQL  Server configuration file.</span><br><span class="line">#</span><br><span class="line"># For explanations see</span><br><span class="line"># http://dev.mysql.com/doc/mysql/en/server-system-variables.html</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">pid-file= /var/run/mysqld/mysqld.pid</span><br><span class="line">socket= /var/run/mysqld/mysqld.sock</span><br><span class="line">datadir= /var/lib/mysql</span><br><span class="line">#log-error= /var/log/mysql/error.log</span><br><span class="line"># Disabling symbolic-links is recommended to prevent assorted security risks</span><br><span class="line">symbolic-links=0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">max_connections = 2000</span><br><span class="line">max_user_connections = 1900</span><br><span class="line">max_connect_errors = 100000</span><br><span class="line">max_allowed_packet = 50M</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">skip-name-resolve</span><br><span class="line">sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION</span><br><span class="line">lower_case_table_names=1</span><br></pre></td></tr></table></figure><h3 id="拉取镜像，并启动容器"><a href="#拉取镜像，并启动容器" class="headerlink" title="拉取镜像，并启动容器"></a>拉取镜像，并启动容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --restart=always --name=mysql -p 3295:3306 -v /www/mysql/conf:/etc/mysql -v /www/mysql/logs:/var/log/mysql -v /www/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 mysql:5.7.21</span><br></pre></td></tr></table></figure><h3 id="进入容器"><a href="#进入容器" class="headerlink" title="进入容器"></a>进入容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it mysql /bin/bash </span><br></pre></td></tr></table></figure><h3 id="登录MySQL"><a href="#登录MySQL" class="headerlink" title="登录MySQL"></a>登录MySQL</h3><p>输入以下命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure><p>输入创建并启动容器命令设置的<code>123456</code></p><p>登陆成功后修改密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;123456&#x27;;</span><br></pre></td></tr></table></figure><p>123456就是root用户的登陆密码</p><h3 id="允许远程连接"><a href="#允许远程连接" class="headerlink" title="允许远程连接"></a>允许远程连接</h3><ul><li>新建用户允许远程连接</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grant all on *.* to admin@&#x27;%&#x27; identified by &#x27;123456&#x27; with grant option;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><ul><li>现有用户下允许远程连接</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">update user set host=&#x27;%&#x27; where user=&#x27;root&#x27; and host=&#x27;localhost&#x27;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><ul><li>查看用户</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">select host,user from user;</span><br></pre></td></tr></table></figure><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><h3 id="mysql内"><a href="#mysql内" class="headerlink" title="mysql内"></a>mysql内</h3><h4 id="查看全局变量"><a href="#查看全局变量" class="headerlink" title="查看全局变量"></a>查看全局变量</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global variables;</span><br></pre></td></tr></table></figure><h4 id="查看端口"><a href="#查看端口" class="headerlink" title="查看端口"></a>查看端口</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global variables like &#x27;port&#x27;;</span><br></pre></td></tr></table></figure><h3 id="mysql外"><a href="#mysql外" class="headerlink" title="mysql外"></a>mysql外</h3><h4 id="查看配置文件路径"><a href="#查看配置文件路径" class="headerlink" title="查看配置文件路径"></a>查看配置文件路径</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/mysqld --verbose --help | grep -A 1 &#x27;Default options&#x27;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> Mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>九月份小结：我的博客优化以及未来计划安排</title>
      <link href="/posts/6007/"/>
      <url>/posts/6007/</url>
      
        <content type="html"><![CDATA[<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>这个月一直在忙实习，没有时间产出文章，质量也水了好多。博客优化减少了频度，逐渐转向文章产出。一句话总结：文章质量不用水</p><h2 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h2><ul><li>增加<a href="https://travellings.cn/">开往</a>、<a href="https://foreverblog.cn/go.html">虫洞</a>随机跳转链接来增加访问量</li><li>上线<a href="https://aqcoder.cn/">导航站点</a></li><li>增加<a href="https://blog.aqcoder.cn/fcircle/">友链朋友圈</a>，加强与友链朋友的联系，快速学习最新文章</li><li>上线<a href="https://bing.aqcoder.cn/">必应壁纸站点</a></li><li>增加<a href="https://blog.aqcoder.cn/history/">建站记录</a>，记录一些重要时刻，增加仪式感</li><li>新增友链若干</li></ul><h2 id="困难"><a href="#困难" class="headerlink" title="困难"></a>困难</h2><ol><li><del>部署服务器加速api的访问，git钩子部署有难度</del>，多查查资料，多问问大佬</li><li><del>每天一篇文章真的撑不住</del>，改个三天一篇</li></ol><h2 id="计划"><a href="#计划" class="headerlink" title="计划"></a>计划</h2><ol><li>保持每月十篇文章的产出</li><li>专注个人提升</li><li>到群里多交流（吹水）</li></ol>]]></content>
      
      
      <categories>
          
          <category> 博客总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 月度总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github在知道仓库地址如何快速下载仓库</title>
      <link href="/posts/e89e/"/>
      <url>/posts/e89e/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>我们有时候在逛Github时遇到自己想要的仓库，想要下载源码，但是奈何总是下载失败，用加速网也不稳定，本教程教大家如何正确使用git下载仓库</p><p>众所周知，仓库名的地址一般是github.com&#x2F;用户名&#x2F;仓库名.git，而且git克隆有两种方式：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/flow2000/bing<span class="literal">-api</span>.git</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:flow2000/bing<span class="literal">-api</span>.git</span><br></pre></td></tr></table></figure><p>如果用第一种方式的话会因为走HTTP协议被<a href="https://baike.baidu.com/item/DNS%E6%B1%A1%E6%9F%93/8620359">DNS污染</a>（无法在浏览器正常访问），而第二种因为走SSH协议就不会了，因此我们可以在已知仓库名的情况下使用<code>git</code>快速下载仓库</p><p><img src="/./img/e89e/20220928143539.png" alt="git下载仓库"></p><h2 id="小技巧"><a href="#小技巧" class="headerlink" title="小技巧"></a>小技巧</h2><p>我一般是在文本下记录<code>git clone git@github.com: </code>，如果遇到了心怡的仓库就复制用户名和仓库名，例如：<code>cjbassi/gotop</code>，然后拼接在一起复制整条语句，例如：<code>git clone git@github.com:cjbassi/gotop</code></p><p><img src="/./img/e89e/2156987653242.png" alt="小技巧"></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何申请一个永久免费的Mongodb数据库-详细版</title>
      <link href="/posts/b267/"/>
      <url>/posts/b267/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>MongoDB是一个文档数据库，它类似于JSON对象，我们可以使用MongoDB存储我们的博客数据，比如用户评论，友链文章信息等等，但由于自建服务略有些麻烦，今天教大家如何申请一个永久免费的Mongodb数据库供我们使用。<a href="https://twikoo.js.org/">twikoo</a>以及<a href="https://fcircle-doc.yyyzyyyz.cn/#/">友链朋友圈</a>都可以基于以下教程使用MongoDB</p><h2 id="注册账号"><a href="#注册账号" class="headerlink" title="注册账号"></a>注册账号</h2><p><a href="https://account.mongodb.com/account/register">MongoDB Cloud Register</a></p><p>填写邮箱等信息，验证邮箱后选择FREE免费套餐</p><p><img src="/./img/b267/20220925212709.png" alt="申请数据库"></p><h2 id="创建数据库用户"><a href="#创建数据库用户" class="headerlink" title="创建数据库用户"></a>创建数据库用户</h2><p>设置自己想要的数据库用户和密码</p><p><img src="/./img/b267/20220925212930.png" alt="创建数据库用户"></p><h2 id="选择地区"><a href="#选择地区" class="headerlink" title="选择地区"></a>选择地区</h2><p>选择提供商选择AWS，地区选择Hong Kong (ap-east-1)，点击<code>Create Cluster</code></p><p><img src="/./img/b267/20220925212832.png" alt="选择地区"></p><p>创建完成后进入到控制台界面</p><p><img src="/./img/b267/20220925213108.png" alt="控制台界面"></p><h2 id="连接字符串"><a href="#连接字符串" class="headerlink" title="连接字符串"></a>连接字符串</h2><p>点击<code>Connect</code>，MongoDB提供了四种连接方式，我们只用两种就行（<code>Connect using VS Code</code>、<code>Connect your application</code>）</p><p><img src="/./img/b267/20220925213148.png" alt="选择连接方式"></p><h3 id="VSCode连接"><a href="#VSCode连接" class="headerlink" title="VSCode连接"></a>VSCode连接</h3><p>使用VSCode连接可以快速查看和操作可视化数据</p><p>在上一步选择<code>Connect using VS Code</code>，复制字符串备用</p><p><img src="/./img/b267/20220925213245.png" alt="VSCode连接"></p><p>安装VSCode插件<code>MongoDB for vs Code</code></p><p><img src="/./img/b267/20220925213304.png" alt="安装VSCode插件"></p><p>点击左边的小叶子，点击加号，点击页面的Connect，出现输入框后粘贴连接字符串，记得将<code>&lt;password&gt;</code>替换成原先创建的数据库密码（有<code>&lt;user&gt;</code>的话替换成创建的数据库账号），回车等待连接完成</p><p><img src="/./img/b267/20220925213541.png" alt="连接Mongodb"></p><p>成功截图：</p><p><img src="/./img/b267/20220925213623.png" alt="成功截图"></p><h3 id="应用连接"><a href="#应用连接" class="headerlink" title="应用连接"></a>应用连接</h3><p>上述步骤只是我们便于查看和操作可视化数据，我们还需要一个连接字符串用于应用开发，此时我们选择<code>Connect your application</code>，选择驱动语言为python，<a href="https://twikoo.js.org/">twikoo</a>以及<a href="https://fcircle-doc.yyyzyyyz.cn/#/">友链朋友圈</a>都是基于python开发的。复制字符串，并替换<code>&lt;password&gt;</code>（有<code>&lt;user&gt;</code>的话替换成创建的数据库账号），这个字符串就是进行开发时需要用到的字符串。</p><p><img src="/./img/b267/20220925213212.png" alt="Connect your application"></p><h2 id="Studio-3T连接"><a href="#Studio-3T连接" class="headerlink" title="Studio 3T连接"></a>Studio 3T连接</h2><p>如果VSCode不满足可视化数据的需求，可以使用<a href="https://studio3t.com/">Studio3T</a>连接，连接字符串使用<code>应用连接</code>的字符串即可。</p><h2 id="MongoDB-Compass连接"><a href="#MongoDB-Compass连接" class="headerlink" title="MongoDB Compass连接"></a>MongoDB Compass连接</h2><p><a href="https://www.mongodb.com/products/compass">MongoDB Compass</a>是Mongodb官方的可视化管理工具，不仅拥有数据的基本操作，而且支持搜索、表格与 Json 格式查看，一键导入导出 Json 或 csv等等</p><p>下载方式可在选择连接方式的第三钟方式获得：<code>Connect using MongoDB Compass</code>，选择windows版本下载即可，连接字符串同样选择<code>应用连接</code></p><p><img src="/./img/b267/1664286817563.png" alt="Connect using MongoDB Compass"></p><div class="note success no-icon flat"><p>再次感谢博主<a href="https://zhangshier.vip/">张时贰</a>的指点，这个官方自带的连接工具的确方便了数据操作，也减少了卡顿的产生（Studio 3T有时候很卡顿）</p></div>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mongodb </tag>
            
            <tag> 数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>提问的智慧</title>
      <link href="/posts/8778/"/>
      <url>/posts/8778/</url>
      
        <content type="html"><![CDATA[<p><strong>How To Ask Questions The Smart Way</strong></p><p>Copyright © 2001,2006,2014 Eric S. Raymond, Rick Moen</p><p>本指南英文版版权为 Eric S. Raymond, Rick Moen 所有。</p><p>原文网址：<a href="http://www.catb.org/~esr/faqs/smart-questions.html">http://www.catb.org/~esr&#x2F;faqs&#x2F;smart-questions.html</a></p><p>Copyleft 2001 by D.H.Grand(nOBODY&#x2F;Ginux), 2010 by Gasolin, 2015 by Ryan Wu</p><p>本中文指南是基于原文 3.10 版以及 2010 年由 <a href="https://github.com/gasolin">Gasolin</a> 所翻译版本的最新翻译；</p><p>协助指出翻译问题，<strong>请<a href="https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/issues/new">发 issue</a>，或直接<a href="https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/compare">发 pull request</a> 给我。</strong></p><p>本文另有<a href="https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way">繁體中文版</a>。</p><h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><p>许多项目在他们的使用协助&#x2F;说明网页中链接了本指南，这么做很好，我们也鼓励大家都这么做。但如果你是负责管理这个项目网页的人，请在超链接附近的显著位置上注明：</p><p><strong>本指南不提供此项目的实际支持服务！</strong></p><p>我们已经深刻领教到少了上述声明所带来的痛苦。因为少了这点声明，我们不停地被一些白痴纠缠。这些白痴认为既然我们发布了这本指南，那么我们就有责任解决世上所有的技术问题。</p><p>如果你因寻求某些帮助而阅读本指南，并在离开时还觉得可以从本文作者这里得到直接帮助，那你就是我们之前说的那些白痴之一。别问我们问题，我们只会忽略你。我们在这本指南中想教你如何从那些真正懂得你所遇到的软件或硬件问题的人处取得协助，而 99% 的情况下那不会是我们。除非你确定本指南的作者之一刚好是你所遇到的问题领域的专家，否则请不要打扰我们，这样大家都会开心一点。</p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>在<a href="http://www.catb.org/~esr/faqs/hacker-howto.html">黑客</a>的世界里，当你拋出一个技术问题时，最终是否能得到有用的回答，往往取决于你所提问和追问的方式。本指南将教你如何正确的提问以获得你满意的答案。</p><p>现在开源（Open Source）软件已经相当盛行，您通常可以从其他更有经验的用户那里获得与黑客一样好的答案，这是件<strong>好事</strong>；和黑客相比，用户们往往对那些新手常遇到的问题更宽容一些。尽管如此，以我们在此推荐的方式对待这些有经验的用户通常也是从他们那里获得有用答案的最有效方式。</p><p>首先你应该明白，黑客们喜爱有挑战性的问题，或者能激发他们思维的好问题。如果我们并非如此，那我们也不会成为你想询问的对象。如果你给了我们一个值得反复咀嚼玩味的好问题，我们自会对你感激不尽。好问题是激励，是厚礼。好问题可以提高我们的理解力，而且通常会暴露我们以前从没意识到或者思考过的问题。对黑客而言，“好问题！”是诚挚的大力称赞。</p><p>尽管如此，黑客们有着蔑视或傲慢面对简单问题的坏名声，这有时让我们看起来对新手、无知者似乎较有敌意，但其实不是那样的。</p><p>我们不讳言我们对那些不愿思考、或者在发问前不做他们该做的事的人的蔑视。那些人是时间杀手 —— 他们只想索取，从不付出，消耗我们可用在更有趣的问题或更值得回答的人身上的时间。我们称这样的人为 <code>失败者（撸瑟）</code> （由于历史原因，我们有时把它拼作 <code>lusers</code>）。</p><p>我们意识到许多人只是想使用我们写的软件，他们对学习技术细节没有兴趣。对大多数人而言，电脑只是种工具，是种达到目的的手段而已。他们有自己的生活并且有更要紧的事要做。我们了解这点，也从不指望每个人都对这些让我们着迷的技术问题感兴趣。尽管如此，我们回答问题的风格是指向那些真正对此有兴趣并愿意主动参与解决问题的人，这一点不会变，也不该变。如果连这都变了，我们就是在降低做自己最擅长的事情上的效率。</p><p>我们（在很大程度上）是自愿的，从繁忙的生活中抽出时间来解答疑惑，而且时常被提问淹没。所以我们无情地滤掉一些话题，特别是拋弃那些看起来像失败者的家伙，以便更高效地利用时间来回答<code>赢家（winner）</code>的问题。</p><p>如果你厌恶我们的态度，高高在上，或过于傲慢，不妨也设身处地想想。我们并没有要求你向我们屈服 —— 事实上，我们大多数人非常乐意与你平等地交流，只要你付出小小努力来满足基本要求，我们就会欢迎你加入我们的文化。但让我们帮助那些不愿意帮助自己的人是没有效率的。无知没有关系，但装白痴就是不行。</p><p>所以，你不必在技术上很在行才能吸引我们的注意，但你必须表现出能引导你变得在行的特质 —— 机敏、有想法、善于观察、乐于主动参与解决问题。如果你做不到这些使你与众不同的事情，我们建议你花点钱找家商业公司签个技术支持服务合同，而不是要求黑客个人无偿地帮助你。</p><p>如果你决定向我们求助，当然你也不希望被视为失败者，更不愿成为失败者中的一员。能立刻得到快速并有效答案的最好方法，就是像赢家那样提问 —— 聪明、自信、有解决问题的思路，只是偶尔在特定的问题上需要获得一点帮助。</p><p>（欢迎对本指南提出改进意见。你可以把你的建议发送至 <a href="esr@thyrsus.com">esr@thyrsus.com</a> 或 <a href="respond-auto@linuxmafia.com">respond-auto@linuxmafia.com</a>。然而请注意，本文并非<a href="http://www.ietf.org/rfc/rfc1855.txt">网络礼节</a>的通用指南，而我们通常会拒绝无助于在技术论坛得到有用答案的建议）。</p><h2 id="在提问之前"><a href="#在提问之前" class="headerlink" title="在提问之前"></a>在提问之前</h2><p>在你准备要通过电子邮件、新闻群组或者聊天室提出技术问题前，请先做到以下事情：</p><ol><li>尝试在你准备提问的论坛的旧文章中搜索答案。</li><li>尝试上网搜索以找到答案。</li><li>尝试阅读手册以找到答案。</li><li>尝试阅读常见问题文件（FAQ）以找到答案。</li><li>尝试自己检查或试验以找到答案。</li><li>向你身边的强者朋友打听以找到答案。</li><li>如果你是程序开发者，请尝试阅读源代码以找到答案。</li></ol><p>当你提出问题的时候，请先表明你已经做了上述的努力；这将有助于树立你并不是一个不劳而获且浪费别人的时间的提问者。如果你能一并表达在做了上述努力的过程中所<strong>学到</strong>的东西会更好，因为我们更乐于回答那些表现出能从答案中学习的人的问题。</p><p>运用某些策略，比如先用 Google 搜索你所遇到的各种错误信息（搜索 <a href="http://groups.google.com/">Google 论坛</a>和网页），这样很可能直接就找到了能解决问题的文件或邮件列表线索。即使没有结果，在邮件列表或新闻组寻求帮助时加上一句 <code>我在 Google 中搜过下列句子但没有找到什么有用的东西</code> 也是件好事，即使它只是表明了搜索引擎不能提供哪些帮助。这么做（加上搜索过的字串）也让遇到相似问题的其他人能被搜索引擎引导到你的提问来。</p><p>别着急，不要指望几秒钟的 Google 搜索就能解决一个复杂的问题。在向专家求助之前，再阅读一下常见问题文件（FAQ）、放轻松、坐得舒服一些，再花点时间思考一下这个问题。相信我们，他们能从你的提问看出你做了多少阅读与思考，如果你是有备而来，将更有可能得到解答。不要将所有问题一股脑拋出，只因你的第一次搜索没有找到答案（或者找到太多答案）。</p><p>准备好你的问题，再将问题仔细的思考过一遍，因为草率的发问只能得到草率的回答，或者根本得不到任何答案。越是能表现出在寻求帮助前你为解决问题所付出的努力，你越有可能得到实质性的帮助。</p><p>小心别问错了问题。如果你的问题基于错误的假设，某个普通黑客（J. Random Hacker）多半会一边在心里想着<code>蠢问题…</code>，一边用无意义的字面解释来答复你，希望着你会从问题的回答（而非你想得到的答案）中汲取教训。</p><p>绝不要自以为<strong>够格</strong>得到答案，你没有；你并没有。毕竟你没有为这种服务支付任何报酬。你将会是自己去<strong>挣到</strong>一个答案，靠提出有内涵的、有趣的、有思维激励作用的问题 —— 一个有潜力能贡献社区经验的问题，而不仅仅是被动的从他人处索取知识。</p><p>另一方面，表明你愿意在找答案的过程中做点什么是一个非常好的开端。<code>谁能给点提示？</code>、<code>我的这个例子里缺了什么？</code>以及<code>我应该检查什么地方</code>比<code>请把我需要的确切的过程贴出来</code>更容易得到答复。因为你表现出只要有人能指个正确方向，你就有完成它的能力和决心。</p><h2 id="当你提问时"><a href="#当你提问时" class="headerlink" title="当你提问时"></a>当你提问时</h2><h3 id="慎选提问的论坛"><a href="#慎选提问的论坛" class="headerlink" title="慎选提问的论坛"></a>慎选提问的论坛</h3><p>小心选择你要提问的场合。如果你做了下述的事情，你很可能被忽略掉或者被看作失败者：</p><ul><li>在与主题不合的论坛上贴出你的问题。</li><li>在探讨进阶技术问题的论坛张贴非常初级的问题；反之亦然。</li><li>在太多的不同新闻群组上重复转贴同样的问题（cross-post）。</li><li>向既非熟人也没有义务解决你问题的人发送私人电邮。</li></ul><p>黑客会剔除掉那些搞错场合的问题，以保护他们沟通的渠道不被无关的东西淹没。你不会想让这种事发生在自己身上的。</p><p>因此，第一步是找到对的论坛。再说一次，Google 和其它搜索引擎还是你的朋友，用它们来找到与你遭遇到困难的软硬件问题最相关的网站。通常那儿都有常见问题（FAQ）、邮件列表及相关说明文件的链接。如果你的努力（包括<strong>阅读</strong> FAQ）都没有结果，网站上也许还有报告 Bug（Bug-reporting）的流程或链接，如果是这样，链过去看看。</p><p>向陌生的人或论坛发送邮件最可能是风险最大的事情。举例来说，别假设一个提供丰富内容的网页的作者会想充当你的免费顾问。不要对你的问题是否会受到欢迎做太乐观的估计 —— 如果你不确定，那就向别处发送，或者压根别发。</p><p>在选择论坛、新闻群组或邮件列表时，别太相信它的名字，先看看 FAQ 或者许可书以弄清楚你的问题是否切题。发文前先翻翻已有的话题，这样可以让你感受一下那里的文化。事实上，事先在新闻组或邮件列表的历史记录中搜索与你问题相关的关键词是个极好的主意，也许这样就找到答案了。即使没有，也能帮助你归纳出更好的问题。</p><p>别像机关枪似的一次“扫射”所有的帮助渠道，这就像大喊大叫一样会使人不快。要一个一个地来。</p><p>搞清楚你的主题！最典型的错误之一是在某种致力于跨平台可移植的语言、套件或工具的论坛中提关于 Unix 或 Windows 操作系统程序界面的问题。如果你不明白为什么这是大错，最好在搞清楚这之间差异之前什么也别问。</p><p>一般来说，在仔细挑选的公共论坛中提问，会比在私有论坛中提同样的问题更容易得到有用的回答。有几个理由可以支持这点，一是看潜在的回复者有多少，二是看观众有多少。黑客较愿意回答那些能帮助到许多人的问题。</p><p>可以理解的是，老练的黑客和一些热门软件的作者正在接受过多的错发信息。就像那根最后压垮骆驼背的稻草一样，你的加入也有可能使情况走向极端 —— 已经好几次了，一些热门软件的作者由于涌入其私人邮箱的大量不堪忍受的无用邮件而不再提供支持。</p><h3 id="Stack-Overflow"><a href="#Stack-Overflow" class="headerlink" title="Stack Overflow"></a>Stack Overflow</h3><p>搜索，<em>然后</em>在 Stack Exchange 问。</p><p>近年来，Stack Exchange 社区已经成为回答技术及其他问题的主要渠道，尤其是那些开放源码的项目。</p><p>因为 Google 索引是即时的，在看 Stack Exchange 之前先在 Google 搜索。有很高的几率某人已经问了一个类似的问题，而且 Stack Exchange 网站们往往会是搜索结果中最前面几个。如果你在 Google 上没有找到任何答案，你再到特定相关主题的网站去找。用标签（Tag）搜索能让你更缩小你的搜索结果。</p><p>如果你还是找不到任何对你的问题有用的内容，请把你的问题发在与它最相关的网站上。提问的时候请善用格式化工具，尤其注意为代码添加格式，并且添加相关的标签（特别是编程语言、操作系统或库&#x2F;包的名称）。当有人要求你提供更多相关信息时，请编辑你的贴子来补充它们[译注：而不是发一个回帖或回答！]。如果你觉得一个答案对你有帮助，点击向上的箭头来为它投票；如果一个答案提供了问题的正确解决方案，点击投票按钮下方的对勾来将它标记为正解。</p><p>Stack Exchange 已经成长到<a href="https://stackexchange.com/sites">超过一百个网站</a>，以下是最常用的几个站：</p><ul><li>Super User 是问一些通用的电脑问题，如果你的问题跟代码或是写程序无关，只是一些网络连线之类的，请到这里。</li><li>Stack Overflow 是问写程序有关的问题。</li><li>Server Fault 是问服务器和网管相关的问题。</li></ul><h3 id="网站和-IRC-论坛"><a href="#网站和-IRC-论坛" class="headerlink" title="网站和 IRC 论坛"></a>网站和 IRC 论坛</h3><p>本地的用户群组（user group），或者你所用的 Linux 发行版本也许正在宣传他们的网页论坛或 IRC 频道，并提供新手帮助（在一些非英语国家，新手论坛很可能还是邮件列表），这些都是开始提问的好地方，特别是当你觉得遇到的也许只是相对简单或者很普通的问题时。有广告赞助的 IRC 频道是公开欢迎提问的地方，通常可以即时得到回应。</p><p>事实上，如果程序出的问题只发生在特定 Linux 发行版提供的版本（这很常见），最好先去该发行版的论坛或邮件列表中提问，再到程序本身的论坛或邮件列表提问。（否则）该项目的黑客可能仅仅回复“使用<strong>我们的</strong>版本”。</p><p>在任何论坛发文以前，先确认一下有没有搜索功能。如果有，就试着搜索一下问题的几个关键词，也许这会有帮助。如果在此之前你已做过通用的网页搜索（你也该这样做），还是再搜索一下论坛，搜索引擎有可能没来得及索引此论坛的全部内容。</p><p>通过论坛或 IRC 频道来提供用户支持服务有增长的趋势，电子邮件则大多为项目开发者间的交流而保留。所以最好先在论坛或 IRC 中寻求与该项目相关的协助。</p><p>在使用 IRC 的时候，首先最好不要发布很长的问题描述，有些人称之为频道洪水。最好通过一句话的问题描述来开始聊天。</p><h3 id="第二步，使用项目邮件列表"><a href="#第二步，使用项目邮件列表" class="headerlink" title="第二步，使用项目邮件列表"></a>第二步，使用项目邮件列表</h3><p>当某个项目提供开发者邮件列表时，要向列表而不是其中的个别成员提问，即使你确信他能最好地回答你的问题。查一查项目的文件和首页，找到项目的邮件列表并使用它。有几个很好的理由支持我们采用这种办法：</p><ul><li>任何好到需要向个别开发者提出的问题，也将对整个项目群组有益。反之，如果你认为自己的问题对整个项目群组来说太愚蠢，那这也不能成为骚扰个别开发者的理由。</li><li>向列表提问可以分散开发者的负担，个别开发者（尤其是项目领导人）也许太忙以至于没法回答你的问题。</li><li>大多数邮件列表都会被存档，那些被存档的内容将被搜索引擎索引。如果你向列表提问并得到解答，将来其他人可以通过网页搜索找到你的问题和答案，也就不用再次发问了。</li><li>如果某些问题经常被问到，开发者可以利用此信息来改进说明文件或软件本身，以使其更清楚。如果只是私下提问，就没有人能看到最常见问题的完整场景。</li></ul><p>如果一个项目既有“用户”也有“开发者”（或“黑客”）邮件列表或论坛，而你又不会动到那些源代码，那么就向“用户”列表或论坛提问。不要假设自己会在开发者列表中受到欢迎，那些人多半会将你的提问视为干扰他们开发的噪音。</p><p>然而，如果你<strong>确信</strong>你的问题很特别，而且在“用户”列表或论坛中几天都没有回复，可以试试前往“开发者”列表或论坛发问。建议你在张贴前最好先暗地里观察几天以了解那里的行事方式（事实上这是参与任何私有或半私有列表的好主意）</p><p>如果你找不到一个项目的邮件列表，而只能查到项目维护者的电子邮件地址，尽管向他发信。即使是在这种情况下，也别假设（项目）邮件列表不存在。在你的电子邮件中，请陈述你已经试过但没有找到合适的邮件列表，也提及你不反对将自己的邮件转发给他人（许多人认为，即使没什么秘密，私人电子邮件也不应该被公开。通过允许将你的电子邮件转发他人，你给了相应人员处置你邮件的选择）。</p><h3 id="使用有意义且描述明确的标题"><a href="#使用有意义且描述明确的标题" class="headerlink" title="使用有意义且描述明确的标题"></a>使用有意义且描述明确的标题</h3><p>在邮件列表、新闻群组或论坛中，大约 50 字以内的标题是抓住资深专家注意力的好机会。别用喋喋不休的<code>帮帮忙</code>、<code>跪求</code>、<code>急</code>（更别说<code>救命啊！！！！</code>这样让人反感的话，用这种标题会被条件反射式地忽略）来浪费这个机会。不要妄想用你的痛苦程度来打动我们，而应该是在这点空间中使用极简单扼要的描述方式来提出问题。</p><p>一个好标题范例是<code>目标 —— 差异</code>式的描述，许多技术支持组织就是这样做的。在<code>目标</code>部分指出是哪一个或哪一组东西有问题，在<code>差异</code>部分则描述与期望的行为不一致的地方。</p><blockquote><p>蠢问题：救命啊！我的笔记本电脑不能正常显示了！</p></blockquote><blockquote><p>聪明问题：X.org 6.8.1 的鼠标指针会变形，某牌显卡 MV1005 芯片组。</p></blockquote><blockquote><p>更聪明问题：X.org 6.8.1 的鼠标指针，在某牌显卡 MV1005 芯片组环境下 - 会变形。</p></blockquote><p>编写<code>目标 —— 差异</code> 式描述的过程有助于你组织对问题的细致思考。是什么被影响了？ 仅仅是鼠标指针或者还有其它图形？只在 X.org 的 X 版中出现？或只是出现在 6.8.1 版中？ 是针对某牌显卡芯片组？或者只是其中的 MV1005 型号？ 一个黑客只需瞄一眼就能够立即明白你的环境<strong>和</strong>你遇到的问题。</p><p>总而言之，请想像一下你正在一个只显示标题的存档讨论串（Thread）索引中查寻。让你的标题更好地反映问题，可使下一个搜索类似问题的人能够关注这个讨论串，而不用再次提问相同的问题。</p><p>如果你想在回复中提出问题，记得要修改内容标题，以表明你是在问一个问题， 一个看起来像 <code>Re: 测试</code> 或者 <code>Re: 新 bug</code> 的标题很难引起足够重视。另外，在不影响连贯性之下，适当引用并删减前文的内容，能给新来的读者留下线索。</p><p>对于讨论串，不要直接点击回复来开始一个全新的讨论串，这将限制你的观众。因为有些邮件阅读程序，比如 mutt ，允许用户按讨论串排序并通过折叠讨论串来隐藏消息，这样做的人永远看不到你发的消息。</p><p>仅仅改变标题还不够。mutt 和其它一些邮件阅读程序还会检查邮件标题以外的其它信息，以便为其指定讨论串。所以宁可发一个全新的邮件。</p><p>在网页论坛上，好的提问方式稍有不同，因为讨论串与特定的信息紧密结合，并且通常在讨论串外就看不到里面的内容，故通过回复提问，而非改变标题是可接受的。不是所有论坛都允许在回复中出现分离的标题，而且这样做了基本上没有人会去看。不过，通过回复提问，这本身就是暧昧的做法，因为它们只会被正在查看该标题的人读到。所以，除非你<strong>只想</strong>在该讨论串当前活跃的人群中提问，不然还是另起炉灶比较好。</p><h3 id="使问题容易回复"><a href="#使问题容易回复" class="headerlink" title="使问题容易回复"></a>使问题容易回复</h3><p>以<code>请将你的回复发送到……</code>来结束你的问题多半会使你得不到回答。如果你觉得花几秒钟在邮件客户端设置一下回复地址都麻烦，我们也觉得花几秒钟思考你的问题更麻烦。如果你的邮件程序不支持这样做，<a href="http://linuxmafia.com/faq/Mail/muas.html">换个好点的</a>；如果是操作系统不支持这种邮件程序，也换个好点的。</p><p>在论坛，要求通过电子邮件回复是非常无礼的，除非你认为回复的信息可能比较敏感（有人会为了某些未知的原因，只让你而不是整个论坛知道答案）。如果你只是想在有人回复讨论串时得到电子邮件提醒，可以要求网页论坛发送给你。几乎所有论坛都支持诸如<code>追踪此讨论串</code>、<code>有回复时发送邮件提醒</code>等功能。</p><h3 id="使用清晰、正确、精准且合乎语法的语句"><a href="#使用清晰、正确、精准且合乎语法的语句" class="headerlink" title="使用清晰、正确、精准且合乎语法的语句"></a><a name="使用清晰、正确、精准且合乎语法的语句">使用清晰、正确、精准且合乎语法的语句</a></h3><p>我们从经验中发现，粗心的提问者通常也会粗心地写程序与思考（我敢打包票）。回答粗心大意者的问题很不值得，我们宁愿把时间耗在别处。</p><p>正确的拼写、标点符号和大小写是很重要的。一般来说，如果你觉得这样做很麻烦，不想在乎这些，那我们也觉得麻烦，不想在乎你的提问。花点额外的精力斟酌一下字句，用不着太僵硬与正式 —— 事实上，黑客文化很看重能准确地使用非正式、俚语和幽默的语句。但它<strong>必须很</strong>准确，而且有迹象表明你是在思考和关注问题。</p><p>正确地拼写、使用标点和大小写，不要将<code>its</code>混淆为<code>it&#39;s</code>，<code>loose</code>搞成<code>lose</code>或者将<code>discrete</code>弄成<code>discreet</code>。不要<strong>全部用大写</strong>，这会被视为无礼的大声嚷嚷（全部小写也好不到哪去，因为不易阅读。<a href="http://en.wikipedia.org/wiki/Alan_Cox">Alan Cox</a> 也许可以这样做，但你不行）。</p><p>更白话的说，如果你写得像是个半文盲[译注：<a href="http://zh.wikipedia.org/wiki/%E5%B0%8F%E7%99%BD">小白</a>]，那多半得不到理睬。也不要使用即时通信中的简写或<a href="http://zh.wikipedia.org/wiki/%E7%81%AB%E6%98%9F%E6%96%87">火星文</a>，如将<code>的</code>简化为<code>d</code>会使你看起来像一个为了少打几个键而省字的小白。更糟的是，如果像个小孩似地鬼画符那绝对是在找死，可以肯定没人会理你（或者最多是给你一大堆指责与挖苦）。</p><p>如果在使用非母语的论坛提问，你可以犯点拼写和语法上的小错，但决不能在思考上马虎（没错，我们通常能弄清两者的分别）。同时，除非你知道回复者使用的语言，否则请使用英语书写。繁忙的黑客一般会直接删除用他们看不懂的语言写的消息。在网络上英语是通用语言，用英语书写可以将你的问题在尚未被阅读就被直接删除的可能性降到最低。</p><p>如果英文是你的外语（Second language），提示潜在回复者你有潜在的语言困难是很好的：<br>[译注：以下附上原文以供使用]</p><blockquote><p>English is not my native language; please excuse typing errors.</p></blockquote><ul><li>英文不是我的母语，请原谅我的错字或语法。</li></ul><blockquote><p>If you speak $LANGUAGE, please email&#x2F;PM me;<br>I may need assistance translating my question.</p></blockquote><ul><li>如果你说<strong>某语言</strong>，请向我发电邮&#x2F;私信；</li><li>我需要有人协助我翻译我的问题。</li></ul><blockquote><p>I am familiar with the technical terms,<br>but some slang expressions and idioms are difficult for me.</p></blockquote><ul><li>我对技术名词很熟悉，但对于俗语或是特别用法不甚了解。</li></ul><blockquote><p>I’ve posted my question in $LANGUAGE and English.<br>I’ll be glad to translate responses, if you only use one or the other.</p></blockquote><ul><li>我把我的问题用<strong>某语言</strong>和英文写出来。</li><li>如果你只用其中的一种语言回答，我会乐意将回复翻译成为你使用的语言。</li></ul><h3 id="使用易于读取且标准的文件格式发送问题"><a href="#使用易于读取且标准的文件格式发送问题" class="headerlink" title="使用易于读取且标准的文件格式发送问题"></a>使用易于读取且标准的文件格式发送问题</h3><p>如果你人为地将问题搞得难以阅读，它多半会被忽略，人们更愿读易懂的问题，所以：</p><ul><li>使用纯文字而不是 HTML (<a href="http://archive.birdhouse.org/etc/evilmail.html">关闭 HTML</a> 并不难）。</li><li>使用 MIME 附件通常是可以的，前提是真正有内容（譬如附带的源代码或 patch），而不仅仅是邮件程序生成的模板（譬如只是信件内容的拷贝）。</li><li>不要发送一段文字只是一行句子但自动换行后会变成多行的邮件（这使得回复部分内容非常困难）。设想你的读者是在 80 个字符宽的终端机上阅读邮件，最好设置你的换行分割点小于 80 字。</li><li>但是，对一些特殊的文件<strong>不要</strong>设置固定宽度（譬如日志文件拷贝或会话记录）。数据应该原样包含，让回复者有信心他们看到的是和你看到的一样的东西。</li><li>在英语论坛中，不要使用<code>Quoted-Printable</code> MIME 编码发送消息。这种编码对于张贴非 ASCII 语言可能是必须的，但很多邮件程序并不支持这种编码。当它们处理换行时，那些文本中四处散布的<code>=20</code>符号既难看也分散注意力，甚至有可能破坏内容的语意。</li><li>绝对，<strong>永远</strong>不要指望黑客们阅读使用封闭格式编写的文档，像微软公司的 Word 或 Excel 文件等。大多数黑客对此的反应就像有人将还在冒热气的猪粪倒在你家门口时你的反应一样。即便他们能够处理，他们也很厌恶这么做。</li><li>如果你从使用 Windows 的电脑发送电子邮件，关闭微软愚蠢的<code>智能引号</code>功能 （从[选项] &gt; [校订] &gt; [自动校正选项]，勾选掉<code>智能引号</code>单选框），以免在你的邮件中到处散布垃圾字符。</li><li>在论坛，勿滥用<code>表情符号</code>和<code>HTML</code>功能（当它们提供时）。一两个表情符号通常没有问题，但花哨的彩色文本倾向于使人认为你是个无能之辈。过滥地使用表情符号、色彩和字体会使你看来像个傻笑的小姑娘。这通常不是个好主意，除非你只是对性而不是对答案感兴趣。</li></ul><p>如果你使用图形用户界面的邮件程序（如微软公司的 Outlook 或者其它类似的），注意它们的默认设置不一定满足这些要求。大多数这类程序有基于选单的<code>查看源代码</code>命令，用它来检查发送文件夹中的邮件，以确保发送的是纯文本文件同时没有一些奇怪的字符。</p><h3 id="精确地描述问题并言之有物"><a href="#精确地描述问题并言之有物" class="headerlink" title="精确地描述问题并言之有物"></a>精确地描述问题并言之有物</h3><ul><li>仔细、清楚地描述你的问题或 Bug 的症状。</li><li>描述问题发生的环境（机器配置、操作系统、应用程序、以及相关的信息），提供经销商的发行版和版本号（如：<code>Fedora Core 4</code>、<code>Slackware 9.1</code>等）。</li><li>描述在提问前你是怎样去研究和理解这个问题的。</li><li>描述在提问前为确定问题而采取的诊断步骤。</li><li>描述最近做过什么可能相关的硬件或软件变更。</li><li>尽可能地提供一个可以<code>重现这个问题的可控环境</code>的方法。</li></ul><p>尽量去揣测一个黑客会怎样反问你，在你提问之前预先将黑客们可能提出的问题回答一遍。</p><p>以上几点中，当你报告的是你认为可能在代码中的问题时，给黑客一个可以重现你的问题的环境尤其重要。当你这么做时，你得到有效的回答的机会和速度都会大大的提升。</p><p><a href="http://www.chiark.greenend.org.uk/~sgtatham/">Simon Tatham</a> 写过一篇名为《<a href="http://www.chiark.greenend.org.uk/~sgtatham/bugs-cn.html">如何有效的报告 Bug</a>》的出色文章。强力推荐你也读一读。</p><h3 id="话不在多而在精"><a href="#话不在多而在精" class="headerlink" title="话不在多而在精"></a>话不在多而在精</h3><p>你需要提供精确有内容的信息。这并不是要求你简单的把成堆的出错代码或者资料完全转录到你的提问中。如果你有庞大而复杂的测试样例能重现程序挂掉的情境，尽量将它剪裁得越小越好。</p><p>这样做的用处至少有三点。<br>第一，表现出你为简化问题付出了努力，这可以使你得到回答的机会增加；<br>第二，简化问题使你更有可能得到<strong>有用</strong>的答案；<br>第三，在精炼你的 bug 报告的过程中，你很可能就自己找到了解决方法或权宜之计。</p><h3 id="别动辄声称找到-Bug"><a href="#别动辄声称找到-Bug" class="headerlink" title="别动辄声称找到 Bug"></a>别动辄声称找到 Bug</h3><p>当你在使用软件中遇到问题，除非你非常、<strong>非常</strong>的有根据，不要动辄声称找到了 Bug。提示：除非你能提供解决问题的源代码补丁，或者提供回归测试来表明前一版本中行为不正确，否则你都多半不够完全确信。这同样适用在网页和文件，如果你（声称）发现了文件的<code>Bug</code>，你应该能提供相应位置的修正或替代文件。</p><p>请记得，还有其他许多用户没遇到你发现的问题，否则你在阅读文件或搜索网页时就应该发现了（你在抱怨前<a href="#%E5%9C%A8%E6%8F%90%E9%97%AE%E4%B9%8B%E5%89%8D">已经做了这些，是吧</a>？）。这也意味着很有可能是你弄错了而不是软件本身有问题。</p><p>编写软件的人总是非常辛苦地使它尽可能完美。如果你声称找到了 Bug，也就是在质疑他们的能力，即使你是对的，也有可能会冒犯到其中某部分人。当你在标题中嚷嚷着有<code>Bug</code>时，这尤其严重。</p><p>提问时，即使你私下非常确信已经发现一个真正的 Bug，最好写得像是<strong>你</strong>做错了什么。如果真的有 Bug，你会在回复中看到这点。这样做的话，如果真有 Bug，维护者就会向你道歉，这总比你惹恼别人然后欠别人一个道歉要好一点。</p><h3 id="低声下气不能代替你的功课"><a href="#低声下气不能代替你的功课" class="headerlink" title="低声下气不能代替你的功课"></a>低声下气不能代替你的功课</h3><p>有些人明白他们不该粗鲁或傲慢的提问并要求得到答复，但他们选择另一个极端 —— 低声下气：<code>我知道我只是个可悲的新手，一个撸瑟，但...</code>。这既使人困扰，也没有用，尤其是伴随着与实际问题含糊不清的描述时更令人反感。</p><p>别用原始灵长类动物的把戏来浪费你我的时间。取而代之的是，尽可能清楚地描述背景条件和你的问题情况。这比低声下气更好地定位了你的位置。</p><p>有时网页论坛会设有专为新手提问的版面，如果你真的认为遇到了初学者的问题，到那去就是了，但一样别那么低声下气。</p><h3 id="描述问题症状而非你的猜测"><a href="#描述问题症状而非你的猜测" class="headerlink" title="描述问题症状而非你的猜测"></a>描述问题症状而非你的猜测</h3><p>告诉黑客们你认为问题是怎样造成的并没什么帮助。（如果你的推断如此有效，还用向别人求助吗？），因此要确信你原原本本告诉了他们问题的症状，而不是你的解释和理论；让黑客们来推测和诊断。如果你认为陈述自己的猜测很重要，清楚地说明这只是你的猜测，并描述为什么它们不起作用。</p><p><strong>蠢问题</strong></p><blockquote><p>我在编译内核时接连遇到 SIG11 错误，<br>我怀疑某条飞线搭在主板的走线上了，这种情况应该怎样检查最好？</p></blockquote><p><strong>聪明问题</strong></p><blockquote><p>我的组装电脑是 FIC-PA2007 主机板搭载 AMD K6&#x2F;233 CPU（威盛 Apollo VP2 芯片组），<br>256MB Corsair PC133 SDRAM 内存，在编译内核时，从开机 20 分钟以后就频频产生 SIG11 错误，<br>但是在头 20 分钟内从没发生过相同的问题。重新启动也没有用，但是关机一晚上就又能工作 20 分钟。<br>所有内存都换过了，没有效果。相关部分的标准编译记录如下…</p></blockquote><p>由于以上这点似乎让许多人觉得难以配合，这里有句话可以提醒你：<code>所有的诊断专家都来自密苏里州。</code> 美国国务院的官方座右铭则是：<code>让我看看</code>（出自国会议员 Willard D. Vandiver 在 1899 年时的讲话：<code>我来自一个出产玉米，棉花，牛蒡和民主党人的国家，滔滔雄辩既不能说服我，也不会让我满意。我来自密苏里州，你必须让我看看。</code>） 针对诊断者而言，这并不是一种怀疑，而只是一种真实而有用的需求，以便让他们看到的是与你看到的原始证据尽可能一致的东西，而不是你的猜测与归纳的结论。所以，大方的展示给我们看吧！</p><h3 id="按发生时间先后列出问题症状"><a href="#按发生时间先后列出问题症状" class="headerlink" title="按发生时间先后列出问题症状"></a>按发生时间先后列出问题症状</h3><p>问题发生前的一系列操作，往往就是对找出问题最有帮助的线索。因此，你的说明里应该包含你的操作步骤，以及机器和软件的反应，直到问题发生。在命令行处理的情况下，提供一段操作记录（例如运行脚本工具所生成的），并引用相关的若干行（如 20 行）记录会非常有帮助。</p><p>如果挂掉的程序有诊断选项（如 -v 的详述开关），试着选择这些能在记录中增加调试信息的选项。记住，<code>多</code>不等于<code>好</code>。试着选取适当的调试级别以便提供有用的信息而不是让读者淹没在垃圾中。</p><p>如果你的说明很长（如超过四个段落），在开头简述问题，接下来再按时间顺序详述会有所帮助。这样黑客们在读你的记录时就知道该注意哪些内容了。</p><h3 id="描述目标而不是过程"><a href="#描述目标而不是过程" class="headerlink" title="描述目标而不是过程"></a>描述目标而不是过程</h3><p>如果你想弄清楚如何做某事（而不是报告一个 Bug），在开头就描述你的目标，然后才陈述重现你所卡住的特定步骤。</p><p>经常寻求技术帮助的人在心中有个更高层次的目标，而他们在自以为能达到目标的特定道路上被卡住了，然后跑来问该怎么走，但没有意识到这条路本身就有问题。结果要费很大的劲才能搞定。</p><p><strong>蠢问题</strong></p><blockquote><p>我怎样才能从某绘图程序的颜色选择器中取得十六进制的 RGB 值？</p></blockquote><p><strong>聪明问题</strong></p><blockquote><p>我正试着用替换一幅图片的色码（color table）成自己选定的色码，我现在知道的唯一方法是编辑每个色码区块（table slot），<br>但却无法从某绘图程序的颜色选择器取得十六进制的 RGB 值。</p></blockquote><p>第二种提问法比较聪明，你可能得到像是<code>建议采用另一个更合适的工具</code>的回复。</p><h3 id="别要求使用私人电邮回复"><a href="#别要求使用私人电邮回复" class="headerlink" title="别要求使用私人电邮回复"></a>别要求使用私人电邮回复</h3><p>黑客们认为问题的解决过程应该公开、透明，此过程中如果更有经验的人注意到不完整或者不当之处，最初的回复才能够、也应该被纠正。同时，作为提供帮助者可以得到一些奖励，奖励就是他的能力和学识被其他同行看到。</p><p>当你要求私下回复时，这个过程和奖励都被中止。别这样做，让<strong>回复者</strong>来决定是否私下回答 —— 如果他真这么做了，通常是因为他认为问题编写太差或者太肤浅，以至于不可能使其他人产生兴趣。</p><p>这条规则存在一条有限的例外，如果你确信提问可能会引来大量雷同的回复时，那么这个神奇的提问句会是<code>向我发电邮，我将为论坛归纳这些回复</code>。试着将邮件列表或新闻群组从洪水般的雷同回复中解救出来是非常有礼貌的 —— 但你必须信守诺言。</p><h3 id="清楚明确的表达你的问题以及需求"><a href="#清楚明确的表达你的问题以及需求" class="headerlink" title="清楚明确的表达你的问题以及需求"></a>清楚明确的表达你的问题以及需求</h3><p>漫无边际的提问是近乎无休无止的时间黑洞。最有可能给你有用答案的人通常也正是最忙的人（他们忙是因为要亲自完成大部分工作）。这样的人对无节制的时间黑洞相当厌恶，所以他们也倾向于厌恶那些漫无边际的提问。</p><p>如果你明确表述需要回答者做什么（如提供指点、发送一段代码、检查你的补丁、或是其他等等），就最有可能得到有用的答案。因为这会定出一个时间和精力的上限，便于回答者能集中精力来帮你。这么做很棒。</p><p>要理解专家们所处的世界，请把专业技能想像为充裕的资源，而回复的时间则是稀缺的资源。你要求他们奉献的时间越少，你越有可能从真正专业而且很忙的专家那里得到解答。</p><p>所以，界定一下你的问题，使专家花在辨识你的问题和回答所需要付出的时间减到最少，这技巧对你有用答案相当有帮助 —— 但这技巧通常和简化问题有所区别。因此，问<code>我想更好地理解 X，可否指点一下哪有好一点说明？</code>通常比问<code>你能解释一下 X 吗？</code>更好。如果你的代码不能运作，通常请别人看看哪里有问题，比要求别人替你改正要明智得多。</p><h3 id="询问有关代码的问题时"><a href="#询问有关代码的问题时" class="headerlink" title="询问有关代码的问题时"></a>询问有关代码的问题时</h3><p>别要求他人帮你调试有问题的代码，不提示一下应该从何入手。张贴几百行的代码，然后说一声：<code>它不能工作</code>会让你完全被忽略。只贴几十行代码，然后说一句：<code>在第七行以后，我期待它显示 &lt;x&gt;，但实际出现的是 &lt;y&gt;</code>比较有可能让你得到回应。</p><p>最有效描述程序问题的方法是提供最精简的 Bug 展示测试用例（bug-demonstrating test case）。什么是最精简的测试用例？那是问题的缩影；一小个程序片段能<strong>刚好</strong>展示出程序的异常行为，而不包含其他令人分散注意力的内容。怎么制作最精简的测试用例？如果你知道哪一行或哪一段代码会造成异常的行为，复制下来并加入足够重现这个状况的代码（例如，足以让这段代码能被编译&#x2F;直译&#x2F;被应用程序处理）。如果你无法将问题缩减到一个特定区块，就复制一份代码并移除不影响产生问题行为的部分。总之，测试用例越小越好（查看<a href="#%E8%AF%9D%E4%B8%8D%E5%9C%A8%E5%A4%9A%E8%80%8C%E5%9C%A8%E7%B2%BE">话不在多而在精</a>一节）。</p><p>一般而言，要得到一段相当精简的测试用例并不太容易，但永远先尝试这样做的是种好习惯。这种方式可以帮助你了解如何自行解决这个问题 —— 而且即使你的尝试不成功，黑客们也会看到你在尝试取得答案的过程中付出了努力，这可以让他们更愿意与你合作。</p><p>如果你只是想让别人帮忙审查（Review）一下代码，在信的开头就要说出来，并且一定要提到你认为哪一部分特别需要关注以及为什么。</p><h3 id="别把自己家庭作业的问题贴上来"><a href="#别把自己家庭作业的问题贴上来" class="headerlink" title="别把自己家庭作业的问题贴上来"></a>别把自己家庭作业的问题贴上来</h3><p>黑客们很擅长分辨哪些问题是家庭作业式的问题；因为我们中的大多数都曾自己解决这类问题。同样，这些问题得由<strong>你</strong>来搞定，你会从中学到东西。你可以要求给点提示，但别要求得到完整的解决方案。</p><p>如果你怀疑自己碰到了一个家庭作业式的问题，但仍然无法解决，试试在用户群组，论坛或（最后一招）在项目的<strong>用户</strong>邮件列表或论坛中提问。尽管黑客们<strong>会</strong>看出来，但一些有经验的用户也许仍会给你一些提示。</p><h3 id="去掉无意义的提问句"><a href="#去掉无意义的提问句" class="headerlink" title="去掉无意义的提问句"></a>去掉无意义的提问句</h3><p>避免用无意义的话结束提问，例如<code>有人能帮我吗？</code>或者<code>这有答案吗？</code>。</p><p>首先：如果你对问题的描述不是很好，这样问更是画蛇添足。</p><p>其次：由于这样问是画蛇添足，黑客们会很厌烦你 —— 而且通常会用逻辑上正确，但毫无意义的回答来表示他们的蔑视， 例如：<code>没错，有人能帮你</code>或者<code>不，没答案</code>。</p><p>一般来说，避免用 <code>是或否</code>、<code>对或错</code>、<code>有或没有</code>类型的问句，除非你想得到<a href="https://strcat.de/questions-with-yes-or-no-answers.html">是或否类型的回答</a>。</p><h3 id="即使你很急也不要在标题写紧急"><a href="#即使你很急也不要在标题写紧急" class="headerlink" title="即使你很急也不要在标题写紧急"></a>即使你很急也不要在标题写<code>紧急</code></h3><p>这是你的问题，不是我们的。宣称<code>紧急</code>极有可能事与愿违：大多数黑客会直接删除无礼和自私地企图即时引起关注的问题。更严重的是，<code>紧急</code>这个字（或是其他企图引起关注的标题）通常会被垃圾信过滤器过滤掉 —— 你希望能看到你问题的人可能永远也看不到。</p><p>有半个例外的情况是，如果你是在一些很高调，会使黑客们兴奋的地方，也许值得这样去做。在这种情况下，如果你有时间压力，也很有礼貌地提到这点，人们也许会有兴趣回答快一点。</p><p>当然，这风险很大，因为黑客们兴奋的点多半与你的不同。譬如从 NASA 国际空间站（International Space Station）发这样的标题没有问题，但用自我感觉良好的慈善行为或政治原因发肯定不行。事实上，张贴诸如<code>紧急：帮我救救这个毛茸茸的小海豹！</code>肯定让你被黑客忽略或惹恼他们，即使他们认为毛茸茸的小海豹很重要。</p><p>如果你觉得这点很不可思议，最好再把这份指南剩下的内容多读几遍，直到你弄懂了再发文。</p><h3 id="礼多人不怪，而且有时还很有帮助"><a href="#礼多人不怪，而且有时还很有帮助" class="headerlink" title="礼多人不怪，而且有时还很有帮助"></a>礼多人不怪，而且有时还很有帮助</h3><p>彬彬有礼，多用<code>请</code>和<code>谢谢您的关注</code>，或<code>谢谢你的关照</code>。让大家都知道你对他们花时间免费提供帮助心存感激。</p><p>坦白说，这一点并没有比使用清晰、正确、精准且合乎语法和避免使用专用格式重要（也不能取而代之）。黑客们一般宁可读有点唐突但技术上鲜明的 Bug 报告，而不是那种有礼但含糊的报告。（如果这点让你不解，记住我们是按问题能教给我们什么来评价问题的价值的）</p><p>然而，如果你有一串的问题待解决，客气一点肯定会增加你得到有用回应的机会。</p><p>（我们注意到，自从本指南发布后，从资深黑客那里得到的唯一严重缺陷反馈，就是对预先道谢这一条。一些黑客觉得<code>先谢了</code>意味着事后就不用再感谢任何人的暗示。我们的建议是要么先说<code>先谢了</code>，<strong>然后</strong>事后再对回复者表示感谢，或者换种方式表达感激，譬如用<code>谢谢你的关注</code>或<code>谢谢你的关照</code>。）</p><h3 id="问题解决后，加个简短的补充说明"><a href="#问题解决后，加个简短的补充说明" class="headerlink" title="问题解决后，加个简短的补充说明"></a>问题解决后，加个简短的补充说明</h3><p>问题解决后，向所有帮助过你的人发个说明，让他们知道问题是怎样解决的，并再一次向他们表示感谢。如果问题在新闻组或者邮件列表中引起了广泛关注，应该在那里贴一个说明比较恰当。</p><p>最理想的方式是向最初提问的话题回复此消息，并在标题中包含<code>已修正</code>，<code>已解决</code>或其它同等含义的明显标记。在人来人往的邮件列表里，一个看见讨论串<code>问题 X</code>和<code>问题 X - 已解决</code>的潜在回复者就明白不用再浪费时间了（除非他个人觉得<code>问题 X</code>的有趣），因此可以利用此时间去解决其它问题。</p><p>补充说明不必很长或是很深入；简单的一句<code>你好，原来是网线出了问题！谢谢大家 – Bill</code>比什么也不说要来的好。事实上，除非结论真的很有技术含量，否则简短可爱的小结比长篇大论更好。说明问题是怎样解决的，但大可不必将解决问题的过程复述一遍。</p><p>对于有深度的问题，张贴调试记录的摘要是有帮助的。描述问题的最终状态，说明是什么解决了问题，在此<strong>之后</strong>才指明可以避免的盲点。避免盲点的部分应放在正确的解决方案和其它总结材料之后，而不要将此信息搞成侦探推理小说。列出那些帮助过你的名字，会让你交到更多朋友。</p><p>除了有礼貌和有内涵以外，这种类型的补充也有助于他人在邮件列表&#x2F;新闻群组&#x2F;论坛中搜索到真正解决你问题的方案，让他们也从中受益。</p><p>至少，这种补充有助于让每位参与协助的人因问题的解决而从中得到满足感。如果你自己不是技术专家或者黑客，那就相信我们，这种感觉对于那些你向他们求助的大师或者专家而言，是非常重要的。问题悬而未决会让人灰心；黑客们渴望看到问题被解决。好人有好报，满足他们的渴望，你会在下次提问时尝到甜头。</p><p>思考一下怎样才能避免他人将来也遇到类似的问题，自问写一份文件或加个常见问题（FAQ）会不会有帮助。如果是的话就将它们发给维护者。</p><p>在黑客中，这种良好的后继行动实际上比传统的礼节更为重要，也是你如何透过善待他人而赢得声誉的方式，这是非常有价值的资产。</p><h2 id="如何解读答案"><a href="#如何解读答案" class="headerlink" title="如何解读答案"></a>如何解读答案</h2><p><a id="rtfm"></a></p><h3 id="RTFM-和-STFW：如何知道你已完全搞砸了"><a href="#RTFM-和-STFW：如何知道你已完全搞砸了" class="headerlink" title="RTFM 和 STFW：如何知道你已完全搞砸了"></a>RTFM 和 STFW：如何知道你已完全搞砸了</h3><p>有一个古老而神圣的传统：如果你收到<code>RTFM（Read The Fucking Manual）</code>的回应，回答者认为你<strong>应该去读他妈的手册</strong>。当然，基本上他是对的，你应该去读一读。</p><p>RTFM 有一个年轻的亲戚。如果你收到<code>STFW（Search The Fucking Web）</code>的回应，回答者认为你<strong>应该到他妈的网上搜索</strong>。那人多半也是对的，去搜索一下吧。（更温和一点的说法是 **<a href="http://lmgtfy.com/">Google 是你的朋友</a>**！）</p><p>在论坛，你也可能被要求去爬爬论坛的旧文。事实上，有人甚至可能热心地为你提供以前解决此问题的讨论串。但不要依赖这种关照，提问前应该先搜索一下旧文。</p><p>通常，用这两句之一回答你的人会给你一份包含你需要内容的手册或者一个网址，而且他们打这些字的时候也正在读着。这些答复意味着回答者认为</p><ul><li><strong>你需要的信息非常容易获得</strong>；</li><li><strong>你自己去搜索这些信息比灌给你，能让你学到更多</strong>。</li></ul><p>你不应该因此不爽；<strong>依照黑客的标准，他已经表示了对你一定程度的关注，而没有对你的要求视而不见</strong>。你应该对他祖母般的慈祥表示感谢。</p><h3 id="如果还是搞不懂"><a href="#如果还是搞不懂" class="headerlink" title="如果还是搞不懂"></a>如果还是搞不懂</h3><p>如果你看不懂回应，别立刻要求对方解释。像你以前试着自己解决问题时那样（利用手册，FAQ，网络，身边的高手），先试着去搞懂他的回应。如果你真的需要对方解释，记得表现出你已经从中学到了点什么。</p><p>比方说，如果我回答你：<code>看来似乎是 zentry 卡住了；你应该先清除它。</code>，然后，这是一个<strong>很糟的</strong>后续问题回应：<code>zentry 是什么？</code> <strong>好</strong>的问法应该是这样：<code>哦~~~我看过说明了但是只有 -z 和 -p 两个参数中提到了 zentries，而且还都没有清楚的解释如何清除它。你是指这两个中的哪一个吗？还是我看漏了什么？</code></p><h3 id="处理无礼的回应"><a href="#处理无礼的回应" class="headerlink" title="处理无礼的回应"></a>处理无礼的回应</h3><p>很多黑客圈子中看似无礼的行为并不是存心冒犯。相反，它是直截了当，一针见血式的交流风格，这种风格更注重解决问题，而不是使人感觉舒服而却模模糊糊。</p><p>如果你觉得被冒犯了，试着平静地反应。如果有人真的做了出格的事，邮件列表、新闻群组或论坛中的前辈多半会招呼他。如果这<strong>没有</strong>发生而你却发火了，那么你发火对象的言语可能在黑客社区中看起来是正常的，而<strong>你</strong>将被视为有错的一方，这将伤害到你获取信息或帮助的机会。</p><p>另一方面，你偶尔真的会碰到无礼和无聊的言行。与上述相反，对真正的冒犯者狠狠地打击，用犀利的语言将其驳得体无完肤都是可以接受的。然而，在行事之前一定要非常非常的有根据。纠正无礼的言论与开始一场毫无意义的口水战仅一线之隔，黑客们自己莽撞地越线的情况并不鲜见。如果你是新手或外人，避开这种莽撞的机会并不高。如果你想得到的是信息而不是消磨时光，这时最好不要把手放在键盘上以免冒险。</p><p>（有些人断言很多黑客都有轻度的自闭症或亚斯伯格综合症，缺少用于润滑人类社会<strong>正常</strong>交往所需的神经。这既可能是真也可能是假的。如果你自己不是黑客，兴许你认为我们脑袋有问题还能帮助你应付我们的古怪行为。只管这么干好了，我们不在乎。我们<strong>喜欢</strong>我们现在这个样子，并且通常对病患标记都有站得住脚的怀疑。）</p><p>Jeff Bigler 的观察总结和这个相关也值得一读 (<strong><a href="http://www.mit.edu/~jcb/tact.html">tact filters</a></strong>)。</p><p>在下一节，我们会谈到另一个问题，当<strong>你</strong>行为不当时所会受到的<code>冒犯</code>。</p><h2 id="如何避免扮演失败者"><a href="#如何避免扮演失败者" class="headerlink" title="如何避免扮演失败者"></a>如何避免扮演失败者</h2><p>在黑客社区的论坛中，你以本指南所描述的或类似的方式，可能会有那么几次搞砸了。而你会在公开场合中被告知你是如何搞砸的，也许攻击的言语中还会带点夹七夹八的颜色。</p><p>这种事发生以后，你能做的最糟糕的事莫过于哀嚎你的遭遇、宣称被言语攻击、要求道歉、高声尖叫、憋闷气、威胁诉诸法律、向其雇主报怨、不去关马桶盖等等。相反地，你该这么做：</p><p>熬过去，这很正常。事实上，它是有益健康且合理的。</p><p>社区的标准不会自行维持，它们是通过参与者积极而<strong>公开地</strong>执行来维持的。不要哭嚎所有的批评都应该通过私下的邮件传送，它不是这样运作的。当有人评论你的一个说法有误或者提出不同看法时，坚持声称受到个人攻击也毫无益处，这些都是失败者的态度。</p><p>也有其它的黑客论坛，受过高礼节要求的误导，禁止参与者张贴任何对别人帖子挑毛病的消息，并声称<code>如果你不想帮助用户就闭嘴。</code> 结果造成有想法的参与者纷纷离开，这么做只会使它们沦为毫无意义的唠叨与无用的技术论坛。</p><p>夸张的讲法是：你要的是“友善”（以上述方式）还是有用？两个里面挑一个。</p><p>记着：当黑客说你搞砸了，并且（无论多么刺耳）告诉你别再这样做时，他正在为关心<strong>你</strong>和<strong>他的社区</strong>而行动。对他而言，不理你并将你从他的生活中滤掉更简单。如果你无法做到感谢，至少要表现得有点尊严，别大声哀嚎，也别因为自己是个有戏剧性超级敏感的灵魂和自以为有资格的新来者，就指望别人像对待脆弱的洋娃娃那样对你。</p><p>有时候，即使你没有搞砸（或者只是在他的想像中你搞砸了），有些人也会无缘无故地攻击你本人。在这种情况下，抱怨倒是<strong>真的</strong>会把问题搞砸。</p><p>这些来找麻烦的人要么是毫无办法但自以为是专家的不中用家伙，要么就是测试你是否真会搞砸的心理专家。其它读者要么不理睬，要么用自己的方式对付他们。这些来找麻烦的人在给他们自己找麻烦，这点你不用操心。</p><p>也别让自己卷入口水战，最好不要理睬大多数的口水战 —— 当然，这是在你检验它们只是口水战，并且未指出你有搞砸的地方，同时也没有巧妙地将问题真正的答案藏于其后（这也是有可能的）。</p><h2 id="不该问的问题"><a href="#不该问的问题" class="headerlink" title="不该问的问题"></a>不该问的问题</h2><p>以下是几个经典蠢问题，以及黑客没回答时心中所想的：</p><p>问题：<a href="#q1">我能在哪找到 X 程序或 X 资源？</a></p><p>问题：<a href="#q2">我怎样用 X 做 Y？</a></p><p>问题：<a href="#q3">如何设定我的 shell 提示？</a></p><p>问题：<a href="#q4">我可以用 Bass-o-matic 文件转换工具将 AcmeCorp 文件转换为 TeX 格式吗？</a></p><p>问题：<a href="#q5">我的程序&#x2F;设定&#x2F;SQL 语句没有用</a></p><p>问题：<a href="#q6">我的 Windows 电脑有问题，你能帮我吗？</a></p><p>问题：<a href="#q7">我的程序不会动了，我认为系统工具 X 有问题</a></p><p>问题：<a href="#q8">我在安装 Linux（或者 X ）时有问题，你能帮我吗？</a></p><p>问题：<a href="#q9">我怎么才能破解 root 帐号&#x2F;窃取 OP 特权&#x2F;读别人的邮件呢？</a></p><hr><p><a id="q1"></a></p><blockquote><p>问题：我能在哪找到 X 程序或 X 资源？</p></blockquote><p>回答：就在我找到它的地方啊，白痴 —— 搜索引擎的那一头。天哪！难道还有人不会用 <a href="https://www.google.com/">Google</a> 吗？</p><p><a id="q2"></a></p><blockquote><p>问题：我怎样用 X 做 Y？</p></blockquote><p>回答：如果你想解决的是 Y ，提问时别给出可能并不恰当的方法。这种问题说明提问者不但对 X 完全无知，也对 Y 要解决的问题糊涂，还被特定形势禁锢了思维。最好忽略这种人，等他们把问题搞清楚了再说。</p><p><a id="q3"></a></p><blockquote><p>问题：如何设定我的 shell 提示？？</p></blockquote><p>回答：如果你有足够的智慧提这个问题，你也该有足够的智慧去 <a href="#RTFM">RTFM</a>，然后自己去找出来。</p><p><a id="q4"></a></p><blockquote><p>问题：我可以用 Bass-o-matic 文件转换工具将 AcmeCorp 文件转换为 TeX 格式吗？</p></blockquote><p>回答：试试看就知道了。如果你试过，你就知道了答案，就不用浪费我的时间了。</p><p><a id="q5"></a></p><blockquote><p>问题：我的{程序&#x2F;设定&#x2F;SQL 语句}没有用</p></blockquote><p>回答：这不算是问题吧，我对要我问你二十个问题才找得出你真正问题的问题没兴趣 —— 我有更有意思的事要做呢。在看到这类问题的时候，我的反应通常不外如下三种</p><ul><li>你还有什么要补充的吗？</li><li>真糟糕，希望你能搞定。</li><li>这关我屁事？</li></ul><p><a id="q6"></a></p><blockquote><p>问题：我的 Windows 电脑有问题，你能帮我吗？</p></blockquote><p>回答：能啊，扔掉微软的垃圾，换个像 Linux 或 BSD 的开源操作系统吧。</p><p>注意：如果程序有官方版 Windows 或者与 Windows 有互动（如 Samba），你<strong>可以</strong>问与 Windows 相关的问题，只是别对问题是由 Windows 操作系统而不是程序本身造成的回复感到惊讶， 因为 Windows 一般来说实在太烂，这种说法通常都是对的。</p><p><a id="q7"></a></p><blockquote><p>问题：我的程序不会动了，我认为系统工具 X 有问题</p></blockquote><p>回答：你完全有可能是第一个注意到被成千上万用户反复使用的系统调用与函数库文件有明显缺陷的人，更有可能的是你完全没有根据。不同凡响的说法需要不同凡响的证据，当你这样声称时，你必须有清楚而详尽的缺陷说明文件作后盾。</p><p><a id="q8"></a></p><blockquote><p>问题：我在安装 Linux（或者 X ）时有问题，你能帮我吗？</p></blockquote><p>回答：不能，我只有亲自在你的电脑上动手才能找到毛病。还是去找你当地的 Linux 使用群组者寻求实际的指导吧（你能在<a href="http://www.linux.org/groups/index.html">这儿</a>找到用户群组的清单）。</p><p>注意：如果安装问题与某 Linux 的发行版有关，在它的邮件列表、论坛或本地用户群组中提问也许是恰当的。此时，应描述问题的准确细节。在此之前，先用 <code>Linux</code> 和<strong>所有</strong>被怀疑的硬件作关键词仔细搜索。</p><p><a id="q9"></a></p><blockquote><p>问题：我怎么才能破解 root 帐号&#x2F;窃取 OP 特权&#x2F;读别人的邮件呢？</p></blockquote><p>回答：想要这样做，说明了你是个卑鄙小人；想找个黑客帮你，说明你是个白痴！</p><h2 id="好问题与蠢问题"><a href="#好问题与蠢问题" class="headerlink" title="好问题与蠢问题"></a>好问题与蠢问题</h2><p>最后，我将透过举一些例子，来说明怎样聪明的提问；同一个问题的两种问法被放在一起，一种是愚蠢的，另一种才是明智的。</p><p><strong>蠢问题</strong>：</p><blockquote><p>我可以在哪儿找到关于 Foonly Flurbamatic 的资料？</p></blockquote><p>这种问法无非想得到 <a href="#RTFM">STFW</a> 这样的回答。</p><p><strong>聪明问题</strong>：</p><blockquote><p>我用 Google 搜索过 “Foonly Flurbamatic 2600”，但是没找到有用的结果。谁知道上哪儿去找对这种设备编程的资料？</p></blockquote><p>这个问题已经 STFW 过了，看起来他真的遇到了麻烦。</p><p><strong>蠢问题</strong>：</p><blockquote><p>我从 foo 项目找来的源码没法编译。它怎么这么烂？</p></blockquote><p>他觉得都是别人的错，这个傲慢自大的提问者。</p><p><strong>聪明问题</strong>：</p><blockquote><p>foo 项目代码在 Nulix 6.2 版下无法编译通过。我读过了 FAQ，但里面没有提到跟 Nulix 有关的问题。这是我编译过程的记录，我有什么做的不对的地方吗？</p></blockquote><p>提问者已经指明了环境，也读过了 FAQ，还列出了错误，并且他没有把问题的责任推到别人头上，他的问题值得被关注。</p><p><strong>蠢问题</strong>：</p><blockquote><p>我的主机板有问题了，谁来帮我？</p></blockquote><p>某黑客对这类问题的回答通常是：<code>好的，还要帮你拍拍背和换尿布吗？</code>，然后按下删除键。</p><p><strong>聪明问题</strong>：</p><blockquote><p>我在 S2464 主机板上试过了 X 、 Y 和 Z ，但没什么作用，我又试了 A 、 B 和 C 。请注意当我尝试 C 时的奇怪现象。显然 florbish 正在 grommicking，但结果出人意料。通常在 Athlon MP 主机板上引起 grommicking 的原因是什么？有谁知道接下来我该做些什么测试才能找出问题？</p></blockquote><p>这个家伙，从另一个角度来看，值得去回答他。他表现出了解决问题的能力，而不是坐等天上掉答案。</p><p>在最后一个问题中，注意<code>告诉我答案</code>和<code>给我启示，指出我还应该做什么诊断工作</code>之间微妙而又重要的区别。</p><p>事实上，后一个问题源自于 2001 年 8 月在 Linux 内核邮件列表（lkml）上的一个真实的提问。我（Eric）就是那个提出问题的人。我在 Tyan S2464 主板上观察到了这种无法解释的锁定现象，列表成员们提供了解决这一问题的重要信息。</p><p>通过我的提问方法，我给了别人可以咀嚼玩味的东西；我设法让人们很容易参与并且被吸引进来。我显示了自己具备和他们同等的能力，并邀请他们与我共同探讨。通过告诉他们我所走过的弯路，以避免他们再浪费时间，我也表明了对他们宝贵时间的尊重。</p><p>事后，当我向每个人表示感谢，并且赞赏这次良好的讨论经历的时候，一个 Linux 内核邮件列表的成员表示，他觉得我的问题得到解决并非由于我是这个列表中的<strong>名</strong>人，而是因为我用了正确的方式来提问。</p><p>黑客从某种角度来说是拥有丰富知识但缺乏人情味的家伙；我相信他是对的，如果我<strong>像</strong>个乞讨者那样提问，不论我是谁，一定会惹恼某些人或者被他们忽视。他建议我记下这件事，这直接导致了本指南的出现。</p><h2 id="如果得不到回答"><a href="#如果得不到回答" class="headerlink" title="如果得不到回答"></a>如果得不到回答</h2><p>如果仍得不到回答，请不要以为我们觉得无法帮助你。有时只是看到你问题的人不知道答案罢了。没有回应不代表你被忽视，虽然不可否认这种差别很难区分。</p><p>总的来说，简单的重复张贴问题是个很糟的点子。这将被视为无意义的喧闹。有点耐心，知道你问题答案的人可能生活在不同的时区，可能正在睡觉，也有可能你的问题一开始就没有组织好。</p><p>你可以通过其他渠道获得帮助，这些渠道通常更适合初学者的需要。</p><p>有许多网上的以及本地的用户群组，由热情的软件爱好者（即使他们可能从没亲自写过任何软件）组成。通常人们组建这样的团体来互相帮助并帮助新手。</p><p>另外，你可以向很多商业公司寻求帮助，不论公司大还是小。别为要付费才能获得帮助而感到沮丧！毕竟，假使你的汽车发动机汽缸密封圈爆掉了 —— 完全可能如此 —— 你还得把它送到修车铺，并且为维修付费。就算软件没花费你一分钱，你也不能强求技术支持总是免费的。</p><p>对像是 Linux 这种大众化的软件，每个开发者至少会对应到上万名用户。根本不可能由一个人来处理来自上万名用户的求助电话。要知道，即使你要为这些协助付费，和你所购买的同类软件相比，你所付出的也是微不足道的（通常封闭源代码软件的技术支持费用比开源软件的要高得多，且内容也没那么丰富）。</p><h2 id="如何更好地回答问题"><a href="#如何更好地回答问题" class="headerlink" title="如何更好地回答问题"></a>如何更好地回答问题</h2><p><strong>态度和善一点。</strong> 问题带来的压力常使人显得无礼或愚蠢，其实并不是这样。</p><p><strong>对初犯者私下回复。</strong> 对那些坦诚犯错之人没有必要当众羞辱，一个真正的新手也许连怎么搜索或在哪找常见问题都不知道。</p><p><strong>如果你不确定，一定要说出来！</strong> 一个听起来权威的错误回复比没有还要糟，别因为听起来像个专家很好玩，就给别人乱指路。要谦虚和诚实，给提问者与同行都树个好榜样。</p><p><strong>如果帮不了忙，也别妨碍他。</strong> 不要在实际步骤上开玩笑，那样也许会毁了提问者的设置 —— 有些可怜的呆瓜会把它当成真的指令。</p><p><strong>试探性的反问以引出更多的细节。</strong> 如果你做得好，提问者可以学到点东西 —— 你也可以。试试将蠢问题转变成好问题，别忘了我们都曾是新手。</p><p>尽管对那些懒虫抱怨一声 RTFM 是正当的，但能给出文档的链接（即使只是建议个 Google 搜索关键词）会更好。</p><p><strong>如果你决定回答，就请给出好的答案。</strong> 当别人正在用错误的工具或方法时别建议笨拙的权宜之计（workaround），应推荐更好的工具，重新界定问题。</p><p><strong>正面地回答问题！</strong> 如果这个提问者已经很深入的研究而且也表明已经试过 X 、 Y 、 Z 、 A 、 B 、 C 但没得到结果，回答 <code>试试看 A 或是 B</code> 或者 <code>试试 X 、 Y 、 Z 、 A 、 B 、 C</code> 并附上一个链接一点用都没有。</p><p><strong>帮助你的社区从问题中学习。</strong> 当回复一个好问题时，问问自己<code>如何修改相关文件或常见问题文件以免再次解答同样的问题？</code>，接着再向文件维护者发一份补丁。</p><p>如果你在研究一番后才作出了回答，<strong>展现你的技巧而不是直接端出结果</strong>。毕竟<code>授人以鱼不如授人以渔</code>。</p><h2 id="相关资源"><a href="#相关资源" class="headerlink" title="相关资源"></a>相关资源</h2><p>如果你需要个人电脑、Unix 系统和网络如何运作的基础知识，参阅 <a href="http://en.tldp.org/HOWTO/Unix-and-Internet-Fundamentals-HOWTO/">Unix 系统和网络基本原理</a>。</p><p>当你发布软件或补丁时，试着按<a href="http://en.tldp.org/HOWTO/Software-Release-Practice-HOWTO/index.html">软件发布实践</a>操作。</p><h2 id="鸣谢"><a href="#鸣谢" class="headerlink" title="鸣谢"></a>鸣谢</h2><p>Evelyn Mitchel 贡献了一些愚蠢问题例子并启发了编写<code>如何更好地回答问题</code>这一节， Mikhail Ramendik 贡献了一些特别有价值的建议和改进。</p>]]></content>
      
      
      <categories>
          
          <category> 优秀文章 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 优秀文章 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>搭建一个SprintBoot简单入门项目</title>
      <link href="/posts/8dfa/"/>
      <url>/posts/8dfa/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>SpringBoot是一个开箱即用，提供各种默认配置来简化项目配置，让开发者能够更加专注于业务逻辑的Java开源框架，其目的在于简化Spring应用的搭建和开发过程。下面快速学习SpringBoot的入门示例</p><p>学习前提：</p><ul><li>已经安装了IDEA、Postman以及jdk等相关环境</li><li>具备一定的Java基础</li></ul><h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><p>文件-&gt;New Project，选择Spring lnitializr</p><p>如果下载很慢，可以切换国内源：<code>https://start.aliyun.com/</code>，如图</p><p><img src="/./img/8dfa/58719892014.png" alt="创建项目"></p><span id="more"></span><p>选择SpringWeb，创建完成</p><p><img src="/./img/8dfa/47192789127535.png" alt="选择SpringWeb"></p><h2 id="创建Controller"><a href="#创建Controller" class="headerlink" title="创建Controller"></a>创建Controller</h2><p>在com.example.demo包下创建HelloController</p><p>其中@RestController注解表示返回字符串，一般用于接口</p><p>而@Controller注解表示返回html页面，一般用于Html、Jquery</p><p>@RequestMapping注解则表示路由，用来映射URL； 注解的value、method、params及headers分别指定<code>请求的URL、请求方法、请求参数及请求头</code></p><p><img src="/./img/8dfa/407910523523.png" alt="创建Contronller"></p><h2 id="添加符合RESTful风格的接口"><a href="#添加符合RESTful风格的接口" class="headerlink" title="添加符合RESTful风格的接口"></a>添加符合RESTful风格的接口</h2><p>下面我们添加几个符合<a href="https://restfulapi.cn/">RESTful</a>风格的接口</p><p>其中@PostMapping对应增</p><p>其中@DeleteMapping对应删</p><p>其中@PutMapping对应改</p><p>其中@GetMapping对应查</p><p><img src="/./img/8dfa/249878912412212.png" alt="具有RESTful风格的接口"></p><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>用postman测试这4个方法</p><p><img src="/./img/8dfa/2145901312412.png" alt="测试PostMapping"></p><p><img src="/./img/8dfa/2189328694964.png" alt="测试DeleteMapping"></p><p><img src="/./img/8dfa/096348914213.png" alt="测试PutMapping"></p><p><img src="/./img/8dfa/747821421424.png" alt="测试GetMapping"></p><h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><p>打包jar后上传到服务器，终端输入命令java -jar jar名称</p><p>将jar包放入服务器运行：</p><p><img src="/./img/8dfa/5712892141242.png" alt="服务器跑jar包"></p><p>在postman上将localhost替换为服务器ip地址即可（需要<a href="https://developer.aliyun.com/article/767328">服务器开放端口</a>）</p><p>后台常驻运行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar xxx.jar &gt; run.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><p>恭喜你，你已经获得了入门java开发能力！</p>]]></content>
      
      
      <categories>
          
          <category> 敲敲代码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> SprintBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux服务器开发环境配置</title>
      <link href="/posts/9651/"/>
      <url>/posts/9651/</url>
      
        <content type="html"><![CDATA[<p>分享Linux服务器一些环境安装脚本</p><p>直接运行<code>sh xxx.sh</code>即可</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">java1.8</button></li><li class="tab"><button type="button" data-href="#tab-1-2">maven</button></li><li class="tab"><button type="button" data-href="#tab-1-3">mysql5.7</button></li><li class="tab"><button type="button" data-href="#tab-1-4">mysql8.0</button></li><li class="tab"><button type="button" data-href="#tab-1-5">nginx1.21.3</button></li><li class="tab"><button type="button" data-href="#tab-1-6">node16.14.0</button></li><li class="tab"><button type="button" data-href="#tab-1-7">redis5.0.8</button></li><li class="tab"><button type="button" data-href="#tab-1-8">gotop</button></li><li class="tab"><button type="button" data-href="#tab-1-9">postgresql12</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><a href="/code/shell/install-java-1.8.sh">install-java-1.8.sh</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><a href="/code/shell/install-maven.sh">install-maven.sh</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><a href="/code/shell/install-mysql-5.7.sh">install-mysql-5.7.sh</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p><a href="/code/shell/install-mysql-8.0.sh">install-mysql-8.0.sh</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p><a href="/code/shell/install-nginx-1.21.3.sh">install-nginx-1.21.3.sh</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-6"><p><a href="/code/shell/install-node-16.14.0.sh">install-node-16.14.0.sh</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-7"><p><a href="/code/shell/install-redis-5.0.8.sh">install-redis-5.0.8.sh</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-8"><p><a href="/code/shell/install-gotop.sh">install-gotop.sh</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-9"><p><a href="/code/shell/install-postgresql-12.sh">install-postgresql-12.sh</a></p><div class="note warning flat"><p>不可直接运行，需分步运行（还没整理）</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux服务器免密码登录添加SSH公钥</title>
      <link href="/posts/9e+29/"/>
      <url>/posts/9e+29/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>当拥有一台服务器时，最先保证的是安全，而保证安全的方式有很多，譬如避免开放过多的端口，尽量避免使用默认端口，登录口令尽量复杂，其中登录口令是进入服务器的第一道防线，但有时候复杂的口令即阻挡了外来人也阻挡正常登录（密码太复杂了），所以有没有一种既简单又能有效防止被破解的方法呢？当然有，免密登录就是最简单有效的方法</p><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>1、在windows系统的cmd命令行上执行生成密钥对命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br></pre></td></tr></table></figure><div class="note success no-icon flat"><p>其实我们应该指定生成密钥的文件名、备注来区分不同的密钥，避免使用同一份密钥，防止丢失密钥时需要在各代码托管平台逐一上传</p><p>感谢博主<a href="https://zhangshier.vip/">张时贰</a>的指点</p></div><p>例子：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh<span class="literal">-keygen</span> <span class="literal">-t</span> rsa <span class="literal">-C</span> <span class="string">&quot;Ubuntu&quot;</span> <span class="operator">-f</span> <span class="string">&quot;tecent_VPS&quot;</span>     <span class="comment"># 给服务器的Ubuntu用户</span></span><br><span class="line">ssh<span class="literal">-keygen</span> <span class="literal">-t</span> rsa <span class="literal">-C</span> <span class="string">&quot;GC-ZF&quot;</span> <span class="operator">-f</span> <span class="string">&quot;id_rsa_github&quot;</span>   <span class="comment"># 给Github下GC-ZF的账号</span></span><br></pre></td></tr></table></figure><p>参数解释</p><table><thead><tr><th align="center">参数</th><th align="center"><strong>解释</strong></th></tr></thead><tbody><tr><td align="center">-t rsa</td><td align="center">采用rsa加密方式</td></tr><tr><td align="center">-f</td><td align="center">生成文件名</td></tr><tr><td align="center">-C</td><td align="center">备注</td></tr></tbody></table><p>2、将生成的id_rsa.pub公钥内容复制到远程服务器上的&#x2F;.ssh&#x2F;authorized_keys(不存在则手动创建)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">touch /root/.ssh/authorized_keys #文件不存在时手动创建</span><br><span class="line">vim /root/.ssh/authorized_keys #编辑authorized_keys文件</span><br></pre></td></tr></table></figure><p>3、导入密钥，打开xshell-&gt;工具-&gt;用户密钥管理者-&gt;导入选项，导入刚刚生成的id_rsa密钥文件</p><p>4、登录服务器，选择密钥登录并选择刚刚导入成功的密钥文件，即可完成无密码登录。</p><p>5、（可选）取消密码登录，加强服务器安全性。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config #编辑ssh配置文件</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将PasswordAuthentication处的值改为no</span></span><br><span class="line">service sshd restart #重启ssh服务</span><br></pre></td></tr></table></figure><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>免密登录服务器利用非对称加密原理，简单来说使用两个密钥（公钥和私钥），公钥加密传输数据，私钥解密接收数据；公钥是公开的，私钥是保密的。</p><p>免密登录原理如下（ 图片来自于网络）</p><p><img src="/./img/9e29/20160319193556260.png" alt="免密登录原理"></p><p>图解，server A免登录到server B:<br>1、在A上生成公钥私钥。<br>2、将公钥拷贝给server B，要重命名成authorized_keys(从英文名就知道含义了)<br>3、Server A向Server B发送一个连接请求。<br>4、Server B得到Server A的信息后，在authorized_key中查找，如果有相应的用户名和IP，则随机生成一个字符串，并用Server A的公钥加密，发送给Server A。<br>5、Server A得到Server B发来的消息后，使用私钥进行解密，然后将解密后的字符串发送给Server B。Server B进行和生成的对比，如果一致，则允许免登录。</p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://blog.csdn.net/qq_35793285/article/details/119568841"> 非对称加密工作原理</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 服务器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux脚本实现一键启动或停止应用程序</title>
      <link href="/posts/aa77/"/>
      <url>/posts/aa77/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>我们在Linux服务器运行jar包时常常会因为命令行太复杂而忘记如何运行和停止，我们可以使用脚本的形式来启动、停止、重新启动应用程序，节省时间减少出错概率</p><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>通常我们在linux运行一个jar包或者war包的命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar xxx.jar</span><br></pre></td></tr></table></figure><p>但是关掉连接工具后就会停止正在运行的应用，需要后台执行，可使用命令<code>nohup</code>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar xxx.jar &gt; out.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><p>但是这又会出现一个问题，我想重新部署的话必须关掉原来运行的，在linux中可执行以下命令寻找pid：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep java</span><br></pre></td></tr></table></figure><p>PS：使用以下命令可以去掉查询进程本身的信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep java | grep -v grep</span><br></pre></td></tr></table></figure><p>只保留pid信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep java | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27;</span><br></pre></td></tr></table></figure><p>杀死进程：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -9 xxx</span><br></pre></td></tr></table></figure><p>重新运行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar xxx.jar &gt; out.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><p>总结来说运行一个应用程序的一般步骤：</p><p><code>运行</code> -&gt; <code>停止</code> -&gt; <code>运行</code></p><p>以上步骤复杂且有人工误操作的风险，所以我们可以制作一个脚本来一键运行或停止它：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash  </span></span><br><span class="line"><span class="comment"># 使用方法：修改jar包名称，完整的jar路径，运行日志名称即可</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#jar包名称</span></span><br><span class="line">APP_NAME=fivechess-1.0.jar</span><br><span class="line"><span class="comment">#完整的jar路径</span></span><br><span class="line">APP_PATH=target/<span class="variable">$APP_NAME</span></span><br><span class="line"><span class="comment">#运行日志</span></span><br><span class="line">LOG_FILE=fivechess.log</span><br><span class="line"><span class="comment">#JVM运行参数</span></span><br><span class="line">JVM_OPTS=<span class="string">&quot;-Xms128m -Xmx512m -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=512m -Dfile.encoding=UTF-8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#使用说明，用来提示输入参数  </span></span><br><span class="line"><span class="function"><span class="title">usage</span></span>() &#123;  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Usage: sh 执行脚本.sh [start|stop|restart|status]&quot;</span>  </span><br><span class="line">    <span class="built_in">exit</span> 1  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">#检查程序是否在运行  </span></span><br><span class="line"><span class="function"><span class="title">is_exist</span></span>()&#123;  </span><br><span class="line">  pid=`ps -ef|grep <span class="variable">$APP_NAME</span>|grep -v grep|awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> `  </span><br><span class="line">  <span class="comment">#如果不存在返回1，存在返回0       </span></span><br><span class="line">  <span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$&#123;pid&#125;</span>&quot;</span> ]; <span class="keyword">then</span>  </span><br><span class="line">   <span class="built_in">return</span> 10  </span><br><span class="line">  <span class="keyword">else</span>  </span><br><span class="line">    <span class="built_in">return</span> 0  </span><br><span class="line">  <span class="keyword">fi</span>  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">#启动方法  </span></span><br><span class="line"><span class="function"><span class="title">start</span></span>()&#123;  </span><br><span class="line">  is_exist  </span><br><span class="line">  <span class="keyword">if</span> [ $? -eq <span class="string">&quot;0&quot;</span> ]; <span class="keyword">then</span>  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;APP_NAME&#125;</span> is already running. pid=<span class="variable">$&#123;pid&#125;</span> .&quot;</span>  </span><br><span class="line">  <span class="keyword">else</span>  </span><br><span class="line">    <span class="built_in">nohup</span> java <span class="variable">$JVM_OPTS</span> -jar <span class="variable">$APP_PATH</span> &gt; <span class="variable">$LOG_FILE</span> 2&gt;&amp;1 &amp;  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;APP_NAME&#125;</span> started&quot;</span></span><br><span class="line">  <span class="keyword">fi</span>  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">#停止方法  </span></span><br><span class="line"><span class="function"><span class="title">stop</span></span>()&#123;  </span><br><span class="line">  is_exist  </span><br><span class="line">  <span class="keyword">if</span> [ $? -eq <span class="string">&quot;0&quot;</span> ]; <span class="keyword">then</span>  </span><br><span class="line">    <span class="built_in">kill</span> -9 <span class="variable">$pid</span>  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;APP_NAME&#125;</span> stoped&quot;</span></span><br><span class="line">  <span class="keyword">else</span>  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;APP_NAME&#125;</span> is not running&quot;</span>  </span><br><span class="line">  <span class="keyword">fi</span>    </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">#输出运行状态  </span></span><br><span class="line"><span class="function"><span class="title">status</span></span>()&#123;  </span><br><span class="line">  is_exist  </span><br><span class="line">  <span class="keyword">if</span> [ $? -eq <span class="string">&quot;0&quot;</span> ]; <span class="keyword">then</span>  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;APP_NAME&#125;</span> is running. Pid is <span class="variable">$&#123;pid&#125;</span>&quot;</span>  </span><br><span class="line">  <span class="keyword">else</span>  </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;APP_NAME&#125;</span> is NOT running.&quot;</span>  </span><br><span class="line">  <span class="keyword">fi</span>  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">#重启  </span></span><br><span class="line"><span class="function"><span class="title">restart</span></span>()&#123;  </span><br><span class="line">  status</span><br><span class="line">  stop  </span><br><span class="line">  start</span><br><span class="line">  status</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">#根据输入参数，选择执行对应方法，不输入则执行使用说明  </span></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="keyword">in</span>  </span><br><span class="line">  <span class="string">&quot;start&quot;</span>)  </span><br><span class="line">    start  </span><br><span class="line">    ;;  </span><br><span class="line">  <span class="string">&quot;stop&quot;</span>)  </span><br><span class="line">    stop  </span><br><span class="line">    ;;  </span><br><span class="line">  <span class="string">&quot;status&quot;</span>)  </span><br><span class="line">    status  </span><br><span class="line">    ;;  </span><br><span class="line">  <span class="string">&quot;restart&quot;</span>)  </span><br><span class="line">    restart  </span><br><span class="line">    ;;  </span><br><span class="line">  *)  </span><br><span class="line">    usage  </span><br><span class="line">    ;;  </span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure><p>新建一个<code>start.sh</code>，复制代码进去，塞到项目根目录中，修改相应变量即可使用</p><p>启动命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start.sh start</span><br></pre></td></tr></table></figure><p>重新启动命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start.sh restart</span><br></pre></td></tr></table></figure><p>关闭命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start.sh stop</span><br></pre></td></tr></table></figure><p>查看运行状态命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start.sh status</span><br></pre></td></tr></table></figure><p>tips：可以给日志命名为日期形式的：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nohup start.sh &gt;&gt; `date -d yesterday +%Y%m%d`.log 2&gt;&amp;1 &amp;</span><br><span class="line">nohup start.sh &gt;&gt; `date -d today +%Y%m%d`.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><p>shell输出日期格式：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-4-7-centos ~]# date -d yesterday +%Y-%m-%d</span><br><span class="line">2023-04-16</span><br><span class="line">[root@VM-4-7-centos ~]# date -d today +%Y-%m-%d</span><br><span class="line">2023-04-17</span><br><span class="line">[root@VM-4-7-centos ~]#</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用ffmpeg合并手机B站缓存的视频</title>
      <link href="/posts/8594/"/>
      <url>/posts/8594/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>有时候在B站发布的视频下架了，虽然已经缓存了，但是B站已经把视频处理过，无法在相册查看和上传电脑，本教程利用ffmpeg将B站的缓存的视频和音频合并成mp4文件</p><p>本教程使用python编程，但使用ffmpeg合并音视频</p><h2 id="安装ffmpeg"><a href="#安装ffmpeg" class="headerlink" title="安装ffmpeg"></a>安装ffmpeg</h2><p>进入官网下载：<a href="https://ffmpeg.org/download.html#build-windows">Download FFmpeg</a></p><p>选择windows，点击第一个</p><p><img src="/./img/8594/1663041193774.png" alt="ffmpeg下载页面"></p><p>选择ffmpeg-git-full.7z</p><p><img src="/./img/8594/1663041301725.png" alt="下载ffmpeg"></p><p>解压</p><p><img src="/./img/8594/1663041675831.png" alt="解压后的文件夹目录"></p><p>设置环境变量</p><p>在系统变量的Path下新增环境变量，路径为解压后的文件夹路径加上bin目录即可</p><p><img src="/./img/8594/1663041477963.png" alt="添加环境变量"></p><p><a href="https://blog.csdn.net/weixin_39887926/article/details/118871838">win10配置计算机环境变量</a></p><p>测试</p><p><img src="/./img/8594/1663041572998.png" alt="测试ffmpeg是否安装成功"></p><h2 id="寻找缓存视频的位置"><a href="#寻找缓存视频的位置" class="headerlink" title="寻找缓存视频的位置"></a>寻找缓存视频的位置</h2><p><a href="https://www.bilibili.com/video/BV1hY411E72z/">2022了，手机app版b站的缓存视频文件在哪里找</a></p><p>简单来说就是到离线缓存-&gt;设置(小齿轮)-&gt;离线诊断，选择一个缓存过的视频，找到视频id，到文件管理器搜索，</p><p>直接去文件管理器去找B站缓存视频的位置：<code>Android\data\tv.danmaku.bili\download</code></p><p>找到位置后复制视频到电脑</p><h2 id="编写代码"><a href="#编写代码" class="headerlink" title="编写代码"></a>编写代码</h2><p>新建<code>demo.py</code>，将以下代码复制到<code>demo.py</code>中，执行<code>python demo.py</code>运行</p><p>input_path就是上传的B站缓存视频文件夹</p><p>out_path就是输出视频文件夹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">input_path=<span class="string">&quot;./系统架构师&quot;</span></span><br><span class="line">out_path=<span class="string">&quot;./out&quot;</span></span><br><span class="line"></span><br><span class="line">filename=<span class="string">&quot;&quot;</span></span><br><span class="line">video_path=<span class="string">&quot;&quot;</span></span><br><span class="line">audio_path=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_json</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(path,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> load_f:</span><br><span class="line">        <span class="keyword">return</span> json.load(load_f)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> root,dirs,files <span class="keyword">in</span> os.walk(input_path):</span><br><span class="line">    <span class="keyword">if</span> root==input_path:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> files:</span><br><span class="line">        <span class="keyword">if</span> item == <span class="string">&quot;entry.json&quot;</span>:</span><br><span class="line">            json_data=read_json(root+<span class="string">&quot;/&quot;</span>+item)</span><br><span class="line">            filename=json_data[<span class="string">&#x27;page_data&#x27;</span>][<span class="string">&#x27;part&#x27;</span>].rsplit(<span class="string">&#x27;_&#x27;</span>,<span class="number">1</span>)[<span class="number">0</span>].replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;_&quot;</span>,<span class="number">10</span>)</span><br><span class="line">        <span class="keyword">if</span> item == <span class="string">&quot;video.m4s&quot;</span>:</span><br><span class="line">            video_path=root+<span class="string">&quot;/&quot;</span>+item</span><br><span class="line">        <span class="keyword">if</span> item == <span class="string">&quot;audio.m4s&quot;</span>:</span><br><span class="line">            audio_path=root+<span class="string">&quot;/&quot;</span>+item</span><br><span class="line">    <span class="keyword">if</span> filename!=<span class="string">&quot;&quot;</span> <span class="keyword">and</span> video_path!=<span class="string">&quot;&quot;</span> <span class="keyword">and</span> audio_path!=<span class="string">&quot;&quot;</span>:</span><br><span class="line">        os.system(<span class="string">&#x27;ffmpeg.exe -i &#x27;</span>+video_path+<span class="string">&#x27; -i &#x27;</span>+audio_path+<span class="string">&#x27; -vcodec copy -acodec copy &#x27;</span>+out_path+<span class="string">&#x27;/&#x27;</span>+filename+<span class="string">&#x27;.mp4 &#x27;</span>+<span class="string">&#x27; -y&#x27;</span>)</span><br><span class="line">        filename=<span class="string">&quot;&quot;</span></span><br><span class="line">        video_path=<span class="string">&quot;&quot;</span></span><br><span class="line">        audio_path=<span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ffmpeg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>轻量级定制化框架Flask常用功能介绍</title>
      <link href="/posts/31000000/"/>
      <url>/posts/31000000/</url>
      
        <content type="html"><![CDATA[<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install Flask==<span class="number">2.0</span><span class="number">.3</span></span><br><span class="line">pip install Jinja2==<span class="number">3.1</span><span class="number">.1</span>.</span><br></pre></td></tr></table></figure><p>下面介绍如何快速使用Flask搭建接口功能</p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>最小的一个Flask应用：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><h3 id="请求方式"><a href="#请求方式" class="headerlink" title="请求方式"></a>请求方式</h3><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">GET(默认)</button></li><li class="tab"><button type="button" data-href="#tab-1-2">POST</button></li><li class="tab"><button type="button" data-href="#tab-1-3">PUT</button></li><li class="tab"><button type="button" data-href="#tab-1-4">DELETE</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><div class="note info flat"><p>methods：指定请求方法，可以多个，<code>methods=[&quot;POST&quot;,&quot;GET&quot;]</code>表示既可以接收<code>GET</code>请求，也可以接收<code>POST</code>请求</p><p>一般对应<code>CURD</code>操作的请求方法：<code>GET</code>、<code>POST</code>、<code>PUT</code>、<code>DELETE</code></p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&quot;PUT&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&quot;DELETE&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="返回数据方式"><a href="#返回数据方式" class="headerlink" title="返回数据方式"></a>返回数据方式</h3><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">字符串</button></li><li class="tab"><button type="button" data-href="#tab-1-2">json</button></li><li class="tab"><button type="button" data-href="#tab-1-3">文件</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,Response</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    json_data=&#123;</span><br><span class="line">        <span class="string">&quot;a&quot;</span>:<span class="number">1</span>,</span><br><span class="line">        <span class="string">&quot;b&quot;</span>:<span class="string">&quot;test&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Response(json.dumps(json_data),mimetype=<span class="string">&#x27;application/json&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>其中第一个参数是json数据转化后的字符串，第二个参数是媒体类型，json的媒体类型为<code>application/json</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,send_from_directory</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> send_from_directory(<span class="string">&#x27;./&#x27;</span>,<span class="string">&#x27;favicon.ico&#x27;</span>,mimetype=<span class="string">&#x27;image/vnd.microsoft.icon&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>其中第一个参数是文件路径，第二个参数是文件名，第三个是媒体类型，</p><p>常用媒体类型：</p><p>html：<code>text/html</code></p><p>css：&#96;text&#x2F;css&#96;&#96;</p><p>js：<code>application/x-javascript</code></p><p>图片：<code>image/jpeg</code></p><p>视频：<code>video/mp4</code></p><p>更多媒体类型参考：<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types">MIME 类型 - HTTP | MDN</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="获取请求路径"><a href="#获取请求路径" class="headerlink" title="获取请求路径"></a>获取请求路径</h3><p>有时候请求路径不是固定的，我们可以在<code>@app.route()</code>中使用<code>&lt;&gt;</code>指定变化的部分路径</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">获取请求路径</button></li><li class="tab"><button type="button" data-href="#tab-1-2">获取指定类型的请求路径</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&lt;num&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World! %s&#x27;</span> %num</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>注意：定义的方法要传参</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>Flask还可以定义路径的类型<code>&lt;int:num&gt;</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&lt;int:num&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World! %s&#x27;</span> %num</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>如果&#x2F;后面不是int类型，它不会走进<code>hello_world</code>函数，如果没有符合的条件，Flask将会返回<code>404</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="获取请求参数"><a href="#获取请求参数" class="headerlink" title="获取请求参数"></a>获取请求参数</h3><p>在Flask中，有全局对象 <code>request</code> 处理请求，需要使用 <code>from flask import request</code> 导入模块</p><table><thead><tr><th align="center">属性名</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">args</td><td align="center">获取 get 请求的参数</td></tr><tr><td align="center">form</td><td align="center">获取 post 请求的参数</td></tr><tr><td align="center">method</td><td align="center">获取请求的方式 GET or POST</td></tr><tr><td align="center">files</td><td align="center">获取上传的文件</td></tr><tr><td align="center">cookies</td><td align="center">获取 cookie 信息</td></tr><tr><td align="center">headers</td><td align="center">获取请求头</td></tr><tr><td align="center">path</td><td align="center">获取 &#x2F;</td></tr><tr><td align="center">host</td><td align="center">获取 ip:host</td></tr><tr><td align="center">host_url</td><td align="center">获取 <a href="http://127.0.0.1:5000/">http://127.0.0.1:5000/</a></td></tr><tr><td align="center">referrer</td><td align="center">请求的来源</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,make_response,jsonify</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/to&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">today1</span>():</span><br><span class="line">    data=&#123;&#125;</span><br><span class="line">    data[<span class="string">&#x27;args&#x27;</span>]=request.args</span><br><span class="line">    data[<span class="string">&#x27;form&#x27;</span>]=request.form</span><br><span class="line">    data[<span class="string">&#x27;mothod&#x27;</span>]=request.method</span><br><span class="line">    data[<span class="string">&#x27;files&#x27;</span>]=request.files</span><br><span class="line">    data[<span class="string">&#x27;cookies&#x27;</span>]=request.cookies</span><br><span class="line">    data[<span class="string">&#x27;headers&#x27;</span>]=<span class="built_in">dict</span>(request.headers)</span><br><span class="line">    data[<span class="string">&#x27;path&#x27;</span>]=request.path</span><br><span class="line">    data[<span class="string">&#x27;host&#x27;</span>]=request.host</span><br><span class="line">    data[<span class="string">&#x27;host_url&#x27;</span>]=request.host_url</span><br><span class="line">    data[<span class="string">&#x27;referrer&#x27;</span>]=request.referrer</span><br><span class="line">    <span class="keyword">return</span> make_response(jsonify(data), <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><h3 id="重定向页面"><a href="#重定向页面" class="headerlink" title="重定向页面"></a>重定向页面</h3><p>获取今日必应壁纸</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,redirect</span><br><span class="line"><span class="keyword">import</span> json,requests</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/bing/today&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">today</span>():</span><br><span class="line">    req_url=<span class="string">&quot;https://cn.bing.com/HPImageArchive.aspx?n=1&amp;format=js&amp;idx=0&quot;</span></span><br><span class="line">    bing_url=<span class="string">&#x27;https://cn.bing.com&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> redirect(bing_url+json.loads(requests.get(req_url).text)[<span class="string">&quot;images&quot;</span>][<span class="number">0</span>][<span class="string">&#x27;url&#x27;</span>]) </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p><code>redirect</code>函数接受一个参数，即转向地址栏的地址</p><h3 id="自定义请求错误页面"><a href="#自定义请求错误页面" class="headerlink" title="自定义请求错误页面"></a>自定义请求错误页面</h3><p>Flask自带的错误请求：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,abort</span><br><span class="line"><span class="keyword">import</span> json,requests</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/error&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">error</span>():</span><br><span class="line">    abort(<span class="number">403</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>利用<code>abort</code>函数抛出错误码和对应的错误页面，常见的错误码含义：</p><p><code>400</code>：错误的请求</p><p><code>401</code>：未授权</p><p><code>403</code>：禁止访问</p><p><code>404</code>：未找到页面</p><p><code>405</code>：不被允许的请求方法</p><p><code>406</code>：不被接受的请求</p><p>自定义错误请求页面：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,abort,render_template_string</span><br><span class="line"><span class="keyword">import</span> json,requests</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/error&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">error</span>():</span><br><span class="line">    abort(<span class="number">403</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(<span class="params"><span class="number">403</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">page_403</span>(<span class="params">error</span>):</span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="string">&#x27;&lt;h1&gt; Unauthorized &lt;/h1&gt;&lt;h2&gt;&#123;&#123; error_info &#125;&#125;&lt;/h2&gt;&#x27;</span>, error_info=error), <span class="number">403</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>如果<code>return jsonify(&#123;&quot;msg&quot;:&quot;请求错误&quot;,&quot;code&quot;:403&#125;), 200</code>，可返回json格式的错误提示（状态码200）</p><h2 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h2><p>可使用开发模式实现热部署：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><p>部署在服务器时，除了安装必要的环境之外，代码也有所变化。</p><p>因为<code>app.run()</code>默认属于同一网段才能访问且默认端口为<code>5000</code>，允许外网访问，指定运行端口，需要设置：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">8080</span>)</span><br></pre></td></tr></table></figure><p>因为<code>app.run()</code>是Flask自带的一个服务器供我们进行开发，我们可以使用python自带的<code>wsgiref</code>进行部署：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> wsgiref.simple_server <span class="keyword">import</span> make_server</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    server = make_server(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">5000</span>, app)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure><p>也可以使用Flask+Gunicorn+Nginx的Flask部署方案：<a href="https://www.cnblogs.com/hellohorld/p/10033720.html">Flask 应用如何部署</a></p><h2 id="建议阅读"><a href="#建议阅读" class="headerlink" title="建议阅读"></a>建议阅读</h2><p><a href="https://flask.net.cn/">Flask 中文网</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginx原理详细讲解分析</title>
      <link href="/posts/d86b/"/>
      <url>/posts/d86b/</url>
      
        <content type="html"><![CDATA[<h2 id="模块结构"><a href="#模块结构" class="headerlink" title="模块结构"></a>模块结构</h2><p>Nginx是一个高性能的HTTP和反向代理服务器，它由内核和模块组成</p><p>内核包含着一些基础的数据结构，例如：链表、内存池、hashmap、String等，内核的工作十分简单，只是负责查找配置文件映射到location block上，location上匹配的指令将会启动不同的模块进行工作</p><p>Nginx 的模块从结构上分为<strong>核心模块、基础模块和第三方模块</strong>：</p><ul><li><strong>核心模块</strong>：HTTP 模块、EVENT 模块和 MAIL 模块</li><li><strong>基础模块</strong>：HTTP Access 模块、HTTP FastCGI 模块、HTTP</li><li><strong>第三方模块</strong>：HTTP Upstream Request Hash 模块、Notice 模块和 HTTPAccess Key 模块</li></ul><p>用户根据自己的需要开发的模块都属于第三方模块。正是有了这么多模块的支撑，Nginx 的功能才会如此强大。</p><p>Nginx 的模块从功能上分为如下三类：</p><ul><li><strong>Handlers</strong>：即处理器模块。此类模块直接处理请求，并进行输出内容和修改 headers 信息等操作。Handlers 处理器模块一般只能有一个。</li><li><strong>Filters</strong>：即过滤器模块。此类模块主要对其他处理器模块输出的内容进行修改操作，最后由 Nginx 输出。</li><li><strong>Proxies</strong>：即代理类模块。此类模块是 Nginx 的 HTTP Upstream 之类的模块，这些模块主要与后端一些服务比如 FastCGI 等进行交互，实现服务代理和负载均衡等功能。</li></ul><h2 id="进程模型"><a href="#进程模型" class="headerlink" title="进程模型"></a>进程模型</h2><p><img src="/./img/d86b/1662609700517.png" alt="nginx进程模型"></p><p>nginx启动后会创建一个master进程（建立需要listen的socket），Master进程再fork出若干个worker进程，当用户请求到nginx时，worker会接受并处理用户请求</p><h3 id="master进程"><a href="#master进程" class="headerlink" title="master进程"></a>master进程</h3><p>master进程只负责管理worker进程，当master进程启动后，它会读取配置文件，fork出worker进程；当重新启动master进程时，它会重新加载配置文件，并启动新的worker进程，向旧的worke进程发送信号，结束旧进程，而旧的worker在收到来自master的信号后，就不再接收新的请求，并且在当前进程中的所有未处理完的请求处理完成后，再退出。</p><h3 id="worker进程"><a href="#worker进程" class="headerlink" title="worker进程"></a>worker进程</h3><p>worker进程之间是平等的，每个进程，处理请求的机会也是一样的。当我们提供80端口的http服务时，一个连接请求过来，每个进程都有可能处理这个连接。首先，每个worker进程都是从master进程fork过来，在master进程里面，先建立好需要listen的socket（listenfd）之后，然后再fork出多个worker进程。所有worker进程的listenfd会在新连接到来时变得可读，为保证只有一个进程处理该连接，所有worker进程在注册listenfd读事件前抢accept_mutex，抢到互斥锁的那个进程注册listenfd读事件，在读事件里调用accept接受该连接。当一个worker进程在accept这个连接之后，就开始读取请求，解析请求，处理请求，产生数据后，再返回给客户端，最后才断开连接，这样一个完整的请求就是这样的了。我们可以看到，一个请求，完全由worker进程来处理，而且只在一个worker进程中处理。</p><h2 id="多进程IO模型"><a href="#多进程IO模型" class="headerlink" title="多进程IO模型"></a>多进程IO模型</h2><p>Nginx 采用了异步非阻塞的方式来处理请求。也就是说，Nginx 是可以同时处理成千上万个请求的。非阻塞就是，事件没有准备好，马上返回EAGAIN，告诉你，事件还没准备好呢，你慌什么，过会再来吧。好吧，你过一会，再来检查一下事件，直到事件准备好了为止，在这期间，你就可以先去做其它事情，然后再来看看事件好了没，也就是epoll多路复用技术</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python日期格式化输出的方法（time，datetime）</title>
      <link href="/posts/a9f4/"/>
      <url>/posts/a9f4/</url>
      
        <content type="html"><![CDATA[<h2 id="time模块"><a href="#time模块" class="headerlink" title="time模块"></a>time模块</h2><p>time模块是python的一个内置模块，使用时需要导入</p><ul><li>输出时间戳</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> time</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ticks = time.time()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(ticks)</span><br><span class="line"><span class="number">1662470588.7917633</span></span><br></pre></td></tr></table></figure><ul><li>获取当前时间</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> time</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>now=time.asctime()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(now)</span><br><span class="line">Tue Sep  <span class="number">6</span> <span class="number">21</span>:<span class="number">26</span>:04 <span class="number">2022</span></span><br></pre></td></tr></table></figure><ul><li>获取格式化时间（%Y-%m-%d %H:%M:%S）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> time</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>,time.localtime())</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">21</span>:<span class="number">28</span>:<span class="number">42</span></span><br></pre></td></tr></table></figure><ul><li>获取格式化日期（%Y-%m-%d）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> time</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=time.strftime(<span class="string">&quot;%Y-%m-%d&quot;</span>,time.localtime())</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06</span><br></pre></td></tr></table></figure><ul><li>获取指定格式化时间（<code>2022/09/06 20:40:00</code> -&gt;<code>2022-09-06 20:40:00</code>）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> time</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>timearray=time.strptime(<span class="string">&#x27;2022/09/06 20:40:00&#x27;</span>,<span class="string">&#x27;%Y/%m/%d %H:%M:%S&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>,timearray)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">20</span>:<span class="number">40</span>:<span class="number">00</span></span><br></pre></td></tr></table></figure><ul><li>格式化时间转换为时间戳</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> time</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>timearray=time.strptime(<span class="string">&#x27;2022/09/06 20:40:00&#x27;</span>,<span class="string">&#x27;%Y/%m/%d %H:%M:%S&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>timestamp=<span class="built_in">int</span>(time.mktime(timearray))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(timestamp)</span><br><span class="line"><span class="number">1662468000</span></span><br></pre></td></tr></table></figure><ul><li>时间戳转换为格式化时间</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> time</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>timestamp=<span class="number">1662468000</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>timearray=time.localtime(timestamp)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>,timearray)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">20</span>:<span class="number">40</span>:<span class="number">00</span></span><br></pre></td></tr></table></figure><h2 id="datetime模块"><a href="#datetime模块" class="headerlink" title="datetime模块"></a>datetime模块</h2><p>datetime模块是python的一个内置模块，使用时需要导入</p><ul><li>输出时间戳</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>timestamp=datetime.datetime.now().timestamp()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(timestamp)</span><br><span class="line"><span class="number">1662472380.087664</span></span><br></pre></td></tr></table></figure><ul><li>获取当前时间</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>now=datetime.datetime.now()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(now)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">21</span>:<span class="number">35</span>:<span class="number">12.361862</span></span><br></pre></td></tr></table></figure><ul><li>获取格式化时间（%Y-%m-%d %H:%M:%S）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=datetime.datetime.now().strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">21</span>:<span class="number">36</span>:<span class="number">32</span></span><br></pre></td></tr></table></figure><ul><li>获取格式化日期（%Y-%m-%d）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=datetime.datetime.now().strftime(<span class="string">&quot;%Y-%m-%d&quot;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06</span><br></pre></td></tr></table></figure><ul><li>获取指定格式化时间（<code>2022/09/06 20:40:00</code> -&gt;<code>2022-09-06 20:40:00</code>）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=datetime.datetime(<span class="number">2022</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">2</span>,<span class="number">32</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">22</span>:02:<span class="number">32</span></span><br></pre></td></tr></table></figure><ul><li>格式化时间转换为时间戳</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>stamptime=datetime.datetime(<span class="number">2022</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">2</span>,<span class="number">32</span>).timestamp()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(stamptime)</span><br><span class="line"><span class="number">1662472952.0</span></span><br></pre></td></tr></table></figure><ul><li>时间戳转换为格式化时间</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>strtime=datetime.datetime.fromtimestamp(<span class="number">1662472952.0</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strtime)</span><br><span class="line"><span class="number">2022</span>-09-06 <span class="number">22</span>:02:<span class="number">32</span></span><br></pre></td></tr></table></figure><ul><li>同时区：<code>%Y-%m-%dT%H:%M:%fZ</code>（例如：<code>2022-12-15T02:04:24Z</code>）格式转北京时间（<code>%Y-%m-%d %H:%M:%S</code>）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>normal_time=datetime.datetime.strptime(<span class="string">&#x27;2022-12-15T02:04:24Z&#x27;</span>,<span class="string">&#x27;%Y-%m-%dT%H:%M:%fZ&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>strf_time=normal_time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strf_time)</span><br><span class="line"><span class="number">2022</span>-<span class="number">12</span>-<span class="number">15</span> 02:04:<span class="number">00</span></span><br></pre></td></tr></table></figure><ul><li>不同时区：<code>%Y-%m-%dT%H:%M:%fZ</code>（例如：<code>2022-12-15T02:04:24Z</code>）格式转北京时间（<code>%Y-%m-%d %H:%M:%S</code>）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>normal_time=datetime.datetime.strptime(<span class="string">&#x27;2022-12-15T02:04:24Z&#x27;</span>,<span class="string">&#x27;%Y-%m-%dT%H:%M:%fZ&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>strf_time=normal_time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)+datetime.timedelta(hours=<span class="number">8</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(strf_time)</span><br><span class="line"><span class="number">2022</span>-<span class="number">12</span>-<span class="number">15</span> 02:04:<span class="number">00</span></span><br></pre></td></tr></table></figure><h2 id="日期格式化符号"><a href="#日期格式化符号" class="headerlink" title="日期格式化符号"></a>日期格式化符号</h2><p>python中时间日期格式化符号：</p><ul><li>%y：两位数的年份表示（00-99）</li><li>%Y：四位数的年份表示（000-9999）</li><li>%m：月份（01-12）</li><li>%d：月内中的一天（0-31）</li><li>%H：24小时制小时数（0-23）</li><li>%I：12小时制小时数（01-12）</li><li>%M：分钟数（00-59）</li><li>%S：秒（00-59）</li><li>%a：本地简化星期名称</li><li>%A：本地完整星期名称</li><li>%b：本地简化的月份名称</li><li>%B：本地完整的月份名称</li><li>%c：本地相应的日期表示和时间表示</li><li>%j：年内的一天（001-366）</li><li>%p：本地A.M.或P.M.的等价符</li><li>%U：一年中的星期数（00-53）星期天为星期的开始</li><li>%w：星期（0-6），星期天为星期的开始</li><li>%W：一年中的星期数（00-53）星期一为星期的开始</li><li>%x：本地相应的日期表示</li><li>%X：本地相应的时间表示</li><li>%Z：当前时区的名称</li><li>%%：%号本身</li></ul><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://www.runoob.com/python/python-date-time.html">Python 日期和时间 | 菜鸟教程</a></p><p><a href="https://www.liaoxuefeng.com/wiki/1016959663602400/1017648783851616">datetime - 廖雪峰的官方网站</a></p><p><a href="https://www.cnblogs.com/Army-Knife/p/10689599.html">python中日期和时间格式化输出的方法</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 日期格式化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>我用include命令让Nginx配置文件内容缩短到四分之一</title>
      <link href="/posts/b261/"/>
      <url>/posts/b261/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>做网站一段时间了，最近登录服务器发现Nginx的配置文件达到了惊人的四百多行，这个配置文件臃肿得让我看不下去了，该给配置文件”瘦瘦身”了。现在此记录一下”瘦身过程”。</p><h2 id="瘦身过程"><a href="#瘦身过程" class="headerlink" title="瘦身过程"></a>瘦身过程</h2><p>众所周知，Nginx可以引入其他<code>.conf</code>配置文件，我们可以将各个域名单独给它命名一个<code>.conf</code>配置文件，然后在<code>nginx.conf</code>引入它即可。</p><p>首先在Nginx的conf目录下新建文件夹，用来保存网站的配置文件：</p><p><img src="/./img/b261/1662290172444.png" alt="nginx配置文件路径"></p><p>然后为Nginx下的站点单独命名一个<code>.conf</code>文件：</p><p><img src="/./img/b261/1662290241192.png" alt="站点配置"></p><p>将关于该站点的<code>server</code>块剪切到对应的<code>.conf</code>文件后，在<code>nginx.conf</code>添加<code>include</code>引入网站配置文件：</p><p><img src="/./img/b261/1662290404095.png" alt="nginx配置"></p><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">瘦身前</button></li><li class="tab"><button type="button" data-href="#tab-1-2">瘦身后</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/./img/b261/1662289899056.png" alt="瘦身前配置行数"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/./img/b261/1662290051371.png" alt="瘦身后配置行数"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux常用命令学习：cat命令</title>
      <link href="/posts/7cc8/"/>
      <url>/posts/7cc8/</url>
      
        <content type="html"><![CDATA[<h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>cat（英文全拼：concatenate）命令用于连接文件并打印到标准输出设备上</p><h4 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat [-option] fileName</span><br></pre></td></tr></table></figure><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p>显示文件内容</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat textfile1</span><br></pre></td></tr></table></figure><p>将文件追加（&gt;&gt;）覆盖（&gt;）到另一个文件中</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat textfile1 &gt;&gt; textfile2</span><br><span class="line"></span><br><span class="line">cat textfile1 &gt; textfile2</span><br></pre></td></tr></table></figure><p>将字符串追加（&gt;&gt;）覆盖（&gt;）到文件中</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat &gt;&gt; file &lt;&lt; EOF</span><br><span class="line">aaaaaa</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cat &gt; file &lt;&lt; EOF</span><br><span class="line">aaaaaa</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p>清空文档内容</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /dev/null &gt; /etc/test.txt</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;&quot; &gt; /etc/test.txt</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>定时任务Cron表达式详细讲解</title>
      <link href="/posts/19b8/"/>
      <url>/posts/19b8/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>定时任务，就是能够在规定时间内<code>重复执行</code>的任务。而定义定时任务的表达式就是<code>Cron</code>表达式。</p><p>Corn表达式就是一个字符串，它以5或6个空格隔开，包含6或7个域，每一个域代表一个含义，Cron表达式有两种语法格式：</p><p>（1）秒 分 时 日 月 周 年</p><p>（2）秒 分 时 日 月 周</p><p>第二种语法格式少了一个<code>年</code>，代表每一年，尽量使用第一种，第二年钟可能会出现奇怪的<code>bug</code></p><p>各字段的符号范围以及允许字符：</p><table><thead><tr><th align="center"><strong>字段</strong></th><th align="center"><strong>允许值</strong></th><th align="center"><strong>允许字符</strong></th></tr></thead><tbody><tr><td align="center">秒</td><td align="center">0-59</td><td align="center">, - * &#x2F;</td></tr><tr><td align="center">分</td><td align="center">0-59</td><td align="center">, - * &#x2F;</td></tr><tr><td align="center">时</td><td align="center">0-23</td><td align="center">, - * &#x2F;</td></tr><tr><td align="center">日</td><td align="center">1-31</td><td align="center">, - * ? &#x2F; L W C</td></tr><tr><td align="center">月</td><td align="center">1-12 或 JAN-DEC</td><td align="center">, - * &#x2F;</td></tr><tr><td align="center">周</td><td align="center">1-7 或 SUN-SAT</td><td align="center">, - * ? &#x2F; L C #</td></tr><tr><td align="center">年</td><td align="center">留空 或 1970-2099</td><td align="center">, - * &#x2F;</td></tr></tbody></table><h2 id="详解"><a href="#详解" class="headerlink" title="详解"></a>详解</h2><p>Cron在线表达式生成器：<a href="http://cron.ciding.cc/">http://cron.ciding.cc/</a></p><h3 id="秒"><a href="#秒" class="headerlink" title="秒"></a>秒</h3><p>允许值范围: 0~59，不允许为空值</p><p><code>*</code>：每隔1秒钟触发。例子：<code>* * * * * *</code>代表每秒钟执行<code>1</code>次</p><p><code>,</code>：指定的秒数触发。例子：<code>0,30,45 * * * * *</code> 代表每分钟的第<code>0,30,45</code>秒执行</p><p><code>-</code>：指定的范围内触发。例子：<code>10-30 * * * * *</code>代表每分钟从<code>第10秒开始到第30秒</code>结束，<code>每隔1秒执行1次</code></p><p><code>/</code>：触发步进，<code>/</code>前面的值代表初始值（没有则为<code>0</code>），后面的值代表偏移量。例子：</p><ul><li><code>5/10 * * * * ?</code>代表从第<code>5</code>秒开始，每隔<code>10</code>秒执行1次</li><li><code>/20 * * * * ?</code>代表从第<code>0</code>秒开始，每隔<code>20</code>秒执行1次</li><li><code>10-40/10 * * * * *</code>代表从第<code>10</code>秒开始，第<code>40</code>秒结束，每隔<code>10</code>秒执行<code>1</code>次</li></ul><h3 id="分"><a href="#分" class="headerlink" title="分"></a>分</h3><p>允许值范围: 0~59，不允许为空值</p><p><code>*</code>：每隔1分钟触发。例子：<code>0 * * * * *</code>代表每分钟执行<code>1</code>次</p><p><code>,</code>：指定的分钟触发。例子：<code>0 0,30,45 * * * *</code> 代表第<code>0,30,45</code>分钟执行</p><p><code>-</code>：指定的范围内触发。例子：<code>0 10-30 * * * *</code>代表从<code>第10分钟开始到第30分钟</code>结束，<code>每隔1分钟执行1次</code></p><p><code>/</code>：触发步进，<code>/</code>前面的值代表初始值（没有则为<code>0</code>），后面的值代表偏移量。例子：</p><ul><li><code>0 5/10 * * * *</code>代表从第<code>5</code>分钟开始，每隔<code>10</code>分钟执行1次</li><li><code>0 /20 * * * ?</code>代表从第<code>0</code>分钟开始，每隔<code>20</code>分钟执行1次</li><li><code>0 10-40/10 * * * *</code>代表从第<code>10</code>分钟开始，第<code>40</code>分钟结束，每隔<code>10</code>分钟执行<code>1</code>次</li></ul><h3 id="时"><a href="#时" class="headerlink" title="时"></a>时</h3><p>允许值范围: 0~23，不允许为空值</p><p><code>*</code>：每隔1小时触发。例子：<code>0 0 * * * *</code>代表每小时执行<code>1</code>次</p><p><code>,</code>：指定的时间点触发。例子：<code>0 0 0,2,9 * * *</code> 代表第<code>0,2,9</code>小时执行</p><p><code>-</code>：指定的范围内触发。例子：<code>0 0 10-20 * * *</code>代表从<code>第10点开始到第20点</code>结束，<code>每隔1小时执行1次</code></p><p><code>/</code>：触发步进，<code>/</code>前面的值代表初始值（没有则为<code>0</code>），后面的值代表偏移量。例子：</p><ul><li><code>0 0 5/10 * * *</code>代表从第<code>5</code>点开始，每隔<code>10</code>小时执行1次</li><li><code>0 0 /20 * * ?</code>代表从第<code>0</code>点开始，每隔<code>20</code>小时执行1次</li><li><code>0 0 10-20/10 * * *</code>代表从第<code>10</code>点开始，第<code>20</code>点结束，每隔<code>10</code>小时执行<code>1</code>次</li></ul><h3 id="日"><a href="#日" class="headerlink" title="日"></a>日</h3><p>允许值范围: 1-31 ,不允许为空值</p><p><code>W</code>字符代表着平日(Mon-Fri)，并且仅能用于日域中。它用来指定离指定日的最近的一个平日。大部分的商业处理都是基于工作周的，所以 W 字符可能是非常重要的。例子：</p><ul><li><code>15W</code>：离该月15号的最近一个平日。假如15号是星期六，那么<code>15W</code>会在14号(星期五)触发，因为星期四比星期一离15号更近。</li></ul><p><code>C</code>：计划所关联的日期，如果日期没有被关联，则相当于日历中所有日期。例子：</p><ul><li><code>5C</code>在日期字段中就相当于日历5日以后的第一天。<code>1C</code>在星期字段中相当于星期日后的第一天。</li></ul><h3 id="月"><a href="#月" class="headerlink" title="月"></a>月</h3><p>允许值范围: 1~12 (JAN-DEC),不允许为空值</p><p><code>*</code>：每月触发。例子：<code>0 0 0 1 * ? *</code>代表每月<code>1日</code>执行<code>1</code>次</p><p><code>,</code>：指定的时间点触发。例子：<code>0 0 0 1 2,5 ? *</code> 代表<code>2月1日、5月1日</code>执行</p><p><code>-</code>：指定的范围内触发。例子：<code>0 0 0 1 8-12 ? *</code>代表从<code>8月1日开始，12月1日</code>结束，<code>每隔1月执行1次</code></p><p><code>/</code>：触发步进，<code>/</code>前面的值代表初始值（没有则为<code>0</code>），后面的值代表偏移量。例子：</p><ul><li><code>0 0 0 1 1/2 ? *</code>代表从<code>1月1日</code>开始，每隔<code>2</code>月执行1次</li><li><code>0 0 0 1 /2 ? *</code>代表从<code>1月1日</code>开始，每隔<code>2</code>年执行1次</li><li><code>0 0 0 1 2-10/2 ? *</code>代表从<code>2月1日</code>开始，<code>10月1日</code>结束，每隔<code>2</code>月执行<code>1</code>次</li></ul><h3 id="周"><a href="#周" class="headerlink" title="周"></a>周</h3><p>允许值范围: 1~7 (SUN-SAT),1代表星期天(一星期的第一天)，以此类推，7代表星期六(一星期的最后一天)，不允许为空值</p><p><code>*</code> ：每星期都触发；</p><p><code>?</code>：与{日期}互斥，即意味着若明确指定{日期}触发，则表示{星期}无意义，以免引起冲突和混乱</p><p><code>,</code> ：在指定的星期约定触发。例子：</p><ul><li><code>0 0 0 * * 1,3,5</code>代表星期天、星期二和星期四触发</li></ul><p><code>-</code>：在指定的星期范围内触发，比如<code>2-4</code>代表从星期一开始触发到星期三结束触发，每隔1天触发</p><p><code>/</code> ：触发步进(step)，<code>/</code>前面的值代表初始值(等同1)，后面的值代表偏移量，例子：</p><ul><li><p><code>1/3</code>或者<code>/3</code>：从星期天开始触发，每隔3天触发1次</p></li><li><p><code>1-5/2</code>：在[1,5]范围内，每隔2天触发，即星期天、星期二、星期四触发</p></li></ul><p><code>L</code> 如果{星期}占位符如果是<code>L</code>，即意味着星期的的最后一天触发，即星期六触发，L&#x3D; 7或者 L &#x3D; SAT，例子：</p><ul><li><code>5L</code>：一个月的最后一个星期四触发</li></ul><p><code>#</code> 用来指定具体的周数，<code>#</code>前面代表星期，<code>#</code>后面代表本月第几周，例子：</p><ul><li><code>2#2</code>：本月第二周的星期一，<code>5#3</code>表示本月第三周的星期四，因此，<code>5L</code>这种形式只不过是<code>#</code>的特殊形式而已</li></ul><h3 id="年"><a href="#年" class="headerlink" title="年"></a>年</h3><p>允许值范围: 1970~2099 ,允许为空</p><p><code>*</code>：每年触发。例子：<code>0 0 0 1 1 ? *</code>代表每年<code>1月1日</code>执行<code>1</code>次</p><p><code>,</code>：指定的时间点触发。例子：<code>0 0 0 1 1 ? 2022,2023</code> 代表<code>2022年1月1日、2023年1月1日</code>执行</p><p><code>-</code>：指定的范围内触发。例子：<code>0 0 0 1 1 ? 2022-2032</code>代表从<code>2022年1月1日开始到2032年1月1日</code>结束，<code>每隔1年执行1次</code></p><p><code>/</code>：触发步进，<code>/</code>前面的值代表初始值（没有则为<code>0</code>），后面的值代表偏移量。例子：</p><ul><li><code>0 0 0 1 1 ? 2022/2</code>代表从<code>2022</code>年开始，每隔<code>2</code>年执行1次</li><li><code>0 0 0 1 1 ? /2</code>代表从<code>当前年1月1日</code>开始，每隔<code>2</code>年执行1次</li><li><code>0 0 0 1 1 ? 2022-2032/2</code>代表从<code>2022年1月1日</code>开始，<code>2032年1月1日</code>结束，每隔<code>2</code>年执行<code>1</code>次</li></ul>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cron表达式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux常用工具安装：python3.8.5</title>
      <link href="/posts/d5f4/"/>
      <url>/posts/d5f4/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>通常服务器上自带了python2.7环境，但由于版本太低，部署一些需要python3环境的应用就会被限制，但是yum命令又依赖python2.7环境，所以升级python时需要注意。本次安装版本为<code>3.8.5</code></p><h2 id="安装python3-8-5"><a href="#安装python3-8-5" class="headerlink" title="安装python3.8.5"></a>安装<code>python3.8.5</code></h2><p>官网下载地址：<a href="https://www.python.org/downloads/source/">https://www.python.org/downloads/source/</a></p><p>选择gzip压缩的源码包，上传到服务器中</p><p><img src="/./img/d5f4/1662039490513.png" alt="python下载界面"></p><p>新建python安装路径</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /usr/local/python3.8</span><br></pre></td></tr></table></figure><p>安装依赖</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel libffi-devel zlib*</span><br></pre></td></tr></table></figure><p>解压<code>Python-3.8.5.tgz</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxf Python-3.8.5.tgz</span><br></pre></td></tr></table></figure><p>进入<code>Python-3.8.5</code>目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd Python-3.8.5</span><br></pre></td></tr></table></figure><p>编译</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/local/python3.8</span><br></pre></td></tr></table></figure><p>安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><h2 id="创建新的软连接"><a href="#创建新的软连接" class="headerlink" title="创建新的软连接"></a>创建新的软连接</h2><p>首先确定是否需要更换<code>python</code>命令，因为有时候服务器会需要python2.x版本的命令，例如<code>yum</code>，虽然可以更换，但尽量不要动系统配置，防止出现奇怪的<code>bug</code>，所以说想要侵入性小一点的方法可以换一个命令，例如：<code>python3.8</code>、<code>pip3.8</code>，创建软连接即可：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/local/python3.8/bin/python3 /usr/bin/python3.8</span><br><span class="line">ln -s /usr/local/python3.8/bin/pip3 /usr/bin/pip3.8</span><br><span class="line">python3.8 -V</span><br><span class="line">pip3.8 -V</span><br></pre></td></tr></table></figure><p>到这里python安装就结束了，如果真的想要用<code>python</code>、<code>pip</code>命令，继续往下看：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /usr/bin/python</span><br><span class="line">rm -rf /usr/bin/pip</span><br><span class="line">ln -s /usr/local/python3.8/bin/python3 /usr/bin/python</span><br><span class="line">ln -s /usr/local/python3.8/bin/pip3 /usr/bin/pip</span><br></pre></td></tr></table></figure><h2 id="修改yum配置"><a href="#修改yum配置" class="headerlink" title="修改yum配置"></a>修改yum配置</h2><p>升级<code>python3.8.5</code>以后，运行yum命令就会报错，需要修改yum的配置文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/bin/yum</span><br></pre></td></tr></table></figure><p><img src="/./img/d5f4/1662040659422.png" alt="yum配置"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/libexec/urlgrabber-ext-down</span><br></pre></td></tr></table></figure><p><img src="/./img/d5f4/1662040693608.png" alt="yum配置"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/bin/yum-config-manager</span><br></pre></td></tr></table></figure><p><img src="/./img/d5f4/20230216095241.png" alt="修改yum-config-manager"></p><h2 id="pip换源"><a href="#pip换源" class="headerlink" title="pip换源"></a>pip换源</h2><p>pip更换国内源，可以提升python包的下载速度，建议更换</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.pip/pip.conf</span><br></pre></td></tr></table></figure><p>写下以下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url = http://pypi.douban.com/simple/</span><br><span class="line">trusted-host = pypi.douban.com</span><br></pre></td></tr></table></figure><h2 id="升级pip"><a href="#升级pip" class="headerlink" title="升级pip"></a>升级pip</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install --upgrade pip</span><br></pre></td></tr></table></figure><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip -V</span><br><span class="line">python -V</span><br><span class="line">yum --version</span><br></pre></td></tr></table></figure><p><img src="/./img/d5f4/1662041052405.png" alt="测试结果"></p><p>升级完成</p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://blog.csdn.net/Eternal_Blue/article/details/103762999">Linux下升级安装python3.8</a></p><p><a href="https://blog.csdn.net/qq_39852676/article/details/101591865">linux更换pip源</a></p><p><a href="https://www.cnblogs.com/qinlangsky/p/12653880.html">Linux系统中如何升级pip</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>八月份小结：我的博客收获小结</title>
      <link href="/posts/5f5d/"/>
      <url>/posts/5f5d/</url>
      
        <content type="html"><![CDATA[<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>这个月上旬一直在迷茫，下旬想了想搭建了博客玩玩，加了官方群学到了基础的博客用法，同时也认识了许多博客大佬，在和大佬们的交流中学到了很多有趣的想法。一句话总结：一入优化深似海</p><h2 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h2><ul><li>记录了<a href="https://blog.aqcoder.cn/posts/447d/">博客搭建过程</a></li><li>想要图片背景，搭建了一个<a href="https://blog.aqcoder.cn/posts/af9f/">必应壁纸api</a>免去找图烦恼</li><li>记录自己在<a href="https://blog.aqcoder.cn/posts/830e/">Nginx的应用</a></li><li>想要博客评论系统，找文档私有部署了<a href="https://blog.aqcoder.cn/posts/3f0b/">Twikoo</a></li><li>想要有效地收到消息，找文档私有部署了<a href="https://blog.aqcoder.cn/posts/7b50/">Qmsg</a></li><li>逛其他博客时觉得效果很好，搬到自己博客里，并修改了部分代码适配自己地博客</li><li>添加了许多大佬的友链，更方便地向他们学习</li><li>使用CDN加速自己的博客</li><li>查找资料让搜索引擎收录自己的博客</li><li>查找api监控博客状态</li><li>月底整理了文章标签和分类</li></ul><h2 id="困难"><a href="#困难" class="headerlink" title="困难"></a>困难</h2><ol><li><del>博客优化中按照官方搭建说说的api用不了</del>，看看大佬是怎么搭建的</li><li><del>每天一篇博文太多了</del>，克服克服</li><li><del>优化真的是永无止境</del>，该适可而止了</li></ol><h2 id="计划"><a href="#计划" class="headerlink" title="计划"></a>计划</h2><ol><li>保持每日一篇文章的产出</li><li>是时候搭建另一个站点了</li><li>继续完善页面，逐渐停止优化，专注文章产出</li></ol>]]></content>
      
      
      <categories>
          
          <category> 博客总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 月度总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly博客主题搭建系列：美化魔改教程</title>
      <link href="/posts/b20a/"/>
      <url>/posts/b20a/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>看到群里大佬优化的页面后终于还是忍不住了，在借鉴大佬的代码上我加了些许改进以更适合我的博客。</p><p>总体来说这篇文章是在Butterfly的基础对页面的一些优化，因为涉及到修改源码，所以记录一下修改过程，以免升级主题时产生冲突。</p><p>推荐一个魔改教程：<a href="https://butterfly.zhheo.com/">Butterfly主题美化教程</a>，里面有大佬们的魔改教学，帮助你取百家之所长，做出好看的博客。PS：主要是我的<a href="https://butterfly.zhheo.com/docs/performance.html#%E7%BD%91%E7%BB%9C%E9%80%9F%E5%BA%A6">文章</a>也收录进去了🥰</p><h2 id="添加loading动画"><a href="#添加loading动画" class="headerlink" title="添加loading动画"></a>添加loading动画</h2><p>原文：<a href="https://anzhiy.cn/posts/52d8.html">Heo同款loading动画 | 安知鱼</a></p><h3 id="修改样式"><a href="#修改样式" class="headerlink" title="修改样式"></a>修改样式</h3><p><code>themes/butterfly/source/css/_layout/loading.styl</code>替换为以下代码：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;preloader&#x27;</span>)</span><br><span class="line">  <span class="selector-class">.loading-bg</span></span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-card-bg);</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1001</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">transition</span>: .<span class="number">3s</span>;</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#loading-box</span></span><br><span class="line">    <span class="selector-class">.loading-img</span></span><br><span class="line">      <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">      <span class="attribute">margin</span>: auto;</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">4px</span> solid <span class="number">#f0f0f2</span>;</span><br><span class="line">      <span class="attribute">animation-duration</span>: .<span class="number">3s</span>;</span><br><span class="line">      <span class="attribute">animation-name</span>: loadingAction;</span><br><span class="line">      <span class="attribute">animation-iteration-count</span>: infinite;</span><br><span class="line">      <span class="attribute">animation-direction</span>: alternate;</span><br><span class="line">    <span class="selector-class">.loading-image-dot</span></span><br><span class="line">      <span class="attribute">width</span>: <span class="number">30px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">      <span class="attribute">background</span>: <span class="number">#6bdf8f</span>;</span><br><span class="line">      <span class="attribute">position</span>: absolute;</span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">6px</span> solid <span class="number">#fff</span>;</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">      <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">18px</span>, <span class="number">24px</span>);</span><br><span class="line">    &amp;<span class="selector-class">.loaded</span></span><br><span class="line">      <span class="selector-class">.loading-bg</span></span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">z-index</span>: -<span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@keyframes</span> loadingAction</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: .<span class="number">4</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="修改结构"><a href="#修改结构" class="headerlink" title="修改结构"></a>修改结构</h3><p><code>themes/butterfly/layout/includes/loading/loading.pug</code>替换为以下代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#loading-box(onclick=&#x27;document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)&#x27;)</span><br><span class="line">  .loading-bg</span><br><span class="line">    div.loading-img</span><br><span class="line">    .loading-image-dot</span><br></pre></td></tr></table></figure><h3 id="添加自定义-css"><a href="#添加自定义-css" class="headerlink" title="添加自定义 css"></a>添加自定义 css</h3><p>在合适的地方加上自定义 css，url换成自己的头像即可：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.loading-img</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">https://blog.aqcoder.cn/img/avatar.png</span>) no-repeat center center;</span><br><span class="line">    <span class="attribute">background-size</span>: cover;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="添加顶部加载条"><a href="#添加顶部加载条" class="headerlink" title="添加顶部加载条"></a>添加顶部加载条</h2><p>原文：<a href="https://xlenco.eu.org/posts/769f.html">为你的Butterfly添加顶部加载进度条 | Xlenco</a></p><h3 id="添加自定义-css-1"><a href="#添加自定义-css-1" class="headerlink" title="添加自定义 css"></a>添加自定义 css</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.pace</span> &#123;</span><br><span class="line">    <span class="attribute">pointer-events</span>: none;</span><br><span class="line">    <span class="attribute">user-select</span>: none;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">2</span>;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">margin</span>: auto;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">6rem</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#eaecf2</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace-inactive</span> <span class="selector-class">.pace-progress</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">transition</span>: <span class="number">0.3s</span> ease-in;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace</span><span class="selector-class">.pace-inactive</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">transition</span>: <span class="number">0.3s</span>;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">8px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace</span> <span class="selector-class">.pace-progress</span> &#123;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">2</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#49b1f5</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right,</span><br><span class="line">            <span class="built_in">rgb</span>(<span class="number">18</span>, <span class="number">194</span>, <span class="number">233</span>),</span><br><span class="line">            <span class="built_in">rgb</span>(<span class="number">196</span>, <span class="number">113</span>, <span class="number">237</span>),</span><br><span class="line">            <span class="built_in">rgb</span>(<span class="number">246</span>, <span class="number">79</span>, <span class="number">89</span>));</span><br><span class="line">    <span class="attribute">animation</span>: gradient <span class="number">2s</span> ease infinite;</span><br><span class="line">    <span class="attribute">background-size</span>: <span class="number">200%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="引入-JS"><a href="#引入-JS" class="headerlink" title="引入 JS"></a>引入 JS</h3><p>可在配置文件<code>_config.butterfly.yml</code>的<code>head</code>添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;//cdn.bootcss.com/pace/1.0.2/pace.min.js&quot;&gt;&lt;/script&gt;</span>   </span><br></pre></td></tr></table></figure><h2 id="魔改导航栏样式"><a href="#魔改导航栏样式" class="headerlink" title="魔改导航栏样式"></a>魔改导航栏样式</h2><p>原文：<a href="https://yisous.xyz/posts/895003b5/">关于Butterfly的导航栏的一些教程 Ariasakaの小窝</a></p><h3 id="分离搜索栏与菜单栏"><a href="#分离搜索栏与菜单栏" class="headerlink" title="分离搜索栏与菜单栏"></a>分离搜索栏与菜单栏</h3><p>修改<code>[blogRoot]\themes\Butterfly\layout\includes\header\nav.pug</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">nav#nav</span><br><span class="line">  span#blog_name</span><br><span class="line">    a#site-name(href=url_for(&#x27;/&#x27;)) #[=config.title]</span><br><span class="line">    </span><br><span class="line">  #menus</span><br><span class="line">-    if (theme.algolia_search.enable || theme.local_search.enable)</span><br><span class="line">-      #search-button</span><br><span class="line">-        a.site-page.social-icon.search</span><br><span class="line">-          i.fas.fa-search.fa-fw</span><br><span class="line">-          span=&#x27; &#x27;+_p(&#x27;search.title&#x27;)</span><br><span class="line">  !=partial(&#x27;includes/header/menu_item&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">  #nav-right</span><br><span class="line">+    if (theme.algolia_search.enable || theme.local_search.enable)</span><br><span class="line">+      #search-button</span><br><span class="line">+        a.site-page.social-icon.search</span><br><span class="line">+          i.fas.fa-search.fa-fw</span><br><span class="line">-    #toggle-menu</span><br><span class="line">-      a.site-page</span><br><span class="line">-        i.fas.fa-bars.fa-fw</span><br><span class="line">+      #toggle-menu</span><br><span class="line">+        a.site-page</span><br><span class="line">+          i.fas.fa-bars.fa-fw</span><br></pre></td></tr></table></figure><h3 id="导航栏居中"><a href="#导航栏居中" class="headerlink" title="导航栏居中"></a>导航栏居中</h3><p>自定义css：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#nav-right</span>&#123;</span><br><span class="line">    <span class="attribute">flex</span>:<span class="number">1</span> <span class="number">1</span> auto;</span><br><span class="line">    <span class="attribute">justify-content</span>: flex-end;</span><br><span class="line">    <span class="attribute">margin-left</span>: auto;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-wrap</span>:nowrap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="去掉导航栏项目底下的蓝色长条"><a href="#去掉导航栏项目底下的蓝色长条" class="headerlink" title="去掉导航栏项目底下的蓝色长条"></a>去掉导航栏项目底下的蓝色长条</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#nav</span> *<span class="selector-pseudo">::after</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: transparent<span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="子菜单横向布局"><a href="#子菜单横向布局" class="headerlink" title="子菜单横向布局"></a>子菜单横向布局</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.menus_item_child</span> <span class="selector-tag">li</span><span class="selector-pseudo">:not</span>(<span class="selector-id">#sidebar-menus</span> <span class="selector-tag">li</span>)&#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">6px</span><span class="meta">!important</span>;</span><br><span class="line">    -webkit-<span class="attribute">border-radius</span>: <span class="number">6px</span><span class="meta">!important</span>;</span><br><span class="line">    -moz-<span class="attribute">border-radius</span>: <span class="number">6px</span><span class="meta">!important</span>;</span><br><span class="line">    -ms-<span class="attribute">border-radius</span>: <span class="number">6px</span><span class="meta">!important</span>;</span><br><span class="line">    -o-<span class="attribute">border-radius</span>: <span class="number">6px</span><span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.menus_item_child</span><span class="selector-pseudo">:not</span>(<span class="selector-id">#sidebar-menus</span> <span class="selector-tag">ul</span>)&#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">    left:calc(-150%)!important;这是估算值，为了保持元素居中的，如果不合适可以自己调</span></span><br><span class="line"><span class="comment">  在网友的建议下，改为：*/</span></span><br><span class="line">  <span class="attribute">left</span>:<span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">translate</span>:-<span class="number">50%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="网站标题部分的增强版"><a href="#网站标题部分的增强版" class="headerlink" title="网站标题部分的增强版"></a>网站标题部分的增强版</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#site-name</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--lyx-theme)<span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    -webkit-<span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    -moz-<span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    -ms-<span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    -o-<span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">transition</span>: .<span class="number">3s</span>;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: .<span class="number">3s</span>;</span><br><span class="line">    -moz-<span class="attribute">transition</span>: .<span class="number">3s</span>;</span><br><span class="line">    -ms-<span class="attribute">transition</span>: .<span class="number">3s</span>;</span><br><span class="line">    -o-<span class="attribute">transition</span>: .<span class="number">3s</span>;</span><br><span class="line">    <span class="attribute">position</span>:absolute;</span><br><span class="line">    <span class="attribute">top</span>:<span class="number">0</span><span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">right</span>:<span class="number">0</span><span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;\f015&quot;</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">var</span>(--lyx-theme);</span><br><span class="line">    <span class="attribute">font-family</span>: <span class="string">&quot;Font Awesome 6 Free&quot;</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">color</span>:white;</span><br><span class="line">    <span class="attribute">line-height</span>:<span class="number">34px</span>;<span class="comment">/*如果有溢出或者垂直不居中的现象微调一下这个参数*/</span></span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>;<span class="comment">/*根据个人喜好*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#site-name</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">scale</span>:<span class="number">1.03</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#site-name</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">24px</span>; <span class="comment">/*一定要把字体调大点，否则效果惨不忍睹！*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-pseudo">:root</span>&#123;</span><br><span class="line">    <span class="attr">--lyx-theme</span>:<span class="number">#ed709b</span> <span class="comment">/*我的主题色*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="顶栏常驻"><a href="#顶栏常驻" class="headerlink" title="顶栏常驻"></a>顶栏常驻</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.nav-fixed</span> <span class="selector-id">#nav</span>&#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">58px</span>)<span class="meta">!important</span>;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">58px</span>)<span class="meta">!important</span>;</span><br><span class="line">    -moz-<span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">58px</span>)<span class="meta">!important</span>;</span><br><span class="line">    -ms-<span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">58px</span>)<span class="meta">!important</span>;</span><br><span class="line">    -o-<span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">58px</span>)<span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#nav</span>&#123;</span><br><span class="line">    <span class="attribute">transition</span>: none<span class="meta">!important</span>;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: none<span class="meta">!important</span>;</span><br><span class="line">    -moz-<span class="attribute">transition</span>: none<span class="meta">!important</span>;</span><br><span class="line">    -ms-<span class="attribute">transition</span>: none<span class="meta">!important</span>;</span><br><span class="line">    -o-<span class="attribute">transition</span>: none<span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="显示标题"><a href="#显示标题" class="headerlink" title="显示标题"></a>显示标题</h3><p>修改<code>[blogRoot]\themes\Butterfly\layout\includes\header\nav.pug</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">nav#nav</span><br><span class="line">  span#blog_name</span><br><span class="line">    a#site-name(href=url_for(&#x27;/&#x27;)) #[=config.title]</span><br><span class="line">    </span><br><span class="line">  #menus</span><br><span class="line">    !=partial(&#x27;includes/header/menu_item&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">+    center(id=&quot;name-container&quot;)</span><br><span class="line">+      a(id=&quot;page-name&quot; href=&quot;javascript:scrollToTop()&quot;) PAGE_NAME</span><br><span class="line">  ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>然后添加<code>nav.js</code>，并且按照注释修改配置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//js有一个小问题：就是只要鼠标滚动不论哪里都会响应，即便你滚动的是子元素</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2022.9.11 已修复，需要jq，请自行引入</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;name-container&quot;</span>).<span class="title function_">setAttribute</span>(<span class="string">&quot;style&quot;</span>, <span class="string">&quot;display:none&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> position = $(<span class="variable language_">window</span>).<span class="title function_">scrollTop</span>();</span><br><span class="line"></span><br><span class="line">$(<span class="variable language_">window</span>).<span class="title function_">scroll</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> scroll = $(<span class="variable language_">window</span>).<span class="title function_">scrollTop</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (scroll &gt; position) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;name-container&quot;</span>).<span class="title function_">setAttribute</span>(<span class="string">&quot;style&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;menus_items&quot;</span>)[<span class="number">1</span>].<span class="title function_">setAttribute</span>(<span class="string">&quot;style&quot;</span>, <span class="string">&quot;display:none!important&quot;</span>);</span><br><span class="line"></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;menus_items&quot;</span>)[<span class="number">1</span>].<span class="title function_">setAttribute</span>(<span class="string">&quot;style&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;name-container&quot;</span>).<span class="title function_">setAttribute</span>(<span class="string">&quot;style&quot;</span>, <span class="string">&quot;display:none&quot;</span>);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  position = scroll;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">scrollToTop</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;menus_items&quot;</span>)[<span class="number">1</span>].<span class="title function_">setAttribute</span>(<span class="string">&quot;style&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;name-container&quot;</span>).<span class="title function_">setAttribute</span>(<span class="string">&quot;style&quot;</span>,<span class="string">&quot;display:none&quot;</span>);</span><br><span class="line">    btf.<span class="title function_">scrollToDest</span>(<span class="number">0</span>, <span class="number">500</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//修复没有弄右键菜单的童鞋无法回顶部的问题</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;page-name&quot;</span>).<span class="property">innerText</span> = <span class="variable language_">document</span>.<span class="property">title</span>.<span class="title function_">split</span>(<span class="string">&quot; | Ariasakaの小窝&quot;</span>)[<span class="number">0</span>];</span><br><span class="line"><span class="comment">/*这里是去掉你的网站全局名称的设置，如果你不需要去掉，你可以写成：</span></span><br><span class="line"><span class="comment">document.getElementById(&quot;page-name&quot;).innerText=document.title</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">或者把你的网站的分隔符和全局网站名称加上去*/</span></span><br></pre></td></tr></table></figure><p>最后添加如下css，按照注释修改参数：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#page-name</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">    <span class="attribute">font-size</span>:<span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">color</span>:white<span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">top</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">content</span>:<span class="string">&#x27;回到顶部&#x27;</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--lyx-theme);</span><br><span class="line">    <span class="attribute">transition</span>: all .<span class="number">3s</span>;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: all .<span class="number">3s</span>;</span><br><span class="line">    -moz-<span class="attribute">transition</span>: all .<span class="number">3s</span>;</span><br><span class="line">    -ms-<span class="attribute">transition</span>: all .<span class="number">3s</span>;</span><br><span class="line">    -o-<span class="attribute">transition</span>: all .<span class="number">3s</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">3px</span> <span class="built_in">var</span>(--lyx-theme);</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">45px</span>; <span class="comment">/*如果垂直位置不居中可以微调此值，也可以删了*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#page-name</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">:before</span>&#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#name-container</span>&#123;</span><br><span class="line">    <span class="attribute">transition</span>: all .<span class="number">3s</span>;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: all .<span class="number">3s</span>;</span><br><span class="line">    -moz-<span class="attribute">transition</span>: all .<span class="number">3s</span>;</span><br><span class="line">    -ms-<span class="attribute">transition</span>: all .<span class="number">3s</span>;</span><br><span class="line">    -o-<span class="attribute">transition</span>: all .<span class="number">3s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#name-container</span><span class="selector-pseudo">:hover</span>&#123;</span><br><span class="line">    <span class="attribute">scale</span>:<span class="number">1.03</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#page-name</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">padding</span>:<span class="number">10px</span> <span class="number">30px</span><span class="comment">/*如果文字间隔不合理可以微调修改，第二个是水平方向的padding，第一个是垂直的*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="展示首页文章分类"><a href="#展示首页文章分类" class="headerlink" title="展示首页文章分类"></a>展示首页文章分类</h2><p>冰老师的方案一：</p><p><img src="/./img/b/b20a/635a9d0b5a5c1.png" alt="冰老师的首页文章分类"></p><p>原文：<a href="https://zfe.space/post/hexo-magnet.html">教程：hexo-magnet 插件 1.0 | 小冰博客</a></p><p>冰老师的方案二：</p><p><img src="/./img/b/b20a/635a9e11f2504.png" alt="image-20221027230449107"></p><p>原文：<a href="https://akilar.top/posts/a9131002/">Categories Magnet | Akilarの糖果屋</a></p><h3 id="npm安装"><a href="#npm安装" class="headerlink" title="npm安装"></a>npm安装</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo<span class="literal">-butterfly-categories-card</span> <span class="literal">--save</span></span><br></pre></td></tr></table></figure><p>在站点配置文件<code>_config.yml</code>配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 文章分类磁贴</span></span><br><span class="line"><span class="comment"># hexo-butterfly-categories-card</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/a9131002/</span></span><br><span class="line"><span class="attr">categoryBar:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 开关</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span> <span class="comment">#过滤器优先权</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">/</span> <span class="comment"># 应用页面</span></span><br><span class="line">  <span class="attr">layout:</span> <span class="comment"># 挂载容器类型</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">recent-posts</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">column:</span> <span class="string">odd</span> <span class="comment"># odd：3列 | even：4列</span></span><br><span class="line">  <span class="attr">row:</span> <span class="number">1</span> <span class="comment">#显示行数，默认两行，超过行数切换为滚动显示</span></span><br><span class="line">  <span class="attr">message:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">descr:</span> <span class="string">记录搭建过程</span></span><br><span class="line">      <span class="attr">cover:</span> <span class="string">/img/category-card-bg/Scooter.png</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">descr:</span> <span class="string">详细教程讲解</span></span><br><span class="line">      <span class="attr">cover:</span> <span class="string">/img/category-card-bg/Hydrogen.png</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">descr:</span> <span class="string">记录学习历程</span></span><br><span class="line">      <span class="attr">cover:</span> <span class="string">/img/category-card-bg/VisionsofGrandur.png</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">descr:</span> <span class="string">分享博客收获</span></span><br><span class="line">      <span class="attr">cover:</span> <span class="string">/img/category-card-bg/Relaxingred.png</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">descr:</span> <span class="string">学习精辟思路</span></span><br><span class="line">      <span class="attr">cover:</span> <span class="string">/img/category-card-bg/SublimeLight.png</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">descr:</span> <span class="string">分享日常生活</span></span><br><span class="line">      <span class="attr">cover:</span> <span class="string">/img/category-card-bg/TaranTado.png</span></span><br><span class="line">  <span class="attr">custom_css:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css</span></span><br></pre></td></tr></table></figure><p>注意图片更换为自己的图片链接</p><h2 id="魔改文章分类"><a href="#魔改文章分类" class="headerlink" title="魔改文章分类"></a>魔改文章分类</h2><p><img src="/./img/b/b20a/635a9fab2650e.png" alt="魔改文章分类"></p><p>参考原文：</p><p><a href="https://blog.zhheo.com/p/bc61964d.html">Butterfly魔改：动态分类条，可以根据页面变化而改变的分类列表展示方式 | 张洪Heo</a></p><p><a href="https://blog.justlovesmile.top/posts/2bfb1caa.html">Hexo博客 | 动态分类标签条，自动获取全站分类与标签进行展示 | Justlovesmile’s BLOG</a></p><h3 id="新建PUG文件"><a href="#新建PUG文件" class="headerlink" title="新建PUG文件"></a>新建PUG文件</h3><p>首先是分类条，在<code>themes/butterfly/layout/includes/</code>处新建文件<code>categoryBar.pug</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#category-bar</span><br><span class="line">  .category-bar-items#category-bar-items</span><br><span class="line">    !=getarray_bar(&quot;category&quot;)</span><br><span class="line">  a.category-bar-more(href=&quot;/categories/&quot;) 更多</span><br></pre></td></tr></table></figure><p>其次是标签条，在<code>themes/butterfly/layout/includes/</code>处新建文件<code>tagBar.pug</code>，因为样式一样，所以没有更改id和class名称：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#category-bar</span><br><span class="line">  .category-bar-items#category-bar-items</span><br><span class="line">    !=getarray_bar(&quot;tag&quot;)</span><br><span class="line">  a.category-bar-more(href=&quot;/tags/&quot;) 更多</span><br></pre></td></tr></table></figure><h3 id="新建Hexo辅助函数"><a href="#新建Hexo辅助函数" class="headerlink" title="新建Hexo辅助函数"></a>新建Hexo辅助函数</h3><p>在<code>theme/butterfly/scripts/helpers/</code>中创建<code>get_arrays.js</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="property">extend</span>.<span class="property">helper</span>.<span class="title function_">register</span>(<span class="string">&#x27;getarray_bar&#x27;</span>, <span class="keyword">function</span> (<span class="params">types</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!types) &#123;</span><br><span class="line">    types = <span class="string">&quot;category&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> categoriesBar = <span class="keyword">function</span> (<span class="params">categories</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!categories || !categories.<span class="property">length</span>) <span class="keyword">return</span> <span class="string">``</span></span><br><span class="line">    <span class="keyword">const</span> categoryArr = []</span><br><span class="line">    hexo.<span class="property">locals</span>.<span class="title function_">get</span>(<span class="string">&#x27;categories&#x27;</span>).<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">category</span>) &#123;</span><br><span class="line">      categoryArr.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: category.<span class="property">name</span>, <span class="attr">value</span>: category.<span class="property">length</span> &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    categoryArr.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123; <span class="keyword">return</span> b.<span class="property">value</span> - a.<span class="property">value</span> &#125;)</span><br><span class="line">    <span class="keyword">let</span> strCategoriesBar = <span class="string">``</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; categories.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      strTemp=<span class="string">`</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;category-bar-item&quot; id=&quot;<span class="subst">$&#123;categoryArr[i].name&#125;</span>&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;a href=&quot;/categories/<span class="subst">$&#123;categoryArr[i].name&#125;</span>/&quot;&gt;<span class="subst">$&#123;categoryArr[i].name&#125;</span>&lt;/a&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;`</span></span><br><span class="line">      strCategoriesBar+=strTemp</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> strCategoriesBar</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> tagsBar = <span class="keyword">function</span>(<span class="params">tags</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!tags || !tags.<span class="property">length</span>) <span class="keyword">return</span> <span class="string">``</span></span><br><span class="line">    <span class="keyword">const</span> tagArr = []</span><br><span class="line">    hexo.<span class="property">locals</span>.<span class="title function_">get</span>(<span class="string">&#x27;tags&#x27;</span>).<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">tag</span>) &#123;</span><br><span class="line">      tagArr.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: tag.<span class="property">name</span>, <span class="attr">value</span>: tag.<span class="property">length</span> &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    tagArr.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123; <span class="keyword">return</span> b.<span class="property">value</span> - a.<span class="property">value</span> &#125;)</span><br><span class="line">    <span class="keyword">let</span> strTagsBar = <span class="string">``</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; tags.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      strTemp=<span class="string">`</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;category-bar-item&quot; id=&quot;<span class="subst">$&#123;tagArr[i].name&#125;</span>&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;a href=&quot;/tags/<span class="subst">$&#123;tagArr[i].name&#125;</span>/&quot;&gt;<span class="subst">$&#123;tagArr[i].name&#125;</span>&lt;/a&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;`</span></span><br><span class="line">      strTagsBar+=strTemp</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> strTagsBar</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (types == <span class="string">&quot;category&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">categoriesBar</span>(<span class="variable language_">this</span>.<span class="property">site</span>.<span class="property">categories</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (types == <span class="string">&quot;tag&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">tagsBar</span>(<span class="variable language_">this</span>.<span class="property">site</span>.<span class="property">tags</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="引用模块"><a href="#引用模块" class="headerlink" title="引用模块"></a>引用模块</h3><p>在分类页面引用：找到<code>theme/butterfly/layout/category.pug</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">  if theme.category_ui == &#x27;index&#x27;</span><br><span class="line">    include ./includes/mixins/post-ui.pug</span><br><span class="line">    #recent-posts.recent-posts.category_ui   </span><br><span class="line">      +postUI</span><br><span class="line">      include includes/pagination.pug    </span><br><span class="line">  else</span><br><span class="line">    include ./includes/mixins/article-sort.pug</span><br><span class="line">    #category</span><br><span class="line">+      .category-in-bar</span><br><span class="line">+        .category-in-bar-tips</span><br><span class="line">+          i.fa-fw.fas.fa-folder-open</span><br><span class="line">+        include includes/categoryBar.pug</span><br><span class="line">      .article-sort-title= _p(&#x27;page.category&#x27;) + &#x27; - &#x27; + page.category</span><br><span class="line">      +articleSort(page.posts)</span><br><span class="line">      include includes/pagination.pug</span><br></pre></td></tr></table></figure><p>在标签页引用：找到<code>theme/butterfly/layout/tag.pug</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">  if theme.tag_ui == &#x27;index&#x27;</span><br><span class="line">    include ./includes/mixins/post-ui.pug</span><br><span class="line">    #recent-posts.recent-posts</span><br><span class="line">      +postUI</span><br><span class="line">      include includes/pagination.pug</span><br><span class="line">  else</span><br><span class="line">    include ./includes/mixins/article-sort.pug</span><br><span class="line">    #tag</span><br><span class="line">+      .category-in-bar</span><br><span class="line">+        .category-in-bar-tips</span><br><span class="line">+          i.fa-fw.fas.fa-tags</span><br><span class="line">+        include includes/tagBar.pug</span><br><span class="line">      .article-sort-title= _p(&#x27;page.tag&#x27;) + &#x27; - &#x27; + page.tag</span><br><span class="line">      +articleSort(page.posts)</span><br><span class="line">      include includes/pagination.pug</span><br></pre></td></tr></table></figure><h3 id="引入js和css文件"><a href="#引入js和css文件" class="headerlink" title="引入js和css文件"></a>引入js和css文件</h3><p>引入js：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//分类条</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">categoriesBarActive</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">var</span> urlinfo = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>;</span><br><span class="line">urlinfo = <span class="built_in">decodeURIComponent</span>(urlinfo)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(urlinfo);</span><br><span class="line"><span class="comment">//判断是否是首页</span></span><br><span class="line"><span class="keyword">if</span> (urlinfo == <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#category-bar&#x27;</span>)) &#123;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;主页&#x27;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;select&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// 验证是否是分类链接</span></span><br><span class="line"><span class="keyword">var</span> pattern = <span class="regexp">/\/categories\/.*?\//</span>;</span><br><span class="line"><span class="keyword">var</span> patbool = pattern.<span class="title function_">test</span>(urlinfo);</span><br><span class="line"><span class="comment">// 获取当前的分类</span></span><br><span class="line"><span class="keyword">if</span> (patbool) &#123;</span><br><span class="line"><span class="keyword">var</span> valuegroup = urlinfo.<span class="title function_">split</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"><span class="comment">// 获取当前分类</span></span><br><span class="line"><span class="keyword">var</span> nowCategorie = valuegroup[<span class="number">2</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#category-bar&#x27;</span>)) &#123;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(nowCategorie).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;select&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//鼠标控制横向滚动</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">topCategoriesBarScroll</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;category-bar-items&quot;</span>)) &#123;</span><br><span class="line"><span class="keyword">let</span> xscroll = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;category-bar-items&quot;</span>);</span><br><span class="line">xscroll.<span class="title function_">addEventListener</span>(<span class="string">&quot;mousewheel&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line"><span class="comment">//计算鼠标滚轮滚动的距离</span></span><br><span class="line"><span class="keyword">let</span> v = -e.<span class="property">wheelDelta</span> / <span class="number">2</span>;</span><br><span class="line">xscroll.<span class="property">scrollLeft</span> += v;</span><br><span class="line"><span class="comment">//阻止浏览器默认方法</span></span><br><span class="line">e.<span class="title function_">preventDefault</span>();</span><br><span class="line">&#125;, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//标签条</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">tagsBarActive</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">var</span> urlinfo = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>;</span><br><span class="line">urlinfo = <span class="built_in">decodeURIComponent</span>(urlinfo)</span><br><span class="line"><span class="comment">//console.log(urlinfo);</span></span><br><span class="line"><span class="comment">//判断是否是首页</span></span><br><span class="line"><span class="keyword">if</span> (urlinfo == <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#tags-bar&#x27;</span>)) &#123;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;首页&#x27;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;select&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// 验证是否是分类链接</span></span><br><span class="line"><span class="keyword">var</span> pattern = <span class="regexp">/\/tags\/.*?\//</span>;</span><br><span class="line"><span class="keyword">var</span> patbool = pattern.<span class="title function_">test</span>(urlinfo);</span><br><span class="line"><span class="comment">//console.log(patbool);</span></span><br><span class="line"><span class="comment">// 获取当前的标签</span></span><br><span class="line"><span class="keyword">if</span> (patbool) &#123;</span><br><span class="line"><span class="keyword">var</span> valuegroup = urlinfo.<span class="title function_">split</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"><span class="comment">//console.log(valuegroup[2]);</span></span><br><span class="line"><span class="comment">// 获取当前分类</span></span><br><span class="line"><span class="keyword">var</span> nowTag = valuegroup[<span class="number">2</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#category-bar&#x27;</span>)) &#123;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(nowTag).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;select&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">categoriesBarActive</span>()</span><br><span class="line"><span class="title function_">topCategoriesBarScroll</span>()</span><br><span class="line"><span class="title function_">tagsBarActive</span>()</span><br></pre></td></tr></table></figure><p>引入css：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">    <span class="attr">--heo-white</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attr">--heo-black</span>: <span class="number">#000</span>;</span><br><span class="line">    <span class="attr">--heo-none</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="attr">--heo-gray</span>: <span class="number">#999999</span>;</span><br><span class="line">    <span class="attr">--heo-yellow</span>: <span class="number">#ffc93e</span>;</span><br><span class="line">    <span class="attr">--heo-main</span>: <span class="built_in">var</span>(--heo-theme);</span><br><span class="line">    <span class="attr">--heo-main-op</span>: <span class="built_in">var</span>(--heo-theme-op);</span><br><span class="line">    <span class="attr">--heo-shadow-theme</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">12px</span> -<span class="number">3px</span> <span class="built_in">var</span>(--heo-theme-op);</span><br><span class="line">    <span class="attr">--heo-shadow-main</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">12px</span> -<span class="number">3px</span> <span class="built_in">var</span>(--heo-main-op);</span><br><span class="line">    <span class="attr">--heo-shadow-blue</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">12px</span> -<span class="number">3px</span> <span class="built_in">rgba</span>(<span class="number">40</span>, <span class="number">109</span>, <span class="number">234</span>, .<span class="number">20</span>);</span><br><span class="line">    <span class="attr">--heo-shadow-white</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">12px</span> -<span class="number">3px</span> <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, .<span class="number">20</span>);</span><br><span class="line">    <span class="attr">--heo-shadow-black</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">12px</span> <span class="number">4px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">05</span>);</span><br><span class="line">    <span class="attr">--heo-shadow-yellow</span>: <span class="number">0px</span> <span class="number">38px</span> <span class="number">77px</span> -<span class="number">26px</span> <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">201</span>, <span class="number">62</span>, .<span class="number">12</span>);</span><br><span class="line">    <span class="attr">--heo-shadow-red</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">12px</span> -<span class="number">3px</span> <span class="number">#ee7d7936</span>;</span><br><span class="line">    <span class="attr">--heo-shadow-green</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">12px</span> -<span class="number">3px</span> <span class="number">#87ee7936</span>;</span><br><span class="line">    <span class="attr">--heo-logo-color</span>: <span class="built_in">linear-gradient</span>(<span class="number">215deg</span>, <span class="number">#4584ff</span> <span class="number">30%</span>, <span class="number">#ff7676</span> <span class="number">70%</span>);</span><br><span class="line">    <span class="attr">--style-border</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--heo-card-border);</span><br><span class="line">    <span class="attr">--style-border-hover</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--heo-theme);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">::selection</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--heo-fontcolor);</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--heo-background);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=light]</span> &#123;</span><br><span class="line">    <span class="attr">--heo-theme</span>: <span class="number">#425AEF</span>;</span><br><span class="line">    <span class="attr">--heo-theme-op</span>: <span class="number">#4259ef23</span>;</span><br><span class="line">    <span class="attr">--heo-blue</span>: <span class="number">#425AEF</span>;</span><br><span class="line">    <span class="attr">--heo-red</span>: <span class="number">#D8213C</span>;</span><br><span class="line">    <span class="attr">--heo-pink</span>: <span class="number">#FF7C7C</span>;</span><br><span class="line">    <span class="attr">--heo-green</span>: <span class="number">#57bd6a</span>;</span><br><span class="line">    <span class="attr">--heo-fontcolor</span>: <span class="number">#363636</span>;</span><br><span class="line">    <span class="attr">--heo-background</span>: <span class="number">#f7f9fe</span>;</span><br><span class="line">    <span class="attr">--heo-reverse</span>: <span class="number">#000</span>;</span><br><span class="line">    <span class="attr">--heo-maskbg</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.6</span>);</span><br><span class="line">    <span class="attr">--heo-maskbgdeep</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.85</span>);</span><br><span class="line">    <span class="attr">--heo-hovertext</span>: <span class="built_in">var</span>(--heo-theme);</span><br><span class="line">    <span class="attr">--heo-ahoverbg</span>: <span class="number">#F7F7FA</span>;</span><br><span class="line">    <span class="attr">--heo-lighttext</span>: <span class="built_in">var</span>(--heo-main);</span><br><span class="line">    <span class="attr">--heo-secondtext</span>: <span class="built_in">rgba</span>(<span class="number">60</span>, <span class="number">60</span>, <span class="number">67</span>, <span class="number">0.6</span>);</span><br><span class="line">    <span class="attr">--heo-scrollbar</span>: <span class="built_in">rgba</span>(<span class="number">60</span>, <span class="number">60</span>, <span class="number">67</span>, <span class="number">0.4</span>);</span><br><span class="line">    <span class="attr">--heo-card-btn-bg</span>: <span class="number">#edf0f7</span>;</span><br><span class="line">    <span class="attr">--heo-post-blockquote-bg</span>: <span class="number">#fafcff</span>;</span><br><span class="line">    <span class="attr">--heo-post-tabs-bg</span>: <span class="number">#f2f5f8</span>;</span><br><span class="line">    <span class="attr">--heo-secondbg</span>: <span class="number">#edf0f7</span>;</span><br><span class="line">    <span class="attr">--heo-shadow-nav</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">12px</span> -<span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">102</span>, <span class="number">68</span>, <span class="number">68</span>, <span class="number">0.05</span>);</span><br><span class="line">    <span class="attr">--heo-card-bg</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attr">--heo-shadow-lightblack</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">12px</span> -<span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">102</span>, <span class="number">68</span>, <span class="number">68</span>, <span class="number">0.00</span>);</span><br><span class="line">    <span class="attr">--heo-shadow-light2black</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">12px</span> -<span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">102</span>, <span class="number">68</span>, <span class="number">68</span>, <span class="number">0.00</span>);</span><br><span class="line">    <span class="attr">--heo-card-border</span>: <span class="number">#e3e8f7</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=dark]</span> &#123;</span><br><span class="line">    <span class="attr">--heo-theme</span>: <span class="number">#0084FF</span>;</span><br><span class="line">    <span class="attr">--heo-theme-op</span>: <span class="number">#0084FF23</span>;</span><br><span class="line">    <span class="attr">--heo-blue</span>: <span class="number">#0084FF</span>;</span><br><span class="line">    <span class="attr">--heo-red</span>: <span class="number">#FF3842</span>;</span><br><span class="line">    <span class="attr">--heo-pink</span>: <span class="number">#FF7C7C</span>;</span><br><span class="line">    <span class="attr">--heo-green</span>: <span class="number">#57bd6a</span>;</span><br><span class="line">    <span class="attr">--heo-fontcolor</span>: <span class="number">#F7F7FA</span>;</span><br><span class="line">    <span class="attr">--heo-background</span>: <span class="number">#18171d</span>;</span><br><span class="line">    <span class="attr">--heo-reverse</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attr">--heo-maskbg</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.6</span>);</span><br><span class="line">    <span class="attr">--heo-maskbgdeep</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.85</span>);</span><br><span class="line">    <span class="attr">--heo-hovertext</span>: <span class="number">#0A84FF</span>;</span><br><span class="line">    <span class="attr">--heo-ahoverbg</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attr">--heo-lighttext</span>: <span class="number">#f2b94b</span>;</span><br><span class="line">    <span class="attr">--heo-secondtext</span>: <span class="number">#a1a2b8</span>;</span><br><span class="line">    <span class="attr">--heo-scrollbar</span>: <span class="built_in">rgba</span>(<span class="number">200</span>, <span class="number">200</span>, <span class="number">223</span>, <span class="number">0.4</span>);</span><br><span class="line">    <span class="attr">--heo-card-btn-bg</span>: <span class="number">#30343f</span>;</span><br><span class="line">    <span class="attr">--heo-post-blockquote-bg</span>: <span class="number">#000</span>;</span><br><span class="line">    <span class="attr">--heo-post-tabs-bg</span>: <span class="number">#121212</span>;</span><br><span class="line">    <span class="attr">--heo-secondbg</span>: <span class="number">#30343f</span>;</span><br><span class="line">    <span class="attr">--heo-shadow-nav</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">20px</span> <span class="number">0px</span> <span class="built_in">rgba</span>(<span class="number">28</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">0.4</span>);</span><br><span class="line">    <span class="attr">--heo-card-bg</span>: <span class="number">#1d1b26</span>;</span><br><span class="line">    <span class="attr">--heo-shadow-lightblack</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">12px</span> -<span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">102</span>, <span class="number">68</span>, <span class="number">68</span>, <span class="number">0.0</span>);</span><br><span class="line">    <span class="attr">--heo-shadow-light2black</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">12px</span> -<span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">102</span>, <span class="number">68</span>, <span class="number">68</span>, <span class="number">0.0</span>);</span><br><span class="line">    <span class="attr">--heo-card-border</span>: <span class="number">#42444a</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">        <span class="attr">--style-border</span>: <span class="number">0px</span> solid <span class="built_in">var</span>(--heo-card-border);</span><br><span class="line">        <span class="attr">--style-border-hover</span>: <span class="number">0px</span> solid <span class="built_in">var</span>(--heo-theme);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 首页分类条展示 */</span></span><br><span class="line"><span class="selector-id">#category-bar</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.4rem</span> <span class="number">1rem</span> <span class="number">0.4rem</span> <span class="number">0.5rem</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#FFFFFF</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--card-box-shadow);</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="comment">/* margin-bottom: 1rem; */</span></span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">1rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#category-bar</span> &#123;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#category</span> <span class="selector-id">#category-bar</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#category</span> <span class="selector-tag">a</span><span class="selector-class">.category-bar-item</span><span class="selector-class">.select</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.category-in-bar</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.category-in-bar-tips</span> &#123;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">1rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.category-bar-items</span> &#123;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow-x</span>: scroll;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.category-bar-items</span>::-webkit-scrollbar &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.category-bar-item</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.1rem</span> <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0.25rem</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#363636</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.category-bar-item</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--heo-main);</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--heo-white);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.category-bar-item</span><span class="selector-class">.select</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--heo-main);</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--heo-white);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.category-bar-more</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#363636</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="http://blog.aqcoder.cn/posts/6e665e82/">记录一次因为pjax导致js无法生效以及解决方案 | aqcoder</a></p><h2 id="添加文章置顶"><a href="#添加文章置顶" class="headerlink" title="添加文章置顶"></a>添加文章置顶</h2><p>原主题置顶方案：</p><p><img src="/./img/b/b20a/6358ea63cd172.png" alt="原主题置顶方案"></p><p>设置方法参考<a href="http://localhost:4000/posts/447d/#%E6%96%87%E7%AB%A0%E7%BD%AE%E9%A1%B6">Butterfly博客主题搭建系列：基础教程 | aqcoder</a></p><p>这种方法会有一个缺陷：当置顶文章过多导致一页都置顶文章，观感不好，可参考：<a href="https://zfe.space/post/hexo-swiper.html">教程：hexo-swiper 文章置顶插件 | 小冰博客</a></p><p>完成效果预览：</p><p><img src="/./img/b/b20a/6358e89a3dc55.png" alt="文章置顶效果"></p><h3 id="npm安装插件"><a href="#npm安装插件" class="headerlink" title="npm安装插件"></a>npm安装插件</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo<span class="literal">-butterfly-swiper</span> <span class="literal">--save</span></span><br></pre></td></tr></table></figure><p>在网站根目录<code>_config.yml</code>新增配置项：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hexo-butterfly-swiper</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/8e1264d1/</span></span><br><span class="line"><span class="attr">swiper:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 开关</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span> <span class="comment">#过滤器优先权</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">all</span> <span class="comment"># 应用页面</span></span><br><span class="line">  <span class="attr">timemode:</span> <span class="string">date</span> <span class="comment">#date/updated</span></span><br><span class="line">  <span class="attr">layout:</span> <span class="comment"># 挂载容器类型</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">recent-posts</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">default_descr:</span> <span class="string">再怎么看我也不知道怎么描述它的啦！</span></span><br><span class="line">  <span class="attr">swiper_css:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css</span> <span class="comment">#swiper css依赖</span></span><br><span class="line">  <span class="attr">swiper_js:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js</span> <span class="comment">#swiper js依赖</span></span><br><span class="line">  <span class="attr">custom_css:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css</span> <span class="comment"># 适配主题样式补丁</span></span><br><span class="line">  <span class="attr">custom_js:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js</span> <span class="comment"># swiper初始化方法</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">参数</th><th align="left">备选值&#x2F;类型</th><th align="left">释义</th></tr></thead><tbody><tr><td align="left">priority</td><td align="left">number</td><td align="left">【可选】过滤器优先级，数值越小，执行越早，默认为10，选填</td></tr><tr><td align="left">enable</td><td align="left">true&#x2F;false</td><td align="left">【必选】控制开关</td></tr><tr><td align="left">enable_page</td><td align="left">path&#x2F;all</td><td align="left">【可选】填写想要应用的页面的相对路径（即路由地址）,如根目录就填’&#x2F;‘,分类页面就填’&#x2F;categories&#x2F;‘。若要应用于所有页面，就填’all’，默认为all</td></tr><tr><td align="left">timemode</td><td align="left">date&#x2F;updated</td><td align="left">【可选】时间显示，date为显示创建日期，updated为显示更新日期,默认为date</td></tr><tr><td align="left">layout.type</td><td align="left">id&#x2F;class</td><td align="left">【可选】挂载容器类型，填写id或class，不填则默认为id</td></tr><tr><td align="left">layout.name</td><td align="left">text</td><td align="left">【必选】挂载容器名称</td></tr><tr><td align="left">layout.index</td><td align="left">0和正整数</td><td align="left">【可选】前提是layout.type为class，因为同一页面可能有多个class，此项用来确认究竟排在第几个顺位</td></tr><tr><td align="left">default_descr</td><td align="left">text</td><td align="left">默认文章描述</td></tr><tr><td align="left">swiper_css</td><td align="left">url</td><td align="left">【可选】自定义的swiper依赖项css链接</td></tr><tr><td align="left">swiper_js</td><td align="left">url</td><td align="left">【可选】自定义的swiper依赖项加js链接</td></tr><tr><td align="left">custom_css</td><td align="left">url</td><td align="left">【可选】适配主题样式补丁</td></tr><tr><td align="left">custom_js</td><td align="left">url</td><td align="left">【可选】swiper初始化方法</td></tr></tbody></table><h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><p>在文章的<code>front_matter</code>中添加<code>swiper_index</code>配置项即可。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 文章标题</span><br><span class="line">date: 创建日期</span><br><span class="line">updated: 更新日期</span><br><span class="line">cover: 文章封面</span><br><span class="line">description: 文章描述</span><br><span class="line"><span class="section">swiper<span class="emphasis">_index: 1 #置顶轮播图顺序，非负整数，数字越大越靠前</span></span></span><br><span class="line"><span class="emphasis"><span class="section">---</span></span></span><br></pre></td></tr></table></figure><h2 id="文章双栏"><a href="#文章双栏" class="headerlink" title="文章双栏"></a>文章双栏</h2><p><img src="/./img/b/b20a/635a9b429859c.png" alt="文章双栏"></p><p>原文：<a href="https://zfe.space/post/hexo-butterfly-article-double-row.html">教程：butterfly 主题文章双栏布局插件 | 小冰博客</a></p><p>npm安装</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo<span class="literal">-butterfly-article-double-row</span> <span class="literal">--save</span></span><br></pre></td></tr></table></figure><p>新增网站根目录<code>_config.yml</code> 配置项：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">butterfly_article_double_row:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="魔改分类页面"><a href="#魔改分类页面" class="headerlink" title="魔改分类页面"></a>魔改分类页面</h2><p><img src="/./img/b/b20a/635b8026b9ba6.png" alt="分类页面"></p><p>原文：<a href="https://leeay.gitee.io/2022/08/22/hexo/hexo%E5%8D%9A%E5%AE%A2butterfly%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96css%E5%A4%A7%E7%A4%BC%E5%8C%85/">hexo博客butterfly主题美化css大礼包 | space of Lee ！</a></p><p>自定义css：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/* 分类页面样式 */</span></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-class">.category-list-item</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">48%</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0.5%</span> <span class="number">2%</span> <span class="number">0.5%</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--border-radius);</span><br><span class="line">    -webkit-<span class="attribute">box-shadow</span>: <span class="built_in">rgb</span>(<span class="number">50</span> <span class="number">50</span> <span class="number">50</span> / <span class="number">30%</span>) <span class="number">50px</span> <span class="number">50px</span> <span class="number">50px</span> <span class="number">50px</span> inset;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="built_in">rgb</span>(<span class="number">50</span> <span class="number">50</span> <span class="number">50</span> / <span class="number">30%</span>) <span class="number">50px</span> <span class="number">50px</span> <span class="number">50px</span> <span class="number">50px</span> inset;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">640px</span>) &#123;</span><br><span class="line">    <span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-class">.category-list-item</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">95%</span>;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">        <span class="attribute">margin-top</span>: <span class="number">3px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-class">.category-list-item</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-class">.category-list-item</span> <span class="selector-class">.category-list-link</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.5rem</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">0.4rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-class">.category-list-item</span> <span class="selector-class">.category-list-link</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-class">.category-list-item</span> <span class="selector-class">.category-list-link</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">60%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">1%</span>;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: all <span class="number">0.6s</span>;</span><br><span class="line">    -moz-<span class="attribute">transition</span>: all <span class="number">0.6s</span>;</span><br><span class="line">    -o-<span class="attribute">transition</span>: all <span class="number">0.6s</span>;</span><br><span class="line">    -ms-<span class="attribute">transition</span>: all <span class="number">0.6s</span>;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.6s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-class">.category-list-item</span> <span class="selector-class">.category-list-count</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-class">.category-list-item</span> <span class="selector-class">.category-list-count</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;\f02d&quot;</span>;</span><br><span class="line">    <span class="attribute">padding-right</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">font-family</span>: <span class="string">&quot;Font Awesome 6 Free&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* #page .category-list-count::before, */</span></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-list-count</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span> <span class="selector-tag">a</span><span class="selector-class">.category-list-link</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">4rem</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">4rem</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">15deg</span>);</span><br><span class="line">    -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">15deg</span>);</span><br><span class="line">    -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">15deg</span>);</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">15deg</span>);</span><br><span class="line">    -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">15deg</span>);</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: all <span class="number">0.6s</span>;</span><br><span class="line">    -moz-<span class="attribute">transition</span>: all <span class="number">0.6s</span>;</span><br><span class="line">    -o-<span class="attribute">transition</span>: all <span class="number">0.6s</span>;</span><br><span class="line">    -ms-<span class="attribute">transition</span>: all <span class="number">0.6s</span>;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.6s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span> <span class="selector-tag">a</span><span class="selector-class">.category-list-link</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0.9</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">    -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">    -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">    -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 优秀文章 */</span></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#4074f6</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(to right, <span class="number">#667db6</span>, <span class="number">#0082c8</span>, <span class="number">#0082c8</span>, <span class="number">#667db6</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>) <span class="selector-tag">a</span><span class="selector-class">.category-list-link</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;📑&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 博客总结 */</span></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(left, <span class="number">#ba52ed</span>, <span class="number">#ff99fe</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-moz-linear-gradient</span>(left, <span class="number">#ba52ed</span>, <span class="number">#ff99fe</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-o-linear-gradient</span>(left, <span class="number">#ba52ed</span>, <span class="number">#ff99fe</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-ms-linear-gradient</span>(left, <span class="number">#ba52ed</span>, <span class="number">#ff99fe</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#ba52ed</span>, <span class="number">#ff99fe</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) <span class="selector-tag">a</span><span class="selector-class">.category-list-link</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;📚&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 博客搭建 */</span></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>) &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(left, <span class="number">#6639a6</span>, <span class="number">#3490de</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-moz-linear-gradient</span>(left, <span class="number">#6639a6</span>, <span class="number">#3490de</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-o-linear-gradient</span>(left, <span class="number">#6639a6</span>, <span class="number">#3490de</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-ms-linear-gradient</span>(left, <span class="number">#6639a6</span>, <span class="number">#3490de</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#6639a6</span>, <span class="number">#3490de</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>) <span class="selector-tag">a</span><span class="selector-class">.category-list-link</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;🦋&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">4</span>) &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(right, <span class="number">#38ef7d</span>, <span class="number">#11998e</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-moz-linear-gradient</span>(right, <span class="number">#38ef7d</span>, <span class="number">#11998e</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-o-linear-gradient</span>(right, <span class="number">#38ef7d</span>, <span class="number">#11998e</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-ms-linear-gradient</span>(right, <span class="number">#38ef7d</span>, <span class="number">#11998e</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to left, <span class="number">#38ef7d</span>, <span class="number">#11998e</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">4</span>) <span class="selector-tag">a</span><span class="selector-class">.category-list-link</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;📔&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 实用教程 */</span></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">5</span>) &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(left, <span class="number">#b91d73</span>, <span class="number">#f953c6</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-moz-linear-gradient</span>(left, <span class="number">#b91d73</span>, <span class="number">#f953c6</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-o-linear-gradient</span>(left, <span class="number">#b91d73</span>, <span class="number">#f953c6</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-ms-linear-gradient</span>(left, <span class="number">#b91d73</span>, <span class="number">#f953c6</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#b91d73</span>, <span class="number">#f953c6</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">5</span>) <span class="selector-tag">a</span><span class="selector-class">.category-list-link</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;✨&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 敲敲代码 */</span></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">6</span>) &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(left, <span class="number">#f12711</span>, <span class="number">#f5af19</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-moz-linear-gradient</span>(left, <span class="number">#f12711</span>, <span class="number">#f5af19</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-o-linear-gradient</span>(left, <span class="number">#f12711</span>, <span class="number">#f5af19</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-ms-linear-gradient</span>(left, <span class="number">#f12711</span>, <span class="number">#f5af19</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#f12711</span>, <span class="number">#f5af19</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">6</span>) <span class="selector-tag">a</span><span class="selector-class">.category-list-link</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;💻&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生活杂谈 */</span></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">7</span>) &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(left, <span class="number">#009ad6</span>, <span class="number">#1b315e</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-moz-linear-gradient</span>(left, <span class="number">#009ad6</span>, <span class="number">#1b315e</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-o-linear-gradient</span>(left, <span class="number">#009ad6</span>, <span class="number">#1b315e</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-ms-linear-gradient</span>(left, <span class="number">#009ad6</span>, <span class="number">#1b315e</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#009ad6</span>, <span class="number">#1b315e</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span> <span class="selector-class">.category-lists</span> <span class="selector-class">.category-list</span> <span class="selector-tag">li</span><span class="selector-class">.category-list-item</span><span class="selector-pseudo">:nth-child</span>(<span class="number">7</span>) <span class="selector-tag">a</span><span class="selector-class">.category-list-link</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;💬&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="魔改标签页面"><a href="#魔改标签页面" class="headerlink" title="魔改标签页面"></a>魔改标签页面</h2><p><img src="/./img/b/b20a/635b912e5a525.png" alt="魔改标签页面"></p><p>原文：<a href="https://blog.leonus.cn/2022/tags.html">Hexo博客标签的魔改 | Leonus</a></p><p>修改<code>butterfly\scripts\helpers\page.js</code>文件：</p><p>如果你只是想添加一个数量的话，在第52行的<code>$&#123;tag.name&#125;</code>后增加 <code>($&#123;tag.length&#125;)</code>，如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result += <span class="string">`&lt;a href=&quot;<span class="subst">$&#123;env.url_for(tag.path)&#125;</span>&quot; style=&quot;<span class="subst">$&#123;style&#125;</span>&quot;&gt;<span class="subst">$&#123;tag.name&#125;</span> (<span class="subst">$&#123;tag.length&#125;</span>)&lt;/a&gt;`</span></span><br></pre></td></tr></table></figure><p>如果你不想要字体有大有小的话，可以采用<code>css + !important</code>的方法，也可以选择删除如下代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 需要删除的</span></span><br><span class="line"><span class="keyword">const</span> minfontsize = options.<span class="property">minfontsize</span> </span><br><span class="line"><span class="keyword">const</span> maxfontsize = options.<span class="property">maxfontsize</span> </span><br><span class="line"><span class="keyword">const</span> unit = options.<span class="property">unit</span> || <span class="string">&#x27;px&#x27;</span> </span><br><span class="line"><span class="keyword">const</span> sizes = []</span><br><span class="line">source.<span class="title function_">sort</span>(<span class="string">&#x27;length&#x27;</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">tag</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; length &#125; = tag</span><br><span class="line">  <span class="keyword">if</span> (sizes.<span class="title function_">includes</span>(length)) <span class="keyword">return</span></span><br><span class="line">  sizes.<span class="title function_">push</span>(length)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> length = sizes.<span class="property">length</span> - <span class="number">1</span></span><br><span class="line"><span class="keyword">const</span> ratio = length ? sizes.<span class="title function_">indexOf</span>(tag.<span class="property">length</span>) / length : <span class="number">0</span></span><br><span class="line"><span class="keyword">const</span> size = minfontsize + ((maxfontsize - minfontsize) * ratio)</span><br><span class="line"><span class="keyword">let</span> style = <span class="string">`font-size: <span class="subst">$&#123;<span class="built_in">parseFloat</span>(size.toFixed(<span class="number">2</span>))&#125;</span><span class="subst">$&#123;unit&#125;</span>;`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 最后需要修改以下代码</span></span><br><span class="line">source.<span class="title function_">forEach</span>(<span class="function"><span class="params">tag</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> color = <span class="string">&#x27;rgb(&#x27;</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">201</span>) + <span class="string">&#x27;, &#x27;</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">201</span>) + <span class="string">&#x27;, &#x27;</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">201</span>) + <span class="string">&#x27;)&#x27;</span> <span class="comment">// 0,0,0 -&gt; 200,200,200</span></span><br><span class="line">  <span class="keyword">let</span> style = <span class="string">` color: <span class="subst">$&#123;color&#125;</span>`</span></span><br><span class="line">  result += <span class="string">`&lt;a href=&quot;<span class="subst">$&#123;env.url_for(tag.path)&#125;</span>&quot; style=&quot;<span class="subst">$&#123;style&#125;</span>&quot;&gt;<span class="subst">$&#123;tag.name&#125;</span>&lt;/a&gt;`</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>如果你还想再给标签从大到小排个序的话，那么就是我正在使用的这个了：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="property">extend</span>.<span class="property">helper</span>.<span class="title function_">register</span>(<span class="string">&#x27;cloudTags&#x27;</span>, <span class="keyword">function</span>(<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> env = <span class="variable language_">this</span></span><br><span class="line">    <span class="keyword">let</span> source = options.<span class="property">source</span></span><br><span class="line">    <span class="keyword">const</span> limit = options.<span class="property">limit</span></span><br><span class="line">    <span class="comment">// 从小到大排序然后再翻转，即从大到小排序</span></span><br><span class="line">    source = source.<span class="title function_">sort</span>(<span class="string">&#x27;length&#x27;</span>).<span class="title function_">reverse</span>()</span><br><span class="line">    <span class="keyword">let</span> result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> (limit &gt; <span class="number">0</span>) source = source.<span class="title function_">limit</span>(limit)</span><br><span class="line"></span><br><span class="line">    source.<span class="title function_">forEach</span>(<span class="function"><span class="params">tag</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> color = <span class="string">&#x27;rgb(&#x27;</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">201</span>) + <span class="string">&#x27;, &#x27;</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">201</span>) + <span class="string">&#x27;, &#x27;</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">201</span>) + <span class="string">&#x27;)&#x27;</span> <span class="comment">// 0,0,0 -&gt; 200,200,200</span></span><br><span class="line">        result += <span class="string">`&lt;a href=&quot;<span class="subst">$&#123;env.url_for(tag.path)&#125;</span>&quot; style=&quot;color: <span class="subst">$&#123;color&#125;</span>&quot;&gt;<span class="subst">$&#123;tag.name&#125;</span> (<span class="subst">$&#123;tag.length&#125;</span>)&lt;/a&gt;`</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>修改样式</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/* 标签 */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-tag-cloud</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.5</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tag-cloud-list</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.5</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.2rem</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="魔改友链页面"><a href="#魔改友链页面" class="headerlink" title="魔改友链页面"></a>魔改友链页面</h2><p><img src="/./img/b/b20a/635f597c0175a.gif" alt="魔改友链页面"></p><p>原文：<a href="https://blog.leonus.cn/2022/link.html">Hexo博客友链样式修改 | Leonus</a></p><p>友链创建教程：<a href="https://butterfly.js.org/posts/dc584b87/#%E5%8F%8B%E6%83%85%E9%8F%88%E6%8E%A5">Butterfly 安裝文檔(二) 主題頁面 | Butterfly</a></p><h3 id="修改源码"><a href="#修改源码" class="headerlink" title="修改源码"></a>修改源码</h3><p>在<code>HexoRoot/source</code>新建<code>_data</code>文件夹，新建<code>link.yml</code>，格式类似以下代码：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">友情链接</span></span><br><span class="line">  <span class="attr">class_desc:</span> <span class="string">博主</span></span><br><span class="line">  <span class="attr">link_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">枫叶</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://blog.aqcoder.cn</span></span><br><span class="line">      <span class="attr">avatar:</span> <span class="string">https://blog.aqcoder.cn/img/avatar.png</span></span><br><span class="line">      <span class="attr">descr:</span> <span class="string">分享知识，认识世界</span></span><br></pre></td></tr></table></figure><p>修改<code>butterfly\layout\includes\page\flink.pug</code>：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if site.data.link</span><br><span class="line">  - let result = &quot;&quot;</span><br><span class="line">  each i in site.data.link</span><br><span class="line"><span class="deletion">-    - let className = i.class_name ? markdown(`## $&#123;i.class_name&#125;`) : &quot;&quot; </span></span><br><span class="line"><span class="addition">+    - let className = i.class_name ? markdown(`## $&#123;i.class_name&#125; ($&#123;i.link_list.length&#125;)`) : &quot;&quot; </span></span><br><span class="line">    - let classDesc = i.class_desc ? `&lt;div class=&quot;flink-desc&quot;&gt;$&#123;i.class_desc&#125;&lt;/div&gt;` : &quot;&quot;</span><br></pre></td></tr></table></figure><p>修改<code>butterfly\layout\includes\page\flink.pug</code> 的第54行，使用<code>flink_url</code>的修改第24行：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># 使用flink_url，修改的代码第24行</span><br><span class="line">listResult += `</span><br><span class="line">  &lt;div class=&quot;flink-list-item&quot;&gt;</span><br><span class="line"><span class="deletion">-    &lt;a href=&quot;$&#123;lists[j].link&#125;&quot; title=&quot;$&#123;lists[j].name&#125;&quot; target=&quot;_blank&quot;&gt;</span></span><br><span class="line"><span class="addition">+    &lt;a href=&quot;$&#123;lists[j].link&#125;&quot; title=&quot;$&#123;lists[j].name&#125;&quot; target=&quot;_blank&quot;&gt;</span></span><br><span class="line">      &lt;div class=&quot;flink-item-icon&quot;&gt;</span><br><span class="line">        &lt;img class=&quot;no-lightbox&quot; src=&quot;$&#123;lists[j].avatar&#125;&quot; onerror=&#x27;this.onerror=null;this.src=&quot;!&#123;url_for(theme.error_img.flink)&#125;&quot;&#x27; alt=&quot;$&#123;lists[j].name&#125;&quot; /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;flink-item-name&quot;&gt;$&#123;lists[j].name&#125;&lt;/div&gt; </span><br><span class="line">      &lt;div class=&quot;flink-item-desc&quot; title=&quot;$&#123;lists[j].descr&#125;&quot;&gt;$&#123;lists[j].descr&#125;&lt;/div&gt;</span><br><span class="line">    &lt;/a&gt;</span><br><span class="line">  &lt;/div&gt;`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 使用_data，修改的代码第54行</span><br><span class="line">  listResult += `</span><br><span class="line">    &lt;div class=&quot;flink-list-item&quot;&gt;</span><br><span class="line"><span class="deletion">-      &lt;a href=&quot;$&#123;j.link&#125;&quot; title=&quot;$&#123;j.name&#125;&quot; target=&quot;_blank&quot;&gt;</span></span><br><span class="line"><span class="addition">+      &lt;a href=&quot;$&#123;j.link&#125;&quot; title=&quot;$&#123;j.name&#125;&quot; target=&quot;_blank&quot;&gt;</span></span><br><span class="line">        &lt;div class=&quot;flink-item-icon&quot;&gt;</span><br><span class="line">          &lt;img class=&quot;no-lightbox&quot; src=&quot;$&#123;j.avatar&#125;&quot; onerror=&#x27;this.onerror=null;this.src=&quot;$&#123;url_for(theme.error_img.flink)&#125;&quot;&#x27; alt=&quot;$&#123;j.name&#125;&quot; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;flink-item-name&quot;&gt;$&#123;j.name&#125;&lt;/div&gt; </span><br><span class="line">        &lt;div class=&quot;flink-item-desc&quot; title=&quot;$&#123;j.descr&#125;&quot;&gt;$&#123;j.descr&#125;&lt;/div&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;`</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="添加自定义css"><a href="#添加自定义css" class="headerlink" title="添加自定义css"></a>添加自定义css</h3><p>在<code>HexoRoot/source</code>新建<code>css</code>文件夹，新建<code>links.css</code>：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 头像微调 */</span></span><br><span class="line"><span class="selector-class">.flink-item-icon</span> &#123;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">transition</span>: .<span class="number">5s</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.flink-item-name</span>,</span><br><span class="line"><span class="selector-class">.flink-item-desc</span> &#123;</span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="number">10px</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 去掉原来自带的before */</span></span><br><span class="line"><span class="selector-id">#article-container</span> <span class="selector-class">.flink</span> <span class="selector-class">.flink-list</span>&gt;<span class="selector-class">.flink-list-item</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 鼠标经过改变背景 */</span></span><br><span class="line"><span class="selector-id">#article-container</span> <span class="selector-class">.flink</span> <span class="selector-class">.flink-list</span>&gt;<span class="selector-class">.flink-list-item</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#61bcf2cc</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 鼠标经过改变文字颜色 */</span></span><br><span class="line"><span class="selector-id">#article-container</span> <span class="selector-class">.flink</span> <span class="selector-class">.flink-list</span>&gt;<span class="selector-class">.flink-list-item</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: white <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 鼠标经过头像滚动 */</span></span><br><span class="line"><span class="selector-id">#article-container</span> <span class="selector-class">.flink</span> <span class="selector-class">.flink-list</span>&gt;<span class="selector-class">.flink-list-item</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.flink-item-icon</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">60px</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: -<span class="number">70px</span>;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">180deg</span>);</span><br><span class="line">    -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">180deg</span>);</span><br><span class="line">    -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">180deg</span>);</span><br><span class="line">    -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">180deg</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">180deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在<code>_config.butterfly.yml</code>引入<code>css</code>：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line"><span class="addition">+    - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/style.css?1&quot;&gt;</span></span><br><span class="line">  bottom:</span><br></pre></td></tr></table></figure><h2 id="添加侧边栏访问统计"><a href="#添加侧边栏访问统计" class="headerlink" title="添加侧边栏访问统计"></a>添加侧边栏访问统计</h2><p><img src="/./img/b/b20a/635a9b7975053.png" alt="image-20221027225344672"></p><p>原文：<a href="https://blog.leonus.cn/2022/51la.html">51la统计美化 | Leonus</a></p><h3 id="重点"><a href="#重点" class="headerlink" title="重点"></a>重点</h3><p>在<code>md</code>文件中添加以下代码：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">## 博客统计</span></span><br><span class="line"></span><br><span class="line"><span class="section">### 访客统计</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;pvisitor&quot;</span>&gt;</span></span></span><br><span class="line"><span class="code">    &lt;div class=&quot;content&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">&lt;/div&gt;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="section">### 访客信息</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;ivisitor&quot;</span>&gt;</span></span></span><br><span class="line"><span class="code">&lt;div class=&quot;content&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">&lt;/div&gt;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/css/visitor.css&quot;</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line">fetch(&#x27;https://v6-widget.51.la/v6/KRFNvLFZwSFuA2NM/quote.js&#x27;).then(res =&gt; res.text()).then((data) =&gt; &#123;</span><br><span class="line"><span class="code">    let title = [&#x27;最近活跃访客&#x27;, &#x27;今日访问人数&#x27;, &#x27;今日访问量&#x27;, &#x27;昨日人数&#x27;, &#x27;昨日访问量&#x27;, &#x27;本月访问量&#x27;, &#x27;总访问量&#x27;]</span></span><br><span class="line"><span class="code">    let num = data.match(/(?&lt;=&lt;\/span&gt;&lt;span&gt;).*?(?=&lt;\/span&gt;&lt;\/p&gt;)/g)</span></span><br><span class="line"><span class="code">    let s = document.querySelectorAll(&#x27;#pvisitor .content&#x27;)[0]</span></span><br><span class="line"><span class="code">    for (let i = 0; i &lt; num.length; i++) &#123;</span></span><br><span class="line"><span class="code">        if (i == 3 || i == 4) continue;</span></span><br><span class="line"><span class="code">        s.innerHTML += &#x27;&lt;div&gt;&lt;span&gt;&#x27; + title[i] + &#x27;&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;&#x27; + num[i] + &#x27;&lt;/span&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code">&#125;);</span></span><br><span class="line"><span class="code">fetch(&#x27;https://api.vvhan.com/api/visitor.info&#x27;).then(res =&gt; res.json()).then((data) =&gt; &#123; //获取访客信息</span></span><br><span class="line"><span class="code">    let c = document.querySelectorAll(&#x27;#ivisitor .content&#x27;)[0]</span></span><br><span class="line"><span class="code">    var system = data[&#x27;system&#x27;]</span></span><br><span class="line"><span class="code">    var addr = data[&#x27;location&#x27;]===&#x27;---&#x27;?&#x27;未知&#x27;:data[&#x27;location&#x27;]</span></span><br><span class="line"><span class="code">    var ipaddr = data[&#x27;ip&#x27;]</span></span><br><span class="line"><span class="code">    var weather = data[&#x27;tq&#x27;]+&quot;&amp;nbsp&quot;+data[&#x27;low&#x27;].replace(&quot;最低 &quot;,&quot;&quot;)+&quot;~&quot;+data[&#x27;high&#x27;].replace(&quot;最高 &quot;,&quot;&quot;)</span></span><br><span class="line"><span class="code">    var tip = data[&#x27;tip&#x27;]</span></span><br><span class="line"><span class="code">    system = system===&quot;未知操作系统&quot;?&quot;移动端&quot;:system</span></span><br><span class="line"><span class="code">    addr = addr===null?&quot;未知&quot;:addr</span></span><br><span class="line"><span class="code">    ipaddr = ipaddr===null?&quot;未知&quot;:ipaddr</span></span><br><span class="line"><span class="code">    weather = weather===null?&quot;未知&quot;:weather</span></span><br><span class="line"><span class="code">    tip = tip===null?&quot;未知&quot;:tip</span></span><br><span class="line"><span class="code">    c.innerHTML = `&lt;div&gt;&lt;span&gt;系统&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;$&#123;system&#125;&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">    &lt;div&gt;&lt;span&gt;地址&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;$&#123;addr&#125;&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">    &lt;div&gt;&lt;span&gt;IP地址&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;$&#123;ipaddr&#125;&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">    &lt;div&gt;&lt;span&gt;天气&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;$&#123;weather&#125;&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">    &lt;div&gt;&lt;span&gt;温馨提示&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;</span></span><br><span class="line"><span class="code">        &lt;div style=&quot;width:100% !important&quot;&gt;&lt;span style=&quot;font-size:1.5rem;font-weight:bold;display:block;&quot;&gt;$&#123;tip&#125;&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">    &lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="code">    `</span></span><br><span class="line"><span class="code">&#125;);</span></span><br><span class="line"><span class="code">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>这里我修改了部分代码以适配我的博客</p><h3 id="添加侧边栏统计"><a href="#添加侧边栏统计" class="headerlink" title="添加侧边栏统计"></a>添加侧边栏统计</h3><p>除此之外，根据<a href="https://blog.leonus.cn/">大佬</a>记录的代码，我增加了侧边栏统计的样式</p><p><img src="/./img/b20a/1661956151336.png" alt="侧边栏统计"></p><div class="note info modern"><p>自定义侧边栏可参考官方文档：<a href="https://butterfly.js.org/posts/ea33ab97/">https://butterfly.js.org/posts/ea33ab97/</a></p></div><p>步骤如下：</p><p>1、新建<code>博客根目录/source/_data/widget.yml</code>，添加代码：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span></span><br><span class="line">    <span class="attr">id_name:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">访问统计</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">iconfont</span> <span class="string">icon-tongji</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">html:</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/visitor.css&quot;&gt;&lt;div</span> <span class="string">id=&quot;visitor&quot;&gt;&lt;div</span> <span class="string">class=&quot;content&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;script</span> <span class="string">src=&quot;/js/visitor.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>2、新建<code>博客根目录/source/js/visitor.js</code>，添加代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 侧边栏访问统计</span></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;https://v6-widget.51.la/v6/KRFNvLFZwSFuA2NM/quote.js&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">text</span>()).<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">let</span> title = [<span class="string">&#x27;最近活跃访客&#x27;</span>, <span class="string">&#x27;今日访问人数&#x27;</span>, <span class="string">&#x27;今日访问量&#x27;</span>, <span class="string">&#x27;昨日人数&#x27;</span>, <span class="string">&#x27;昨日访问量&#x27;</span>, <span class="string">&#x27;本月访问量&#x27;</span>, <span class="string">&#x27;总访问量&#x27;</span>]</span><br><span class="line"><span class="keyword">let</span> num = data.<span class="title function_">match</span>(<span class="regexp">/(?&lt;=&lt;\/span&gt;&lt;span&gt;).*?(?=&lt;\/span&gt;&lt;\/p&gt;)/g</span>)</span><br><span class="line"><span class="keyword">let</span> s = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;#visitor .content&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> (s !== <span class="literal">undefined</span>) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; num.<span class="property">length</span>; i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (i == <span class="number">3</span> || i == <span class="number">4</span>) <span class="keyword">continue</span>;</span><br><span class="line">s.<span class="property">innerHTML</span> += <span class="string">&#x27;&lt;div&gt;&lt;p&gt;&lt;span id=name&gt;&#x27;</span> + title[i] + <span class="string">&#x27;&lt;/span&gt;&lt;span class=&quot;num&quot;&gt;&#x27;</span> + num[i] + <span class="string">&#x27;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;); </span><br></pre></td></tr></table></figure><p><code>KRFNvLFZwSFuA2NM</code>改为自己的，获取方式可参照：<a href="/posts/c90c/#%E4%BE%A7%E8%BE%B9%E6%A0%8F%E8%AE%BF%E9%97%AE%E7%BB%9F%E8%AE%A1">Butterfly 博客搭建（进阶教程）</a></p><p>3、新建<code>博客根目录/source/css/visitor.css</code>，添加代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 关于页面访问统计、访客信息样式 */</span></span><br><span class="line"><span class="selector-id">#pvisitor</span>,</span><br><span class="line"><span class="selector-id">#ivisitor</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--font-color);</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--card-bg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-id">#pvisitor</span> <span class="selector-class">.content</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-id">#ivisitor</span> <span class="selector-class">.content</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">    <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-id">#pvisitor</span> <span class="selector-tag">a</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-id">#ivisitor</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#pvisitor</span> <span class="selector-class">.content</span> <span class="selector-tag">div</span>,</span><br><span class="line"><span class="selector-id">#ivisitor</span> <span class="selector-class">.content</span> <span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#pvisitor</span> <span class="selector-tag">div</span> <span class="selector-tag">span</span>,</span><br><span class="line"><span class="selector-id">#ivisitor</span> <span class="selector-tag">div</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.3</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#pvisitor</span> <span class="selector-tag">div</span> <span class="selector-class">.num</span>,</span><br><span class="line"><span class="selector-id">#ivisitor</span> <span class="selector-tag">div</span> <span class="selector-class">.num</span> &#123;</span><br><span class="line">    <span class="attribute">letter-spacing</span>: <span class="number">1px</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.6rem</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: .<span class="number">8rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 侧边栏访问统计样式 */</span></span><br><span class="line"><span class="selector-id">#visitor</span> &#123;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0px</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.7</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">rgb</span>(<span class="number">51</span>, <span class="number">51</span>, <span class="number">51</span>) <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>) <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">16px</span> <span class="number">0px</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>) <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">height</span>: auto <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#visitor</span> <span class="selector-tag">div</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0px</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: left <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#visitor</span> <span class="selector-tag">div</span> <span class="selector-id">#name</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">rgb</span>(<span class="number">137</span>, <span class="number">137</span>, <span class="number">137</span>) <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">display</span>: inline-block <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#visitor</span> <span class="selector-tag">div</span> <span class="selector-class">.num</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">rgb</span>(<span class="number">51</span>, <span class="number">51</span>, <span class="number">51</span>) <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">float</span>: right <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="添加文章统计图"><a href="#添加文章统计图" class="headerlink" title="添加文章统计图"></a>添加文章统计图</h2><p>原文：<a href="https://blog.eurkon.com/post/1213ef82.html">Hexo 博客文章统计图 | Eurkon</a></p><h3 id="重点-1"><a href="#重点-1" class="headerlink" title="重点"></a>重点</h3><p>在 <code>[Blogroot]\themes\butterfly\scripts\helpers\</code> 目录下新建 <code>charts.js</code> 文件，然后添加以下内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cheerio = <span class="built_in">require</span>(<span class="string">&#x27;cheerio&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> moment = <span class="built_in">require</span>(<span class="string">&#x27;moment&#x27;</span>)</span><br><span class="line"></span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">filter</span>.<span class="title function_">register</span>(<span class="string">&#x27;after_render:html&#x27;</span>, <span class="keyword">function</span> (<span class="params">locals</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> $ = cheerio.<span class="title function_">load</span>(locals)</span><br><span class="line">  <span class="keyword">const</span> post = $(<span class="string">&#x27;#posts-chart&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> tag = $(<span class="string">&#x27;#tags-chart&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> category = $(<span class="string">&#x27;#categories-chart&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> htmlEncode = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (post.<span class="property">length</span> &gt; <span class="number">0</span> || tag.<span class="property">length</span> &gt; <span class="number">0</span> || category.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (post.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; $(<span class="string">&#x27;#postsChart&#x27;</span>).<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (post.<span class="title function_">attr</span>(<span class="string">&#x27;data-encode&#x27;</span>) === <span class="string">&#x27;true&#x27;</span>) htmlEncode = <span class="literal">true</span></span><br><span class="line">      post.<span class="title function_">after</span>(<span class="title function_">postsChart</span>(post.<span class="title function_">attr</span>(<span class="string">&#x27;data-start&#x27;</span>)))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tag.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; $(<span class="string">&#x27;#tagsChart&#x27;</span>).<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (tag.<span class="title function_">attr</span>(<span class="string">&#x27;data-encode&#x27;</span>) === <span class="string">&#x27;true&#x27;</span>) htmlEncode = <span class="literal">true</span></span><br><span class="line">      tag.<span class="title function_">after</span>(<span class="title function_">tagsChart</span>(tag.<span class="title function_">attr</span>(<span class="string">&#x27;data-length&#x27;</span>)))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (category.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; $(<span class="string">&#x27;#categoriesChart&#x27;</span>).<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (category.<span class="title function_">attr</span>(<span class="string">&#x27;data-encode&#x27;</span>) === <span class="string">&#x27;true&#x27;</span>) htmlEncode = <span class="literal">true</span></span><br><span class="line">      category.<span class="title function_">after</span>(<span class="title function_">categoriesChart</span>(category.<span class="title function_">attr</span>(<span class="string">&#x27;data-parent&#x27;</span>)))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (htmlEncode) &#123;</span><br><span class="line">      <span class="keyword">return</span> $.<span class="title function_">root</span>().<span class="title function_">html</span>().<span class="title function_">replace</span>(<span class="regexp">/&amp;amp;#/g</span>, <span class="string">&#x27;&amp;#&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> $.<span class="title function_">root</span>().<span class="title function_">html</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> locals</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="number">15</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">postsChart</span> (<span class="params">startMonth</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> startDate = <span class="title function_">moment</span>(startMonth || <span class="string">&#x27;2022-07&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> endDate = <span class="title function_">moment</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> monthMap = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line">  <span class="keyword">const</span> dayTime = <span class="number">3600</span> * <span class="number">24</span> * <span class="number">1000</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> time = startDate; time &lt;= endDate; time += dayTime) &#123;</span><br><span class="line">    <span class="keyword">const</span> month = <span class="title function_">moment</span>(time).<span class="title function_">format</span>(<span class="string">&#x27;YYYY-MM&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (!monthMap.<span class="title function_">has</span>(month)) &#123;</span><br><span class="line">      monthMap.<span class="title function_">set</span>(month, <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  hexo.<span class="property">locals</span>.<span class="title function_">get</span>(<span class="string">&#x27;posts&#x27;</span>).<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">post</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> month = post.<span class="property">date</span>.<span class="title function_">format</span>(<span class="string">&#x27;YYYY-MM&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (monthMap.<span class="title function_">has</span>(month)) &#123;</span><br><span class="line">      monthMap.<span class="title function_">set</span>(month, monthMap.<span class="title function_">get</span>(month) + <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">const</span> monthArr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>([...monthMap.<span class="title function_">keys</span>()])</span><br><span class="line">  <span class="keyword">const</span> monthValueArr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>([...monthMap.<span class="title function_">values</span>()])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;script id=&quot;postsChart&quot;&gt;</span></span><br><span class="line"><span class="string">    var color = document.documentElement.getAttribute(&#x27;data-theme&#x27;) === &#x27;light&#x27; ? &#x27;#4c4948&#x27; : &#x27;rgba(255,255,255,0.7)&#x27;</span></span><br><span class="line"><span class="string">    var postsChart = echarts.init(document.getElementById(&#x27;posts-chart&#x27;), &#x27;light&#x27;);</span></span><br><span class="line"><span class="string">    var postsOption = &#123;</span></span><br><span class="line"><span class="string">      title: &#123;</span></span><br><span class="line"><span class="string">        text: &#x27;文章发布统计图&#x27;,</span></span><br><span class="line"><span class="string">        x: &#x27;center&#x27;,</span></span><br><span class="line"><span class="string">        textStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      tooltip: &#123;</span></span><br><span class="line"><span class="string">        trigger: &#x27;axis&#x27;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      xAxis: &#123;</span></span><br><span class="line"><span class="string">        name: &#x27;日期&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;category&#x27;,</span></span><br><span class="line"><span class="string">        boundaryGap: false,</span></span><br><span class="line"><span class="string">        nameTextStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisTick: &#123;</span></span><br><span class="line"><span class="string">          show: false</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLabel: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLine: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          lineStyle: &#123;</span></span><br><span class="line"><span class="string">            color: color</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;monthArr&#125;</span></span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      yAxis: &#123;</span></span><br><span class="line"><span class="string">        name: &#x27;文章篇数&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;value&#x27;,</span></span><br><span class="line"><span class="string">        nameTextStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        splitLine: &#123;</span></span><br><span class="line"><span class="string">          show: false</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisTick: &#123;</span></span><br><span class="line"><span class="string">          show: false</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLabel: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLine: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          lineStyle: &#123;</span></span><br><span class="line"><span class="string">            color: color</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      series: [&#123;</span></span><br><span class="line"><span class="string">        name: &#x27;文章篇数&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;line&#x27;,</span></span><br><span class="line"><span class="string">        smooth: true,</span></span><br><span class="line"><span class="string">        lineStyle: &#123;</span></span><br><span class="line"><span class="string">            width: 0</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        showSymbol: false,</span></span><br><span class="line"><span class="string">        itemStyle: &#123;</span></span><br><span class="line"><span class="string">          opacity: 1,</span></span><br><span class="line"><span class="string">          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [&#123;</span></span><br><span class="line"><span class="string">            offset: 0,</span></span><br><span class="line"><span class="string">            color: &#x27;rgba(128, 255, 165)&#x27;</span></span><br><span class="line"><span class="string">          &#125;,</span></span><br><span class="line"><span class="string">          &#123;</span></span><br><span class="line"><span class="string">            offset: 1,</span></span><br><span class="line"><span class="string">            color: &#x27;rgba(1, 191, 236)&#x27;</span></span><br><span class="line"><span class="string">          &#125;])</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        areaStyle: &#123;</span></span><br><span class="line"><span class="string">          opacity: 1,</span></span><br><span class="line"><span class="string">          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [&#123;</span></span><br><span class="line"><span class="string">            offset: 0,</span></span><br><span class="line"><span class="string">            color: &#x27;rgba(128, 255, 165)&#x27;</span></span><br><span class="line"><span class="string">          &#125;, &#123;</span></span><br><span class="line"><span class="string">            offset: 1,</span></span><br><span class="line"><span class="string">            color: &#x27;rgba(1, 191, 236)&#x27;</span></span><br><span class="line"><span class="string">          &#125;])</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;monthValueArr&#125;</span>,</span></span><br><span class="line"><span class="string">        markLine: &#123;</span></span><br><span class="line"><span class="string">          data: [&#123;</span></span><br><span class="line"><span class="string">            name: &#x27;平均值&#x27;,</span></span><br><span class="line"><span class="string">            type: &#x27;average&#x27;,</span></span><br><span class="line"><span class="string">            label: &#123;</span></span><br><span class="line"><span class="string">              color: color</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">          &#125;]</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;]</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">    postsChart.setOption(postsOption);</span></span><br><span class="line"><span class="string">    window.addEventListener(&#x27;resize&#x27;, () =&gt; &#123; </span></span><br><span class="line"><span class="string">      postsChart.resize();</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">    postsChart.on(&#x27;click&#x27;, &#x27;series&#x27;, (event) =&gt; &#123;</span></span><br><span class="line"><span class="string">      if (event.componentType === &#x27;series&#x27;) window.location.href = &#x27;/archives/&#x27; + event.name.replace(&#x27;-&#x27;, &#x27;/&#x27;);</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">  &lt;/script&gt;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">tagsChart</span> (<span class="params">len</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> tagArr = []</span><br><span class="line">  hexo.<span class="property">locals</span>.<span class="title function_">get</span>(<span class="string">&#x27;tags&#x27;</span>).<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">tag</span>) &#123;</span><br><span class="line">    tagArr.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: tag.<span class="property">name</span>, <span class="attr">value</span>: tag.<span class="property">length</span>, <span class="attr">path</span>: tag.<span class="property">path</span> &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  tagArr.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123; <span class="keyword">return</span> b.<span class="property">value</span> - a.<span class="property">value</span> &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dataLength = <span class="title class_">Math</span>.<span class="title function_">min</span>(tagArr.<span class="property">length</span>, len) || tagArr.<span class="property">length</span></span><br><span class="line">  <span class="keyword">const</span> tagNameArr = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; dataLength; i++) &#123;</span><br><span class="line">    tagNameArr.<span class="title function_">push</span>(tagArr[i].<span class="property">name</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> tagNameArrJson = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(tagNameArr)</span><br><span class="line">  <span class="keyword">const</span> tagArrJson = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(tagArr)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;script id=&quot;tagsChart&quot;&gt;</span></span><br><span class="line"><span class="string">    var color = document.documentElement.getAttribute(&#x27;data-theme&#x27;) === &#x27;light&#x27; ? &#x27;#4c4948&#x27; : &#x27;rgba(255,255,255,0.7)&#x27;</span></span><br><span class="line"><span class="string">    var tagsChart = echarts.init(document.getElementById(&#x27;tags-chart&#x27;), &#x27;light&#x27;);</span></span><br><span class="line"><span class="string">    var tagsOption = &#123;</span></span><br><span class="line"><span class="string">      title: &#123;</span></span><br><span class="line"><span class="string">        text: &#x27;Top <span class="subst">$&#123;dataLength&#125;</span> 标签统计图&#x27;,</span></span><br><span class="line"><span class="string">        x: &#x27;center&#x27;,</span></span><br><span class="line"><span class="string">        textStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      tooltip: &#123;&#125;,</span></span><br><span class="line"><span class="string">      xAxis: &#123;</span></span><br><span class="line"><span class="string">        name: &#x27;标签&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;category&#x27;,</span></span><br><span class="line"><span class="string">        nameTextStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisTick: &#123;</span></span><br><span class="line"><span class="string">          show: false</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        grid: &#123;</span></span><br><span class="line"><span class="string">          lineHeight: 32</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLabel: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          color: color,</span></span><br><span class="line"><span class="string">          interval: 0,</span></span><br><span class="line"><span class="string">          formatter: function(value)&#123;</span></span><br><span class="line"><span class="string">            var res = &quot;&quot;;</span></span><br><span class="line"><span class="string">            var max_strlen = 5;</span></span><br><span class="line"><span class="string">            var strlen = 0;</span></span><br><span class="line"><span class="string">            for (var i = 0; i &lt; value.length; i++) &#123;</span></span><br><span class="line"><span class="string">                if (value.charCodeAt(i) &gt; 255)</span></span><br><span class="line"><span class="string">                    strlen++;</span></span><br><span class="line"><span class="string">                else</span></span><br><span class="line"><span class="string">                    strlen+=0.8;</span></span><br><span class="line"><span class="string">                if (strlen&gt;max_strlen)&#123;</span></span><br><span class="line"><span class="string">                  res+=&quot;\\n&quot;</span></span><br><span class="line"><span class="string">                  strlen=0;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                res+=value.charAt(i);</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            return res;</span></span><br><span class="line"><span class="string">          &#125;,</span></span><br><span class="line"><span class="string">      // rotate: 40,</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLine: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          lineStyle: &#123;</span></span><br><span class="line"><span class="string">            color: color</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;tagNameArrJson&#125;</span></span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      yAxis: &#123;</span></span><br><span class="line"><span class="string">        name: &#x27;文章篇数&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;value&#x27;,</span></span><br><span class="line"><span class="string">        splitLine: &#123;</span></span><br><span class="line"><span class="string">          show: false</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        nameTextStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisTick: &#123;</span></span><br><span class="line"><span class="string">          show: false</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLabel: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        axisLine: &#123;</span></span><br><span class="line"><span class="string">          show: true,</span></span><br><span class="line"><span class="string">          lineStyle: &#123;</span></span><br><span class="line"><span class="string">            color: color</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      series: [&#123;</span></span><br><span class="line"><span class="string">        name: &#x27;文章篇数&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;bar&#x27;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;tagArrJson&#125;</span>,</span></span><br><span class="line"><span class="string">        itemStyle: &#123;</span></span><br><span class="line"><span class="string">          borderRadius: [5, 5, 0, 0],</span></span><br><span class="line"><span class="string">          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [&#123;</span></span><br><span class="line"><span class="string">            offset: 0,</span></span><br><span class="line"><span class="string">            color: &#x27;rgba(128, 255, 165)&#x27;</span></span><br><span class="line"><span class="string">          &#125;,</span></span><br><span class="line"><span class="string">          &#123;</span></span><br><span class="line"><span class="string">            offset: 1,</span></span><br><span class="line"><span class="string">            color: &#x27;rgba(1, 191, 236)&#x27;</span></span><br><span class="line"><span class="string">          &#125;])</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        emphasis: &#123;</span></span><br><span class="line"><span class="string">          itemStyle: &#123;</span></span><br><span class="line"><span class="string">            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [&#123;</span></span><br><span class="line"><span class="string">              offset: 0,</span></span><br><span class="line"><span class="string">              color: &#x27;rgba(128, 255, 195)&#x27;</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">              offset: 1,</span></span><br><span class="line"><span class="string">              color: &#x27;rgba(1, 211, 255)&#x27;</span></span><br><span class="line"><span class="string">            &#125;])</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        markLine: &#123;</span></span><br><span class="line"><span class="string">          data: [&#123;</span></span><br><span class="line"><span class="string">            name: &#x27;平均值&#x27;,</span></span><br><span class="line"><span class="string">            type: &#x27;average&#x27;,</span></span><br><span class="line"><span class="string">            label: &#123;</span></span><br><span class="line"><span class="string">              color: color</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">          &#125;]</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;]</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">    tagsChart.setOption(tagsOption);</span></span><br><span class="line"><span class="string">    window.addEventListener(&#x27;resize&#x27;, () =&gt; &#123; </span></span><br><span class="line"><span class="string">      tagsChart.resize();</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">    tagsChart.on(&#x27;click&#x27;, &#x27;series&#x27;, (event) =&gt; &#123;</span></span><br><span class="line"><span class="string">      if(event.data.path) window.location.href = &#x27;/&#x27; + event.data.path;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">  &lt;/script&gt;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">categoriesChart</span> (<span class="params">dataParent</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> categoryArr = []</span><br><span class="line">  <span class="keyword">let</span> categoryParentFlag = <span class="literal">false</span></span><br><span class="line">  hexo.<span class="property">locals</span>.<span class="title function_">get</span>(<span class="string">&#x27;categories&#x27;</span>).<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">category</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (category.<span class="property">parent</span>) categoryParentFlag = <span class="literal">true</span></span><br><span class="line">    categoryArr.<span class="title function_">push</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: category.<span class="property">name</span>,</span><br><span class="line">      <span class="attr">value</span>: category.<span class="property">length</span>,</span><br><span class="line">      <span class="attr">path</span>: category.<span class="property">path</span>,</span><br><span class="line">      <span class="attr">id</span>: category.<span class="property">_id</span>,</span><br><span class="line">      <span class="attr">parentId</span>: category.<span class="property">parent</span> || <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  categoryParentFlag = categoryParentFlag &amp;&amp; dataParent === <span class="string">&#x27;true&#x27;</span></span><br><span class="line">  categoryArr.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123; <span class="keyword">return</span> b.<span class="property">value</span> - a.<span class="property">value</span> &#125;)</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">translateListToTree</span> (<span class="params">data, parent</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> tree = []</span><br><span class="line">    <span class="keyword">let</span> temp</span><br><span class="line">    data.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (data[index].<span class="property">parentId</span> == parent) &#123;</span><br><span class="line">        <span class="keyword">let</span> obj = data[index];</span><br><span class="line">        temp = <span class="title function_">translateListToTree</span>(data, data[index].<span class="property">id</span>);</span><br><span class="line">        <span class="keyword">if</span> (temp.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          obj.<span class="property">children</span> = temp</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (tree.<span class="title function_">indexOf</span>())</span><br><span class="line">          tree.<span class="title function_">push</span>(obj)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> tree</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> categoryNameJson = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(categoryArr.<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">category</span>) &#123; <span class="keyword">return</span> category.<span class="property">name</span> &#125;))</span><br><span class="line">  <span class="keyword">const</span> categoryArrJson = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(categoryArr)</span><br><span class="line">  <span class="keyword">const</span> categoryArrParentJson = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="title function_">translateListToTree</span>(categoryArr, <span class="string">&#x27;0&#x27;</span>))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;script id=&quot;categoriesChart&quot;&gt;</span></span><br><span class="line"><span class="string">    var color = document.documentElement.getAttribute(&#x27;data-theme&#x27;) === &#x27;light&#x27; ? &#x27;#4c4948&#x27; : &#x27;rgba(255,255,255,0.7)&#x27;</span></span><br><span class="line"><span class="string">    var categoriesChart = echarts.init(document.getElementById(&#x27;categories-chart&#x27;), &#x27;light&#x27;);</span></span><br><span class="line"><span class="string">    var categoryParentFlag = <span class="subst">$&#123;categoryParentFlag&#125;</span></span></span><br><span class="line"><span class="string">    var categoriesOption = &#123;</span></span><br><span class="line"><span class="string">      title: &#123;</span></span><br><span class="line"><span class="string">        text: &#x27;文章分类统计图&#x27;,</span></span><br><span class="line"><span class="string">        x: &#x27;center&#x27;,</span></span><br><span class="line"><span class="string">        textStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      legend: &#123;</span></span><br><span class="line"><span class="string">        top: &#x27;bottom&#x27;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;categoryNameJson&#125;</span>,</span></span><br><span class="line"><span class="string">        textStyle: &#123;</span></span><br><span class="line"><span class="string">          color: color</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      tooltip: &#123;</span></span><br><span class="line"><span class="string">        trigger: &#x27;item&#x27;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      series: []</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">    categoriesOption.series.push(</span></span><br><span class="line"><span class="string">      categoryParentFlag ? </span></span><br><span class="line"><span class="string">      &#123;</span></span><br><span class="line"><span class="string">        nodeClick :false,</span></span><br><span class="line"><span class="string">        name: &#x27;文章篇数&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;sunburst&#x27;,</span></span><br><span class="line"><span class="string">        radius: [&#x27;15%&#x27;, &#x27;90%&#x27;],</span></span><br><span class="line"><span class="string">        center: [&#x27;50%&#x27;, &#x27;55%&#x27;],</span></span><br><span class="line"><span class="string">        sort: &#x27;desc&#x27;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;categoryArrParentJson&#125;</span>,</span></span><br><span class="line"><span class="string">        itemStyle: &#123;</span></span><br><span class="line"><span class="string">          borderColor: &#x27;#fff&#x27;,</span></span><br><span class="line"><span class="string">          borderWidth: 2,</span></span><br><span class="line"><span class="string">          emphasis: &#123;</span></span><br><span class="line"><span class="string">            focus: &#x27;ancestor&#x27;,</span></span><br><span class="line"><span class="string">            shadowBlur: 10,</span></span><br><span class="line"><span class="string">            shadowOffsetX: 0,</span></span><br><span class="line"><span class="string">            shadowColor: &#x27;rgba(255, 255, 255, 0.5)&#x27;</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">      :</span></span><br><span class="line"><span class="string">      &#123;</span></span><br><span class="line"><span class="string">        name: &#x27;文章篇数&#x27;,</span></span><br><span class="line"><span class="string">        type: &#x27;pie&#x27;,</span></span><br><span class="line"><span class="string">        radius: [30, 80],</span></span><br><span class="line"><span class="string">        roseType: &#x27;area&#x27;,</span></span><br><span class="line"><span class="string">        label: &#123;</span></span><br><span class="line"><span class="string">          color: color,</span></span><br><span class="line"><span class="string">          formatter: &#x27;&#123;b&#125; : &#123;c&#125; (&#123;d&#125;%)&#x27;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        data: <span class="subst">$&#123;categoryArrJson&#125;</span>,</span></span><br><span class="line"><span class="string">        itemStyle: &#123;</span></span><br><span class="line"><span class="string">          emphasis: &#123;</span></span><br><span class="line"><span class="string">            shadowBlur: 10,</span></span><br><span class="line"><span class="string">            shadowOffsetX: 0,</span></span><br><span class="line"><span class="string">            shadowColor: &#x27;rgba(255, 255, 255, 0.5)&#x27;</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">    categoriesChart.setOption(categoriesOption);</span></span><br><span class="line"><span class="string">    window.addEventListener(&#x27;resize&#x27;, () =&gt; &#123; </span></span><br><span class="line"><span class="string">      categoriesChart.resize();</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">    categoriesChart.on(&#x27;click&#x27;, &#x27;series&#x27;, (event) =&gt; &#123;</span></span><br><span class="line"><span class="string">      if(event.data.path) window.location.href = &#x27;/&#x27; + event.data.path;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">  &lt;/script&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在<code>.md文件</code>使用：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;!-- 文章发布时间统计图 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;posts-chart&quot;</span> <span class="attr">data-start</span>=<span class="string">&quot;2022-07&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border-radius: 8px; height: 300px; padding: 10px;margin-top:30px&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;!-- 文章标签统计图 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;tags-chart&quot;</span> <span class="attr">data-length</span>=<span class="string">&quot;10&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border-radius: 8px; height: 300px; padding: 10px;&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;!-- 文章分类统计图 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;categories-chart&quot;</span> <span class="attr">data-parent</span>=<span class="string">&quot;true&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border-radius: 8px; height: 300px; padding: 10px;margin-top:30px&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>为了适配我的长标签，我在在<code>标签统计图</code>中添加了以下代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">formatter</span>: <span class="keyword">function</span>(<span class="params">value</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">var</span> max_strlen = <span class="number">5</span>;</span><br><span class="line">            <span class="keyword">var</span> strlen = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; value.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (value.<span class="title function_">charCodeAt</span>(i) &gt; <span class="number">255</span>)</span><br><span class="line">                    strlen++;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    strlen+=<span class="number">0.8</span>;</span><br><span class="line">                <span class="keyword">if</span> (strlen&gt;max_strlen)&#123;</span><br><span class="line">                  res+=<span class="string">&quot;\\n&quot;</span></span><br><span class="line">                  strlen=<span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                res+=value.<span class="title function_">charAt</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">          &#125;,</span><br></pre></td></tr></table></figure><p>效果如图：</p><p><img src="/./img/b20a/1661863365054.png" alt="文章统计图"></p><h2 id="魔改Twikoo样式"><a href="#魔改Twikoo样式" class="headerlink" title="魔改Twikoo样式"></a>魔改Twikoo样式</h2><h3 id="魔改信息栏"><a href="#魔改信息栏" class="headerlink" title="魔改信息栏"></a>魔改信息栏</h3><p>点击评论系统的输入框会出现提示：</p><p><img src="/./img/b20a/1663208091131.png" alt="友好提示"></p><p>css代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Twikoo评论系统样式 */</span></span><br><span class="line"><span class="comment">/* 设置文字内容 :nth-child(1)的作用是选择第几个 */</span></span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>)<span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;输入QQ号会自动获取昵称和头像🐧&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>)<span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;收到回复将会发送到您的邮箱📧&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>)<span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;可以通过昵称访问您的网站🔗&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 当用户点击输入框时显示 */</span></span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">:focus-within</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">:focus-within</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 主内容区 */</span></span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="comment">/* 先隐藏起来 */</span></span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="comment">/* 绝对定位 */</span></span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="comment">/* 向上移动60像素 */</span></span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">60px</span>;</span><br><span class="line">    <span class="comment">/* 文字强制不换行，防止left:50%导致的文字换行 */</span></span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="comment">/* 圆角 */</span></span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="comment">/* 距离左边50% */</span></span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="comment">/* 然后再向左边挪动自身的一半，即可实现居中 */</span></span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>);</span><br><span class="line">    <span class="comment">/* 填充 */</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">14px</span> <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#444</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 小角标 */</span></span><br><span class="line"><span class="selector-class">.el-input</span><span class="selector-class">.el-input--small</span><span class="selector-class">.el-input-group</span><span class="selector-class">.el-input-group--prepend</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="comment">/* 内容大小（宽高）为0且边框大小不为0的情况下，每一条边（4个边）都是一个三角形，组成一个正方形。</span></span><br><span class="line"><span class="comment">    我们先将所有边框透明，再给其中的一条边添加颜色就可以实现小三角图标 */</span></span><br><span class="line">    <span class="attribute">border</span>: <span class="number">12px</span> solid transparent;</span><br><span class="line">    <span class="attribute">border-top-color</span>: <span class="number">#444</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">48px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="魔改评论区"><a href="#魔改评论区" class="headerlink" title="魔改评论区"></a>魔改评论区</h3><p><a href="https://www.cxl2020mc.top/post/Hexo-Butterfly-Twikoo%E8%AF%84%E8%AE%BA%E5%8C%BA%E7%BE%8E%E5%8C%96/">原文</a></p><p>css代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 声名部分变量 */</span></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--cxl2020mc-radius</span>: <span class="number">7px</span>;</span><br><span class="line">  <span class="attr">--cxl2020mc-card-border-width</span>: <span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 浅色模式颜色 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=light]</span> &#123;</span><br><span class="line">  <span class="attr">--cxl2020mc-border-color</span>: <span class="number">#e3e8f7</span>;</span><br><span class="line">  <span class="attr">--cxl2020mc-card-bg</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attr">--cxl2020mc-card-border</span>: <span class="number">#e3e8f7</span>;</span><br><span class="line">  <span class="attr">--style-border-always</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--cxl2020mc-card-border);</span><br><span class="line">  <span class="attr">--cxl2020mc-blue</span>: <span class="number">#425AEF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 深色模式颜色 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=dark]</span> &#123;</span><br><span class="line">  <span class="attr">--cxl2020mc-border-color</span>: <span class="number">#42444a</span>;</span><br><span class="line">  <span class="attr">--cxl2020mc-card-bg</span>: <span class="number">#1d1b26</span>;</span><br><span class="line">  <span class="attr">--cxl2020mc-card-border</span>: <span class="number">#42444a</span>;</span><br><span class="line">  <span class="attr">--style-border-always</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--cxl2020mc-card-border);</span><br><span class="line">  <span class="attr">--cxl2020mc-blue</span>: <span class="number">#0084FF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 评论区评论大框 */</span></span><br><span class="line"><span class="selector-class">.twikoo</span> <span class="selector-class">.tk-comments-container</span>&gt;<span class="selector-class">.tk-comment</span> &#123;</span><br><span class="line">  <span class="comment">/* 内边距 */</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">1rem</span>;</span><br><span class="line">  <span class="comment">/* 圆角 */</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--cxl2020mc-radius);</span><br><span class="line">  <span class="comment">/* 背景颜色 */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--cxl2020mc-card-bg);</span><br><span class="line">  <span class="comment">/* 变动动画时长 */</span></span><br><span class="line">  <span class="attribute">transition</span>: .<span class="number">3s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 浅色模式评论区评论大框 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=light]</span> <span class="selector-class">.twikoo</span> <span class="selector-class">.tk-comments-container</span>&gt;<span class="selector-class">.tk-comment</span> &#123;</span><br><span class="line">  <span class="comment">/* 阴影 */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--card-box-shadow);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 浅色模式评论区评论大框阴影悬浮加深 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=light]</span> <span class="selector-class">.twikoo</span> <span class="selector-class">.tk-comments-container</span>&gt;<span class="selector-class">.tk-comment</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="comment">/* 阴影（浅色模式突出层次感） */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--card-hover-box-shadow);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 黑暗模式评论区评论大框 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=dark]</span> <span class="selector-class">.twikoo</span> <span class="selector-class">.tk-comments-container</span>&gt;<span class="selector-class">.tk-comment</span> &#123;</span><br><span class="line">  <span class="comment">/* 边框样式 */</span></span><br><span class="line">  <span class="attribute">border-style</span>: solid;</span><br><span class="line">  <span class="comment">/* 边框宽度 */</span></span><br><span class="line">  <span class="attribute">border-width</span>: <span class="built_in">var</span>(--cxl2020mc-card-border-width);</span><br><span class="line">  <span class="comment">/* 边框颜色 */</span></span><br><span class="line">  <span class="attribute">border-color</span>: <span class="built_in">var</span>(--cxl2020mc-card-border);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 设备信息 */</span></span><br><span class="line"><span class="selector-class">.twikoo</span> <span class="selector-class">.tk-extra</span> &#123;</span><br><span class="line">  <span class="comment">/* 圆角 */</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--cxl2020mc-radius);</span><br><span class="line">  <span class="comment">/* 背景颜色 */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--cxl2020mc-card-bg);</span><br><span class="line">  <span class="comment">/* 内边距 */</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0.4rem</span>;</span><br><span class="line">  <span class="comment">/* 底边距 */</span></span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">1rem</span>;</span><br><span class="line">  <span class="comment">/* 变动动画时长 */</span></span><br><span class="line">  <span class="attribute">transition</span>: .<span class="number">3s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 浅色模式设备信息 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=light]</span> <span class="selector-class">.twikoo</span> <span class="selector-class">.tk-extra</span> &#123;</span><br><span class="line">  <span class="comment">/* 阴影 */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--card-box-shadow);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 浅色模式设备信息阴影悬浮加深 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=light]</span> <span class="selector-class">.twikoo</span> <span class="selector-class">.tk-extra</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="comment">/* 阴影 */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--card-hover-box-shadow);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 黑暗模式设备信息 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=dark]</span> <span class="selector-class">.twikoo</span> <span class="selector-class">.tk-extra</span> &#123;</span><br><span class="line">  <span class="comment">/* 边框样式 */</span></span><br><span class="line">  <span class="attribute">border-style</span>: solid;</span><br><span class="line">  <span class="comment">/* 边框宽度 */</span></span><br><span class="line">  <span class="attribute">border-width</span>: <span class="built_in">var</span>(--cxl2020mc-card-border-width);</span><br><span class="line">  <span class="comment">/* 边框颜色 */</span></span><br><span class="line">  <span class="attribute">border-color</span>: <span class="built_in">var</span>(--cxl2020mc-card-border);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 加载更多按钮 */</span></span><br><span class="line"><span class="selector-class">.twikoo</span> <span class="selector-class">.tk-expand</span> &#123;</span><br><span class="line">  <span class="comment">/* 圆角 */</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--cxl2020mc-radius);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 浅色模式加载更多按钮 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=light]</span> <span class="selector-class">.twikoo</span> <span class="selector-class">.tk-expand</span> &#123;</span><br><span class="line">  <span class="comment">/* 阴影 */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--card-box-shadow);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 浅色模式加载更多按钮（鼠标悬浮时） */</span></span><br><span class="line"><span class="selector-attr">[data-theme=light]</span> <span class="selector-class">.twikoo</span> <span class="selector-class">.tk-expand</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="comment">/* 阴影 */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--card-hover-box-shadow);</span><br><span class="line">  <span class="comment">/* 背景颜色 */</span></span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--btn-bg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 黑暗模式加载更多按钮（鼠标悬浮时） */</span></span><br><span class="line"><span class="selector-attr">[data-theme=dark]</span> <span class="selector-class">.twikoo</span> <span class="selector-class">.tk-expand</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="comment">/* 背景颜色 */</span></span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--cxl2020mc-blue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 黑暗模式加载更多按钮 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=dark]</span> <span class="selector-class">.twikoo</span> <span class="selector-class">.tk-expand</span> &#123;</span><br><span class="line">  <span class="comment">/* 边框样式 */</span></span><br><span class="line">  <span class="attribute">border-style</span>: solid;</span><br><span class="line">  <span class="comment">/* 边框宽度 */</span></span><br><span class="line">  <span class="attribute">border-width</span>: <span class="built_in">var</span>(--cxl2020mc-card-border-width);</span><br><span class="line">  <span class="comment">/* 边框颜色 */</span></span><br><span class="line">  <span class="attribute">border-color</span>: <span class="built_in">var</span>(--cxl2020mc-card-border);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="魔改页脚"><a href="#魔改页脚" class="headerlink" title="魔改页脚"></a>魔改页脚</h2><p><img src="/./img/b/b20a/635a9b8ed5210.png" alt="魔改页脚"></p><p>原文：<a href="https://blog.jayhrn.com/posts/1799/">Butterfly 主题页脚美化 | Jayhrn - 分享科技与热爱生活</a></p><p>修改 <code>themes/butterfly/layout/includes/footer.pug</code> 文件，直接替换内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">#footer_deal</span><br><span class="line">  a.deal_link(href=&quot;mailto:1982989137@qq.com&quot; title=&quot;mail&quot;)</span><br><span class="line">    i.iconfont.icon-youxiang1</span><br><span class="line">  a.deal_link(href=&quot;https://res.abeim.cn/api/qq/?qq=1982989137&quot; title=&quot;qq&quot; target=&quot;_blank&quot;)</span><br><span class="line">    i.iconfont.icon-qq1</span><br><span class="line">  a.deal_link(href=&quot;https://weibo.com/flow2000&quot; title=&quot;微博&quot; target=&quot;_blank&quot;)</span><br><span class="line">    i.iconfont.icon-weibo</span><br><span class="line">  a.deal_link(href=&quot;https://github.com/flow2000&quot; title=&quot;github&quot;  target=&quot;_blank&quot;)</span><br><span class="line">    i.iconfont.icon-github</span><br><span class="line">  img.footer_mini_logo.entered.loading(style=&quot;border-radius:50%&quot; src=&#x27;/img/avatar.png&#x27; onclick=&quot;btf.scrollToDest(0,500)&quot; title=&quot;返回顶部&quot;)</span><br><span class="line">  a.deal_link(href=&quot;/&quot; title=&quot;主页&quot; target=&quot;_blank&quot;)</span><br><span class="line">    i.iconfont.icon-zhuye</span><br><span class="line">  a.deal_link(href=&quot;https://www.travellings.cn/go.html&quot; title=&quot;开往-随机跳转另一个加入开往的网页&quot; target=&quot;_blank&quot;)</span><br><span class="line">    i.iconfont.icon-huoche</span><br><span class="line">  a.deal_link(href=&quot;/comment/&quot; title=&quot;留言&quot; target=&quot;_blank&quot;)</span><br><span class="line">    i.iconfont.icon-liuyan</span><br><span class="line">  a.deal_link(href=&quot;/atom.xml&quot; title=&quot;rss&quot; target=&quot;_blank&quot;)</span><br><span class="line">    i.iconfont.icon-rss</span><br><span class="line">#Jay-footer</span><br><span class="line">  .footer-group</span><br><span class="line">    h3.footer-title 直达</span><br><span class="line">    .footer-links</span><br><span class="line">      a.footer-item(href=&quot;/&quot; target=&quot;_blank&quot;) 我的主页</span><br><span class="line">      a.footer-item(href=&quot;javascript:toRandomPost();&quot;) 随机文章</span><br><span class="line">      a.footer-item(href=&quot;https://bimg.cc&quot; target=&quot;_blank&quot;) 必应壁纸</span><br><span class="line">  .footer-group</span><br><span class="line">    h3.footer-title 分类</span><br><span class="line">    .footer-links</span><br><span class="line">      a.footer-item(href=&quot;/categories/优秀文章/&quot;) 优秀文章</span><br><span class="line">      a.footer-item(href=&quot;/categories/博客搭建/&quot;) 博客搭建</span><br><span class="line">      a.footer-item(href=&quot;/categories/学习笔记/&quot;) 学习笔记</span><br><span class="line">      a.footer-item(href=&quot;/categories/实用教程/&quot;) 实用教程</span><br><span class="line">      a.footer-item(href=&quot;/categories/总结/&quot;) 总结</span><br><span class="line">  .footer-group</span><br><span class="line">    h3.footer-title 友链</span><br><span class="line">    .footer-links#friend-links-in-footer</span><br><span class="line">      a.footer-item(href=&quot;https://blog.zhheo.com/&quot; target=&quot;_blank&quot;) 张洪Heo</span><br><span class="line">      a.footer-item(href=&quot;https://zfe.one/&quot; target=&quot;_blank&quot;) 小冰博客</span><br><span class="line">      a.footer-item(href=&quot;https://blog.leonus.cn/&quot; target=&quot;_blank&quot;) Leonus</span><br><span class="line">      a.footer-item(href=&quot;https://zhangshier.vip/&quot; target=&quot;_blank&quot;) 张时贰</span><br><span class="line">      a.footer-item(href=&quot;/links/&quot; target=&quot;_blank&quot;) 查看更多</span><br><span class="line">  .footer-group</span><br><span class="line">    h3.footer-title 关于</span><br><span class="line">    .footer-links</span><br><span class="line">      a.footer-item(href=&quot;/about/&quot;) 关于我</span><br><span class="line">      a.footer-item(href=&quot;/about/#博客统计&quot;) 博客统计</span><br><span class="line">      a.footer-item(href=&quot;/archives/&quot;) 文章归档</span><br><span class="line">      a.footer-item(href=&quot;/history/&quot;) 建站记录</span><br><span class="line">#footer-banner</span><br><span class="line">  .footer-banner-links</span><br><span class="line">    .footer-banner-left</span><br><span class="line">      .footer-banner-left</span><br><span class="line">        #footer-banner-tips</span><br><span class="line"></span><br><span class="line">    .footer-banner-right</span><br><span class="line"></span><br><span class="line">      a.footer-banner-link(href=&quot;https://hexo.io/zh-cn/&quot; title=&quot;Hexo&quot;) 框架</span><br><span class="line">      a.footer-banner-link |</span><br><span class="line">      a.footer-banner-link(href=&quot;https://github.com/jerryc127/hexo-theme-butterfly&quot; title=&quot;theme&quot;) 主题</span><br><span class="line">      a.footer-banner-link |</span><br><span class="line">      a.footer-banner-link(href=&quot;/atom.xml&quot; title=&quot;RSS&quot;) 订阅</span><br><span class="line">      a.footer-banner-link |</span><br><span class="line">      a.footer-banner-link(href=&quot;/about/&quot; title=&quot;about&quot;) 关于</span><br><span class="line">      a.footer-banner-link</span><br></pre></td></tr></table></figure><p>图标需要自己修改，引入第三方图标库还请查阅官方文档：<a href="https://butterfly.js.org/posts/4073eda/#iconfont">Butterfly 安裝文檔(六) 進階教程 | Butterfly</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>世界上最先进的开源关系型数据库——PostgreSql常用命令</title>
      <link href="/posts/394e/"/>
      <url>/posts/394e/</url>
      
        <content type="html"><![CDATA[<h3 id="用户操作命令"><a href="#用户操作命令" class="headerlink" title="用户操作命令"></a>用户操作命令</h3><h4 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h4><p>1、指定参数登录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psql -U username -d database_name -h host -W</span><br></pre></td></tr></table></figure><blockquote><p>参数含义: <code>-U</code>指定用户 <code>-d</code>要连接的数据库 <code>-h</code>要连接的主机 <code>-W</code>提示输入密码。</p></blockquote><p>2、使用<code>postgres</code>同名用户后登录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su username</span><br><span class="line">psql</span><br></pre></td></tr></table></figure><blockquote><p>注意：</p><p>当不指定参数时<code>psql</code>使用操作系统当前用户的用户名作为postgres的登录用户名和要连接的数据库名。所以在PostgreSQL安装完成后可以通过以上方式登录。</p></blockquote><h4 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su - postgres </span><br><span class="line">psql</span><br><span class="line">\password postgres</span><br></pre></td></tr></table></figure><h4 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h4><p>1、系统命令行创建</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">createuser username </span><br></pre></td></tr></table></figure><p>2、PostgresSQL命令行创建（使用CREATE ROLE）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE ROLE rolename;</span><br></pre></td></tr></table></figure><p>3、PostgresSQL命令行创建（使用CREATE USER）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER testuser WITH PASSWORD &#x27;testuser&#x27;;</span><br></pre></td></tr></table></figure><blockquote><p><code>CREATE USER</code>和<code>CREATE ROLE</code>的区别在于，<code>CREATE USER</code>指令创建的用户默认是有登录权限的，而<code>CREATE ROLE</code>没有。</p></blockquote><h3 id="允许远程访问"><a href="#允许远程访问" class="headerlink" title="允许远程访问"></a>允许远程访问</h3><p>在<code>pg_hba.conf</code>添加以下命令，配置用户的访问权限：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># TYPE  DATABASE    USER    ADDRESS       METHOD</span><br><span class="line">local      all       all                    trust</span><br><span class="line">host      all       all    0.0.0.0/0        trust</span><br></pre></td></tr></table></figure><p>在<code>postgresql.conf</code>添加以下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">listen_addresses = &#x27;*&#x27;</span><br><span class="line">port=5432</span><br><span class="line">logging_collector = on</span><br><span class="line">log_directory = &#x27;pg_log&#x27;</span><br><span class="line">log_filename = &#x27;postgresql-%a.log&#x27;</span><br></pre></td></tr></table></figure><h3 id="数据库操作命令"><a href="#数据库操作命令" class="headerlink" title="数据库操作命令"></a>数据库操作命令</h3><h4 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE testuser_1 OWNER testuser;</span><br></pre></td></tr></table></figure><h4 id="切换数据库"><a href="#切换数据库" class="headerlink" title="切换数据库"></a>切换数据库</h4><p>相当于mysql的use dbname</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\c dbname</span><br></pre></td></tr></table></figure><h4 id="列举数据库"><a href="#列举数据库" class="headerlink" title="列举数据库"></a>列举数据库</h4><p>相当于mysql的show databases</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\l</span><br></pre></td></tr></table></figure><h4 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop database [数据库名];</span><br></pre></td></tr></table></figure><h4 id="列举表"><a href="#列举表" class="headerlink" title="列举表"></a>列举表</h4><p>相当于mysql的show tables</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\dt</span><br></pre></td></tr></table></figure><h4 id="查看表结构"><a href="#查看表结构" class="headerlink" title="查看表结构"></a>查看表结构</h4><p>相当于desc tblname,show columns from tbname</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\d tblname</span><br></pre></td></tr></table></figure><h4 id="查看索引"><a href="#查看索引" class="headerlink" title="查看索引"></a>查看索引</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\di</span><br></pre></td></tr></table></figure><h3 id="表操作命令"><a href="#表操作命令" class="headerlink" title="表操作命令"></a>表操作命令</h3><h4 id="重命名一个表"><a href="#重命名一个表" class="headerlink" title="重命名一个表"></a>重命名一个表</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table [表名A] rename to [表名B]; </span><br></pre></td></tr></table></figure><h4 id="删除一个表"><a href="#删除一个表" class="headerlink" title="删除一个表"></a>删除一个表</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop table [表名]; </span><br></pre></td></tr></table></figure><h4 id="在已有的表里添加字段"><a href="#在已有的表里添加字段" class="headerlink" title="在已有的表里添加字段"></a>在已有的表里添加字段</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table [表名] add column [字段名] [类型]; </span><br></pre></td></tr></table></figure><h4 id="删除表中的字段"><a href="#删除表中的字段" class="headerlink" title="删除表中的字段"></a>删除表中的字段</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table [表名] drop column [字段名]; </span><br></pre></td></tr></table></figure><h4 id="重命名一个字段"><a href="#重命名一个字段" class="headerlink" title="重命名一个字段"></a>重命名一个字段</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table [表名] rename column [字段名A] to [字段名B]; </span><br></pre></td></tr></table></figure><h4 id="给一个字段设置缺省值"><a href="#给一个字段设置缺省值" class="headerlink" title="给一个字段设置缺省值"></a>给一个字段设置缺省值</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table [表名] alter column [字段名] set default [新的默认值];</span><br></pre></td></tr></table></figure><h4 id="去除缺省值"><a href="#去除缺省值" class="headerlink" title="去除缺省值"></a>去除缺省值</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table [表名] alter column [字段名] drop default; </span><br></pre></td></tr></table></figure><h4 id="在表中插入数据"><a href="#在表中插入数据" class="headerlink" title="在表中插入数据"></a>在表中插入数据</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名 ([字段名m],[字段名n],......) values ([列m的值],[列n的值],......); </span><br></pre></td></tr></table></figure><h4 id="修改表中的某行某列的数据"><a href="#修改表中的某行某列的数据" class="headerlink" title="修改表中的某行某列的数据"></a>修改表中的某行某列的数据</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update [表名] set [目标字段名]=[目标值] where [该行特征]; </span><br></pre></td></tr></table></figure><h4 id="删除表中某行数据"><a href="#删除表中某行数据" class="headerlink" title="删除表中某行数据"></a>删除表中某行数据</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">delete from [表名] where [该行特征]; </span><br><span class="line">delete from [表名];--删空整个表 </span><br></pre></td></tr></table></figure><h4 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create table ([字段名1] [类型1] ;,[字段名2] [类型2],......&lt;,primary key (字段名m,字段名n,...)&gt;;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PostgreSql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>世界上最先进的开源关系型数据库——PostgreSql安装教程</title>
      <link href="/posts/71b1/"/>
      <url>/posts/71b1/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><code>PostgreSQL </code>是一个免费的对象-关系数据库服务器(ORDBMS)，在灵活的BSD许可证下发行。</p><p><code>PostgreSQL</code> 的 Slogan 是 “世界上最先进的开源关系型数据库”。</p><p>本次安装选择二进制源码包编译安装</p><p>服务器操作系统为<code>Centos7.6</code>，PostgreSql安装版本为<code>14.0</code></p><h2 id="安装包下载"><a href="#安装包下载" class="headerlink" title="安装包下载"></a>安装包下载</h2><p>在官网源码包选择<code>14.0</code>版本下载，下载地址：<a href="https://www.postgresql.org/ftp/source/">PostgreSQL: File Browser</a></p><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><h3 id="下载环境依赖"><a href="#下载环境依赖" class="headerlink" title="下载环境依赖"></a>下载环境依赖</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y cmake make gcc zlib zlib-devel gcc-c++ perl readline readline-devel  python36 tcl openssl ncurses-devel openldap pam flex</span><br></pre></td></tr></table></figure><div class="note warning flat"><p>如果出现<code>File “/usr/bin/yum“, line 30 except KeyboardInterrupt, e:</code>这类错误，多半yum命令的python环境发生改变了，需要改回来：</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/bin</span><br><span class="line">rm -rf python</span><br><span class="line">ln -s python2.7 python</span><br></pre></td></tr></table></figure><h3 id="创建postgre用户"><a href="#创建postgre用户" class="headerlink" title="创建postgre用户"></a>创建postgre用户</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">groupadd postgres</span><br><span class="line">adduser -g postgres postgres </span><br></pre></td></tr></table></figure><h3 id="修改用户密码"><a href="#修改用户密码" class="headerlink" title="修改用户密码"></a>修改用户密码</h3><p>此处修改密码即修改登录用户密码（如果你使用postgres作为登录用户的话）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd postgres</span><br></pre></td></tr></table></figure><p>如果使用弱密码方便登录时，可执行以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;123&quot; | passwd --stdin postgres</span><br></pre></td></tr></table></figure><h3 id="创建用户目录并授权"><a href="#创建用户目录并授权" class="headerlink" title="创建用户目录并授权"></a>创建用户目录并授权</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /home/postgres;</span><br><span class="line">chmod -R 775 /home/postgres;</span><br><span class="line">chown -R postgres:postgres /home/postgres;</span><br></pre></td></tr></table></figure><h3 id="开放防火墙端口"><a href="#开放防火墙端口" class="headerlink" title="开放防火墙端口"></a>开放防火墙端口</h3><p>默认<code>5432</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=5432/tcp --permanent;</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><h3 id="修改操作系统打开最大文件句柄数"><a href="#修改操作系统打开最大文件句柄数" class="headerlink" title="修改操作系统打开最大文件句柄数"></a>修改操作系统打开最大文件句柄数</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;postgres soft   nofile         65535&quot; &gt;&gt; /etc/security/limits.conf</span><br><span class="line">echo &quot;postgres hard   nofile        65535&quot; &gt;&gt; /etc/security/limits.conf</span><br></pre></td></tr></table></figure><p>重新登陆后，执行以下命令会出现65535 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su postgres</span><br><span class="line">ulimit -n</span><br></pre></td></tr></table></figure><h3 id="创建数据库目录"><a href="#创建数据库目录" class="headerlink" title="创建数据库目录"></a>创建数据库目录</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /home/postgres/&#123;postgre14,pgdata&#125;</span><br></pre></td></tr></table></figure><h2 id="编译并安装"><a href="#编译并安装" class="headerlink" title="编译并安装"></a>编译并安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">su - postgres</span><br><span class="line">tar -xzvf ./postgresql-14.0.tar.gz -C /home/postgres</span><br><span class="line">cd  /home/postgres/postgresql-14.0</span><br><span class="line">./configure --prefix=/home/postgres/postgre14</span><br><span class="line">make  &amp;&amp; make install</span><br></pre></td></tr></table></figure><h2 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cat &gt;&gt;  ~/.bash_profile &lt;&lt;&quot;EOF&quot;</span><br><span class="line">export PGPORT=5432</span><br><span class="line">export PGDATA=/home/postgres/pgdata</span><br><span class="line">export PGHOME=/home/postgres/postgre14</span><br><span class="line">export LD_LIBRARY_PATH=$PGHOME/lib:$LD_LIBRARY_PATH</span><br><span class="line">export PATH=$PGHOME/bin:$PATH:.</span><br><span class="line">EOF</span><br><span class="line">source  ~/.bash_profile</span><br></pre></td></tr></table></figure><h2 id="数据库及参数初始化"><a href="#数据库及参数初始化" class="headerlink" title="数据库及参数初始化"></a>数据库及参数初始化</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home/postgres/postgre14/bin/initdb -D $PGDATA  -E UTF8 --locale=en_US.utf8 -U postgres</span><br></pre></td></tr></table></figure><blockquote><p>指定<code>-D</code>数据目录，<code>-E</code>字符编码， <code>--locale</code>本及语言环境，<code>-U</code>初始化用户信息。</p></blockquote><h3 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat &gt;&gt; /home/postgres/pgdata/postgresql.conf &lt;&lt;&quot;EOF&quot;</span><br><span class="line">listen_addresses = &#x27;*&#x27;</span><br><span class="line">port=5432</span><br><span class="line">logging_collector = on</span><br><span class="line">log_directory = &#x27;pg_log&#x27;</span><br><span class="line">log_filename = &#x27;postgresql-%a.log&#x27;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><ul><li><code>listen_addresses</code> 表示postgre进程监听的网卡地址，配置<code>*</code>表示监听所有。</li><li><code>port</code>服务监听端口配置</li><li><code>logging_collector=on</code>，启动日志收集器</li><li><code>log_directory</code> 表示日志文件在PGDATA目录下的文件夹位置。</li><li><code>log_filename</code>表示日志文件的名称</li></ul><h3 id="配置访问权限"><a href="#配置访问权限" class="headerlink" title="配置访问权限"></a>配置访问权限</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat   &gt; /home/postgres/pgdata/pg_hba.conf &lt;&lt; EOF</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">TYPE  DATABASE    USER    ADDRESS       METHOD</span></span><br><span class="line">local      all       all                    trust</span><br><span class="line">host      all       all    0.0.0.0/0        md5</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><h2 id="启动数据库新建用户"><a href="#启动数据库新建用户" class="headerlink" title="启动数据库新建用户"></a>启动数据库新建用户</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动命令</span></span><br><span class="line">pg_ctl start</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重启命令</span></span><br><span class="line">pg_ctl restart</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看数据库运行状态</span></span><br><span class="line">pg_ctl status</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">停止数据库</span></span><br><span class="line">pg_ctl stop</span><br></pre></td></tr></table></figure><h3 id="新建用户"><a href="#新建用户" class="headerlink" title="新建用户"></a>新建用户</h3><p>进入postgresql命令行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psql</span><br></pre></td></tr></table></figure><p>新建用户postgres</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter user postgres with password &#x27;password&#x27;;</span><br></pre></td></tr></table></figure><p>一般来说，我们的程序在运行过程中，不会直接使用postgres用户，而是新建一个用户。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">新建一个用户 acai</span></span><br><span class="line">CREATE USER acai WITH password &#x27;密码&#x27;;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">新建一个数据库acaidb，属主是acai</span></span><br><span class="line">CREATE DATABASE acaidb OWNER acai;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">为用户acai赋权，all表示所有权限，acaidb的管理用户</span></span><br><span class="line">GRANT all ON  DATABASE acaidb TO acai; </span><br></pre></td></tr></table></figure><p>实际上在生产环境中，我们需要创建两个用户，一个数据库管理用户用于管理表、视图等操作；另一个是程序用户，用于操作数据库表里面的数据，完成增删改查。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER acaiuser WITH password &#x27;*******&#x27;;</span><br><span class="line">GRANT  update,delete,insert,select  ON  ALL TABLES IN SCHEMA public TO acaiuser;</span><br></pre></td></tr></table></figure><h2 id="开机自启动"><a href="#开机自启动" class="headerlink" title="开机自启动"></a>开机自启动</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; /etc/systemd/system/postgre14.service &lt;&lt;&quot;EOF&quot;</span><br><span class="line">[Unit]</span><br><span class="line">Description=PostgreSQL database server 14.4</span><br><span class="line">Documentation=man:postgres(1)</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">User=postgres</span><br><span class="line">Group=postgres</span><br><span class="line"></span><br><span class="line">Environment=PGPORT=5432</span><br><span class="line">Environment=PGDATA=/home/postgres/pgdata</span><br><span class="line"></span><br><span class="line">ExecStart=/home/postgres/postgre14/bin/pg_ctl start -D $&#123;PGDATA&#125; -s -o &quot;-p $&#123;PGPORT&#125;&quot; -w -t 300</span><br><span class="line">ExecStop=/home/postgres/postgre14/bin/pg_ctl stop -D $&#123;PGDATA&#125; -s -m fast</span><br><span class="line">ExecReload=/home/postgres/postgre14/bin/pg_ctl reload -D $&#123;PGDATA&#125; -s</span><br><span class="line"></span><br><span class="line">KillMode=mixed</span><br><span class="line">KillSignal=SIGINT</span><br><span class="line">TimeoutSec=120</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p>执行下列命令，使得PostgreSQL数据库开机自启动脚本生效。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl enable postgre14</span><br></pre></td></tr></table></figure><p>后续再启停数据库，查看数据库状态，就可以使用下面的这些命令了</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start postgre14</span><br><span class="line">systemctl stop postgre14</span><br><span class="line">systemctl status postgre14</span><br></pre></td></tr></table></figure><h2 id="参考连接"><a href="#参考连接" class="headerlink" title="参考连接"></a>参考连接</h2><p><a href="https://zimug.blog.csdn.net/article/details/126530028">PostgreSql生产级别数据库安装要考虑哪些问题？</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PostgreSql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>高性能Web应用服务器Nginx功能之自动化封禁ip</title>
      <link href="/posts/7e+26/"/>
      <url>/posts/7e+26/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>在日常业务场景中可能存在恶意用户频繁访问系统，占用系统资源，影响正常用户访问，我们有许多方案杜绝此类问题发生，例如增加验证码，应用内限制访问次数，网关ip封禁等等。本次介绍如何利用Nginx和shell脚本自动化封禁访问ip。</p><h2 id="Nginx封禁ip或ip段"><a href="#Nginx封禁ip或ip段" class="headerlink" title="Nginx封禁ip或ip段"></a>Nginx封禁ip或ip段</h2><p>封禁ip&#x2F;ip段语法</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deny <span class="number">1.2</span>.<span class="number">3.4</span>;</span><br><span class="line">deny <span class="number">91.212</span>.<span class="number">45.0</span>/<span class="number">24</span>;</span><br></pre></td></tr></table></figure><p>允许ip&#x2F;ip段语法</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allow <span class="number">1.2</span>.<span class="number">3.4</span>;</span><br><span class="line">allow <span class="number">91.212</span>.<span class="number">45.0</span>/<span class="number">24</span>;</span><br></pre></td></tr></table></figure><p>新建<code>/usr/local/nginx/conf/vhosts/blockip.conf</code>，将封禁ip&#x2F;ip段的语句放入到<code>blockip.conf</code></p><p>根据放入的语句块实现封禁ip的范围：</p><ul><li><code>include vhosts/blockip.conf</code>放在<code>server</code>语句块，则单独封禁某个网站</li><li><code>include vhosts/blockip.conf</code>放在<code>http</code>语句块，则封禁所有网站</li></ul><p>记得在<code>nginx.conf</code>导入<code>blockip.conf</code>：</p><p><img src="/./img/7e26/1661746398969.png" alt="禁用ip配置"></p><h2 id="shell脚本自动化封禁ip"><a href="#shell脚本自动化封禁ip" class="headerlink" title="shell脚本自动化封禁ip"></a>shell脚本自动化封禁ip</h2><h3 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h3><p>AWK 是一种处理文本文件的语言，是一个强大的文本分析工具。后面会详细介绍。</p><p>自动化封禁ip的思路：</p><p>1、统计访问日志的ip并去重排序</p><p>2、计算超过特定访问速率（每分钟60次）的ip</p><p>3、将ip记录在<code>vhosts/blockip.conf</code>并灰度发布</p><p>4、<code>crontab</code>定时运行脚本</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">统计access.log</button></li><li class="tab"><button type="button" data-href="#tab-1-2">去重和排序</button></li><li class="tab"><button type="button" data-href="#tab-1-3">计算超过特定访问速率（每分钟60次）的ip</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;&#123;print $1&#125;&#x27; /usr/local/nginx/logs/access.log</span><br></pre></td></tr></table></figure><p><img src="/./img/7e26/1661744930619.png" alt="统计access.log"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;&#123;print $1&#125;&#x27; /usr/local/nginx/logs/access.log | sort | uniq -cd</span><br></pre></td></tr></table></figure><p><img src="/./img/7e26/1661745475818.png" alt="去重和排序"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;&#123;print $1&#125;&#x27; /usr/local/nginx/logs/access.log | sort | uniq -cd | awk &#x27;&#123;if($1&gt;)print $0&#125;&#x27;</span><br></pre></td></tr></table></figure><p><img src="/./img/7e26/1661745645628.png" alt="计算超过特定访问速率（每分钟60次）的ip"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="编写shell脚本"><a href="#编写shell脚本" class="headerlink" title="编写shell脚本"></a>编写shell脚本</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">不能把别人IP一直封着吧，这里就清除掉了</span></span><br><span class="line">echo &quot;&quot; &gt; /usr/local/nginx/conf/vhosts/blockip.conf</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">前面最开始编写的统计数据功能</span></span><br><span class="line">ip_list=$(awk &#x27;&#123;print $1&#125;&#x27; /usr/local/nginx/logs/access.log | sort | uniq -cd | awk &#x27;&#123;if($1&gt;60)print $0&#125;&#x27;)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">获取当前时间</span></span><br><span class="line">starttime=$(date +%Y-%m-%d\ %H:%M:%S)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">判断这个变量是否为空</span></span><br><span class="line">if test -z &quot;$ip_list&quot;</span><br><span class="line">then</span><br><span class="line">        #为空写入 blockip.log中，并重新启动ngnix</span><br><span class="line">        echo &quot;$starttime 暂无封禁ip&quot;  &gt;&gt; /usr/local/nginx/logs/blockip.log</span><br><span class="line"></span><br><span class="line">        /usr/bin/nginx -s reload</span><br><span class="line">else</span><br><span class="line">        #如果不为空 前面加上 deny格式和ip写入blockip.conf中</span><br><span class="line">        echo &quot;deny&quot; $ip_list &gt; /usr/local/nginx/conf/vhosts/blockip.conf</span><br><span class="line"></span><br><span class="line">        #因为前面携带了行数，所有我们需要去除掉前面的行数，写入后在读取一次</span><br><span class="line">        ip_list2=$(awk &#x27;&#123;print $3&#125;&#x27; /usr/local/nginx/conf/vhosts/blockip.conf)</span><br><span class="line"></span><br><span class="line">        #最后再把读取出来的值，在次写入到blockip.conf中</span><br><span class="line">        echo &quot;deny&quot; $ip_list2&quot;;&quot;&gt; /usr/local/nginx/conf/vhosts/blockip.conf</span><br><span class="line"></span><br><span class="line">        #重启ngnix</span><br><span class="line">        /usr/bin/nginx -s reload</span><br><span class="line">        #清空之前的日志，从最新的开始截取</span><br><span class="line">        echo &quot;&quot; &gt; /usr/local/nginx/logs/access.log</span><br><span class="line"></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">记录封禁ip</span></span><br><span class="line">echo &quot;$starttime 封禁ip $ip_list2&quot;  &gt;&gt; /usr/local/nginx/logs/blockip.log</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h3 id="crontab定时运行脚本"><a href="#crontab定时运行脚本" class="headerlink" title="crontab定时运行脚本"></a>crontab定时运行脚本</h3><p>编辑<code>/etc/crontab</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* * * * * root /usr/bin/sh /usr/local/nginx/shell/blockip.sh</span><br></pre></td></tr></table></figure><p><code>* * * * *</code>表示每分钟运行一次</p><p><code>root</code>表示运行用户</p><p><code>/usr/bin/sh</code>表示运行程序</p><p><code>/usr/local/nginx/shell/blockip.sh</code>表示运行脚本</p><p><img src="/./img/7e26/1661746148387.png" alt="crontab定时运行脚本"></p><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p>为了更快达到效果，博主将访问次数改为20次</p><p><img src="/./img/7e26/20220829222224.gif" alt="封禁ip效果"></p><div class="note info flat"><p>如果想调整每分钟的访问次数，请修改shell脚本</p><p>如果想调整定时任务的间隔时间，请参考cron表达式，修改<code>/etc/crontab</code></p></div>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QQ消息推送机器人Qmsg私有化部署</title>
      <link href="/posts/7b50/"/>
      <url>/posts/7b50/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>引用官网的介绍</p><p>Qmsg酱是一个QQ消息推送机器人，用来通知自己消息的免费服务。通过调用API接口，实现机器人给你的QQ发送消息的功能。通俗易懂点就是有什么重要通知需要及时知道，可以让Qmsg酱第一时间给你发QQ消息。</p><p>公共版有许多限制，只能发送30条消息&#x2F;天，私有部署就没有限制</p><p>前提：得有服务器挂着机器人，服务器已安装jdk1.8</p><p>部署步骤：</p><h2 id="配置机器人"><a href="#配置机器人" class="headerlink" title="配置机器人"></a>配置机器人</h2><p>添加管理台QQ列表：</p><p><img src="/./img/7b50/1661657344765.png" alt="管理台QQ列表"></p><p>这里添加的是机器人发送消息的对象，如果没有添加，则机器人会发送不了消息：</p><p><img src="/./img/7b50/1661658096176.png" alt="管理台没有添加QQ群"></p><p>到<a href="https://qmsg.zendee.cn/user">管理台</a>添加机器人QQ、选择新添加的机器人QQ，点击进入设置，如下图所示步骤：</p><p><img src="/./img/7b50/1661653470790.png" alt="添加机器人QQ"></p><p>如果需要发送图片或者json数据可在机器人设置开启：</p><p><img src="/./img/7b50/1661654262017.png" alt="开启发送图片"></p><p>拉机器人进群，在设置中配置群授权：</p><p><img src="/./img/7b50/1661654338823.png" alt="配置群授权"></p><div class="note info modern"><p>记得保存配置</p></div><h2 id="触发关键词回调URL"><a href="#触发关键词回调URL" class="headerlink" title="触发关键词回调URL"></a>触发关键词回调URL</h2><p><img src="/./img/7b50/1661656275005.png" alt="触发关键词回调URL"></p><p>什么意思呢，就是你在群里（或私发）发送的消息包含关键词时，机器人向设置的url会发送一个post请求。</p><div class="note warning modern"><p>回调URL不能是Qmsg酱的推送接口</p><p><img src="/./img/7b50/1661657952953.png" alt="回调URL不能是Qmsg酱的推送接口"></p></div><p>Key可在<a href="https://qmsg.zendee.cn/user">管理台</a>查询，可根据需要添加QQ号或者QQ群：</p><p><img src="/./img/7b50/1661654109524.png" alt="添加QQ号或者QQ群"></p><h2 id="下载机器人程序"><a href="#下载机器人程序" class="headerlink" title="下载机器人程序"></a>下载机器人程序</h2><p>登录<a href="https://qmsg.zendee.cn/">官网</a>，到<a href="https://qmsg.zendee.cn/pvt">捐赠版页面</a>下载机器人程序</p><h2 id="运行机器人程序"><a href="#运行机器人程序" class="headerlink" title="运行机器人程序"></a>运行机器人程序</h2><p>使用Xftp上传jar到服务器</p><p><img src="/./img/7b50/1661652668986.png" alt="上传jar到服务器"></p><p>运行jar包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar QmsgClient2.1.jar &quot;-noUIQQ账号|QQ密码|0&quot;</span><br></pre></td></tr></table></figure><p>登录验证说明：</p><p>如果登录遇到滑块验证，请下载<a href="https://www.yuque.com/icecreamqaq/api/use-ten-cap">滑块助手</a>。Linux平台需要复制控制台输出的PID粘贴到滑块助手中然后提交验证。</p><p>绑定手机号的QQ需要输入验证码</p><p>完成后出现以下画面：</p><p><img src="/./img/7b50/1661653369002.png" alt="输入验证码"></p><p>部署成功</p><h2 id="测试机器人程序"><a href="#测试机器人程序" class="headerlink" title="测试机器人程序"></a>测试机器人程序</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">测试群发</button></li><li class="tab"><button type="button" data-href="#tab-1-2">测试私发</button></li><li class="tab"><button type="button" data-href="#tab-1-3">测试发送图片消息</button></li><li class="tab"><button type="button" data-href="#tab-1-4">测试发送表情</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>浏览器地址填写，注意将key替换：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://qmsg.zendee.cn/<span class="built_in">group</span>/key?msg=测试<span class="number">1</span>&amp;<span class="built_in">group</span>=qq群号</span><br></pre></td></tr></table></figure><p>测试结果：</p><p><img src="/./img/7b50/1661656861317.png" alt="测试群发消息"></p><p><img src="/./img/7b50/1661656929576.png" alt="测试群发消息"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>浏览器地址填写，注意将key替换：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://qmsg.zendee.cn/send/key?msg=测试</span><br></pre></td></tr></table></figure><p>测试结果：</p><p><img src="/./img/7b50/1661657125323.png" alt="测试私发消息"></p><p><img src="/./img/7b50/1661657139011.png" alt="测试私发消息"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>浏览器地址填写，注意将key替换：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://qmsg.zendee.cn/<span class="built_in">group</span>/key?<span class="built_in">group</span>=<span class="number">798267095</span>&amp;msg=今日壁纸：@image=https://api.aqcoder.cn/today<span class="selector-tag">@</span></span><br></pre></td></tr></table></figure><p>测试结果：</p><p><img src="/./img/7b50/1661657258810.png" alt="测试发送图片消息"></p><p><img src="/./img/7b50/1661657284483.png" alt="测试发送图片消息"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>浏览器地址填写，注意将key替换：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://qmsg.zendee.cn/<span class="built_in">group</span>/key?msg=发送表情@face=<span class="number">0</span><span class="selector-tag">@</span>&amp;<span class="built_in">group</span>=<span class="number">798267095</span></span><br></pre></td></tr></table></figure><p>更多表情：<a href="https://hub.fastgit.org/kyubotics/coolq-http-api/wiki/%E8%A1%A8%E6%83%85-CQ-%E7%A0%81-ID-%E8%A1%A8">点击这里</a></p><p>测试结果：</p><p><img src="/./img/7b50/1661659416963.png" alt="测试发送表情"></p><p><img src="/./img/7b50/1661659453952.png" alt="测试发送表情"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="机器人后台运行"><a href="#机器人后台运行" class="headerlink" title="机器人后台运行"></a>机器人后台运行</h2><p>由于Linux系统控制台窗口关闭就会导致当前程序结束，所以在第一次登陆成功后，可以将窗口关闭，然后使用nohup命令后台启动机器人。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java <span class="literal">-jar</span> QmsgClient2.<span class="number">1</span>.jar &gt; Qmsg.log <span class="number">2</span>&gt;&amp;<span class="number">1</span> &amp;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qmsg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>静态网站评论系统Twikoo私有化部署</title>
      <link href="/posts/3f0b/"/>
      <url>/posts/3f0b/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Twikoo是一个简洁、安全、免费的静态网站评论系统，支持邮件、QQ提醒、微信提醒，访客在昵称栏输入 QQ 号，会自动补全 QQ 昵称和 QQ 邮箱，免费搭建，简单部署。</p><h2 id="私有部署"><a href="#私有部署" class="headerlink" title="私有部署"></a>私有部署</h2><h3 id="安装node"><a href="#安装node" class="headerlink" title="安装node"></a>安装node</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">if ! type node &gt;/dev/null 2&gt;&amp;1; then</span><br><span class="line">  echo &#x27;node 已安装&#x27;</span><br><span class="line">else</span><br><span class="line">    echo &quot;----------------------------------start yum install node -----------------------------&quot;</span><br><span class="line">    wget https://cdn.npm.taobao.org/dist/node/latest-v16.x/node-v16.14.0-linux-x64.tar.gz</span><br><span class="line">    tar -xvf node-v16.14.0-linux-x64.tar.gz</span><br><span class="line">    mv node-v16.14.0-linux-x64 /usr/local/node</span><br><span class="line"></span><br><span class="line">    #删除配置文件中原有的环境变量</span><br><span class="line">    sed -ie &#x27;/NODE_HOME/d&#x27; /etc/profile</span><br><span class="line">    sed -ie &#x27;/cnpm/d&#x27; /etc/profile</span><br><span class="line"></span><br><span class="line">    #修改maven的环境变量，直接写入配置文件</span><br><span class="line">    echo &quot;export NODE_HOME=/usr/local/node&quot; &gt;&gt;/etc/profile</span><br><span class="line">    echo &quot;export PATH=\$NODE_HOME/bin:\$PATH&quot; &gt;&gt;/etc/profile</span><br><span class="line"></span><br><span class="line">    source /etc/profile</span><br><span class="line"></span><br><span class="line">    npm install -g cnpm -registry=https://registry.npm.taobao.org</span><br><span class="line">    echo &quot;export PATH=/usr/local/node/lib/node_moudles/cnpm/bin:$PATH&quot; &gt;&gt;/etc/profile</span><br><span class="line">    source /etc/profile</span><br><span class="line">    npm config set registry https://registry.npm.taobao.org</span><br><span class="line">    npm install npm -g</span><br><span class="line">    source /etc/profile</span><br><span class="line">    node -v</span><br><span class="line">    npm -v</span><br><span class="line">    cnpm -v</span><br><span class="line">    echo &quot;----------------------------------yum install node success -----------------------------&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h3 id="安装Twikoo-server"><a href="#安装Twikoo-server" class="headerlink" title="安装Twikoo server"></a>安装Twikoo server</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g tkserver</span><br></pre></td></tr></table></figure><p>根据需要配置环境变量</p><table><thead><tr><th>名称</th><th>描述</th><th>默认值</th></tr></thead><tbody><tr><td><code>TWIKOO_DATA</code></td><td>数据库存储路径</td><td><code>./data</code></td></tr><tr><td><code>TWIKOO_PORT</code></td><td>端口号</td><td><code>8080</code></td></tr><tr><td><code>TWIKOO_THROTTLE</code></td><td>IP 请求限流，当同一 IP 短时间内请求次数超过阈值将对该 IP 返回错误</td><td><code>250</code></td></tr></tbody></table><p>启动 Twikoo server: <code>tkserver</code></p><p>访问 <code>http://服务端IP:8080</code></p><p>若能正常访问，服务端地址（包含 <code>http://</code> 和端口号，例如 <code>http://12.34.56.78:8080</code>）即为您的环境 id</p><h2 id="修改Butterfly配置"><a href="#修改Butterfly配置" class="headerlink" title="修改Butterfly配置"></a>修改Butterfly配置</h2><p>修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Twikoo</span></span><br><span class="line"><span class="comment"># https://github.com/imaegoo/twikoo</span></span><br><span class="line"><span class="attr">twikoo:</span></span><br><span class="line">  <span class="attr">envId:</span> <span class="string">https://twikoo.aqcoder.cn/</span></span><br><span class="line">  <span class="attr">region:</span></span><br><span class="line">  <span class="attr">visitor:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">option:</span></span><br></pre></td></tr></table></figure><p><code>envId</code>：即为上述的子域名</p><h2 id="配置Twikoo"><a href="#配置Twikoo" class="headerlink" title="配置Twikoo"></a>配置Twikoo</h2><p><code>hexo 三连</code>启动博客</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br></pre></td></tr></table></figure><p>进入任意评论页面，点击齿轮，twikoo默认第一个用户为管理员，注册密码后进入配置：</p><p><img src="/./img/3f0b/1661590346321.png" alt="Twikoo评论配置"></p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">通用配置</button></li><li class="tab"><button type="button" data-href="#tab-1-2">插件</button></li><li class="tab"><button type="button" data-href="#tab-1-3">隐私</button></li><li class="tab"><button type="button" data-href="#tab-1-4">反垃圾</button></li><li class="tab"><button type="button" data-href="#tab-1-5">即时通知</button></li><li class="tab"><button type="button" data-href="#tab-1-6">邮件通知</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/./img/3f0b/1661590536869.png" alt="Twikoo通用配置"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>默认，没嫖到图床</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><img src="/./img/3f0b/1661590607097.png" alt="Twikoo隐私配置"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>默认，没人评论</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p>Qmsg：<a href="https://qmsg.zendee.cn/">Qmsg酱-您的专属QQ消息推送服务小姐姐</a></p><p><img src="/./img/3f0b/1661590754939.png" alt="Twikoo即时通知"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-6"><p>因为博主使用的是域名邮箱，没有使用QQ邮箱，所以<code>SMTP_HOST</code>请不要照抄，详情参考：<a href="https://service.mail.qq.com/cgi-bin/help?subtype=1&&id=28&&no=331">如何使用IMAP服务？_QQ邮箱帮助中心</a></p><p><img src="/./img/3f0b/1661590843272.png" alt="Twikoo邮件通知"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="配置https"><a href="#配置https" class="headerlink" title="配置https"></a>配置https</h2><h3 id="添加解析"><a href="#添加解析" class="headerlink" title="添加解析"></a>添加解析</h3><p>前提要有域名，这里以<a href="https://console.cloud.tencent.com/cns">腾讯云域名解析</a>为例：</p><p><img src="/./img/3f0b/1661589489899.png" alt="添加解析"></p><h3 id="申请免费证书"><a href="#申请免费证书" class="headerlink" title="申请免费证书"></a>申请免费证书</h3><p>这里以腾讯云域名申请证书为例：</p><p><a href="https://console.cloud.tencent.com/ssl">腾讯云申请免费证书</a></p><p>这里绑定的是子域名</p><p><img src="/./img/3f0b/1661589047749.png" alt="申请免费证书"></p><p>验证域名后，等待签发，签发成功后是这样，点击下载：</p><p><img src="/./img/3f0b/1661589172142.png" alt="签发证书"></p><p>下载后解压出来有四个文件：</p><p><img src="/./img/3f0b/1661589265312.png" alt="证书文件"></p><p>只需要上传<code>twikoo.aqcoder.cn_bundle.pem</code>和<code>twikoo.aqcoder.cn.key</code>到服务器即可。</p><p>Nginx配置如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">  #监听twikoo.aqcoder.cn</span><br><span class="line">  server &#123;</span><br><span class="line">      listen 80;</span><br><span class="line">      server_name twikoo.aqcoder.cn;</span><br><span class="line">      return  301 https://$server_name$request_uri;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  server &#123;</span><br><span class="line">      listen       443 ssl;</span><br><span class="line">      ssl_certificate /etc/ssl/twikoo.aqcoder.cn/twikoo.aqcoder.cn.pem;</span><br><span class="line">      ssl_certificate_key /etc/ssl/twikoo.aqcoder.cn/twikoo.aqcoder.cn.key;</span><br><span class="line">      ssl_session_cache    shared:SSL:4m;</span><br><span class="line">      ssl_session_timeout  10m;</span><br><span class="line">      ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">      ssl_prefer_server_ciphers on;</span><br><span class="line">      server_name  twikoo.aqcoder.cn;</span><br><span class="line">location /&#123;</span><br><span class="line">          proxy_pass http://127.0.0.1:8080/;</span><br><span class="line">          proxy_redirect off;</span><br><span class="line">          proxy_set_header Host $host;</span><br><span class="line">          proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">          proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>在本配置中，证书的位置在<code>/etc/ssl/twikoo.aqcoder.cn</code>，请根据需要自行修改</p><p>访问<code>twikoo.aqcoder.cn</code>：</p><p><img src="/./img/3f0b/1661589580603.png" alt="评论接口效果"></p><h2 id="添加自启动脚本"><a href="#添加自启动脚本" class="headerlink" title="添加自启动脚本"></a>添加自启动脚本</h2><h3 id="编写启动脚本"><a href="#编写启动脚本" class="headerlink" title="编写启动脚本"></a>编写启动脚本</h3><p>为防止服务器重启造成服务中断，可以添加自启动脚本，开机自启：</p><p>vim twikoo</p><p>将以下内容粘贴，:wq保存</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"># chkconfig: 2345 85 15</span><br><span class="line"># description:auto_run</span><br><span class="line"></span><br><span class="line">#评论数据存放路径</span><br><span class="line">ROOT_PATH=&quot;/www/data/twikoo/&quot;</span><br><span class="line">TWIKOO_DATA=$ROOT_PATH&quot;data&quot;</span><br><span class="line">#启动端口</span><br><span class="line">TWIKOO_PORT=8080</span><br><span class="line">#限流</span><br><span class="line">TWIKOO_THROTTLE=250</span><br><span class="line"></span><br><span class="line">#初始化方法，安装node</span><br><span class="line">init() &#123;</span><br><span class="line"></span><br><span class="line">#删除twikoo配置文件中原有的环境变量</span><br><span class="line">sed -ie &#x27;/TWIKOO_DATA/d&#x27; /etc/profile</span><br><span class="line">sed -ie &#x27;/TWIKOO_PORT/d&#x27; /etc/profile</span><br><span class="line">sed -ie &#x27;/TWIKOO_THROTTLE/d&#x27; /etc/profile</span><br><span class="line"></span><br><span class="line">#添加twikoo的环境变量，直接写入配置文件</span><br><span class="line">echo &quot;export TWIKOO_DATA=$TWIKOO_DATA&quot; &gt;&gt;/etc/profile</span><br><span class="line">echo &quot;export TWIKOO_PORT=$TWIKOO_PORT&quot; &gt;&gt;/etc/profile</span><br><span class="line">echo &quot;export TWIKOO_THROTTLE=$TWIKOO_THROTTLE&quot; &gt;&gt;/etc/profile</span><br><span class="line">echo &quot;export PATH=\$TWIKOO_DATA:\$PATH&quot; &gt;&gt;/etc/profile</span><br><span class="line">echo &quot;export PATH=\$TWIKOO_PORT:\$PATH&quot; &gt;&gt;/etc/profile</span><br><span class="line">echo &quot;export PATH=\$TWIKOO_THROTTLE:\$PATH&quot; &gt;&gt;/etc/profile</span><br><span class="line"></span><br><span class="line">#判断文件夹是否存在 -d</span><br><span class="line">if [[ ! -d &quot;$TWIKOO_DATA&quot; ]]; then</span><br><span class="line">mkdir -p $TWIKOO_DATA</span><br><span class="line">else</span><br><span class="line">echo &quot;文件夹存在&quot;</span><br><span class="line">fi</span><br><span class="line">source /etc/profile</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#开始方法</span><br><span class="line">start() &#123;</span><br><span class="line">echo &#x27;运行twikoo&#x27;</span><br><span class="line">source /etc/profile</span><br><span class="line">cd ~</span><br><span class="line">    nohup tkserver &gt;&gt; $ROOT_PATH&quot;tkserver.log&quot; 2&gt;&amp;1 &amp;</span><br><span class="line">ps -ef | grep twikoo</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#结束方法</span><br><span class="line">stop() &#123;</span><br><span class="line">    kill -9 `ps -ef|grep tkserver|grep -v grep|grep -v stop|awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">start)</span><br><span class="line">init</span><br><span class="line">    start</span><br><span class="line">    ;;</span><br><span class="line">stop)</span><br><span class="line">    stop</span><br><span class="line">    ;;</span><br><span class="line">restart)</span><br><span class="line">init</span><br><span class="line">    stop</span><br><span class="line">    start</span><br><span class="line">    ;;</span><br><span class="line">*)</span><br><span class="line">    echo &quot;Userage: $0 &#123;start|stop|restart&#125;&quot;</span><br><span class="line">    exit 1</span><br><span class="line">esac</span><br></pre></td></tr></table></figure><p>脚本中可以按需修改<code>ROOT_PATH</code>，<code>TWIKOO_PORT</code>，<code>TWIKOO_THROTTLE</code></p><h3 id="设置脚本存放路径"><a href="#设置脚本存放路径" class="headerlink" title="设置脚本存放路径"></a>设置脚本存放路径</h3><p>复制刚刚保存的脚本到<code>/etc/init.d/</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp twikoo /etc/init.d/</span><br></pre></td></tr></table></figure><h3 id="添加执行权限"><a href="#添加执行权限" class="headerlink" title="添加执行权限"></a>添加执行权限</h3><p>给脚本可执行权限</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /etc/init.<span class="property">d</span>/twikoo</span><br></pre></td></tr></table></figure><h3 id="设置开机启动"><a href="#设置开机启动" class="headerlink" title="设置开机启动"></a>设置开机启动</h3><p>添加为系统服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --add twikoo</span><br></pre></td></tr></table></figure><p>开机自启动</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig twikoo on</span><br></pre></td></tr></table></figure><p>查看</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --list</span><br></pre></td></tr></table></figure><p>启动</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service twikoo start</span><br></pre></td></tr></table></figure><p>停用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service twikoo stop</span><br></pre></td></tr></table></figure><p>重启</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service twikoo restart</span><br></pre></td></tr></table></figure><div class="note info flat"><p>注意定期备份评论数据</p></div>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Twikoo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>高性能Web应用服务器Nginx常用功能之——限制用户请求</title>
      <link href="/posts/5e1e/"/>
      <url>/posts/5e1e/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>nginx有两个限流模块：</p><p>1、ngx_http_limit_conn_module 限制速率策略，使用计数器算法</p><p>2、ngx_http_limit_req_module 并发限制策略，使用漏桶算法，引用一篇<a href="https://cloud.tencent.com/developer/article/2058553">文章</a>来解释该算法：</p><p>算法思想是：</p><ul><li>水（请求）从上方倒入水桶，从水桶下方流出（被处理）；</li><li>来不及流出的水存在水桶中（缓冲），以固定速率流出；</li><li>水桶满后水溢出（丢弃）。</li><li>这个算法的核心是：缓存请求、匀速处理、多余的请求直接丢弃。</li></ul><p><img src="/./img/5e1e/1661520427922.png" alt="限流原理"></p><h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">limit_req_zone key zone rate</span><br><span class="line">limit_conn_zone key zone</span><br></pre></td></tr></table></figure><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><h3 id="限制请求数"><a href="#限制请求数" class="headerlink" title="限制请求数"></a>限制请求数</h3><p>1、<code>limit_req_zone</code>：定义限流策略为限制速率策略</p><p>2、<code>$binary_remote_addr</code>：<code>remote_addr</code>为存储客户端的ip地址变量，加上binary_为了压缩IP地址</p><p>3、<code>zone=req_limit:10m</code>：<code>znoe</code>指定内存区域，<code>req_limit</code>为该区域的名称，<code>10m</code>指这块内存区域的大小，</p><p>一般10m能存储16W IP 地址访问信息</p><p>4、<code>rate=10r/s</code>：指定最大访问速率，10r&#x2F;s表示每秒最多允许接受10个请求，即100ms内最多有一个请求，当100ms内还有请求，则nginx丢弃该请求。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">limit_req_zone $binary_remote_addr zone=req_limit:10m rate=10r/s;</span><br><span class="line">server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name  blog.aqcoder.cn;</span><br><span class="line">        # limit_req，使用限制速率策略</span><br><span class="line">        # burst=5，设置一个大小为 5 的缓冲区（队列），当有大量请求（爆发）过来时，超过了访问频次限制的 # 请求可以先放到这个缓冲区内。</span><br><span class="line">        # nodelay，要求立即处理请求；如果设置，超过访问频次而且缓冲区也满了的时候就会直接返回 503，如果    # 没有设置，则所有请求会等待排队。</span><br><span class="line">        # limit_req_status 指定请求时报错产生的状态码</span><br><span class="line">        limit_req zone=req_limit burst=5 nodelay;</span><br><span class="line">        limit_req_status 503;</span><br><span class="line">        </span><br><span class="line">        location /&#123;</span><br><span class="line">            root   /www/blog.aqcoder.cn;</span><br><span class="line">try_files $uri $uri/ /index.html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        # 当发生指定错误的时候返回50x页面</span><br><span class="line">        error_page 502 503 =200 /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root /usr/local/nginx/html;</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="限制连接数"><a href="#限制连接数" class="headerlink" title="限制连接数"></a>限制连接数</h3><p>1、limit_req_zone：定义限流策略为并发限制策略</p><p>2、$binary_remote_addr：remote_addr为存储客户端的ip地址变量，加上binary_为了压缩IP地址</p><p>2、$server_name：server_name表示虚拟主机(server) 同时能处理并发连接的总数</p><p>3、zone&#x3D;perip:10m：znoe指定内存区域，req_limit为该区域的名称，10m指这块内存区域的大小，</p><p>一般10m能存储16W IP 地址访问信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line"> # 定义限流策略</span><br><span class="line"> limit_conn_zone $binary_remote_addr zone=perip:10m;</span><br><span class="line"> limit_conn_zone $server_name zone=perserver:10m;</span><br><span class="line"> # 搜索服务的虚拟主机</span><br><span class="line"> server &#123;</span><br><span class="line"> location / &#123;</span><br><span class="line"> # 使用并发限制策略，表示限制单个 IP 同时最多能持有 1 个连接</span><br><span class="line"> # limit_conn perip 1;</span><br><span class="line"> # 表示虚拟主机(server) 同时能处理并发连接的总数。只有当 request header 被后端 server   # 处理后，这个连接才进行计数</span><br><span class="line"> limit_conn perserver 10 ;</span><br><span class="line">         limit_conn_status 503;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">conf配置</button></li><li class="tab"><button type="button" data-href="#tab-1-2">效果展示</button></li><li class="tab"><button type="button" data-href="#tab-1-3">配置解释</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">  worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line"></span><br><span class="line">limit_req_zone $binary_remote_addr zone=req_limit:10m rate=1r/s;</span><br><span class="line"></span><br><span class="line">    server&#123;</span><br><span class="line">      listen 8032;</span><br><span class="line">      server_name 119.91.143.195;</span><br><span class="line">      location /&#123;</span><br><span class="line">          root /www/blog/aaa/;</span><br><span class="line">          try_files $uri $uri/ /index.html;</span><br><span class="line">          limit_req zone=req_limit burst=1 nodelay;</span><br><span class="line">          limit_req_status 503;</span><br><span class="line">          </span><br><span class="line"> # 当发生指定错误的时候返回50x页面</span><br><span class="line">        error_page 502 503 =200 /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root /usr/local/nginx/html;</span><br><span class="line">        &#125; </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/./img/5e1e/20220826214509.gif" alt="限流效果"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>rate&#x3D;1r&#x2F;s：速率为1次&#x2F;秒</p><p>burst&#x3D;1：缓冲1个请求</p><p>nodelay：要求立即处理</p><p>综上，当我的访问速率超过2r&#x2F;s时，Nginx会返回503，而error_page代码部分则捕获了503状态码，并返回了<code>/usr/local/nginx/html/50x.html</code>页面</p><p><code>限制连接数</code>效果展示同理，可自行测试。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>高性能Web应用服务器Nginx三大功能之——负载均衡</title>
      <link href="/posts/68ad/"/>
      <url>/posts/68ad/</url>
      
        <content type="html"><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>负载均衡就是将大量的请求按照某种方式均衡分配给集群中的服务器，防止大量请求只请求一台服务器，从而导致服务崩溃。</p><p><img src="/./img/68ad/1661434931816.png" alt="负载均衡"></p><h2 id="轮询策略"><a href="#轮询策略" class="headerlink" title="轮询策略"></a>轮询策略</h2><p>Nginx负载均衡策略（内置）主要有四种：</p><ul><li>轮询策略（默认的负载均衡策略）</li><li>最少连接数负载均衡策略</li><li>ip-hash负载均衡策略</li><li>权重负载均衡策略</li></ul><h3 id="轮询策略-1"><a href="#轮询策略-1" class="headerlink" title="轮询策略"></a>轮询策略</h3><p>轮询负载策略是指每次将请求按顺序轮流发送至相应的服务器上：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">upstream server_list &#123;</span><br><span class="line">server 111.229.10.76:8080;</span><br><span class="line">server 113.12.43.122:8080;</span><br><span class="line">server 119.33.31.61:8080;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server&#123;</span><br><span class="line">listen 80;</span><br><span class="line">location /&#123;</span><br><span class="line">proxy_pass: http://myapp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="最少连接数负载均衡策略"><a href="#最少连接数负载均衡策略" class="headerlink" title="最少连接数负载均衡策略"></a>最少连接数负载均衡策略</h3><p>此策略是指每次将请求分发到当前连接数最少的服务器上，也就是 Nginx 会将请求试图转发给相对空闲的服务器以实现负载均衡，它的配置示例如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">   #负载均衡</span><br><span class="line">upstream server_list &#123;</span><br><span class="line">least_conn;</span><br><span class="line">server 111.229.10.76:8080;</span><br><span class="line">server 113.12.43.122:8080;</span><br><span class="line">server 119.33.31.61:8080;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server&#123;</span><br><span class="line">listen 80;</span><br><span class="line">location /&#123;</span><br><span class="line">proxy_pass: http://myapp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ip-hash-负载均衡策略"><a href="#ip-hash-负载均衡策略" class="headerlink" title="ip-hash 负载均衡策略"></a>ip-hash 负载均衡策略</h3><p>ip-hash 负载均衡策略可以根据客户端的 IP，将其固定的分配到相应的服务器上，配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">   #负载均衡</span><br><span class="line">upstream server_list &#123;</span><br><span class="line">ip-hash;</span><br><span class="line">server 111.229.10.76:8080;</span><br><span class="line">server 113.12.43.122:8080;</span><br><span class="line">server 119.33.31.61:8080;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server&#123;</span><br><span class="line">listen 80;</span><br><span class="line">location /&#123;</span><br><span class="line">proxy_pass: http://myapp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="加权负载均衡"><a href="#加权负载均衡" class="headerlink" title="加权负载均衡"></a>加权负载均衡</h3><p>此配置方式是指每次按照服务器配置的去权重进行请求分发，权重高的服务器会收到更多的请求，这就相当于给 Nginx 在请求分发时加了一个参考的权重选项，并且这个权重值是可以人工配置的，我们可以将服务器配置高的调的权重相对高一些，以便承担更多请求：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">upstream server_list &#123;</span><br><span class="line">server 111.229.10.76:8080 weight=5;</span><br><span class="line">server 113.12.43.122:8080 weight=2;</span><br><span class="line">server 119.33.31.61:8080 weight=1;</span><br><span class="line">server 43.12.12.31:8080 backup;</span><br><span class="line">server 12.31.23.44:8080 down;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server&#123;</span><br><span class="line">listen 80;</span><br><span class="line">location /&#123;</span><br><span class="line">proxy_pass: http://myapp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中，8次请求中，有5次发给了权重为5的服务器，2次发给了权重为2的服务器，1次发给了权重为1的服务器，down代表临时不参与负载，backup代表其他全部的非backup机器down或者忙的时候，请求backup机器。所以这台机器压力会最轻</p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>高性能Web应用服务器Nginx三大功能之——Nginx反向代理</title>
      <link href="/posts/830e/"/>
      <url>/posts/830e/</url>
      
        <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><h4 id="正向代理"><a href="#正向代理" class="headerlink" title="正向代理"></a>正向代理</h4><p>如果把局域网外的 Internet 想象成一个巨大的资源库，则局域网中的客户端要访问 Internet，则需要通过代理服务器来访问，这种代理服务就称为正向代理。</p><p><img src="/./img/830e/1661395226139.png" alt="正向代理原理"></p><h4 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h4><p>客户端对代理是无感知的，因为客户端不需要任何配置就可以访问，我们只需要将请求发送到反向代理服务器，由反向代理服务器去选择目标服务器获取数据后，在返回给客户端，此时反向代理服务器和目标服务器对外就是一个服务器，暴露的是代理服务器地址，隐藏了真实服务器 IP 地址。 </p><p><img src="/./img/830e/1661395486077.png" alt="反向代理原理"></p><p>正向代理和反向代理的区别：</p><p>​如果我们自己调用本地接口，就是正向代理。</p><p>​如果是调用服务器接口，我们用户无感知，就是反向代理。</p><h3 id="location配置"><a href="#location配置" class="headerlink" title="location配置"></a>location配置</h3><p>Nginx的反向代理主要通过location来配置，来看一个简单的例子</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80; #监听80端口</span><br><span class="line">    location /random &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1:8098/;#代理到8098端口</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>定义一个server模块，表示一个虚拟主机</p><ul><li><p>listen 80：监听80端口</p></li><li><p>location &#x2F;random：当请求的路径含有&#x2F;random*或者&#x2F;random&#x2F;*，则匹配成功，例如location&#x2F;random11 或者location&#x2F;random&#x2F;11，都是可以匹配成功的</p></li><li><p>proxy_pass <a href="http://127.0.0.1:8098/%EF%BC%9A%E8%BD%AC%E5%8F%91%E8%AF%B7%E6%B1%82%E7%BB%99%E8%AF%A5%E5%9C%B0%E5%9D%80%EF%BC%8C%E5%8D%B3%E6%9C%AC%E6%AC%A1%E8%AF%B7%E6%B1%82%E5%88%B0%E7%9A%84%E7%9C%9F%E5%AE%9E%E5%9C%B0%E5%9D%80">http://127.0.0.1:8098/：转发请求给该地址，即本次请求到的真实地址</a></p></li></ul><h3 id="location-匹配顺序"><a href="#location-匹配顺序" class="headerlink" title="location 匹配顺序"></a>location 匹配顺序</h3><p>1、<strong>location</strong> 匹配格式规则前缀有如下几种：</p><ul><li><strong>&#x3D;</strong> <strong>开头</strong>：表示精确匹配</li><li><strong>^~</strong> <strong>开头</strong>：注意这不是一个正则表达式，它的目的是优于正则表达式的匹配；如果该 <strong>location</strong> 是最佳匹配，则不再进行正则表达式检测。</li><li><strong>~</strong> <strong>开头</strong>：表示区分大小写的正则匹配;</li><li><strong>~*</strong> <strong>开头</strong>：表示不区分大小写的正则匹配</li><li>**!~ &amp;&amp; !~***：表示区分大小写不匹配的正则和不区分大小写的不匹配的正则</li></ul><p>2、<strong>location</strong> 如果不带前缀就是普通字符串匹配，比如：</p><ul><li><strong>&#x2F;uri&#x2F;</strong> 普通字符串匹配</li><li><strong>&#x2F;</strong> 绝对路径根目录匹配，如果没有其它匹配，任何请求都会匹配到</li></ul><p>3、匹配的搜索顺序优先级如下（从上到下优先级依次递减）：</p><ul><li>首先匹配 <strong>&#x3D;</strong></li><li>其次匹配 <strong>^~</strong></li><li>再其次按照配置文件的顺序进行正则匹配</li><li>最后是交给 <strong>&#x2F;</strong> 进行通用匹配</li></ul><blockquote><p>注意：</p><p>当有匹配成功时，立刻停止匹配，按照当前匹配规则处理请求</p><p>优先搜索并不意味着优先命中！</p><p>字符串匹配优先搜索，但是只是记录下最长的匹配 ( 如果 <strong>^~</strong> 是最长的匹配，则会直接命中，停止搜索正则 )，然后继续搜索正则匹配，如果有正则匹配，则命中正则匹配，如果没有正则匹配，则命中最长的字符串匹配。</p></blockquote><h3 id="匹配模式及顺序举例"><a href="#匹配模式及顺序举例" class="headerlink" title="匹配模式及顺序举例"></a>匹配模式及顺序举例</h3><ul><li><strong>location &#x3D; &#x2F;uri</strong> 　　　<strong>&#x3D;</strong> 开头表示精确匹配，只有完全匹配上才能生效。</li><li><strong>location ^~ &#x2F;uri</strong> 　　<strong>^~</strong> 开头对 <strong>URL</strong> 路径进行前缀匹配，并且在正则之前。</li><li><strong>location ~ pattern</strong> 　<strong>~</strong> 开头表示区分大小写的正则匹配。</li><li><strong>location ~* pattern</strong> 　<strong>~*</strong> 开头表示不区分大小写的正则匹配。</li><li><strong>location &#x2F;uri</strong>       不带任何修饰符，也表示前缀匹配，但是在正则匹配之后，如果没有正则命中，命中最长的规则。</li><li><strong>location &#x2F;</strong> 　　通用匹配，任何未匹配到其它 <strong>location</strong> 的请求都会匹配到，相当于 <strong>switch</strong> 中的 <strong>default</strong>。</li></ul><h3 id="location-x2F-匹配规则"><a href="#location-x2F-匹配规则" class="headerlink" title="location &#x2F; 匹配规则"></a>location &#x2F; 匹配规则</h3><p>1、没有“**&#x2F;<strong>”结尾时，</strong>location&#x2F;random** 可以匹配 <strong>&#x2F;random11</strong> 请求，也可以匹配 <strong>&#x2F;random&#x2F;11</strong> 等</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80; #监听80端口</span><br><span class="line">    location /random &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1:8098/;#代理到8098端口</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、而有“**&#x2F;<strong>”结尾时，</strong>location&#x2F;random&#x2F;** 不能匹配 <strong>&#x2F;random11</strong> 请求，只能匹配 <strong>&#x2F;random&#x2F;11</strong> 这样的请求</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80; #监听80端口</span><br><span class="line">    location /random/ &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1:8098/;#代理到8098端口</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="proxy-pass-代理规则"><a href="#proxy-pass-代理规则" class="headerlink" title="proxy_pass 代理规则"></a>proxy_pass 代理规则</h3><p>1、没有“**&#x2F;<strong>”结尾时，</strong>Nginx** 则会把匹配的路径部分加入代理 <strong>uri</strong>，例如：</p><p>访问<a href="http://ip/random/getName%EF%BC%8C%E6%9C%80%E7%BB%88%E4%BB%A3%E7%90%86%E5%88%B0**URL**%E6%98%AF">http://ip:80/random/getName，最终代理到**URL**是</a> <a href="http://127.0.0.1:8098/random/getName">http://127.0.0.1:8098/random/getName</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80; #监听80端口</span><br><span class="line">    location /random &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1:8098;#代理到8098端口</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、而有“**&#x2F;<strong>”结尾时，相当于是</strong>绝对路径**，则 <strong>Nginx</strong>不会把 <strong>location</strong> 中匹配的路径部分加入代理 <strong>uri</strong>，例如：</p><p>访问<a href="http://ip/random/getName%EF%BC%8C%E6%9C%80%E7%BB%88%E4%BB%A3%E7%90%86%E5%88%B0**URL**%E6%98%AF">http://ip:80/random/getName，最终代理到**URL**是</a> <a href="http://127.0.0.1:8098/getName">http://127.0.0.1:8098/getName</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80; #监听80端口</span><br><span class="line">    location /random &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1:8098/;#代理到8098端口</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p><a href="https://www.hangge.com/blog/cache/detail_2979.html">https://www.hangge.com/blog/cache/detail_2979.html</a></p><p><a href="https://developer.aliyun.com/article/506996">https://developer.aliyun.com/article/506996</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>高性能Web应用服务器Nginx入门介绍</title>
      <link href="/posts/2c47/"/>
      <url>/posts/2c47/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p> Nginx(engine x)是一个高性能的HTTP和反向代理web服务器，具有低系统消耗、稳定、配置简单的特点，能够支持高达50000个并发连接数的响应。</p><h2 id="Nginx入门"><a href="#Nginx入门" class="headerlink" title="Nginx入门"></a>Nginx入门</h2><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>linux安装脚本<a href="/code/shell/install-nginx.sh" target="_blank">install-nginx.sh</a></p><p>安装的nginx位置：<code>/usr/local/nginx</code></p><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><p>nginx的配置在<code>conf/nginx.conf</code></p><p>先给出最简单的配置，server_name改成你自己的公网ip即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">  worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">    server&#123;</span><br><span class="line">      listen 80;</span><br><span class="line">      server_name 119.91.143.195;</span><br><span class="line">      location /&#123;</span><br><span class="line">         root html;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h4><p>服务器执行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx</span><br></pre></td></tr></table></figure><p>没有任何输出表示运行成功，默认运行端口为<code>80</code></p><div class="note info flat"><p>运行效果</p></div><p><img src="/./img/2c47/1661352774101.png" alt="nginx运行界面"></p><h3 id="Nginx常用命令"><a href="#Nginx常用命令" class="headerlink" title="Nginx常用命令"></a>Nginx常用命令</h3><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">启动Nginx</button></li><li class="tab"><button type="button" data-href="#tab-1-2">重新载入配置文件</button></li><li class="tab"><button type="button" data-href="#tab-1-3">停止Nginx</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -s stop</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="Nginx的常用场景配置"><a href="#Nginx的常用场景配置" class="headerlink" title="Nginx的常用场景配置"></a>Nginx的常用场景配置</h3><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">文件映射</button></li><li class="tab"><button type="button" data-href="#tab-1-2">子页面作为主页</button></li><li class="tab"><button type="button" data-href="#tab-1-3">反向代理</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><code>nginx.conf</code>配置：</p><p>有时候需要将博客部署在服务器作为源站，这时候就需要nginx为服务器文件映射给某个端口：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">  worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">    server&#123;</span><br><span class="line">      listen 8032;</span><br><span class="line">      server_name 119.91.143.195;</span><br><span class="line">      location /&#123;</span><br><span class="line">         root /www/blog;</span><br><span class="line">         try_files $uri $uri/ /index.html;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>try_files $uri $uri/ /index.html</code> 表示匹配到<code>/</code>时先尝试文件&#x2F;index.html，成功时返回，失败返回403，nginx默认设置。</p><p><code>服务器文件</code>：</p><p><img src="/./img/2c47/1661354218846.png" alt="定义index文件"></p><div class="note success flat"><p>运行效果</p></div><p><img src="/./img/2c47/1661352705480.png" alt="index文件界面"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><code>nginx.conf</code>配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">  worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">    server&#123;</span><br><span class="line">      listen 8032;</span><br><span class="line">      server_name 119.91.143.195;</span><br><span class="line">      location /&#123;</span><br><span class="line">         root /www/blog/aaa/;</span><br><span class="line">         try_files $uri $uri/ /index.html;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>服务器文件</code>：</p><p><img src="/./img/2c47/1661353566832.png" alt="服务器文件"></p><div class="note success flat"><p>运行效果</p></div><p><img src="/./img/2c47/1661354104730.png" alt="二级页面"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><code>反向代理</code>实际上和服务器文件映射类似，都是将本地资源允许其他人访问，通俗叫做本地接口映射</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">  worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">    server&#123;</span><br><span class="line">      listen 8032;</span><br><span class="line">      server_name 119.91.143.195;</span><br><span class="line">      location /&#123;</span><br><span class="line">         root /www/blog/aaa/;</span><br><span class="line">         try_files $uri $uri/ /index.html;</span><br><span class="line">      &#125;</span><br><span class="line">      location /api/&#123;</span><br><span class="line">         proxy_pass http://127.0.0.1:8098/;</span><br><span class="line">         proxy_redirect off;</span><br><span class="line">         proxy_set_header HOST $host;</span><br><span class="line">         proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">         proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note success flat"><p>运行效果</p></div><p><img src="/./img/2c47/1661356215637.png" alt="接口"></p><div class="note info flat"><p><code>location /api/</code>表示请求的路径严格匹配api字段，即请求的路径一定要有<code>/api/</code>，否则无法匹配到<code>/api/</code>，nginx无法匹配<code>/api1/getName</code>，导致返回了500服务器错误：</p></div><p><img src="/./img/2c47/1661355913211.png" alt="500错误"></p><div class="note info flat"><p><code>location /api</code>表示含有<code>/api</code>就行，故<code>/api1/getName</code>匹配成功：</p></div><p><img src="/./img/2c47/1661355852507.png" alt="请求路径错误"></p><div class="note info flat"><p><code>proxy_pass http://127.0.0.1:8098;</code>表示匹配路径成功后，将<a href="http://127.0.0.1:8098的访问结果返回">http://127.0.0.1:8098的访问结果返回</a></p></div><p><img src="/./img/2c47/1661356448757.png" alt="请求路径错误"></p><div class="note info flat"><p><code>proxy_pass http://127.0.0.1:8098/;</code>表示匹配路径成功后，将<a href="http://127.0.0.1:8098/getName%E7%9A%84%E8%AE%BF%E9%97%AE%E7%BB%93%E6%9E%9C%E8%BF%94%E5%9B%9E%EF%BC%8C%E8%BF%99%E9%87%8C%E7%9A%84getName%E5%AF%B9%E5%BA%94%E7%9D%80/api/getName%EF%BC%8C%E5%8D%B3%60proxy_pass%60%E5%90%8E%E9%9D%A2%E6%9C%89%60/%60%E8%A1%A8%E7%A4%BA%E5%B8%A6%E5%85%A5%E8%B7%AF%E5%BE%84%E5%90%8E%E9%9D%A2%E7%9A%84%E5%AD%97%E7%AC%A6">http://127.0.0.1:8098/getName的访问结果返回，这里的getName对应着/api/getName，即`proxy_pass`后面有`/`表示带入路径后面的字符</a></p></div><p><img src="/./img/2c47/1661356215637.png" alt="请求接口"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://nginx.org/">Nginx官网</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python+Github Action搭建必应壁纸api</title>
      <link href="/posts/af9f/"/>
      <url>/posts/af9f/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>​必应搜索每日都会有一张精美的图片，我们可以</p><p>​1、保存下来搭建api用于图片展示</p><p>​2、放在博客当博客背景</p><p>​于是便有了<a href="https://github.com/flow2000/bing-wallpaper-api">本项目</a>的诞生。<a href="https://github.com/flow2000/bing-wallpaper-api">本项目</a>借助python实现：</p><p>​1、服务端获取2018-至今的壁纸接口数据，并存储到Mongodb</p><p>​2、提供json接口和图片接口</p><p>项目地址：<a href="https://github.com/flow2000/bing-wallpaper-api">https://github.com/flow2000/bing-wallpaper-api</a></p><h3 id="API接口说明"><a href="#API接口说明" class="headerlink" title="API接口说明"></a>API接口说明</h3><h4 id="获取今日壁纸"><a href="#获取今日壁纸" class="headerlink" title="获取今日壁纸"></a>获取今日壁纸</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://api.bimg.cc/today?w=1920&amp;h=1080&amp;mkt=zh-CN</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">参数名</th><th align="center">类型</th><th align="center">是否必要</th><th align="center">备注</th></tr></thead><tbody><tr><td align="center">w</td><td align="center"><code>Int</code></td><td align="center">否</td><td align="center">图片宽度，默认1920</td></tr><tr><td align="center">h</td><td align="center"><code>Int</code></td><td align="center">否</td><td align="center">图片高度，默认1080</td></tr><tr><td align="center">uhd</td><td align="center"><code>Bool</code></td><td align="center">否</td><td align="center">是否4k，默认False</td></tr><tr><td align="center">mkt</td><td align="center"><code>String</code></td><td align="center">否</td><td align="center">地区，默认zh-CN</td></tr></tbody></table><h4 id="获取随机壁纸"><a href="#获取随机壁纸" class="headerlink" title="获取随机壁纸"></a>获取随机壁纸</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://api.bimg.cc/random?w=1920&amp;h=1080&amp;mkt=zh-CN</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">参数名</th><th align="center">类型</th><th align="center">是否必要</th><th align="center">备注</th></tr></thead><tbody><tr><td align="center">w</td><td align="center"><code>Int</code></td><td align="center">否</td><td align="center">图片宽度，默认1920</td></tr><tr><td align="center">h</td><td align="center"><code>Int</code></td><td align="center">否</td><td align="center">图片高度，默认1080</td></tr><tr><td align="center">uhd</td><td align="center"><code>Bool</code></td><td align="center">否</td><td align="center">是否4k，默认False</td></tr><tr><td align="center">mkt</td><td align="center"><code>String</code></td><td align="center">否</td><td align="center">地区，默认zh-CN</td></tr></tbody></table><h4 id="获取壁纸JSON数据"><a href="#获取壁纸JSON数据" class="headerlink" title="获取壁纸JSON数据"></a>获取壁纸JSON数据</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://api.bimg.cc/all?page=1&amp;order=asc&amp;limit=10&amp;w=1920&amp;h=1080&amp;mkt=zh-CN</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">参数名</th><th align="center">类型</th><th align="center">是否必要</th><th align="center">备注</th></tr></thead><tbody><tr><td align="center">page</td><td align="center"><code>Int</code></td><td align="center">否</td><td align="center">页数，默认1</td></tr><tr><td align="center">limit</td><td align="center"><code>Int</code></td><td align="center">否</td><td align="center">每页数据量，默认10（1-20）</td></tr><tr><td align="center">w</td><td align="center"><code>Int</code></td><td align="center">否</td><td align="center">图片宽度，默认1920</td></tr><tr><td align="center">h</td><td align="center"><code>Int</code></td><td align="center">否</td><td align="center">图片高度，默认1080</td></tr><tr><td align="center">order</td><td align="center"><code>string</code></td><td align="center">否</td><td align="center">排序，默认降序<code>desc</code>，升序<code>asc</code></td></tr><tr><td align="center">mkt</td><td align="center"><code>String</code></td><td align="center">否</td><td align="center">地区，默认zh-CN</td></tr></tbody></table><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 已知分辨率</span><br><span class="line">resolutions: [</span><br><span class="line"><span class="code">    &#x27;1920x1200&#x27;,</span></span><br><span class="line"><span class="code">    &#x27;1920x1080&#x27;,</span></span><br><span class="line"><span class="code">    &#x27;1366x768&#x27;,</span></span><br><span class="line"><span class="code">    &#x27;1280x768&#x27;,</span></span><br><span class="line"><span class="code">    &#x27;1024x768&#x27;,</span></span><br><span class="line"><span class="code">    &#x27;800x600&#x27;,</span></span><br><span class="line"><span class="code">    &#x27;800x480&#x27;,</span></span><br><span class="line"><span class="code">    &#x27;768x1280&#x27;,</span></span><br><span class="line"><span class="code">    &#x27;720x1280&#x27;,</span></span><br><span class="line"><span class="code">    &#x27;640x480&#x27;,</span></span><br><span class="line"><span class="code">    &#x27;480x800&#x27;,</span></span><br><span class="line"><span class="code">    &#x27;400x240&#x27;,</span></span><br><span class="line"><span class="code">    &#x27;320x240&#x27;,</span></span><br><span class="line"><span class="code">    &#x27;240x320&#x27;</span></span><br><span class="line"><span class="code">]</span></span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 已知国家地区</span><br><span class="line">locations: [</span><br><span class="line"><span class="code">    &quot;de-DE&quot;,</span></span><br><span class="line"><span class="code">    &quot;en-CA&quot;,</span></span><br><span class="line"><span class="code">    &quot;en-GB&quot;,</span></span><br><span class="line"><span class="code">    &quot;en-IN&quot;,</span></span><br><span class="line"><span class="code">    &quot;en-US&quot;,</span></span><br><span class="line"><span class="code">    &quot;fr-FR&quot;,</span></span><br><span class="line"><span class="code">    &quot;it-IT&quot;,</span></span><br><span class="line"><span class="code">    &quot;ja-JP&quot;,</span></span><br><span class="line"><span class="code">    &quot;zh-CN&quot;</span></span><br><span class="line"><span class="code">]</span></span><br></pre></td></tr></table></figure><h4 id="获取壁纸数量"><a href="#获取壁纸数量" class="headerlink" title="获取壁纸数量"></a>获取壁纸数量</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://api.bimg.cc/total?mkt=zh-CN</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">参数名</th><th align="center">类型</th><th align="center">是否必要</th><th align="center">备注</th></tr></thead><tbody><tr><td align="center">mkt</td><td align="center"><code>String</code></td><td align="center">否</td><td align="center">地区，默认zh-CN</td></tr></tbody></table><h2 id="成果"><a href="#成果" class="headerlink" title="成果"></a>成果</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">今日壁纸</button></li><li class="tab"><button type="button" data-href="#tab-1-2">随机壁纸</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://api.bimg.cc/today</span><br></pre></td></tr></table></figure><p><img src="https://api.bimg.cc/today" alt="今日壁纸"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://api.bimg.cc/random</span><br></pre></td></tr></table></figure><p><img src="https://api.bimg.cc/random" alt="随机壁纸"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><h3 id="vercel部署"><a href="#vercel部署" class="headerlink" title="vercel部署"></a>vercel部署</h3><p>1、在 <a href="https://www.mongodb.com/cloud/atlas/register">MongoDB</a> 申请 MongoDB 帐号，具体可查看我的博客教程：<a href="https://blog.aqcoder.cn/posts/b267/">如何申请一个永久免费的 Mongodb 数据库 - 详细版</a></p><p>2、在<a href="https://vercel.com/signup">Vercel</a>申请 Vercel帐号</p><p>3、创建数据库用户名和密码，在IPAccess List添加<code>0.0.0.0</code>（代表允许所有 IP 地址的连接），在 Clusters 页面点击 CONNECT，选择第二个：Connect your application，并记录数据库连接字符串，请将连接字符串中的 <code>user</code>修改为数据库用户，<code>&lt;password&gt;</code> 修改为数据库密码</p><p>3、点击部署<a href="https://vercel.com/import/project?template=https://github.com/flow2000/bing-wallpaper-api/tree/master" target="_blank" rel="noopener noreferrer"><img src="https://vercel.com/button" alt="vercel deploy"></a></p><p>4、进入 Settings - Environment Variables，添加环境变量 <code>MONGODB_URI</code>，值为第 3 步的数据库连接字符串</p><p>5、进入 Overview，点击 Domains 下方的链接，添加一个子域名，并在域名解析添加一个<code>CNAME</code>解析：<code>cname.vercel-dns.com.</code>，等待刷新完成即可获得一个<code>https</code>的接口</p><h3 id="docker部署"><a href="#docker部署" class="headerlink" title="docker部署"></a>docker部署</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name bimg --restart=always --env MONGODB_URI= -p 9127:8888 flow2000/bimg</span><br></pre></td></tr></table></figure><p><code>MONGODB_URI</code>：存储方式为mongodb时的环境变量</p><h2 id="手动触发Action"><a href="#手动触发Action" class="headerlink" title="手动触发Action"></a>手动触发Action</h2><p>因为<code>Github Action</code>定时触发需要排队，可能会需要等待很长时间才会进行构建，但手动触发优先级会更高，等待时间会更短，所以我们需要调用github的API来手动触发。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line">  <span class="attr">schedule:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="attr">cron:</span> <span class="string">&#x27;30 0 * * *&#x27;</span></span><br><span class="line">  <span class="attr">repository_dispatch:</span></span><br><span class="line">    <span class="attr">types:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">webhook</span></span><br></pre></td></tr></table></figure><p>在<a href="https://github.com/settings/tokens">https://github.com/settings/tokens</a>选择<code>Generate new token</code>-&gt;<code>Generate new token (classic)</code>，过期时间选择No expiration，权限范围选择repo全部权限，复制生成的<code>令牌</code>。</p><p>从hiflow复制我的模板流程：<a href="https://hiflow.tencent.com/share/um1H7Drd0uYfCNhpPzsY48hFS5lOJDWf">https://hiflow.tencent.com/share/um1H7Drd0uYfCNhpPzsY48hFS5lOJDWf</a></p><p>其中，<your username>为用户名，<your repo>为仓库名，<your token>为上一步骤得到的令牌</p><p>例如：<a href="https://api.github.com/repos/flow2000/bing-wallpaper-api/dispatches">https://api.github.com/repos/flow2000/bing-wallpaper-api/dispatches</a></p><p><img src="/./img/b/af9f/637492784885a.png" alt="hiflow模板流程"></p><p>时间定为每天<code>08:00</code>，经测试，每个国家地区的壁纸都能更新到。</p><p>测试地址：<a href="https://github.com/flow2000/vercel-api/actions/runs/3474097895/jobs/5806877139">https://github.com/flow2000/vercel-api/actions/runs/3474097895/jobs/5806877139</a></p><h2 id="鸣谢"><a href="#鸣谢" class="headerlink" title="鸣谢"></a>鸣谢</h2><p>感谢<a href="https://github.com/Rock-Candy-Tea/hexo-circle-of-friends">hexo-circle-of-friends</a>的自动化思路</p><p>感谢<a href="https://github.com/zkeq/Bing-Wallpaper-Action">Bing-Wallpaper-Action</a>的分地区思路以及仓库的初始化数据</p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 必应壁纸 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>笔记本电脑开机自动更换背景壁纸</title>
      <link href="/posts/e22f/"/>
      <url>/posts/e22f/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>​必应搜索每日都会有一张精美的图片，我们可以每次开机设置最新壁纸到电脑背景</p><h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><p>​1、需拥有python环境</p><p>​2、需要在有网络环境下运行</p><p>​    3、最好先单独执行set_today_background.py，执行错误则需要pip安装以上导入的包</p><h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><p>1、克隆项目</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">git</span> <span class="string">clone</span> <span class="string">git@github.com:flow2000/set-today-background.git</span></span><br></pre></td></tr></table></figure><p>2、编辑set_today_background.py的root_path路径，编辑start.bat中path路径（python安装路径）和python文件路径</p><p>3、将set_today_background.py放入图片文件中，start.bat放入C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp，开机重启验证即可</p><p>至此已实现客户端开机自动下载壁纸并设置电脑背景的需求（有网的情况下）。</p><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p>1、本程序有一个缺陷：当开机后没有联网运行set_today_background.py会导致下载壁纸失败。可以在start.bat中set path&#x3D;xxx前加入：</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timeout <span class="number">60</span></span><br></pre></td></tr></table></figure><p>60是秒数，start.bat内已加入timeout 3，可自行设置时长，限定时间内自行连上网即可</p><p>可设置计划任务到0点00分执行该脚本，具体操作可百度查看</p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 必应壁纸 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly博客主题搭建系列：标签外挂教程</title>
      <link href="/posts/5dd3/"/>
      <url>/posts/5dd3/</url>
      
        <content type="html"><![CDATA[<h2 id="标签外挂（Tag-Plugins）"><a href="#标签外挂（Tag-Plugins）" class="headerlink" title="标签外挂（Tag Plugins）"></a>标签外挂（Tag Plugins）</h2><div class="note info icon-padding flat"><i class="note-icon falt"></i><p>标签外挂是Hexo独有的功能，并不是标准的Markdown格式。</p><p>以下的写法，只适用于Butterfly主题，用在其它主题上不会有效果，甚至可能会报错。使用前请留意</p></div><div class="note warning icon-padding flat"><i class="note-icon falt"></i><p>标签外挂虽然能为主题带来一些额外的功能和UI方面的强化，但是，标签外挂也有明显的限制，使用时请留意。</p></div><h3 id="Note-Bootstrap-Callout"><a href="#Note-Bootstrap-Callout" class="headerlink" title="Note (Bootstrap Callout)"></a>Note (Bootstrap Callout)</h3><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">固定icon通用设置</button></li><li class="tab"><button type="button" data-href="#tab-1-2">自定义icon通用设置</button></li><li class="tab"><button type="button" data-href="#tab-1-3">全局设置</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>语法：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note [class] [no-icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">名称</th><th align="center">用法</th></tr></thead><tbody><tr><td align="center">class</td><td align="center">【可选】标识，不同的标识有不同的配色<br/>（ default &#x2F; primary &#x2F; success &#x2F; info &#x2F; warning &#x2F; danger ）</td></tr><tr><td align="center">no-icon</td><td align="center">【可选】不显示 icon</td></tr><tr><td align="center">style</td><td align="center">【可选】可以覆盖配置中的 style<br/>（simple&#x2F;modern&#x2F;flat&#x2F;disabled）</td></tr></tbody></table><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">simple样式</button></li><li class="tab"><button type="button" data-href="#tab-1-2">modern样式</button></li><li class="tab"><button type="button" data-href="#tab-1-3">flat样式</button></li><li class="tab"><button type="button" data-href="#tab-1-4">disabled样式</button></li><li class="tab"><button type="button" data-href="#tab-1-5">no-icon样式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><div class="note simple"><p>默认 提示块标签</p></div><div class="note default simple"><p>default 提示块标签</p></div><div class="note primary simple"><p>primary 提示块标签</p></div><div class="note success simple"><p>success 提示块标签</p></div><div class="note info simple"><p>info 提示块标签</p></div><div class="note warning simple"><p>warning 提示块标签</p></div><div class="note danger simple"><p>danger 提示块标签</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note simple %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default simple %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary simple %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success simple %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info simple %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning simple %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger simple %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><div class="note modern"><p>默认 提示块标签</p></div><div class="note default modern"><p>default 提示块标签</p></div><div class="note primary modern"><p>primary 提示块标签</p></div><div class="note success modern"><p>success 提示块标签</p></div><div class="note info modern"><p>info 提示块标签</p></div><div class="note warning modern"><p>warning 提示块标签</p></div><div class="note danger modern"><p>danger 提示块标签</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note modern %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default modern %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary modern %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success modern %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info modern %&#125;</span><br><span class="line">info 提示块标籤</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning modern %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger modern %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><div class="note flat"><p>默认 提示块标签</p></div><div class="note default flat"><p>default 提示块标签</p></div><div class="note primary flat"><p>primary 提示块标签</p></div><div class="note success flat"><p>success 提示块标签</p></div><div class="note info flat"><p>info 提示块标签</p></div><div class="note warning flat"><p>warning 提示块标签</p></div><div class="note danger flat"><p>danger 提示块标签</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note flat %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default flat %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary flat %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success flat %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info flat  %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning flat %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger flat %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><div class="note disabled"><p>默认 提示块标签</p></div><div class="note default disabled"><p>default 提示块标签</p></div><div class="note primary disabled"><p>primary 提示块标签</p></div><div class="note success disabled"><p>success 提示块标签</p></div><div class="note info disabled"><p>info 提示块标签</p></div><div class="note warning disabled"><p>warning 提示块标签</p></div><div class="note danger disabled"><p>danger 提示块标签</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note disabled %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default disabled %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary disabled %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success disabled %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info disabled %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning disabled %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger disabled %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><div class="note disabled"><p>默认 提示块标签</p></div><div class="note default no-icon flat"><p>default 提示块标签</p></div><div class="note primary no-icon flat"><p>primary 提示块标签</p></div><div class="note success no-icon flat"><p>success 提示块标签</p></div><div class="note info no-icon flat"><p>info 提示块标签</p></div><div class="note warning no-icon flat"><p>warning 提示块标签</p></div><div class="note danger no-icon flat"><p>danger 提示块标签</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note disabled %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default no-icon %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary no-icon %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success no-icon %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info no-icon %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning no-icon %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger no-icon %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><div class="note info flat"><p>3.2.0 以上版本支持</p></div><p>note 语法：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note [color] [icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">名称</th><th align="center">用法</th></tr></thead><tbody><tr><td align="center">color</td><td align="center">【可选】顔色<br/>(default &#x2F; blue &#x2F; pink &#x2F; red &#x2F; purple &#x2F; orange &#x2F; green)</td></tr><tr><td align="center">icon</td><td align="center">【可选】可配置自定义 icon (只支持 fontawesome 图标, 也可以配置 no-icon )</td></tr><tr><td align="center">style</td><td align="center">【可选】可以覆盖配置中的 style<br/>（simple&#x2F;modern&#x2F;flat&#x2F;disabled）</td></tr></tbody></table><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">simple样式</button></li><li class="tab"><button type="button" data-href="#tab-1-2">modern样式</button></li><li class="tab"><button type="button" data-href="#tab-1-3">flat样式</button></li><li class="tab"><button type="button" data-href="#tab-1-4">disabled样式</button></li><li class="tab"><button type="button" data-href="#tab-1-5">no-icon样式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><div class="note icon-padding simple"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding simple"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding simple"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding simple"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding simple"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding simple"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; simple %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; simple %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; simple %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; simple%&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; simple %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; simple %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; simple %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><div class="note icon-padding modern"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding modern"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding modern"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding modern"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; modern %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; modern %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; modern %&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; modern %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; modern %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; modern %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><div class="note icon-padding flat"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding flat"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding flat"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding flat"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding flat"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding flat"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; flat %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; flat %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; flat %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; flat %&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; flat %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; flat %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; flat %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><div class="note icon-padding disabled"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding disabled"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding disabled"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding disabled"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding disabled"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding disabled"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding disabled"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; disabled %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; disabled %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; disabled %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; disabled %&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; disabled %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; disabled %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; disabled %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><div class="note no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue no-icon flat"><p>2021年快到了….</p></div><div class="note pink no-icon flat"><p>小心开车 安全至上</p></div><div class="note red no-icon flat"><p>这是三片呢？还是四片？</p></div><div class="note orange no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple no-icon flat"><p>剪刀石头布</p></div><div class="note green no-icon flat"><p>前端最讨厌的浏览器</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note blue no-icon %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note pink no-icon %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note red no-icon %&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note orange no-icon %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note purple no-icon %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green no-icon %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>移植于next主题，并进行修改。修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Note (Bootstrap Callout)</span></span><br><span class="line"><span class="attr">note:</span></span><br><span class="line">  <span class="comment"># Note tag style values:</span></span><br><span class="line">  <span class="comment">#  - simple    bs-callout old alert style. Default.</span></span><br><span class="line">  <span class="comment">#  - modern    bs-callout new (v2-v3) alert style.</span></span><br><span class="line">  <span class="comment">#  - flat      flat callout style with background, like on Mozilla or StackOverflow.</span></span><br><span class="line">  <span class="comment">#  - disabled  disable all CSS styles import of note tag.</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">flat</span></span><br><span class="line">  <span class="attr">icons:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">border_radius:</span> <span class="number">3</span></span><br><span class="line">  <span class="comment"># Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span></span><br><span class="line">  <span class="comment"># Offset also applied to label tag variables. This option can work with disabled note tag.</span></span><br><span class="line">  <span class="attr">light_bg_offset:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><p><code>icons</code>和<code>light_bg_offset</code>只对方法一生效</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="Gallery相册图库"><a href="#Gallery相册图库" class="headerlink" title="Gallery相册图库"></a>Gallery相册图库</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>name：图库名字</li><li>description：图库描述</li><li>link：连接到对应相册的地址</li><li>img-url：图库封面的地址</li></ul><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span><br><span class="line">&#123;% galleryGroup &#x27;壁纸&#x27; &#x27;收藏的一些壁纸&#x27; &#x27;/gallery/wallpaper/&#x27; https://api.aqcoder.cn/today %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="gallery-group-main">  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://api.aqcoder.cn/today' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">壁纸</div>  <p>收藏的一些壁纸</p>  <a href='/gallery/wallpaper/'></a>  </figcaption>  </figure>  </div><h3 id="Gallery相册"><a href="#Gallery相册" class="headerlink" title="Gallery相册"></a>Gallery相册</h3><p>区别于旧版的Gallery相册,新的Gallery相册会自动根据图片长度进行排版，书写也更加方便，与markdown格式一样。可根据需要插入到相应的md。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">markdown 图片格式</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://api.aqcoder.cn/random?w=1024&amp;h=768</span>)</span><br><span class="line">![](<span class="link">https://api.aqcoder.cn/random?w=1024&amp;h=768</span>)</span><br><span class="line">![](<span class="link">https://api.aqcoder.cn/random?w=1024&amp;h=768</span>)</span><br><span class="line">![](<span class="link">https://api.aqcoder.cn/random?w=1024&amp;h=768</span>)</span><br><span class="line">![](<span class="link">https://api.aqcoder.cn/random?w=1024&amp;h=768</span>)</span><br><span class="line">![](<span class="link">https://api.aqcoder.cn/random?w=1024&amp;h=768</span>)</span><br><span class="line">![](<span class="link">https://api.aqcoder.cn/random?w=1024&amp;h=768</span>)</span><br><span class="line">![](<span class="link">https://api.aqcoder.cn/random?w=1024&amp;h=768</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><div class="fj-gallery"><p><img src="https://api.aqcoder.cn/random?t=1&w=1024&h=768" alt="必应壁纸|壁纸"><br><img src="https://api.aqcoder.cn/random?t=2&w=1024&h=768" alt="必应壁纸|壁纸"><br><img src="https://api.aqcoder.cn/random?t=3&w=1024&h=768" alt="必应壁纸|壁纸"><br><img src="https://api.aqcoder.cn/random?t=4&w=1024&h=768" alt="必应壁纸|壁纸"><br><img src="https://api.aqcoder.cn/random?t=5&w=1024&h=768" alt="必应壁纸|壁纸"><br><img src="https://api.aqcoder.cn/random?t=6&w=1024&h=768" alt="必应壁纸|壁纸"><br><img src="https://api.aqcoder.cn/random?t=7&w=1024&h=768" alt="必应壁纸|壁纸"><br><img src="https://api.aqcoder.cn/random?t=8&w=1024&h=768" alt="必应壁纸|壁纸"></p>          </div><h3 id="Tabs"><a href="#Tabs" class="headerlink" title="Tabs"></a>Tabs</h3><p>移植于next主题</p><p>使用方法</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line">&lt;!-- tab [Tab caption] [@icon] --&gt;</span><br><span class="line">Any content (support inline tags too).</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br><span class="line"></span><br><span class="line">Unique name   : Unique name of tabs block tag without comma.</span><br><span class="line"><span class="code">                Will be used in #id&#x27;s as prefix for each tab with their index numbers.</span></span><br><span class="line"><span class="code">                If there are whitespaces in name, for generate #id all whitespaces will replaced by dashes.</span></span><br><span class="line"><span class="code">                Only for current url of post/page must be unique!</span></span><br><span class="line"><span class="code">[index]       : Index number of active tab.</span></span><br><span class="line"><span class="code">                If not specified, first tab (1) will be selected.</span></span><br><span class="line"><span class="code">                If index is -1, no tab will be selected. It&#x27;s will be something like spoiler.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br><span class="line"><span class="code">[Tab caption] : Caption of current tab.</span></span><br><span class="line"><span class="code">                If not caption specified, unique name with tab index suffix will be used as caption of tab.</span></span><br><span class="line"><span class="code">                If not caption specified, but specified icon, caption will empty.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br><span class="line"><span class="code">[@icon]       : FontAwesome icon name (full-name, look like &#x27;fas fa-font&#x27;)</span></span><br><span class="line"><span class="code">                Can be specified with or without space; e.g. &#x27;Tab caption @icon&#x27; similar to &#x27;Tab caption@icon&#x27;.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>例子 - 自定义Tab名 + 只有icon + icon和Tab名</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test4 %&#125;</span><br><span class="line">&lt;!-- tab 第一个Tab --&gt;</span><br><span class="line"><span class="strong">**tab名字为第一个Tab**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @fab fa-apple-pay --&gt;</span><br><span class="line"><span class="strong">**只有图标 没有Tab名字**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab 炸弹@fas fa-bomb --&gt;</span><br><span class="line"><span class="strong">**名字+icon**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">第一个Tab</button></li><li class="tab"><button type="button" data-href="#test4-2"><i class="fab fa-apple-pay" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#test4-3"><i class="fas fa-bomb"></i>炸弹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><p><strong>tab名字为第一个Tab</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><p><strong>只有图标 没有Tab名字</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-3"><p><strong>名字+icon</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="mermaid"><a href="#mermaid" class="headerlink" title="mermaid"></a>mermaid</h3><p>使用mermaid标签可以绘制Flowchart（流程图）、Sequence diagram（时序图 ）、Class Diagram（类别图）、State Diagram（状态图）、Gantt（甘特图）和Pie Chart（圆形图），具体可以查看<a href="https://mermaid-js.github.io/mermaid/#/">mermaid文档</a></p><p>修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mermaid</span></span><br><span class="line"><span class="comment"># see https://github.com/mermaid-js/mermaid</span></span><br><span class="line"><span class="attr">mermaid:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># built-in themes: default/forest/dark/neutral</span></span><br><span class="line">  <span class="attr">theme:</span></span><br><span class="line">    <span class="attr">light:</span> <span class="string">default</span></span><br><span class="line">    <span class="attr">dark:</span> <span class="string">dark</span></span><br></pre></td></tr></table></figure><p>写法：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% mermaid %&#125;</span><br><span class="line">内容</span><br><span class="line">&#123;% endmermaid %&#125;</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% mermaid %&#125;</span><br><span class="line">pie</span><br><span class="line"><span class="code">    title Key elements in Product X</span></span><br><span class="line"><span class="code">    &quot;Calcium&quot; : 42.96</span></span><br><span class="line"><span class="code">    &quot;Potassium&quot; : 50.05</span></span><br><span class="line"><span class="code">    &quot;Magnesium&quot; : 10.01</span></span><br><span class="line"><span class="code">    &quot;Iron&quot; :  5</span></span><br><span class="line"><span class="code">&#123;% endmermaid %&#125;</span></span><br></pre></td></tr></table></figure><div class="mermaid-wrap"><pre class="mermaid-src" hidden>  pie    title Key elements in Product X    &quot;Calcium&quot; : 42.96    &quot;Potassium&quot; : 50.05    &quot;Magnesium&quot; : 10.01    &quot;Iron&quot; :  5  </pre></div><h3 id="tag-hide"><a href="#tag-hide" class="headerlink" title="tag-hide"></a>tag-hide</h3><div class="note warning modern"><p>请注意，tag-hide内的标签外挂content内都不建议有h1 - h6 等标题。因为Toc会把隐藏内容标题也显示出来，而且当滚动屏幕时，如果隐藏内容没有显示出来，会导致Toc的滚动出现异常。</p></div><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">Toggle</button></li><li class="tab"><button type="button" data-href="#tab-1-2">Inline</button></li><li class="tab"><button type="button" data-href="#tab-1-3">Block</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><div class="note info modern"><p>2.3.0以上支持</p></div><p>如果你需要展示的内容太多，可以把它隐藏在收缩框里，需要时再把它展开。</p><p>( display 不能包含英文逗号，可用<code>&amp;sbquo;</code>)</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideToggle display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideToggle %&#125;</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideToggle Butterfly安装方法 %&#125;</span><br><span class="line">在你的博客根目录里</span><br><span class="line">git clone -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly</span><br><span class="line">如果想要安装比较新的dev分支，可以</span><br><span class="line">git clone -b dev https://github.com/jerryc127/hexo-theme-butterfly.git themes/Butterfly</span><br><span class="line">&#123;% endhideToggle %&#125;</span><br></pre></td></tr></table></figure><details class="toggle" ><summary class="toggle-button" style="">Butterfly安装方法</summary><div class="toggle-content"><p>在你的博客根目录里</p><p>git clone -b master <a href="https://github.com/jerryc127/hexo-theme-butterfly.git">https://github.com/jerryc127/hexo-theme-butterfly.git</a> themes&#x2F;Butterfly</p><p>如果想要安装比较新的dev分支，可以</p><p>git clone -b dev <a href="https://github.com/jerryc127/hexo-theme-butterfly.git">https://github.com/jerryc127/hexo-theme-butterfly.git</a> themes&#x2F;Butterfly</p></div></details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><code>inline</code>在文本里面添加按钮隐藏内容，只限文字</p><p>( content不能包含英文逗号，可用<code>&amp;sbquo;</code>)</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideInline content,display,bg,color %&#125;</span><br></pre></td></tr></table></figure><ul><li><p>content: 文本内容</p></li><li><p>display: 按钮显示的文字(可选)</p></li><li><p>bg: 按钮的背景颜色(可选)</p></li><li><p>color: 按钮文字的颜色(可选)</p></li></ul><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">哪个英文字母最酷？ &#123;% hideInline 因为西装裤(C装酷),查看答案,#FF7242,#fff %&#125;</span><br><span class="line"></span><br><span class="line">门里站着一个人? &#123;% hideInline 闪 %&#125;</span><br></pre></td></tr></table></figure><p>哪个英文字母最酷？ <span class="hide-inline"><button type="button" class="hide-button" style="background-color: #FF7242;color: #fff">查看答案<br>  </button><span class="hide-content">因为西装裤(C装酷)</span></span></p><p>门里站着一个人? <span class="hide-inline"><button type="button" class="hide-button" style="">Click<br>  </button><span class="hide-content">闪</span></span></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><code>block</code>独立的block隐藏内容，可以隐藏很多内容，包括图片，代码块等等</p><p>( display 不能包含英文逗号，可用<code>&amp;sbquo;</code>)</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><ul><li><p>content: 文本内容</p></li><li><p>display: 按钮显示的文字(可选)</p></li><li><p>bg: 按钮的背景颜色(可选)</p></li><li><p>color: 按钮文字的颜色(可选)</p></li></ul><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">查看答案</span><br><span class="line">&#123;% hideBlock 查看答案 %&#125;</span><br><span class="line">傻子，怎么可能有答案</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><p>查看答案</p><div class="hide-block"><button type="button" class="hide-button" style="">查看答案    </button><div class="hide-content"><p>傻子，怎么可能有答案</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="Button"><a href="#Button" class="headerlink" title="Button"></a>Button</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btn [url],[text],[icon],[color] [style] [layout] [position] [size] %&#125;</span><br><span class="line"></span><br><span class="line">[url]         : 链接</span><br><span class="line">[text]        : 按钮文字</span><br><span class="line">[icon]        : [可选] 图标</span><br><span class="line">[color]       : [可选] 按钮背景顔色(默认style时）</span><br><span class="line"><span class="code">                      按钮字体和边框顔色(outline时)</span></span><br><span class="line"><span class="code">                      default/blue/pink/red/purple/orange/green</span></span><br><span class="line"><span class="code">[style]       : [可选] 按钮样式 默认实心</span></span><br><span class="line"><span class="code">                      outline/留空</span></span><br><span class="line"><span class="code">[layout]      : [可选] 按钮佈局 默认为line</span></span><br><span class="line"><span class="code">                      block/留空</span></span><br><span class="line"><span class="code">[position]    : [可选] 按钮位置 前提是设置了layout为block 默认为左边</span></span><br><span class="line"><span class="code">                      center/right/留空</span></span><br><span class="line"><span class="code">[size]        : [可选] 按钮大小</span></span><br><span class="line"><span class="code">                      larger/留空</span></span><br></pre></td></tr></table></figure><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">demo1</button></li><li class="tab"><button type="button" data-href="#tab-1-2">demo2</button></li><li class="tab"><button type="button" data-href="#tab-1-3">demo3</button></li><li class="tab"><button type="button" data-href="#tab-1-4">demo4</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">This is my website, click the button &#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,,outline %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,outline %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,larger %&#125;</span><br></pre></td></tr></table></figure><p>This is my website, click the button <a class="btn-beautify " href="https://blog.aqcoder.cn/"   title="aqcoder"><span>aqcoder</span></a><br>This is my website, click the button <a class="btn-beautify " href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><br>This is my website, click the button <a class="btn-beautify outline" href="https://blog.aqcoder.cn/"   title="aqcoder"><span>aqcoder</span></a><br>This is my website, click the button <a class="btn-beautify outline" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><br>This is my website, click the button <a class="btn-beautify larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,block %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,block center larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,block right outline larger %&#125;</span><br></pre></td></tr></table></figure><p><a class="btn-beautify block" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><br><a class="btn-beautify block center larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><br><a class="btn-beautify block right outline larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,blue larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,pink larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,red larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,purple larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,orange larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,green larger %&#125;</span><br></pre></td></tr></table></figure><p><a class="btn-beautify larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><a class="btn-beautify blue larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><a class="btn-beautify pink larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><a class="btn-beautify red larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><a class="btn-beautify purple larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><a class="btn-beautify orange larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><a class="btn-beautify green larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn-center&quot;</span>&gt;</span></span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,outline larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,outline blue larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,outline pink larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,outline red larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,outline purple larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,outline orange larger %&#125;</span><br><span class="line">&#123;% btn &#x27;https://blog.aqcoder.cn/&#x27;,aqcoder,far fa-hand-point-right,outline green larger %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="btn-center"><a class="btn-beautify outline larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><a class="btn-beautify outline blue larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><a class="btn-beautify outline pink larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><a class="btn-beautify outline red larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><a class="btn-beautify outline purple larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><a class="btn-beautify outline orange larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a><a class="btn-beautify outline green larger" href="https://blog.aqcoder.cn/"   title="aqcoder"><i class="far fa-hand-point-right"></i><span>aqcoder</span></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="inlineImg"><a href="#inlineImg" class="headerlink" title="inlineImg"></a>inlineImg</h3><p>主题中的图片都是默认以<code>块级元素</code>显示，如果你想以<code>内联元素</code>显示，可以使用这个标签外挂。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% inlineImg [src] [height] %&#125;</span><br><span class="line"></span><br><span class="line">[src]      :    图片链接</span><br><span class="line">[height]   ：   图片高度限制【可选】</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>例子</p></div><p>必应每日壁纸</p><p><img src="https://api.aqcoder.cn/today" alt="必应每日壁纸"></p><p>我觉得很好看 <img class="inline-img" src="https://blog.aqcoder.cn/img/avatar.png" style="height:150px"/></p><h3 id="label"><a href="#label" class="headerlink" title="label"></a>label</h3><p>高亮所需的文字</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% label text color %&#125;</span><br></pre></td></tr></table></figure><ul><li>text：文字</li><li>color：【可选】背景颜色，默认为 default（default&#x2F;blue&#x2F;pink&#x2F;red&#x2F;purple&#x2F;orange&#x2F;green）</li></ul><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">臣亮言：&#123;% label 先帝 %&#125;创业未半，而&#123;% label 中道崩殂 blue %&#125;。今天下三分，&#123;% label 益州疲敝 pink %&#125;，此诚&#123;% label 危急存亡之秋 red %&#125;也！然侍衞之臣，不懈于内；&#123;% label 忠志之士 purple %&#125;，忘身于外者，盖追先帝之殊遇，欲报之于陛下也。诚宜开张圣听，以光先帝遗德，恢弘志士之气；不宜妄自菲薄，引喻失义，以塞忠谏之路也。</span><br><span class="line">宫中、府中，俱为一体；陟罚臧否，不宜异同。若有&#123;% label 作奸 orange %&#125;、&#123;% label 犯科 green %&#125;，及为忠善者，宜付有司，论其刑赏，以昭陛下平明之治；不宜偏私，使内外异法也。</span><br></pre></td></tr></table></figure><p>臣亮言：<mark class="hl-label default">先帝</mark> 创业未半，而<mark class="hl-label blue">中道崩殂</mark> 。今天下三分，<mark class="hl-label pink">益州疲敝</mark> ，此诚<mark class="hl-label red">危急存亡之秋</mark> 也！然侍衞之臣，不懈于内；<mark class="hl-label purple">忠志之士</mark> ，忘身于外者，盖追先帝之殊遇，欲报之于陛下也。诚宜开张圣听，以光先帝遗德，恢弘志士之气；不宜妄自菲薄，引喻失义，以塞忠谏之路也。<br>宫中、府中，俱为一体；陟罚臧否，不宜异同。若有<mark class="hl-label orange">作奸</mark> 、<mark class="hl-label green">犯科</mark> ，及为忠善者，宜付有司，论其刑赏，以昭陛下平明之治；不宜偏私，使内外异法也。</p><h3 id="timeline"><a href="#timeline" class="headerlink" title="timeline"></a>timeline</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline title,color %&#125;</span><br><span class="line">&lt;!-- timeline title --&gt;</span><br><span class="line">xxxxx</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&lt;!-- timeline title --&gt;</span><br><span class="line">xxxxx</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><ul><li>text：标题&#x2F;时间线</li><li>color：timeline 颜色，default(留空) （blue &#x2F; pink &#x2F; red &#x2F; purple &#x2F; orange &#x2F; green）</li></ul><div class="note info no-icon flat"><p>例子</p></div><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">留空</button></li><li class="tab"><button type="button" data-href="#tab-1-2">blue</button></li><li class="tab"><button type="button" data-href="#tab-1-3">pink</button></li><li class="tab"><button type="button" data-href="#tab-1-4">red</button></li><li class="tab"><button type="button" data-href="#tab-1-5">purple</button></li><li class="tab"><button type="button" data-href="#tab-1-6">orange</button></li><li class="tab"><button type="button" data-href="#tab-1-7">green</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022 %&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline undefined"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022,blue %&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline blue"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022,pink %&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline pink"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022,red%&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline red"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022,purple%&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline purple"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-6"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022,orange%&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline orange"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-7"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 2022,green%&#125;</span><br><span class="line">&lt;!-- timeline 01-02 --&gt;</span><br><span class="line">这是测试页面</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><div class="timeline green"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p></div></div><div class='timeline-item-content'><p>这是测试页面</p></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="flink"><a href="#flink" class="headerlink" title="flink"></a>flink</h3><p>可在任何界面插入类似友情链接列表效果</p><p>内容格式与友情链接界面一样，支持 yml 格式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% flink %&#125;</span><br><span class="line">xxxxxx</span><br><span class="line">&#123;% endflink %&#125;</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>例子</p></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;% flink %&#125;</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> class<span class="emphasis">_name: 友情链接</span></span><br><span class="line"><span class="emphasis">  class_</span>desc: 博主</span><br><span class="line">  link<span class="emphasis">_list:</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">  - name: aqcoder</span></span><br><span class="line"><span class="emphasis">    link: https://blog.aqcoder.cn</span></span><br><span class="line"><span class="emphasis">    avatar: https://blog.aqcoder.cn/img/avatar.png</span></span><br><span class="line"><span class="emphasis">    descr: 分享知识，认识世界</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">- class_</span>name: 特别鸣谢</span><br><span class="line">  class<span class="emphasis">_desc: 博客框架及主题</span></span><br><span class="line"><span class="emphasis">  link_</span>list:</span><br><span class="line"></span><br><span class="line"><span class="bullet">  -</span> name: Hexo</span><br><span class="line"><span class="code">    link: https://hexo.io/zh-tw/</span></span><br><span class="line"><span class="code">    avatar: https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg</span></span><br><span class="line"><span class="code">    descr: 快速、簡單且強大的網誌框架</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="bullet">  -</span> name: Butterfly</span><br><span class="line"><span class="code">    link: https://butterfly.js.org/</span></span><br><span class="line"><span class="code">    avatar: https://butterfly.js.org/img/avatar.png</span></span><br><span class="line"><span class="code">    descr: A Simple and Card UI Design theme for Hexo</span></span><br><span class="line"><span class="code">&#123;% endflink %&#125;</span></span><br></pre></td></tr></table></figure><div class="flink"><div class="flink-name">友情链接</div><div class="flink-desc">博主</div> <div class="flink-list">          <div class="flink-list-item">            <a href="https://blog.aqcoder.cn" title="aqcoder" target="_blank">              <div class="flink-item-icon">                <img class="no-lightbox" src="https://blog.aqcoder.cn/img/avatar.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="aqcoder" />              </div>              <div class="flink-item-name">aqcoder</div>               <div class="flink-item-desc" title="分享知识，认识世界">分享知识，认识世界</div>            </a>          </div></div><div class="flink-name">特别鸣谢</div><div class="flink-desc">博客框架及主题</div> <div class="flink-list">          <div class="flink-list-item">            <a href="https://hexo.io/zh-tw/" title="Hexo" target="_blank">              <div class="flink-item-icon">                <img class="no-lightbox" src="https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="Hexo" />              </div>              <div class="flink-item-name">Hexo</div>               <div class="flink-item-desc" title="快速、簡單且強大的網誌框架">快速、簡單且強大的網誌框架</div>            </a>          </div>          <div class="flink-list-item">            <a href="https://butterfly.js.org/" title="Butterfly" target="_blank">              <div class="flink-item-icon">                <img class="no-lightbox" src="https://butterfly.js.org/img/avatar.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="Butterfly" />              </div>              <div class="flink-item-name">Butterfly</div>               <div class="flink-item-desc" title="A Simple and Card UI Design theme for Hexo">A Simple and Card UI Design theme for Hexo</div>            </a>          </div></div></div><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89">標籤外掛（Tag-Plugins）</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly博客主题搭建系列：进阶教程</title>
      <link href="/posts/c90c/"/>
      <url>/posts/c90c/</url>
      
        <content type="html"><![CDATA[<div class="note info icon-padding flat"><i class="note-icon falt"></i><p>不要把个人需要的文件&#x2F;图片放在主题<code>source</code>文件夹里，因为在升级主题的过程中，可能会把文件覆盖删除了。<br>在Hexo根目录的<code>source</code>文件夹里，创建一个文件夹来放置个人文件&#x2F;图片。引用文件直接为<code>/文件夹名称/文件名</code></p></div><h2 id="自定义图标"><a href="#自定义图标" class="headerlink" title="自定义图标"></a>自定义图标</h2><p>Butterfly主题内置了<a href="https://fontawesome.com/">Font Awesome V5</a> 图标，目前已更新到 5.13.0，总共有1,588个免费图标。由于是国外的图标网站，对于国内的一些网站Icon并不支持。如有需要，你可以引入其它的图标服务商。下面介绍<a href="https://www.iconfont.cn/">iconfont-阿里巴巴矢量图标库</a>引入自定义icon</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">注册iconfont账号</button></li><li class="tab"><button type="button" data-href="#tab-1-2">添加图标入库</button></li><li class="tab"><button type="button" data-href="#tab-1-3">生成CSS链接</button></li><li class="tab"><button type="button" data-href="#tab-1-4">添加链接进主题配置文件</button></li><li class="tab"><button type="button" data-href="#tab-1-5">添加博客样式文件</button></li><li class="tab"><button type="button" data-href="#tab-1-6">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/./img/c90c/20220821134948.png" alt="iconfont登录页"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>搜索想要的图标，添加到购物车并添加到项目（没有新建一个）</p><p><img src="/./img/c90c/1661061219224.png" alt="iconfont添加图标入库"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>添加成功后跳转到我的项目中，点击Font class，点击生成在线链接</p><p><img src="/./img/c90c/1661061695967.png" alt="iconfont生成CSS链接"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>打开<code>_config.butterfly.yml</code>，找到inject配置，按要求把链接填入</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Inject</span></span><br><span class="line"><span class="comment"># Insert the code to head (before &#x27;&lt;/head&gt;&#x27; tag) and the bottom (before &#x27;&lt;/body&gt;&#x27; tag)</span></span><br><span class="line"><span class="comment"># 插入代码到头部 &lt;/head&gt; 之前 和 底部 &lt;/body&gt; 之前</span></span><br><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;//at.alicdn.com/t/c/font_3587689_u063afxcp1.css&quot;&gt;</span></span><br><span class="line">    <span class="comment"># - &lt;link rel=&quot;stylesheet&quot; href=&quot;/xxx.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="comment"># - &lt;script src=&quot;xxxx&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>在我们需要使用的地方填入icon，例如icon-Bing，图片使用格式为iconfont icon名字，我的社交图标配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">iconfont icon-github:</span> <span class="string">https://gitee.com/pgh1038</span> <span class="string">||</span> <span class="string">Github</span></span><br><span class="line">  <span class="attr">iconfont icon-bilibili-line:</span> <span class="string">https://space.bilibili.com/334851399</span> <span class="string">||</span> <span class="string">bilibili</span></span><br><span class="line">  <span class="attr">iconfont icon-gitee-fill-round:</span> <span class="string">https://gitee.com/pgh1038</span> <span class="string">||</span> <span class="string">Gitee</span></span><br><span class="line">  <span class="attr">iconfont icon-csdn:</span> <span class="string">https://blog.csdn.net/qq_46231952</span> <span class="string">||</span> <span class="string">CSDN</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p>因为第三方图标样式可能和主题内置图标样式不一致，需要修改：</p><p>新建<code>博客根目录/source/css/blog.aqcoder.cn.css</code>，<code>blog.aqcoder.cn.css</code>这里修改为你自己的网站，样式文件内容：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 第三方图标样式 */</span></span><br><span class="line"><span class="selector-class">.iconfont</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Inject</span></span><br><span class="line"><span class="comment"># Insert the code to head (before &#x27;&lt;/head&gt;&#x27; tag) and the bottom (before &#x27;&lt;/body&gt;&#x27; tag)</span></span><br><span class="line"><span class="comment"># 插入代码到头部 &lt;/head&gt; 之前 和 底部 &lt;/body&gt; 之前</span></span><br><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;//at.alicdn.com/t/c/font_3587689_u063afxcp1.css&quot;&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/blog.aqcoder.cn.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="comment"># - &lt;script src=&quot;xxxx&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-6"><p><img src="/./img/c90c/1660999518197.png" alt="社交图标"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="音乐"><a href="#音乐" class="headerlink" title="音乐"></a>音乐</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">安装插件</button></li><li class="tab"><button type="button" data-href="#tab-1-2">生成音乐页面</button></li><li class="tab"><button type="button" data-href="#tab-1-3">修改配置</button></li><li class="tab"><button type="button" data-href="#tab-1-4">引入原生js的配置</button></li><li class="tab"><button type="button" data-href="#tab-1-5">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install <span class="literal">--save</span> hexo<span class="literal">-tag-aplayer</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page music</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>插件会在每一个文件都插入 js 和 css，为了避免重复插入，修改<code>_config.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">aplayer:</span></span><br><span class="line">  <span class="attr">asset_inject:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>然后在你需要使用aplayer的页面<code>Front-matter</code>添加</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aplayer: true</span><br></pre></td></tr></table></figure><p>这样只会在需要aplayer的页面插入js和css。在音乐页面使用以下语句即可展示音乐播放器：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% meting &quot;8594368955&quot; &quot;tencent&quot; &quot;playlist&quot; %&#125;</span><br></pre></td></tr></table></figure><p>music&#x2F;index.md配置示例：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">音乐</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2022-08-05 23:50:30</span></span><br><span class="line"><span class="attr">comments:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">top_img:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">aplayer:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="string">&lt;font</span> <span class="string">color=#0c74d6</span> <span class="string">size=3</span> <span class="string">face=&quot;黑体&quot;&gt;**喜欢的英文歌**&lt;/font&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&lt;!--</span> <span class="string">Simple</span> <span class="string">example</span> <span class="string">(songid,</span> <span class="string">server,</span> <span class="string">type)</span>  <span class="string">--&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="string">%</span> <span class="string">meting</span> <span class="string">&quot;8594368955&quot;</span> <span class="string">&quot;tencent&quot;</span> <span class="string">&quot;playlist&quot;</span> <span class="string">%</span>&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>还有引入原生js展示音乐播放器的形式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&#123;% aplayerlist %&#125;</span><br><span class="line">&#123;</span><br><span class="line"><span class="code">    &quot;narrow&quot;: false,                          </span></span><br><span class="line"><span class="code">    &quot;autoplay&quot;: false,                         </span></span><br><span class="line"><span class="code">    &quot;mode&quot;: &quot;circulation&quot;,                         </span></span><br><span class="line"><span class="code">    &quot;showlrc&quot;: 3,                             </span></span><br><span class="line"><span class="code">    &quot;mutex&quot;: true,                            </span></span><br><span class="line"><span class="code">    &quot;theme&quot;: &quot;#e6d0b2&quot;,                      </span></span><br><span class="line"><span class="code">    &quot;preload&quot;: &quot;metadata&quot;,                    </span></span><br><span class="line"><span class="code">    &quot;listmaxheight&quot;: &quot;513px&quot;,                 </span></span><br><span class="line"><span class="code">    &quot;music&quot;: [</span></span><br><span class="line"><span class="code">        &#123;</span></span><br><span class="line"><span class="code">            &quot;title&quot;: &quot;Mine Mine&quot;,</span></span><br><span class="line"><span class="code">            &quot;author&quot;: &quot;周杰伦&quot;,</span></span><br><span class="line"><span class="code">            &quot;url&quot;: &quot;https://music.aqcoder.cn/song/100.mp3&quot;,</span></span><br><span class="line"><span class="code">            &quot;lrc&quot;: &quot;/lrc/100.lrc&quot;,</span></span><br><span class="line"><span class="code">            &quot;pic&quot;: &quot;https://music.aqcoder.cn/pic/100.webp&quot;</span></span><br><span class="line"><span class="code">        &#125;,</span></span><br><span class="line"><span class="code">        &#123;</span></span><br><span class="line"><span class="code">            &quot;title&quot;: &quot;Mojito&quot;,</span></span><br><span class="line"><span class="code">            &quot;author&quot;: &quot;周杰伦&quot;,</span></span><br><span class="line"><span class="code">            &quot;url&quot;: &quot;https://music.aqcoder.cn/song/101.mp3&quot;,</span></span><br><span class="line"><span class="code">            &quot;lrc&quot;: &quot;/lrc/101.lrc&quot;,</span></span><br><span class="line"><span class="code">            &quot;pic&quot;: &quot;https://music.aqcoder.cn/pic/101.webp&quot;</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code">    ]</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code">&#123;% endaplayerlist %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p>使用hexo-tag-aplayer生成的音乐界面</p><p><img src="/./img/c90c/1661066831569.png" alt="使用hexo-tag-aplayer生成的音乐界面"></p><p>使用原生js导入的音乐界面</p><p><img src="/./img/c90c/1664243542634.png" alt="使用原生js导入的音乐界面"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="全局吸底Aplayer"><a href="#全局吸底Aplayer" class="headerlink" title="全局吸底Aplayer"></a>全局吸底Aplayer</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">修改配置</button></li><li class="tab"><button type="button" data-href="#tab-1-2">参数解释</button></li><li class="tab"><button type="button" data-href="#tab-1-3">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><code>_config.yml</code>添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">aplayer:</span></span><br><span class="line">  <span class="attr">meting:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">asset_inject:</span> <span class="literal">false</span> <span class="comment">#为了防止插入重复的资源，需要把asset_inject设为false</span></span><br></pre></td></tr></table></figure><p>修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Inject the css and script (aplayer/meting)</span></span><br><span class="line"><span class="attr">aplayerInject:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="literal">true</span></span><br><span class="line">  </span><br><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;div</span> <span class="string">class=&quot;aplayer</span> <span class="literal">no</span><span class="string">-destroy&quot;</span> <span class="string">data-id=&quot;8594368955&quot;</span> <span class="string">data-server=&quot;tencent&quot;</span> <span class="string">data-type=&quot;playlist&quot;</span> <span class="string">data-fixed=&quot;true&quot;</span> <span class="string">data-autoplay=&quot;false&quot;</span> <span class="string">data-lrctype=&quot;1&quot;&gt;</span> <span class="string">&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>Aplayer html参数解释</p><table><thead><tr><th align="center">option</th><th align="center">default</th><th align="center">description</th></tr></thead><tbody><tr><td align="center">data-id</td><td align="center">require</td><td align="center">song id &#x2F; playlist id &#x2F; album id &#x2F; search keyword</td></tr><tr><td align="center">data-server</td><td align="center">require</td><td align="center">music platform: netease, tencent, kugou, xiami, baidu</td></tr><tr><td align="center">data-type</td><td align="center">require</td><td align="center">song, playlist, album, search, artist</td></tr><tr><td align="center">data-fixed</td><td align="center">false</td><td align="center">enable fixed mode</td></tr><tr><td align="center">data-mini</td><td align="center">false</td><td align="center">enable mini mode</td></tr><tr><td align="center">data-autoplay</td><td align="center">false</td><td align="center">audio autoplay</td></tr><tr><td align="center">data-theme</td><td align="center">#2980b9</td><td align="center">main color</td></tr><tr><td align="center">data-loop</td><td align="center">all</td><td align="center">player loop play, values: ‘all’, ‘one’, ‘none’</td></tr><tr><td align="center">data-order</td><td align="center">list</td><td align="center">player play order, values: ‘list’, ‘random’</td></tr><tr><td align="center">data-preload</td><td align="center">auto</td><td align="center">values: ‘none’, ‘metadata’, ‘auto’</td></tr><tr><td align="center">data-volume</td><td align="center">0.7</td><td align="center">default volume, notice that player will remember user setting, default volume will not work after user set volume themselves</td></tr><tr><td align="center">data-mutex</td><td align="center">true</td><td align="center">prevent to play multiple player at the same time, pause other players when this player start play</td></tr><tr><td align="center">data-lrctype</td><td align="center">0</td><td align="center">lyric type</td></tr><tr><td align="center">data-listfolded</td><td align="center">false</td><td align="center">indicate whether list should folded at first</td></tr><tr><td align="center">data-listmaxheight</td><td align="center">340px</td><td align="center">list max height</td></tr><tr><td align="center">data-storagename</td><td align="center">metingjs</td><td align="center">localStorage key that store player setting</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>运行 Hexo 就可以看到网页左下角出现了 <code>Aplayer</code></p><p><img src="/./img/c90c/1661069224995.png" alt="全局Aplayer吸底"></p><p>最后，如果你想切换页面时，音乐不会中断。请把主题配置文件的<code>pjax</code>设为 <code>true</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="侧边栏电子时钟（弃用）"><a href="#侧边栏电子时钟（弃用）" class="headerlink" title="侧边栏电子时钟（弃用）"></a>侧边栏电子时钟（弃用）</h2><div class="note warning flat"><p>为简洁画面，已弃用</p></div><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">安装插件</button></li><li class="tab"><button type="button" data-href="#tab-1-2">添加配置</button></li><li class="tab"><button type="button" data-href="#tab-1-3">参数解释</button></li><li class="tab"><button type="button" data-href="#tab-1-4">使用模板</button></li><li class="tab"><button type="button" data-href="#tab-1-5">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>安装插件</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo<span class="literal">-electric-clock</span> <span class="literal">--save</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>在<code>_config.yml</code>添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">electric_clock:</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">all</span></span><br><span class="line">  <span class="attr">layout:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">class</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">sticky_layout</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">temple_html:</span> <span class="string">&#x27;&lt;div class=&quot;card-widget card-clock&quot;&gt;&lt;div class=&quot;card-glass&quot;&gt;&lt;div class=&quot;card-background&quot;&gt;&lt;div class=&quot;card-content&quot;&gt;&lt;div id=&quot;hexo_electric_clock&quot;&gt;&lt;img id=&quot;card-clock-loading&quot; src=&quot;https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif&quot; style=&quot;height: 120px; width: 100%;&quot; data-ll-status=&quot;loading&quot; class=&quot;entered loading&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>enable</td><td>是否开启插件</td></tr><tr><td>enable_page</td><td>路由地址，all 代表全局开启。如 &#x2F; 代表主页。</td></tr><tr><td>priority</td><td>插件的叠放顺序，数字越大，叠放约靠前。</td></tr><tr><td>layout.type</td><td>html类型可以是class或id</td></tr><tr><td>layout.name</td><td>名字</td></tr><tr><td>layout.index</td><td>在定义 class 的时候会出现多个 class 的情况，这时就需要使用 index，确定是哪一个</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>在md文件上也可以使用模板展示时钟，需要注意id&#x2F;class值和配置文件的id&#x2F;class值一样</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是墙&quot;</span> <span class="attr">class</span>=<span class="string">&quot;sticky_layout&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- id=&gt;type  recent-posts=&gt;name    --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是画框&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是纸&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--这里通过js挂载electric_clock，也就是画画--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p><img src="/./img/c90c/1661069035691.png" alt="侧边栏电子时钟"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="侧边栏Git贡献"><a href="#侧边栏Git贡献" class="headerlink" title="侧边栏Git贡献"></a>侧边栏Git贡献</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">安装插件</button></li><li class="tab"><button type="button" data-href="#tab-1-2">添加配置</button></li><li class="tab"><button type="button" data-href="#tab-1-3">参数解释</button></li><li class="tab"><button type="button" data-href="#tab-1-4">使用模板</button></li><li class="tab"><button type="button" data-href="#tab-1-5">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>安装插件</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo<span class="literal">-githubcalendar</span> <span class="literal">--save</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>在<code>_config.yml</code>添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># githubcalendar</span></span><br><span class="line"><span class="comment"># github近期代码贡献度</span></span><br><span class="line"><span class="comment"># https://github.com/Zfour/hexo-github-calendar</span></span><br><span class="line"><span class="attr">githubcalendar:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">/about/</span></span><br><span class="line">  <span class="attr">user:</span> <span class="string">flow2000</span></span><br><span class="line">  <span class="attr">layout:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">github_calendar</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">githubcalendar_html:</span> <span class="string">&#x27;&lt;div class=&quot;recent-post-item&quot; style=&quot;width:100%;height:auto;padding:10px;&quot;&gt;&lt;div id=&quot;github_loading&quot; style=&quot;width:10%;height:100%;margin:0 auto;display: block&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;  viewBox=&quot;0 0 50 50&quot; style=&quot;enable-background:new 0 0 50 50&quot; xml:space=&quot;preserve&quot;&gt;&lt;path fill=&quot;#d0d0d0&quot; d=&quot;M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z&quot; transform=&quot;rotate(275.098 25 25)&quot;&gt;&lt;animateTransform attributeType=&quot;xml&quot; attributeName=&quot;transform&quot; type=&quot;rotate&quot; from=&quot;0 25 25&quot; to=&quot;360 25 25&quot; dur=&quot;0.6s&quot; repeatCount=&quot;indefinite&quot;&gt;&lt;/animateTransform&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/div&gt;&lt;div id=&quot;github_container&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line">  <span class="attr">pc_minheight:</span> <span class="string">280px</span></span><br><span class="line">  <span class="attr">mobile_minheight:</span> <span class="string">0px</span></span><br><span class="line">  <span class="comment"># 以下色调选择喜欢的一行保留即可。其余注释。—————akilar的糖果色</span></span><br><span class="line">  <span class="comment"># color: &quot;[&#x27;#ebedf0&#x27;, &#x27;#fdcdec&#x27;, &#x27;#fc9bd9&#x27;, &#x27;#fa6ac5&#x27;, &#x27;#f838b2&#x27;, &#x27;#f5089f&#x27;, &#x27;#c4067e&#x27;, &#x27;#92055e&#x27;, &#x27;#540336&#x27;, &#x27;#48022f&#x27;, &#x27;#30021f&#x27;]&quot; #浅紫色调</span></span><br><span class="line">  <span class="comment"># color: &quot;[&#x27;#ebedf0&#x27;, &#x27;#f0fff4&#x27;, &#x27;#dcffe4&#x27;, &#x27;#bef5cb&#x27;, &#x27;#85e89d&#x27;, &#x27;#34d058&#x27;, &#x27;#28a745&#x27;, &#x27;#22863a&#x27;, &#x27;#176f2c&#x27;, &#x27;#165c26&#x27;, &#x27;#144620&#x27;]&quot; #翠绿色调</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;[&#x27;#ebedf0&#x27;, &#x27;#f1f8ff&#x27;, &#x27;#dbedff&#x27;, &#x27;#c8e1ff&#x27;, &#x27;#79b8ff&#x27;, &#x27;#2188ff&#x27;, &#x27;#0366d6&#x27;, &#x27;#005cc5&#x27;, &#x27;#044289&#x27;, &#x27;#032f62&#x27;, &#x27;#05264c&#x27;]&quot;</span> <span class="comment">#天青色调</span></span><br><span class="line">  <span class="comment"># 如果想搭建自用 api，具体的部署方案可看考 python_github_calendar_api 及 python_gitee_calendar_api 的文档说明</span></span><br><span class="line">  <span class="attr">api:</span> <span class="string">https://python-github-calendar-api-eta.vercel.app/api</span></span><br><span class="line">  <span class="comment"># api: https://python-gitee-calendar-api.vercel.app/api</span></span><br><span class="line">  <span class="attr">calendar_js:</span> <span class="string">https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js</span></span><br><span class="line">  <span class="attr">plus_style:</span> <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>enable</td><td>是否开启插件</td></tr><tr><td>enable_page</td><td>路由地址，all 代表全局开启。如 &#x2F; 代表主页。</td></tr><tr><td>user</td><td>你的 github 或者 gitee 用户名</td></tr><tr><td>priority</td><td>插件的叠放顺序，数字越大，叠放约靠前。</td></tr><tr><td>layout.type</td><td>html类型可以是class或id</td></tr><tr><td>layout.name</td><td>名字</td></tr><tr><td>layout.index</td><td>在定义 class 的时候会出现多个 class 的情况，这时就需要使用 index，确定是哪一个</td></tr><tr><td>pc_minheight</td><td>电脑端插件的最小高度，减少加载带来的视觉偏移</td></tr><tr><td>mobile_minheight</td><td>手机端插件的最小高度，减少加载带来的视觉偏移</td></tr><tr><td>color</td><td>calendar 的主题色</td></tr><tr><td>api</td><td>获取贡献数据api</td></tr><tr><td>calendar_js</td><td>jsd 加速的 js，将 github calendar 挂载入容器中</td></tr><tr><td>plus_style</td><td>提供可自定义的 style</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>在md文件上也可以使用模板展示git贡献，在md文件填写以下代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">name</span>=<span class="string">&quot;我是墙&quot;</span> <span class="attr">id</span>=<span class="string">&quot;github_calendar&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- id=&gt;type  recent-posts=&gt;name    --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">name</span>=<span class="string">&quot;我是画框&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">name</span>=<span class="string">&quot;我是纸&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--这里通过js挂载githubcalendar，也就是画画--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note warning flat"><p>需要注意id&#x2F;class值和配置文件的id&#x2F;class值一样</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p><img src="/./img/c90c/1661071250725.png" alt="侧边栏Git贡献"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="侧边栏历史上的今天（弃用）"><a href="#侧边栏历史上的今天（弃用）" class="headerlink" title="侧边栏历史上的今天（弃用）"></a>侧边栏历史上的今天（弃用）</h2><div class="note warning flat"><p>为简洁画面，已弃用</p></div><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">安装插件</button></li><li class="tab"><button type="button" data-href="#tab-1-2">添加配置</button></li><li class="tab"><button type="button" data-href="#tab-1-3">参数解释</button></li><li class="tab"><button type="button" data-href="#tab-1-4">使用模板</button></li><li class="tab"><button type="button" data-href="#tab-1-5">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>安装插件</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo<span class="literal">-history-calendar</span> <span class="literal">--save</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>在<code>_config.yml</code>添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 历史上的今天</span></span><br><span class="line"><span class="attr">history_calendar:</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">4</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">/share/</span></span><br><span class="line">  <span class="attr">layout:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">history_calendar</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">temple_html:</span> <span class="string">&#x27;&lt;div class=&quot;card-widget card-history&quot;&gt;&lt;div class=&quot;card-content&quot;&gt;&lt;div class=&quot;item-headline&quot;&gt;&lt;i class=&quot;fas fa-clock fa-spin&quot;&gt;&lt;/i&gt;&lt;span&gt;那年今日&lt;/span&gt;&lt;/div&gt;&lt;div id=&quot;history-baidu&quot; style=&quot;height: 100px;overflow: hidden&quot;&gt;&lt;div class=&quot;history_swiper-container&quot; id=&quot;history-container&quot; style=&quot;width: 100%;height: 100%&quot;&gt;&lt;div class=&quot;swiper-wrapper&quot; id=&quot;history_container_wrapper&quot; style=&quot;height:20px&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>enable</td><td>是否开启插件</td></tr><tr><td>enable_page</td><td>路由地址，all 代表全局开启。如 &#x2F; 代表主页。</td></tr><tr><td>priority</td><td>插件的叠放顺序，数字越大，叠放约靠前。</td></tr><tr><td>layout.type</td><td>html类型可以是class或id</td></tr><tr><td>layout.name</td><td>名字</td></tr><tr><td>layout.index</td><td>在定义 class 的时候会出现多个 class 的情况，这时就需要使用 index，确定是哪一个</td></tr><tr><td>temple_html</td><td>包含挂载容器</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>在md文件上也可以使用模板展示历史上的今天，复制以下内容到md文件即可：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">name</span>=<span class="string">&quot;我是墙&quot;</span> <span class="attr">id</span>=<span class="string">&quot;history_calendar&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- id=&gt;type  recent-posts=&gt;name    --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">name</span>=<span class="string">&quot;我是画框&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">name</span>=<span class="string">&quot;我是纸&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--这里通过js挂载githubcalendar，也就是画画--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note warning flat"><p>需要注意id&#x2F;class值和配置文件的id&#x2F;class值一样</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p><img src="/./img/c90c/1661071700457.png" alt="侧边栏历史上的今天"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="侧边栏访问统计"><a href="#侧边栏访问统计" class="headerlink" title="侧边栏访问统计"></a>侧边栏访问统计</h2><div class="note info flat"><p>建议使用最新版本：<a href="/posts/b20a/#%E6%B7%BB%E5%8A%A0%E8%AE%BF%E9%97%AE%E7%BB%9F%E8%AE%A1">Butterfly 博客优化</a></p></div><p>思路：自定义侧边栏，使用<a href="https://v6.51.la/">51.LA网站统计V6</a>数据挂件作为访问统计的数据源</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">安装统计代码</button></li><li class="tab"><button type="button" data-href="#tab-1-2">编辑数据挂件样式</button></li><li class="tab"><button type="button" data-href="#tab-1-3">自定义侧边栏</button></li><li class="tab"><button type="button" data-href="#tab-1-4">博主的配置</button></li><li class="tab"><button type="button" data-href="#tab-1-5">某些情况下widget失效</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>注册<a href="https://v6.51.la/">51.LA网站统计V6</a>，添加域名后，选择普通安装：</p><p><img src="/./img/c90c/1661689097799.png" alt="51.LA网站统计V6"></p><p>编辑<code>_config.butterfly.yml</code>添加自己的统计代码：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">charset=&quot;UTF-8&quot;</span> <span class="string">id=&quot;LA_COLLECT&quot;</span> <span class="string">src=&quot;//sdk.51.la/js-sdk-pro.min.js&quot;&gt;&lt;/script&gt;</span>     <span class="comment"># 网站统计V6安装代码</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script&gt;LA.init(&#123;id:&quot;KRFNvLFZwSFuA2NM&quot;,ck:&quot;KRFNvLFZwSFuA2NM&quot;&#125;)&lt;/script&gt;</span>                   <span class="comment"># 网站统计V6安装代码</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>添加代码并检测成功后进入<code>配置</code>-&gt;<code>参数设置</code>-&gt;<code>数据挂件</code>，开启挂件功能，按需求编辑样式：</p><p><img src="/./img/c90c/1661689515833.png" alt="编辑数据挂件样式"></p><p>复制代码：</p><p><img src="/./img/c90c/1661689661073.png" alt="复制代码"></p><p>可使用博主的挂件样式，只需修改<code>KRFNvLFZwSFuA2NM</code>为您的网站的值即可：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">id</span>=<span class="string">&quot;LA-DATA-WIDGET&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://v6-widget.51.la/v6/KRFNvLFZwSFuA2NM/quote.js?theme=#FFFFFF,#333333,#898989,#333333,#FFFFFF,#1690FF,18&amp;col=true&amp;f=12&amp;display=0,1,1,1,0,0,1,1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>在Hexo博客目录中的<code>source/_data</code>（如果没有 _data 文件夹，请自行创建），创建一个文件 <code>widget.yml</code></p><p>格式：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">top:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span></span><br><span class="line">    <span class="attr">id_name:</span></span><br><span class="line">    <span class="attr">name:</span></span><br><span class="line">    <span class="attr">icon:</span></span><br><span class="line">    <span class="attr">html:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span></span><br><span class="line">    <span class="attr">id_name:</span></span><br><span class="line">    <span class="attr">name:</span></span><br><span class="line">    <span class="attr">icon:</span></span><br><span class="line">    <span class="attr">order:</span></span><br><span class="line">    <span class="attr">html:</span></span><br></pre></td></tr></table></figure><div class="note info icon-padding flat"><i class="note-icon falt"></i><p>参数讲解</p></div><p>top: 创建的 widget 会出现在非 sticky 区域（即所有页面都会显示)</p><p>bottom: 创建的 widget 会出现在 sticky 区域（除了文章页都会显示)</p><table><thead><tr><th align="center">参数</th><th align="center">解释</th></tr></thead><tbody><tr><td align="center">class_name</td><td align="center">所创建的 widget 父类 class 名 （可选）</td></tr><tr><td align="center">id_name</td><td align="center">所创建的 widget 父类 id 名（可选）</td></tr><tr><td align="center">name</td><td align="center">所创建的 widget 标题</td></tr><tr><td align="center">icon</td><td align="center">所创建的 widget 图标</td></tr><tr><td align="center">order</td><td align="center">所创建的 widget 排序 （可选）</td></tr><tr><td align="center">html</td><td align="center">所创建的 widget 相关代码</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>博主的<code>widget.yml</code>配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">website_statistics</span></span><br><span class="line">    <span class="attr">id_name:</span> <span class="string">website_statistics</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">访问统计</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">iconfont</span> <span class="string">icon-tongji</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">html:</span> <span class="string">&#x27;&lt;div desc=&quot;我是墙&quot; class=&quot;sticky_layout&quot;&gt;&lt;div desc=&quot;我是画框&quot;&gt;&lt;div desc=&quot;我是纸&quot;&gt;&lt;script id=&quot;LA-DATA-WIDGET&quot; charset=&quot;UTF-8&quot; src=&quot;https://v6-widget.51.la/v6/KRFNvLFZwSFuA2NM/quote.js?theme=#FFFFFF,#333333,#898989,#333333,#FFFFFF,#1690FF,18&amp;col=true&amp;f=12&amp;display=0,1,1,1,0,0,1,1&quot;&gt;&lt;/script&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span></span><br></pre></td></tr></table></figure><p>注意：</p><p><code>iconfont icon-tongji</code>是博主在<a href="https://www.iconfont.cn/">iconfont-阿里巴巴矢量图标库</a>设置的图标，详情<a href="/posts/c90c/#%E8%87%AA%E5%AE%9A%E4%B9%89Iocn">点击这里</a></p><p><code>html</code>中博主添加一些代码防止某些情况无法加载：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是墙&quot;</span> <span class="attr">class</span>=<span class="string">&quot;sticky_layout&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是画框&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是纸&quot;</span>&gt;</span>统计代码<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p>版本：<code>Butterfly4.4.0</code> <code>Hexo6.2.0</code></p><p><code>widget.yml</code>配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">website_statistics</span></span><br><span class="line">    <span class="attr">id_name:</span> <span class="string">website_statistics</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">访问统计</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">iconfont</span> <span class="string">icon-tongji</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">html:</span> <span class="string">&#x27;&lt;script id=&quot;LA-DATA-WIDGET&quot; charset=&quot;UTF-8&quot; src=&quot;https://v6-widget.51.la/v6/KRFNvLFZwSFuA2NM/quote.js?theme=#FFFFFF,#333333,#898989,#333333,#FFFFFF,#1690FF,18&amp;col=true&amp;f=12&amp;display=0,1,1,1,0,0,1,1&quot;&gt;&lt;/script&gt;&#x27;</span></span><br></pre></td></tr></table></figure><p><code>_config.butterfly.yml</code>配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># toc (文章目录)</span></span><br><span class="line"><span class="attr">toc:</span></span><br><span class="line">  <span class="attr">post:</span> <span class="literal">true</span> <span class="comment"># 对文章页是否有效</span></span><br><span class="line">  <span class="attr">page:</span> <span class="literal">false</span> <span class="comment"># 对页面是否有效</span></span><br><span class="line">  <span class="attr">number:</span> <span class="literal">true</span> <span class="comment"># 是否展示章节数</span></span><br><span class="line">  <span class="attr">expand:</span> <span class="literal">true</span> <span class="comment"># 是否展开</span></span><br><span class="line">  <span class="attr">style_simple:</span> <span class="literal">true</span> <span class="comment"># for post 开启简洁模式</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># Pjax</span></span><br><span class="line"><span class="comment"># It may contain bugs and unstable, give feedback when you find the bugs.</span></span><br><span class="line"><span class="comment"># https://github.com/MoOx/pjax</span></span><br><span class="line"><span class="attr">pjax:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br></pre></td></tr></table></figure><p><code>Front-matter</code>配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Butterfly博客搭建（进阶教程）</span></span><br><span class="line"><span class="attr">abbrlink:</span> <span class="string">c90c</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2022-08-21 11:24:41</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Butterfly</span></span><br><span class="line"><span class="attr">categories:</span> <span class="string">Butterfly</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">本教程是Butterfly的进阶教程，用于增加博客的多样性，提升美感。</span></span><br><span class="line"><span class="attr">keywords:</span> <span class="string">Butterfly搭建教程</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">&#x27;https://api.aqcoder.cn/random?w=800&amp;h=480&#x27;</span></span><br><span class="line"><span class="attr">top_img:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">highlight_shrink:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">sticky:</span> <span class="number">99</span></span><br><span class="line"><span class="attr">toc:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">toc_number:</span> <span class="literal">true</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p>过程：点击文章页，从文章页点击导航栏的主页，访问统计侧边栏会失效：</p><p><img src="/./img/c90c/1661691422377.png" alt="访问统计侧边栏失效情况"></p><p>解决方法：</p><p><code>widget.yml</code>的<code>html</code>中修改代码为：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是墙&quot;</span> <span class="attr">class</span>=<span class="string">&quot;sticky_layout&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是画框&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">desc</span>=<span class="string">&quot;我是纸&quot;</span>&gt;</span>统计代码<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="图片压缩"><a href="#图片压缩" class="headerlink" title="图片压缩"></a>图片压缩</h2><p>Butterfly主题需要使用到很多图片。如果图片太大，会严重拖慢网站的加载速度。</p><p>图片压缩能够有效的缓解这个问题。</p><p>除了通过<code>gulp-imagemin</code>来压缩图片，还可以通过在线压缩网站和软件来进行压缩。网上有很多这样的工具，挑选一款适合自己的就行。</p><ul><li><a href="https://tinypng.com/">tinypng</a></li></ul><p>一个在线压缩的网站。压缩后的图片也保留了很高的质量，在知乎上很多人推荐，不过免费版有限制。</p><p><img src="/./img/c90c/1661074081876.png" alt="tinypng"></p><ul><li><a href="https://saerasoft.com/caesium/">caesium</a></li><li><a href="https://github.com/marketplace/imgbot">imgbot</a></li></ul><p>imgbot 是一款 Github 插件。</p><p>安装后，你上传图片到 Github 去，imgbot 会自动压缩图片并推送 PR，我们只需要合併 PR 就行</p><p>你可以配置 imgbot 的侦测方法、压缩方法（有损&#x2F;无损），具体可以查看插件的文档</p><h2 id="插件推荐"><a href="#插件推荐" class="headerlink" title="插件推荐"></a>插件推荐</h2><h3 id="hexo-abbrlink"><a href="#hexo-abbrlink" class="headerlink" title="hexo-abbrlink"></a><a href="https://github.com/rozbo/hexo-abbrlink">hexo-abbrlink</a></h3><p>可以把链接permalink转为数字的插件，配置容易，生成时自动转为数字。</p><h3 id="hexo-generator-feed"><a href="#hexo-generator-feed" class="headerlink" title="hexo-generator-feed"></a><a href="https://github.com/hexojs/hexo-generator-feed">hexo-generator-feed</a></h3><p>生成RSS文件的插件</p><h3 id="hexo-filter-nofollow"><a href="#hexo-filter-nofollow" class="headerlink" title="hexo-filter-nofollow"></a><a href="https://github.com/hexojs/hexo-filter-nofollow">hexo-filter-nofollow</a></h3><p>为网站使用到的所有外链添加rel&#x3D;”noopener external nofollow noreferrer”, 可以有效地加强网站SEO和防止权重流失</p><h3 id="hexo-generator-sitemap"><a href="#hexo-generator-sitemap" class="headerlink" title="hexo-generator-sitemap"></a><a href="https://github.com/hexojs/hexo-generator-sitemap">hexo-generator-sitemap</a></h3><p>生成sitemap的插件</p><h3 id="hexo-generator-baidu-sitemap"><a href="#hexo-generator-baidu-sitemap" class="headerlink" title="hexo-generator-baidu-sitemap"></a><a href="https://github.com/coneycode/hexo-generator-baidu-sitemap">hexo-generator-baidu-sitemap</a></h3><p>看名字就知道，是专门为百度生成sitemap的插件</p><h2 id="评论系统"><a href="#评论系统" class="headerlink" title="评论系统"></a>评论系统</h2><h3 id="Valine"><a href="#Valine" class="headerlink" title="Valine"></a>Valine</h3><p><a href="https://blog.csdn.net/weixin_34434736/article/details/113047474">https://blog.csdn.net/weixin_34434736/article/details/113047474</a></p><h3 id="Twikoo"><a href="#Twikoo" class="headerlink" title="Twikoo"></a>Twikoo</h3><p><a href="/posts/3f0b/">Twikoo 私有部署</a></p><p><a href="https://blog.leonus.cn/2022/inputAlert.html">给你的评论添加一个输入提醒吧 | Leonus</a></p><h2 id="在线聊天"><a href="#在线聊天" class="headerlink" title="在线聊天"></a>在线聊天</h2><p>看配置文件中的官方地址即可</p><h2 id="友链朋友圈"><a href="#友链朋友圈" class="headerlink" title="友链朋友圈"></a>友链朋友圈</h2><p><a href="https://fcircle-doc.yyyzyyyz.cn/#/deploy">项目部署</a></p><p><a href="https://fcircle-doc.yyyzyyyz.cn/#/frontenddeploy">前端部署</a></p><h2 id="收录"><a href="#收录" class="headerlink" title="收录"></a>收录</h2><p><a href="https://www.jianshu.com/p/7d3d87b52ad7">Hexo系列：（四）Hexo博客提交百度和Google收录 - 简书</a></p><p><a href="https://dora-cmon.github.io/posts/3b6da06d/">Hexo博客百度谷歌收录 | 哆啦 C 梦</a></p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://butterfly.js.org/posts/4073eda/#%E9%9F%B3%E6%A8%82">Butterfly 安裝文檔(六) 進階教程 | Butterfly</a></p><p><a href="https://butterfly.js.org/posts/507c070f/">Butterfly添加全局吸底Aplayer教程 | Butterfly</a></p><p><a href="https://zfe.space/post/hexo-githubcalendar.html">教程：hexo-githubcalendar 插件 1.0 | 小冰博客</a></p><p><a href="https://zfe.space/post/hexo-electric-clock.html">教程：hexo-electric-clock 电子时钟插件 | 小冰博客</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>市面上各种主流软件快捷键使用技巧</title>
      <link href="/posts/8a27/"/>
      <url>/posts/8a27/</url>
      
        <content type="html"><![CDATA[<h2 id="通用快捷键"><a href="#通用快捷键" class="headerlink" title="通用快捷键"></a>通用快捷键</h2><p>以下<code>+</code>号代表需要同时按下指定按键，例如<code>Ctrl+C</code>需要同时按下<code>Ctrl</code>和<code>C</code></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+C 复制 </span><br><span class="line">Ctrl+A 全选</span><br><span class="line">Ctrl+V 粘贴</span><br><span class="line">Ctrl+X 剪切</span><br><span class="line">Ctrl+F 搜索</span><br><span class="line">Ctrl+N 新增</span><br><span class="line">Ctrl+S 保存</span><br><span class="line">Ctrl+W 关闭</span><br><span class="line">Ctrl+Z 撤回</span><br></pre></td></tr></table></figure><h2 id="Windows快捷键"><a href="#Windows快捷键" class="headerlink" title="Windows快捷键"></a>Windows快捷键</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Win+D     返回桌面</span><br><span class="line">Win+E           打开文件资源管理器</span><br><span class="line">Alt+F4          关闭当前应用程序</span><br><span class="line">Ctrl+Shift+Esc  打开任务管理器(win10及以上)</span><br><span class="line">Ctrl+Alt+.      打开任务管理器(win7)</span><br></pre></td></tr></table></figure><h2 id="浏览器快捷键"><a href="#浏览器快捷键" class="headerlink" title="浏览器快捷键"></a>浏览器快捷键</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+T  打开新的标签页</span><br><span class="line">Ctrl+W  关闭当前标签页</span><br><span class="line">Ctrl+N  打开新的窗口</span><br><span class="line">Ctrl+H  打开历史记录</span><br><span class="line">Ctrl+D  当前网页添加书签 </span><br><span class="line">Ctrl+P  打印网页</span><br><span class="line">Ctrl+Shift+B 显示/隐藏书签</span><br><span class="line">F12      打开开发者工具</span><br></pre></td></tr></table></figure><h2 id="Typora快捷键"><a href="#Typora快捷键" class="headerlink" title="Typora快捷键"></a>Typora快捷键</h2><p>快速定义标题，数字代表标题等级，例如<code>Ctrl+1</code>建立1级标题</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+1      建立1级标题</span><br><span class="line">Ctrl+2      建立2级标题</span><br><span class="line">Ctrl+3      建立3级标题</span><br><span class="line">Ctrl+4      建立4级标题</span><br><span class="line">Ctrl+5      建立5级标题</span><br><span class="line">Ctrl+6      建立6级标题</span><br><span class="line">Ctrl+T      快速插入表格</span><br><span class="line">Ctrl+K      快速插入链接</span><br><span class="line">​<span class="code">```代码格式        快速新建一个代码块</span></span><br><span class="line"><span class="code">[链接名](链接)      新建一个链接</span></span><br><span class="line"><span class="code">![图片名](图片链接)  新建一张图片</span></span><br><span class="line"><span class="code">&lt;html&gt;&lt;/html&gt;      渲染html</span></span><br><span class="line"><span class="code">&lt;css&gt;&lt;/css&gt;        渲染css</span></span><br><span class="line"><span class="code">&lt;js&gt;&lt;/js&gt;          渲染js</span></span><br><span class="line"><span class="code">&lt;video&gt;&lt;source src=&quot;&quot;&gt;&lt;/video&gt;  渲染视频</span></span><br><span class="line"><span class="code">&lt;audio&gt;&lt;source src=&quot;&quot;&gt;&lt;/audio&gt;  渲染音频</span></span><br></pre></td></tr></table></figure><h2 id="IDEA快捷键"><a href="#IDEA快捷键" class="headerlink" title="IDEA快捷键"></a>IDEA快捷键</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Alt+Enter        调出代码提示</span><br><span class="line">Ctrl+Alt+Shift+L 格式化代码</span><br><span class="line">Alt+Insert  调出生成选项（一般拿来生成getter/setter方法）</span><br><span class="line">Ctrl+Shift+Y  翻译鼠标划中的字符（有插件Translation的情况）</span><br></pre></td></tr></table></figure><h2 id="QQ快捷键"><a href="#QQ快捷键" class="headerlink" title="QQ快捷键"></a>QQ快捷键</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+Alt+A 截屏</span><br><span class="line">Ctrl+Alt+S 录屏</span><br><span class="line">Ctrl+L     锁QQ</span><br></pre></td></tr></table></figure><h2 id="微信快捷键"><a href="#微信快捷键" class="headerlink" title="微信快捷键"></a>微信快捷键</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Alt+A 截屏</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 快捷命令 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly博客主题搭建系列：基础教程</title>
      <link href="/posts/447d/"/>
      <url>/posts/447d/</url>
      
        <content type="html"><![CDATA[<p><strong>Butterfly</strong>是一个界面生动，图文交互性强的Hexo主题，借鉴官方文档和其他博主搭建过程我创作了该教程，希望更多的人使用Butterfly来记录自己的生活。</p><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>本教程更新于 2022 年 08 月 20 日，教程的内容针对hexo6.2.0 butterfly4.4.0，并且只介绍基础教程</p><p>你愿意花时间看，那我愿意尽我所能帮助你</p></div><h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><ol><li>你已经安装了<a href="http://nodejs.cn/">Node.js</a>、<a href="https://www.runoob.com/git/git-tutorial.html">Git</a>、<a href="https://typoraio.cn/">Typora</a>等工具</li><li>你已经拥有github账号并且可以本地推送代码到远程仓库</li><li>你已经了解<a href="https://hexo.io/">Hexo</a>博客框架的使用方法了（使用Typora写博客、hexo部署博客）</li><li>你已经决定好想要优化博客的准备了</li></ol><h2 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h2><div class="tabs" id="tab1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab1-1">安装butterfly</button></li><li class="tab"><button type="button" data-href="#tab1-2">应用主题</button></li><li class="tab"><button type="button" data-href="#tab1-3">安装插件</button></li><li class="tab"><button type="button" data-href="#tab1-4">运行博客</button></li><li class="tab"><button type="button" data-href="#tab1-5">效果展示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab1-1"><p>到hexo根目录打开cmd命令提示符</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone <span class="literal">-b</span> master https://github.com/jerryc127/hexo<span class="literal">-theme-butterfly</span>.git themes/butterfly</span><br></pre></td></tr></table></figure><p>如果超时执行另一个命令：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone <span class="literal">-b</span> master git@github.com:jerryc127/hexo<span class="literal">-theme-butterfly</span>.git themes/butterfly</span><br></pre></td></tr></table></figure><div class="note info modern"><p>这两个命令的区别是，一个是使用https协议，另一个使用ssh协议，目前国内访问github会被<a href="https://baike.baidu.com/item/DNS%E6%B1%A1%E6%9F%93/8620359">DNS污染</a>导致访问错误，因此拉取代码会超时，可以使用ssh协议代替https协议克隆代码</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-2"><p>在博客根目录打开网站配置文件 _config.yml，修改默认主题：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme: butterfly</span><br></pre></td></tr></table></figure><p>在博客根目录下复制主题配置文件<code>blog/themes/butterfly/_config.yml</code>并命名为<code>_config.butterfly.yml</code>，hexo会将<code>_config.butterfly.yml</code>覆盖默认主题配置文件，方便我们进行升级操作</p><div class="note info modern"><p>本教程没有修改主题源码的操作，请放心食用</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-3"><p>在博客根目录下执行：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo<span class="literal">-renderer-pug</span> hexo<span class="literal">-renderer-stylus</span> <span class="literal">--save</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-4"><p>hexo三连：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab1-5"><p><img src="/./img/447d/1660988777075.png" alt="运行效果"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info modern"><p>我们将博客根目录的配置文件称为<code>_config.yml</code>，将主题配置文件称为<code>_config.butterfly.yml</code></p></div><h2 id="基础信息"><a href="#基础信息" class="headerlink" title="基础信息"></a>基础信息</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">基础信息设置</button></li><li class="tab"><button type="button" data-href="#tab-1-2">网站资料效果展示</button></li><li class="tab"><button type="button" data-href="#tab-1-3">网站页脚效果展示</button></li><li class="tab"><button type="button" data-href="#tab-1-4">参数解释</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>在_config.yml设置网站资料：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">枫叶</span> </span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">&#x27;分享知识，认识世界&#x27;</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">&#x27;分享知识，认识世界&#x27;</span></span><br><span class="line"><span class="attr">keywords:</span> <span class="string">&#x27;博客 Linux 算法 服务器&#x27;</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">aqcoder</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">Asia/Shanghai</span></span><br></pre></td></tr></table></figure><p>在_config.butterfly.yml设置网站页脚：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Footer Settings</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">owner:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">since:</span> <span class="number">2022</span></span><br><span class="line">  <span class="attr">custom_text:</span> <span class="string">Copyright</span> <span class="string">枫叶</span> </span><br><span class="line">  <span class="attr">copyright:</span> <span class="literal">true</span> <span class="comment"># Copyright of theme and framework</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/./img/447d/1660999518197.png" alt="网站资料"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><img src="/./img/447d/1660999583130.png" alt="网站页脚"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>网站资料参数解释</p><table><thead><tr><th align="center">参数</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center"><code>title</code></td><td align="center">网站标题</td></tr><tr><td align="center"><code>subtitle</code></td><td align="center">网站副标题</td></tr><tr><td align="center"><code>description</code></td><td align="center">网站描述</td></tr><tr><td align="center"><code>keywords</code></td><td align="center">网站的关键词。支持多个关键词。</td></tr><tr><td align="center"><code>author</code></td><td align="center">您的名字</td></tr><tr><td align="center"><code>language</code></td><td align="center">网站使用的语言。对于简体中文用户来说，使用不同的主题可能需要设置成不同的值，请参考你的主题的文档自行设置，常见的有 <code>zh-Hans</code>和 <code>zh-CN</code>。</td></tr><tr><td align="center"><code>timezone</code></td><td align="center">网站时区。Hexo 默认使用您电脑的时区。请参考 <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">时区列表</a> 进行设置，如 <code>America/New_York</code>, <code>Japan</code>, 和 <code>UTC</code> 。一般的，对于中国大陆地区可以使用 <code>Asia/Shanghai</code>。</td></tr></tbody></table><p>其中，<code>description</code>主要用于SEO，告诉搜索引擎一个关于您站点的简单描述，通常建议在其中包含您网站的关键词。<code>author</code>参数用于主题显示文章的作者。</p><p>网站页脚参数解释</p><table><thead><tr><th align="center">参数</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center"><code>since</code></td><td align="center">建立网站的年份。用于展示站点起始时间，位于页面最底部</td></tr><tr><td align="center"><code>custom_text</code></td><td align="center">位于页脚的自定义文本，支持HTML</td></tr><tr><td align="center"><code>copyright</code></td><td align="center">true展示hexo和butterfly的版权信息，false不展示</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="网站副标题"><a href="#网站副标题" class="headerlink" title="网站副标题"></a>网站副标题</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># the subtitle on homepage (主頁subtitle)</span></span><br><span class="line"><span class="attr">subtitle:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Typewriter Effect (打字效果)</span></span><br><span class="line">  <span class="attr">effect:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># loop (循環打字)</span></span><br><span class="line">  <span class="attr">loop:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># source 調用第三方服務</span></span><br><span class="line">  <span class="comment"># source: false 關閉調用</span></span><br><span class="line">  <span class="comment"># source: 1  調用一言網的一句話（簡體） https://hitokoto.cn/</span></span><br><span class="line">  <span class="comment"># source: 2  調用一句網（簡體） http://yijuzhan.com/</span></span><br><span class="line">  <span class="comment"># source: 3  調用今日詩詞（簡體） https://www.jinrishici.com/</span></span><br><span class="line">  <span class="comment"># subtitle 會先顯示 source , 再顯示 sub 的內容</span></span><br><span class="line">  <span class="attr">source:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># 如果關閉打字效果，subtitle 只會顯示 sub 的第一行文字</span></span><br><span class="line">  <span class="attr">sub:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">分享知识，认识世界</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">烟花许诺夜空，洒落繁星一片</span></span><br></pre></td></tr></table></figure><h2 id="导航菜单"><a href="#导航菜单" class="headerlink" title="导航菜单"></a>导航菜单</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">导航菜单设置</button></li><li class="tab"><button type="button" data-href="#tab-1-2">参数解释</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>在_config.butterfly.yml设置网站导航菜单：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">主页:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="string">站点</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-sitemap</span> <span class="string">||hide:</span></span><br><span class="line">    <span class="string">我的导航:</span> <span class="string">https://aqcoder.cn</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-paper-plane</span></span><br><span class="line">    <span class="string">必应壁纸:</span> <span class="string">https://bimg.cc||</span> <span class="string">iconfont</span> <span class="string">icon-Bing</span></span><br><span class="line">  <span class="string">博文</span> <span class="string">||</span> <span class="attr">fa fa-bookmark:</span></span><br><span class="line">    <span class="string">分类:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-archive</span></span><br><span class="line">    <span class="string">标签:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-tags</span></span><br><span class="line">    <span class="string">归档:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-folder-open</span></span><br><span class="line">  <span class="string">生活</span> <span class="string">||</span> <span class="attr">fas fa-list:</span></span><br><span class="line">    <span class="string">分享:</span> <span class="string">/share/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-share-alt-square</span></span><br><span class="line">    <span class="string">音乐:</span> <span class="string">/music/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-music</span></span><br><span class="line">    <span class="string">图库:</span> <span class="string">/gallery/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-images</span></span><br><span class="line">  <span class="string">友链:</span> <span class="string">/links/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-link</span></span><br><span class="line">  <span class="string">开往:</span> <span class="string">https://www.travellings.cn/go.html</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-train</span></span><br><span class="line">  <span class="string">虫洞:</span> <span class="string">https://foreverblog.cn/go.html</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-circle</span></span><br><span class="line">  <span class="string">留言板:</span> <span class="string">/comment/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-paper-plane</span></span><br><span class="line">  <span class="string">关于我:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-user</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>必须是 &#x2F;xxx&#x2F;，后面||分开，然后写图标名。因为已经内置了<a href="http://www.fontawesome.com.cn/">fontawesome</a>，可以去图标库选择合适图标，然后复制图标名称即可</p><p>如果不希望显示图标，图标名可不写。</p><p>效果展示</p><p><img src="/./img/447d/1661000468097.png" alt="导航菜单"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="导航页面"><a href="#导航页面" class="headerlink" title="导航页面"></a>导航页面</h2><p>有了导航，后面就是建立页面，首先建立下面三个基本页面</p><p>其他页面以此类推，不用加type:”xxx”</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">标签页</button></li><li class="tab"><button type="button" data-href="#tab-1-2">分类页</button></li><li class="tab"><button type="button" data-href="#tab-1-3">友链页</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>在根目录cmd，使用以下命令建立标签页：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure><p>修改source&#x2F;tags&#x2F;index.md：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">title: 标签</span><br><span class="line">date: 2022-08-20 21:13:35</span><br><span class="line">type: &quot;tags&quot;</span><br></pre></td></tr></table></figure><div class="note info modern"><p>添加type:”xxx”是为了设置内置的标签页，分类页，友情链接，这些页面butterfly自带有，不需要我们单独设置</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>在根目录cmd，使用以下命令建立分类页：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure><p>修改source&#x2F;categories&#x2F;index.md：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">title: 分类</span><br><span class="line">date: 2022-08-20 21:15:09</span><br><span class="line">type: &quot;categories&quot;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p>在根目录cmd，使用以下命令建立友链页：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page links</span><br></pre></td></tr></table></figure><p>修改source&#x2F;links&#x2F;index.md：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">title: 友链</span><br><span class="line">date: 2022-08-20 21:15:09</span><br><span class="line">type: &quot;links&quot;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="搜索系统"><a href="#搜索系统" class="headerlink" title="搜索系统"></a>搜索系统</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">本地搜索</button></li><li class="tab"><button type="button" data-href="#tab-1-2">algolia</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p>1、安装插件：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-generator-search</span> <span class="string">--save</span></span><br></pre></td></tr></table></figure><p>2、修改_config.butterfly.yml：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Local search</span></span><br><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#是否启用</span></span><br><span class="line">  <span class="attr">preload:</span> <span class="literal">true</span> <span class="comment"># 是否预加载</span></span><br><span class="line">  <span class="attr">CDN:</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><a href="https://www.algolia.com/">官网</a>注册，创建应用，拿到apikeys</p><p>在 hexo 根目录下的<code>_config.yml</code> 配置文件添加以下代码，appId、apiKey、adminApiKey、indexName 根据自己的情况填写</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">plugins:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">hexo-algoliasearch</span></span><br><span class="line"></span><br><span class="line"><span class="attr">algolia:</span></span><br><span class="line">  <span class="attr">appId:</span> <span class="string">&quot;0Z2Q111FG111&quot;</span></span><br><span class="line">  <span class="attr">apiKey:</span> <span class="string">&quot;079e96e1d3e11111116bf59011&quot;</span></span><br><span class="line">  <span class="attr">adminApiKey:</span> <span class="string">&quot;9e2f194f9f28111111199ce53111&quot;</span></span><br><span class="line">  <span class="attr">chunkSize:</span> <span class="number">5000</span></span><br><span class="line">  <span class="attr">indexName:</span> <span class="string">&quot;hexo_blog&quot;</span></span><br><span class="line">  <span class="attr">fields:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">content:strip:truncate,0,200</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">tags</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">permalink</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">excerpt:strip</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">title</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">categories</span></span><br></pre></td></tr></table></figure><p>修改 Butterfly 主题的<code>_config.yml</code> 配置文件：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Algolia search</span></span><br><span class="line"><span class="attr">algolia_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hits:</span></span><br><span class="line">    <span class="attr">per_page:</span> <span class="number">6</span></span><br></pre></td></tr></table></figure><p>推荐文章：<a href="https://blog.zoutl.cn/479">Hexo 的 Butterfly 主题使用 Algolia 搜索</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="友情链接"><a href="#友情链接" class="headerlink" title="友情链接"></a>友情链接</h2><p>在Hexo博客目录中的source&#x2F;_data（如果没有 _data 文件夹，请自行创建），创建一个文件link.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">友情鏈接</span></span><br><span class="line">  <span class="attr">class_desc:</span> <span class="string">博主</span></span><br><span class="line">  <span class="attr">link_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">aqcoder</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://blog.aqcoder.cn</span></span><br><span class="line">      <span class="attr">avatar:</span> <span class="string">https://blog.aqcoder.cn/img/avatar.png</span></span><br><span class="line">      <span class="attr">descr:</span> <span class="string">分享知识，认识世界</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">特别鸣谢</span></span><br><span class="line">  <span class="attr">class_desc:</span> <span class="string">博客框架及主题</span></span><br><span class="line">  <span class="attr">link_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Hexo</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://hexo.io/zh-tw/</span></span><br><span class="line">      <span class="attr">avatar:</span> <span class="string">https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg</span></span><br><span class="line">      <span class="attr">descr:</span> <span class="string">快速、簡單且強大的網誌框架</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Butterfly</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://butterfly.js.org/</span></span><br><span class="line">      <span class="attr">avatar:</span> <span class="string">https://butterfly.js.org/img/avatar.png</span></span><br><span class="line">      <span class="attr">descr:</span> <span class="string">A</span> <span class="string">Simple</span> <span class="string">and</span> <span class="string">Card</span> <span class="string">UI</span> <span class="string">Design</span> <span class="string">theme</span> <span class="string">for</span> <span class="string">Hexo</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - class_name: 友链</span></span><br><span class="line"><span class="comment">#   class_desc: 同道中人</span></span><br><span class="line"><span class="comment">#   link_list:</span></span><br><span class="line">    <span class="comment"># - name: </span></span><br><span class="line">    <span class="comment">#   link: </span></span><br><span class="line">    <span class="comment">#   avatar:</span></span><br><span class="line">    <span class="comment">#   descr:</span></span><br></pre></td></tr></table></figure><h2 id="404页面"><a href="#404页面" class="headerlink" title="404页面"></a>404页面</h2><p>主题内置了一个简单的404页面，可在设置中开启</p><div class="note info modern"><p>本地预览时，访问出错的网站是不会跳到404页面的。</p><p>如需本地预览，请访问<a href="http://localhost:4000/404.html">http://localhost:4000/404.html</a></p></div><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># A simple 404 page</span></span><br><span class="line"><span class="attr">error_404:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">subtitle:</span> <span class="string">&quot;页面没有找到&quot;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">/img/404.png</span></span><br></pre></td></tr></table></figure><h2 id="社交图标"><a href="#社交图标" class="headerlink" title="社交图标"></a>社交图标</h2><p>Butterfly支持 <a href="https://fontawesome.com/icons?from=io">font-awesome v6</a>图标</p><p>书写格式 <code>图标名：url || 描述性文字</code></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">fab fa-github:</span> <span class="string">https://github.com/xxxxx</span> <span class="string">||</span> <span class="string">Github</span></span><br><span class="line">  <span class="attr">fas fa-envelope:</span> <span class="string">mailto:xxxxxx@gmail.com</span> <span class="string">||</span> <span class="string">Email</span></span><br></pre></td></tr></table></figure><h2 id="图片设置"><a href="#图片设置" class="headerlink" title="图片设置"></a>图片设置</h2><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">网站图标</button></li><li class="tab"><button type="button" data-href="#tab-1-2">网站头像</button></li><li class="tab"><button type="button" data-href="#tab-1-3">主页背景图</button></li><li class="tab"><button type="button" data-href="#tab-1-4">顶部默认图</button></li><li class="tab"><button type="button" data-href="#tab-1-5">文章封面图</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Favicon（网站图标）</span></span><br><span class="line"><span class="attr">favicon:</span> <span class="string">/img/favicon.png</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Avatar (头像)</span></span><br><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="attr">img:</span> <span class="string">/img/avatar.png</span></span><br><span class="line">  <span class="attr">effect:</span> <span class="literal">false</span> <span class="comment">#一直旋转头像</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The banner image of home page</span></span><br><span class="line"><span class="attr">index_img:</span> <span class="string">https://api.bimg.cc/today</span></span><br></pre></td></tr></table></figure><p>可使用我的api接口来生成背景图</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">https://api.bimg.cc/today</span> <span class="comment">#当天必应壁纸</span></span><br><span class="line"><span class="string">https://api.bimg.cc/random</span> <span class="comment">#随机必应壁纸</span></span><br></pre></td></tr></table></figure><p><img src="/./img/447d/1661002974057.png" alt="主页背景图"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># If the banner of page not setting, it will show the top_img</span></span><br><span class="line"><span class="attr">default_top_img:</span> <span class="string">https://api.aqcoder.cn/random</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cover:</span></span><br><span class="line">  <span class="comment"># 是否显示文章封面</span></span><br><span class="line">  <span class="attr">index_enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">aside_enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">archives_enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># 封面显示的位置</span></span><br><span class="line">  <span class="comment"># 三个值可配置 left , right , both</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">both</span></span><br><span class="line">  <span class="comment"># 当文章Front-matter没有设置封面时，默认的封面显示</span></span><br><span class="line">  <span class="attr">default_cover:</span></span><br><span class="line">    <span class="string">https://api.aqcoder.cn/random</span></span><br><span class="line">    <span class="comment"># - https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg</span></span><br></pre></td></tr></table></figure><p><img src="/./img/447d/1661003560681.png" alt="文章封面图"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="大图查看"><a href="#大图查看" class="headerlink" title="大图查看"></a>大图查看</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Lightbox (圖片大圖查看模式)</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"><span class="comment"># You can only choose one, or neither (只能選擇一個 或者 兩個都不選)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># medium-zoom</span></span><br><span class="line"><span class="comment"># https://github.com/francoischalifour/medium-zoom</span></span><br><span class="line"><span class="attr">medium_zoom:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># fancybox</span></span><br><span class="line"><span class="comment"># https://fancyapps.com/fancybox/3/</span></span><br><span class="line"><span class="attr">fancybox:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="图片懒加载"><a href="#图片懒加载" class="headerlink" title="图片懒加载"></a>图片懒加载</h2><p>安装<code>hexo-lazyload-image</code>模块</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo<span class="literal">-lazyload-image</span> <span class="literal">--save</span></span><br></pre></td></tr></table></figure><p>在<code>_config.yml</code>添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lazyload:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">loadingImg:</span> <span class="string">/img/loading.gif</span></span><br></pre></td></tr></table></figure><p><code>_config.butterfly.yml</code>配置也有图片懒加载：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Lazyload (圖片懶加載)</span></span><br><span class="line"><span class="comment"># https://github.com/verlok/vanilla-lazyload</span></span><br><span class="line"><span class="attr">lazyload:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">site</span> <span class="comment"># site/post #懒加载位置</span></span><br><span class="line">  <span class="attr">placeholder:</span> <span class="comment"># 加载图片</span></span><br><span class="line">  <span class="attr">blur:</span> <span class="literal">true</span> <span class="comment">#开启高斯模糊</span></span><br></pre></td></tr></table></figure><p>而且支持懒加载范围自定义和高斯模糊</p><h2 id="网站背景"><a href="#网站背景" class="headerlink" title="网站背景"></a>网站背景</h2><p>修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Background effects (背景特效)</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># canvas_ribbon (靜止彩帶背景)</span></span><br><span class="line"><span class="comment"># See: https://github.com/hustcc/ribbon.js</span></span><br><span class="line"><span class="attr">canvas_ribbon:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">size:</span> <span class="number">150</span></span><br><span class="line">  <span class="attr">alpha:</span> <span class="number">0.6</span></span><br><span class="line">  <span class="attr">zIndex:</span> <span class="number">-1</span></span><br><span class="line">  <span class="attr">click_to_change:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Fluttering Ribbon (動態彩帶)</span></span><br><span class="line"><span class="attr">canvas_fluttering_ribbon:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="右下角按钮"><a href="#右下角按钮" class="headerlink" title="右下角按钮"></a>右下角按钮</h2><h3 id="繁简转换"><a href="#繁简转换" class="headerlink" title="繁简转换"></a>繁简转换</h3><p>简体繁体互换，右下角会有简繁转换按钮。修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Bottom right button (右下角按鈕)</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Conversion between Traditional and Simplified Chinese (簡繁轉換)</span></span><br><span class="line"><span class="attr">translate:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># The text of a button</span></span><br><span class="line">  <span class="attr">default:</span> <span class="string">繁</span></span><br><span class="line">  <span class="comment"># the language of website (1 - Traditional Chinese/ 2 - Simplified Chinese）</span></span><br><span class="line">  <span class="attr">defaultEncoding:</span> <span class="number">2</span></span><br><span class="line">  <span class="comment"># Time delay</span></span><br><span class="line">  <span class="attr">translateDelay:</span> <span class="number">0</span></span><br><span class="line">  <span class="comment"># The text of the button when the language is Simplified Chinese</span></span><br><span class="line">  <span class="attr">msgToTraditionalChinese:</span> <span class="string">&#x27;繁&#x27;</span></span><br><span class="line">  <span class="comment"># The text of the button when the language is Traditional Chinese</span></span><br><span class="line">  <span class="attr">msgToSimplifiedChinese:</span> <span class="string">&#x27;簡&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="夜间模式"><a href="#夜间模式" class="headerlink" title="夜间模式"></a>夜间模式</h3><p>右下角会有夜间模式按钮：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dark mode</span></span><br><span class="line"><span class="attr">darkmode:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Toggle Button to switch dark/light mode</span></span><br><span class="line">  <span class="attr">button:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Switch dark/light mode automatically (自動切換 dark mode和 light mode)</span></span><br><span class="line">  <span class="comment"># autoChangeMode: 1  Following System Settings, if the system doesn&#x27;t support dark mode, it will switch dark mode between 6 pm to 6 am</span></span><br><span class="line">  <span class="comment"># autoChangeMode: 2  Switch dark mode between 6 pm to 6 am</span></span><br><span class="line">  <span class="comment"># autoChangeMode: false</span></span><br><span class="line">  <span class="attr">autoChangeMode:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p><code>autoChangeMode</code>: 1 跟随系统而变化，不支持的浏览器&#x2F;系统将按照时间晚上6点到早上6点之间切换为 dark mode</p><p><code>autoChangeMode</code>: 2 只按照时间 晚上6点到早上6点之间切换为 dark mode,其余时间为light mode</p><p><code>autoChangeMode</code>: false 取消自动切换</p><h3 id="阅读模式"><a href="#阅读模式" class="headerlink" title="阅读模式"></a>阅读模式</h3><p>阅读模式下会去掉除文章外的内容，避免干扰阅读。只会出现在文章页面，右下角会有閲读模式按钮。</p><p>修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">readmode:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="按钮排序"><a href="#按钮排序" class="headerlink" title="按钮排序"></a>按钮排序</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Don&#x27;t modify the following settings unless you know how they work (非必要请不要修改 )</span></span><br><span class="line"><span class="comment"># Choose: readmode,translate,darkmode,hideAside,toc,chat,comment</span></span><br><span class="line"><span class="comment"># Don&#x27;t repeat 不要重复</span></span><br><span class="line"><span class="attr">rightside_item_order:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">hide:</span> <span class="comment"># readmode,translate,darkmode,hideAside</span></span><br><span class="line">  <span class="attr">show:</span> <span class="comment"># toc,chat,comment</span></span><br></pre></td></tr></table></figure><h2 id="侧边栏设置"><a href="#侧边栏设置" class="headerlink" title="侧边栏设置"></a>侧边栏设置</h2><h3 id="主页侧边排版"><a href="#主页侧边排版" class="headerlink" title="主页侧边排版"></a>主页侧边排版</h3><p>只修改公告以及Github账号即可，其他不用修改</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># aside (側邊欄)</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"><span class="attr">aside:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hide:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">button:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">true</span> <span class="comment"># display on mobile</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">right</span> <span class="comment"># left or right</span></span><br><span class="line">  <span class="attr">display:</span></span><br><span class="line">    <span class="attr">archive:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">tag:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">category:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">card_author:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">description:</span> <span class="comment">#网站简介，可以覆盖站点配置文件的description</span></span><br><span class="line">    <span class="attr">button:</span></span><br><span class="line">      <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">icon:</span> <span class="string">fab</span> <span class="string">fa-github</span></span><br><span class="line">      <span class="attr">text:</span> <span class="string">Follow</span> <span class="string">Me</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://github.com/flow2000</span></span><br><span class="line">  <span class="attr">card_announcement:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">content:</span> <span class="string">更换了博客主题为butterfly</span></span><br><span class="line">  <span class="attr">card_recent_post:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">5</span> <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">sort:</span> <span class="string">date</span> <span class="comment"># date or updated</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_categories:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">8</span> <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">expand:</span> <span class="literal">true</span> <span class="comment"># none/true/false</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_tags:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">40</span> <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">color:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_archives:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">monthly</span> <span class="comment"># yearly or monthly</span></span><br><span class="line">    <span class="attr">format:</span> <span class="string">MMMM</span> <span class="string">YYYY</span> <span class="comment"># eg: YYYY年MM月</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">-1</span> <span class="comment"># Sort of order. 1, asc for ascending; -1, desc for descending</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">8</span> <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_webinfo:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">post_count:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">last_push_date:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br></pre></td></tr></table></figure><h3 id="最新评论"><a href="#最新评论" class="headerlink" title="最新评论"></a>最新评论</h3><p>主页侧边栏显示最新评论</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Aside widget - Newest Comments</span></span><br><span class="line"><span class="attr">newest_comments:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">6</span></span><br><span class="line">  <span class="attr">storage:</span> <span class="number">10</span> <span class="comment"># unit: mins, save data to localStorage</span></span><br><span class="line">  <span class="attr">avatar:</span> <span class="literal">false</span> </span><br></pre></td></tr></table></figure><h3 id="访问人数-busuanzi"><a href="#访问人数-busuanzi" class="headerlink" title="访问人数 busuanzi"></a>访问人数 busuanzi</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># busuanzi count for PV / UV in site</span></span><br><span class="line"><span class="comment"># 訪問人數</span></span><br><span class="line"><span class="attr">busuanzi:</span></span><br><span class="line">  <span class="attr">site_uv:</span> <span class="literal">true</span> <span class="comment"># 是否开启本站访客数</span></span><br><span class="line">  <span class="attr">site_pv:</span> <span class="literal">true</span> <span class="comment"># 是否开始本站总访问量</span></span><br><span class="line">  <span class="attr">page_pv:</span> <span class="literal">true</span> <span class="comment"># 是否开启文章页阅读量</span></span><br></pre></td></tr></table></figure><h3 id="网站运行时间"><a href="#网站运行时间" class="headerlink" title="网站运行时间"></a>网站运行时间</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Time difference between publish date and now (網頁運行時間)</span></span><br><span class="line"><span class="comment"># Formal: Month/Day/Year Time or Year/Month/Day Time</span></span><br><span class="line"><span class="attr">runtimeshow:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">publish_date:</span> <span class="number">2022</span><span class="string">/7/28</span> <span class="number">09</span><span class="string">:00:00</span>  </span><br></pre></td></tr></table></figure><h3 id="自定义栏目"><a href="#自定义栏目" class="headerlink" title="自定义栏目"></a>自定义栏目</h3><p>参考：<a href="https://butterfly.js.org/posts/ea33ab97/">https://butterfly.js.org/posts/ea33ab97/</a></p><h2 id="文章设置"><a href="#文章设置" class="headerlink" title="文章设置"></a>文章设置</h2><h3 id="文章链接优化"><a href="#文章链接优化" class="headerlink" title="文章链接优化"></a>文章链接优化</h3><p>安装 <code>hexo-abbrlink</code> 插件</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-abbrlink</span></span><br></pre></td></tr></table></figure><p>编辑 站点的 <code>_config.yml</code>文件，找到 <code>permalink</code> , 改成 <strong>permalink: posts&#x2F;:abbrlink&#x2F;</strong></p><p>重新运行后插件会为每一篇文章生成唯一id并添加到Front-matter。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## Set your site url here. For example, if you use GitHub Page, set url as &#x27;https://username.github.io/project&#x27;</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://blog.aqcoder.cn</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">posts/:abbrlink/</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"><span class="attr">pretty_urls:</span></span><br><span class="line">  <span class="attr">trailing_index:</span> <span class="literal">true</span> <span class="comment"># Set to false to remove trailing &#x27;index.html&#x27; from permalinks</span></span><br><span class="line">  <span class="attr">trailing_html:</span> <span class="literal">true</span> <span class="comment"># Set to false to remove trailing &#x27;.html&#x27; from permalinks</span></span><br><span class="line"><span class="attr">abbrlink:</span> </span><br><span class="line">     <span class="attr">alg:</span> <span class="string">crc16</span> <span class="comment">#算法： crc16(default) and crc32 </span></span><br><span class="line">     <span class="attr">rep:</span> <span class="string">hex</span></span><br></pre></td></tr></table></figure><h3 id="Front-matter"><a href="#Front-matter" class="headerlink" title="Front-matter"></a>Front-matter</h3><p>Front-matter 是 markdown 文件最上方以 <code>---</code>分隔的区域，用于指定个别档案的变数。</p><p><code>Page Front-matter</code> 用于<code>页面</code>配置<br><code>Post Front-matter</code> 用于<code>文章页</code>配置</p><div class="note info modern"><p>如果标注<code>可选</code>的参数，可根据自己需要添加，不用全部都写在markdown里</p></div><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">Page Front-matter</button></li><li class="tab"><button type="button" data-href="#tab-1-2">Post Front-matter</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><table><thead><tr><th align="center">写法</th><th align="left">解释</th></tr></thead><tbody><tr><td align="center">title</td><td align="left">【必需】页面标题</td></tr><tr><td align="center">date</td><td align="left">【必需】页面创建日期</td></tr><tr><td align="center">type</td><td align="left">【必需】标签、分类和友情链接三个页面需要配置</td></tr><tr><td align="center">updated</td><td align="left">【可选】页面更新日期</td></tr><tr><td align="center">description</td><td align="left">【可选】页面描述</td></tr><tr><td align="center">keywords</td><td align="left">【可选】页面关键字</td></tr><tr><td align="center">comments</td><td align="left">【可选】显示页面评论模块(默认 true)</td></tr><tr><td align="center">top_img</td><td align="left">【可选】页面顶部图片</td></tr><tr><td align="center">mathjax</td><td align="left">【可选】显示mathjax(当设置mathjax的per_page: false时，才需要配置，默认 false)</td></tr><tr><td align="center">katex</td><td align="left">【可选】显示katex(当设置katex的per_page: false时，才需要配置，默认 false)</td></tr><tr><td align="center">aside</td><td align="left">【可选】显示侧边栏 (默认 true)</td></tr><tr><td align="center">aplayer</td><td align="left">【可选】在需要的页面加载aplayer的js和css,请参考文章下面的音乐 配置</td></tr><tr><td align="center">highlight_shrink</td><td align="left">【可选】配置代码框是否展开(true&#x2F;false)(默认为设置中highlight_shrink的配置)</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><table><thead><tr><th align="center">写法</th><th align="left">解释</th></tr></thead><tbody><tr><td align="center">title</td><td align="left">【必需】文章标题</td></tr><tr><td align="center">date</td><td align="left">【必需】文章创建日期</td></tr><tr><td align="center">updated</td><td align="left">【可选】文章更新日期</td></tr><tr><td align="center">tags</td><td align="left">【可选】文章标签</td></tr><tr><td align="center">categories</td><td align="left">【可选】文章分类</td></tr><tr><td align="center">description</td><td align="left">【可选】文章描述</td></tr><tr><td align="center">keywords</td><td align="left">【可选】文章关键字</td></tr><tr><td align="center">comments</td><td align="left">【可选】显示文章评论模块(默认 true)</td></tr><tr><td align="center">top_img</td><td align="left">【可选】文章顶部图片</td></tr><tr><td align="center">cover</td><td align="left">【可选】文章缩略图(如果没有设置top_img,文章页顶部将显示缩略图，可设为false&#x2F;图片地址&#x2F;留空)</td></tr><tr><td align="center">comments</td><td align="left">【可选】显示文章评论模块(默认 true)</td></tr><tr><td align="center">toc</td><td align="left">【可选】显示文章TOC(默认为设置中toc的enable配置)</td></tr><tr><td align="center">toc_number</td><td align="left">【可选】显示toc_number(默认为设置中toc的number配置)</td></tr><tr><td align="center">toc_style_simple</td><td align="left">【可选】显示 toc 简洁模式</td></tr><tr><td align="center">copyright</td><td align="left">【可选】显示文章版权模块(默认为设置中post_copyright的enable配置)</td></tr><tr><td align="center">copyright_author</td><td align="left">【可选】文章版权模块的文章作者</td></tr><tr><td align="center">copyright_author_href</td><td align="left">【可选】文章版权模块的文章作者链接</td></tr><tr><td align="center">copyright_url</td><td align="left">【可选】文章版权模块的文章连结链接</td></tr><tr><td align="center">copyright_info</td><td align="left">【可选】文章版权模块的版权声明文字</td></tr><tr><td align="center">mathjax</td><td align="left">【可选】显示mathjax(当设置mathjax的per_page: false时，才需要配置，默认 false)</td></tr><tr><td align="center">katex</td><td align="left">【可选】显示katex(当设置katex的per_page: false时，才需要配置，默认 false)</td></tr><tr><td align="center">aplayer</td><td align="left">【可选】在需要的页面加载aplayer的js和css,请参考文章下面的音乐 配置</td></tr><tr><td align="center">highlight_shrink</td><td align="left">【可选】配置代码框是否展开(true&#x2F;false)(默认为设置中highlight_shrink的配置)</td></tr><tr><td align="center">aside</td><td align="left">【可选】显示侧边栏 (默认 true)</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="文章置顶"><a href="#文章置顶" class="headerlink" title="文章置顶"></a>文章置顶</h3><p>【推荐】hexo-generator-index从 2.0.0 开始，已经支持文章置顶功能。你可以直接在文章的front-matter区域里添加sticky: 1属性来把这篇文章置顶。数值越大，置顶的优先级越大。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">Butterfly博客搭建（一）</span></span><br><span class="line"><span class="attr">categories:</span> <span class="string">Butterfly</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Butterfly</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">butterfly是一个界面生动，图文交互性强的Hexo主题，借助官方文档和其他博主搭建过程我创作了该教程</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">&#x27;https://api.aqcoder.cn/random?w=800&amp;h=480</span></span><br><span class="line"><span class="string">top_img: &#x27;</span><span class="string">https://api.aqcoder.cn/random&amp;w=1024&amp;h=768</span></span><br><span class="line"><span class="attr">abbrlink:</span> <span class="string">447d</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2022-08-20 11:07:24</span></span><br><span class="line"><span class="attr">highlight_shrink:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">sticky:</span> <span class="number">100</span></span><br></pre></td></tr></table></figure><p><img src="/./img/447d/1661048033052.png" alt="文章置顶示例"></p><h3 id="主页文章节选"><a href="#主页文章节选" class="headerlink" title="主页文章节选"></a>主页文章节选</h3><p>因为主题UI的关係，主页文章节选只支持自动节选和文章页description。</p><p>在butterfly里，有四种可供选择</p><p><code>description</code>： 只显示description<br><code>both</code>： 优先选择description，如果没有配置description，则显示自动节选的内容<br><code>auto_excerpt</code>：只显示自动节选<br><code>false</code>： 不显示文章内容</p><p>修改_config.butterfly.yml：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">index_post_content:</span></span><br><span class="line">  <span class="attr">method:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">length:</span> <span class="number">500</span> <span class="comment"># if you set method to 2 or 3, the length need to config</span></span><br></pre></td></tr></table></figure><p><code>description</code>在<code>front-matter</code>里添加</p><h3 id="文章目录"><a href="#文章目录" class="headerlink" title="文章目录"></a>文章目录</h3><p>在文章页，会有一个目录（TOC），修改<code>_config.butterfly.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># toc (文章目录)</span></span><br><span class="line"><span class="attr">toc:</span></span><br><span class="line">  <span class="attr">post:</span> <span class="literal">true</span> <span class="comment"># 对文章页是否有效</span></span><br><span class="line">  <span class="attr">page:</span> <span class="literal">false</span> <span class="comment"># 对页面是否有效</span></span><br><span class="line">  <span class="attr">number:</span> <span class="literal">true</span> <span class="comment"># 是否展示章节数</span></span><br><span class="line">  <span class="attr">expand:</span> <span class="literal">true</span> <span class="comment"># 是否展开</span></span><br><span class="line">  <span class="attr">style_simple:</span> <span class="literal">true</span> <span class="comment"># for post 简洁模式</span></span><br></pre></td></tr></table></figure><p>参数解释</p><table><thead><tr><th>属性</th><th>解释</th></tr></thead><tbody><tr><td>post</td><td>文章页是否显示 TOC</td></tr><tr><td>page</td><td>普通页面是否显示 TOC</td></tr><tr><td>number</td><td>是否显示章节数</td></tr><tr><td>expand</td><td>是否展开 TOC</td></tr><tr><td>style_simple</td><td>简洁模式（侧边栏只显示 TOC, 只对文章页有效 ）</td></tr></tbody></table><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">PC端效果</button></li><li class="tab"><button type="button" data-href="#tab-1-2">移动端效果</button></li><li class="tab"><button type="button" data-href="#tab-1-3">简洁模式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/./img/447d/1661050028330.png" alt="PC端文章目录"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/./img/447d/1661050796023.png" alt="移动端文章目录"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><img src="/./img/447d/1661050702712.png" alt="简洁模式"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="代码样式"><a href="#代码样式" class="headerlink" title="代码样式"></a>代码样式</h3><p>修改<code>_config.butterfly.yml</code>：</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">代码主题</button></li><li class="tab"><button type="button" data-href="#tab-1-2">代码复制按钮</button></li><li class="tab"><button type="button" data-href="#tab-1-3">代码语言</button></li><li class="tab"><button type="button" data-href="#tab-1-4">代码块是否展开</button></li><li class="tab"><button type="button" data-href="#tab-1-5">代码块高度限制</button></li><li class="tab"><button type="button" data-href="#tab-1-6">代码换行</button></li><li class="tab"><button type="button" data-href="#tab-1-7">网站复制</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Code Blocks (代碼相關)</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"><span class="attr">highlight_theme:</span> <span class="string">mac</span> <span class="comment">#  darker / pale night / light / ocean / mac / mac light / false</span></span><br></pre></td></tr></table></figure><p>代码主题样例展示</p><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">darker</button></li><li class="tab"><button type="button" data-href="#tab-1-2">pale night</button></li><li class="tab"><button type="button" data-href="#tab-1-3">light</button></li><li class="tab"><button type="button" data-href="#tab-1-4">ocean</button></li><li class="tab"><button type="button" data-href="#tab-1-5">mac</button></li><li class="tab"><button type="button" data-href="#tab-1-6">mac light</button></li><li class="tab"><button type="button" data-href="#tab-1-7">false</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><p><img src="/./img/447d/1661007394072.png" alt="darker"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p><img src="/./img/447d/1661007471386.png" alt="pale night"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><img src="/./img/447d/1661007579994.png" alt="light"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p><img src="/./img/447d/1661007654205.png" alt="ocean"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><p><img src="/./img/447d/1661007716919.png" alt="mac"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-6"><p><img src="/./img/447d/1661007764931.png" alt="mac light"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-7"><p><img src="/./img/447d/1661007815606.png" alt="false"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>主题支持代码复制功能</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">highlight_copy:</span> <span class="literal">true</span> <span class="comment"># 是否开启复制按钮</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><p><code>true</code>：显示代码语言</p><p><code>false</code>：隐藏代码语言</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># show the code language</span></span><br><span class="line"><span class="attr">highlight_lang:</span> <span class="literal">true</span> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-4"><p>在默认情况下，代码框自动展开，可设置是否所有代码框都关闭状态，点击&gt;可展开代码</p><p><code>true</code> 全部代码框不展开，需点击&gt;打开<br><code>false</code> 代码框展开，有&gt;点击按钮<br><code>none</code> 不显示&gt;按钮</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># true: shrink the code blocks </span></span><br><span class="line"><span class="comment"># false: expand the code blocks     </span></span><br><span class="line"><span class="comment"># none: expand code blocks and hide the button</span></span><br><span class="line"><span class="attr">highlight_shrink:</span> <span class="literal">true</span> </span><br></pre></td></tr></table></figure><div class="note info modern"><p>你也可以在post&#x2F;page页对应的markdown文件front-matter添加highlight_shrink来独立配置。</p><p>当主题配置文件中的 highlight_shrink 设为true时，可在front-matter添加highlight_shrink: false来单独配置文章展开代码框。</p><p>当主题配置文件中的 highlight_shrink 设为false时，可在front-matter添加highlight_shrink: true来单独配置文章收缩代码框。</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-5"><div class="note info modern"><p>3.7.0 及以上支持</p></div><p>可配置代码高度限制，超出的部分会隐藏，并显示展开按钮。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">highlight_height_limit:</span> <span class="number">200</span> <span class="comment"># unit: px</span></span><br></pre></td></tr></table></figure><p>注意：</p><ul><li><p>单位是 px，直接添加数字，如 200</p></li><li><p>实际限制高度为 highlight_height_limit + 30 px ，多增加 30px 限制，目的是避免代码高度只超出highlight_height_limit 一点时，出现展开按钮，展开没内容。</p></li><li><p>不适用于隐藏后的代码块（ css 设置 display: none）</p></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-6"><p>在默认情况下，Hexo 在编译的时候不会实现代码自动换行。如果你不希望在代码块的区域里有横向滚动条的话，那么你可以考虑开启这个功能。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">code_word_wrap:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-7"><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># copy settings</span></span><br><span class="line"><span class="comment"># copyright: Add the copyright information after copied content (複製的內容後面加上版權信息)</span></span><br><span class="line"><span class="attr">copy:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 是否开启网站复制权限</span></span><br><span class="line">  <span class="attr">copyright:</span>  <span class="comment"># 复制的内容后面加上版权信息</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span>  <span class="comment"># 是否开启复制版权信息添加</span></span><br><span class="line">    <span class="attr">limit_count:</span> <span class="number">100</span> <span class="comment"># 字数限制，当复制文字大于这个字数限制时</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="插入图片"><a href="#插入图片" class="headerlink" title="插入图片"></a>插入图片</h3><p>在source下新建img&#x2F;447d，本教程的链接优化为&#x2F;posts&#x2F;447d，所以建立和教程链接一样的资源文件夹即可</p><p>将要插入的图片放入img&#x2F;447d&#x2F;中，md文件则可以写入：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![](<span class="link">../img/447d/1661002974057.png</span>)</span><br></pre></td></tr></table></figure><div class="note info flat"><p>447d是<a href="/posts/447d/#%E6%96%87%E7%AB%A0%E9%93%BE%E6%8E%A5%E4%BC%98%E5%8C%96">hexo-abbrlink</a>生成的随机字符</p></div><p><img src="/./img/447d/1661002974057.png" alt="主页背景图"></p><p>本地即可预览该图片</p><h3 id="文章锚点"><a href="#文章锚点" class="headerlink" title="文章锚点"></a>文章锚点</h3><p>开启文章锚点后，当你在文章页进行滚动时，文章链接会根据标题ID进行替换<br>(注意: 每替换一次，会留下一个历史记录。所以如果一篇文章有很多锚点的话，网页的历史记录会很多。)</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># anchor</span></span><br><span class="line"><span class="comment"># when you scroll in post , the url will update according to header id.</span></span><br><span class="line"><span class="attr">anchor:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="文章分页"><a href="#文章分页" class="headerlink" title="文章分页"></a>文章分页</h3><p>设置分页的逻辑</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># post_pagination (分頁)</span></span><br><span class="line"><span class="comment"># value: 1 || 2 || false</span></span><br><span class="line"><span class="comment"># 1: The &#x27;next post&#x27; will link to old post</span></span><br><span class="line"><span class="comment"># 2: The &#x27;next post&#x27; will link to new post</span></span><br><span class="line"><span class="comment"># false: disable pagination</span></span><br><span class="line"><span class="attr">post_pagination:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><p><code>post_pagination</code>： 分页开关按钮</p><p><code>post_pagination</code>： 1代表下一篇显示的是旧文章；2代表下一篇显示的是新文章</p><h3 id="文章编辑"><a href="#文章编辑" class="headerlink" title="文章编辑"></a>文章编辑</h3><p>在文章标题旁边显示一个编辑按钮，点击会跳转到对应的链接去。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Post edit</span></span><br><span class="line"><span class="comment"># Easily browse and edit blog source code online.</span></span><br><span class="line"><span class="attr">post_edit:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># url: https://github.com/user-name/repo-name/edit/branch-name/subdirectory-name/</span></span><br><span class="line">  <span class="comment"># For example: https://github.com/jerryc127/butterfly.js.org/edit/main/source/</span></span><br><span class="line">  <span class="attr">url:</span></span><br></pre></td></tr></table></figure><h3 id="文章分享"><a href="#文章分享" class="headerlink" title="文章分享"></a>文章分享</h3><p><code>addThis</code>、<code>sharejs</code>、<code>addtoany</code>三个选一个开启</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Share System (分享功能)</span></span><br><span class="line"><span class="comment"># --------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># AddThis</span></span><br><span class="line"><span class="comment"># https://www.addthis.com/</span></span><br><span class="line"><span class="attr">addThis:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">pubid:</span>  <span class="comment">#访问 AddThis 官网, 找到你的 pub-id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Share.js</span></span><br><span class="line"><span class="comment"># https://github.com/overtrue/share.js</span></span><br><span class="line"><span class="attr">sharejs:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>  <span class="comment">#我开启的</span></span><br><span class="line">  <span class="attr">sites:</span> <span class="string">facebook,twitter,wechat,weibo,qq</span>  <span class="comment">#想要显示的内容</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># AddToAny</span></span><br><span class="line"><span class="comment"># https://www.addtoany.com/</span></span><br><span class="line"><span class="attr">addtoany:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">item:</span> <span class="string">facebook,twitter,wechat,sina_weibo,facebook_messenger,email,copy_link</span></span><br></pre></td></tr></table></figure><h3 id="文章过期提醒"><a href="#文章过期提醒" class="headerlink" title="文章过期提醒"></a>文章过期提醒</h3><p>可设置是否显示文章过期提醒，以更新时间为基准。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Displays outdated notice for a post (文章过期提醒)</span></span><br><span class="line"><span class="attr">noticeOutdate:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">flat</span> <span class="comment"># style: simple/flat</span></span><br><span class="line">  <span class="attr">limit_day:</span> <span class="number">365</span> <span class="comment"># When will it be shown</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">top</span> <span class="comment"># position: top/bottom</span></span><br><span class="line">  <span class="attr">message_prev:</span> <span class="string">It</span> <span class="string">has</span> <span class="string">been</span></span><br><span class="line">  <span class="attr">message_next:</span> <span class="string">days</span> <span class="string">since</span> <span class="string">the</span> <span class="string">last</span> <span class="string">update,</span> <span class="string">the</span> <span class="string">content</span> <span class="string">of</span> <span class="string">the</span> <span class="string">article</span> <span class="string">may</span> <span class="string">be</span> <span class="string">outdated.</span></span><br></pre></td></tr></table></figure><p><code>limit_day</code>： 距离更新时间多少天才显示文章过期提醒</p><p><code>message_prev</code> ： 天数之前的文字</p><p><code>message_next</code>：天数之后的文字</p><h3 id="相关文章"><a href="#相关文章" class="headerlink" title="相关文章"></a>相关文章</h3><p>相关文章推荐的原理是根据文章tags的比重来推荐</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">related_post:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">6</span> <span class="comment"># 显示推荐文章数目</span></span><br><span class="line">  <span class="attr">date_type:</span> <span class="string">created</span> <span class="comment"># or created or updated 文章日期显示创建日或者更新日</span></span><br></pre></td></tr></table></figure><h3 id="字数统计"><a href="#字数统计" class="headerlink" title="字数统计"></a>字数统计</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wordcount (字數統計)</span></span><br><span class="line"><span class="comment"># see https://butterfly.js.org/posts/ceeb73f/#字數統計</span></span><br><span class="line"><span class="attr">wordcount:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post_wordcount:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">min2read:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_wordcount:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="文章打赏"><a href="#文章打赏" class="headerlink" title="文章打赏"></a>文章打赏</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sponsor/reward</span></span><br><span class="line"><span class="attr">reward:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">QR_code:</span></span><br><span class="line">    <span class="comment"># - img: /img/wechat.jpg</span></span><br><span class="line">    <span class="comment">#   link:</span></span><br><span class="line">    <span class="comment">#   text: wechat</span></span><br><span class="line">    <span class="comment"># - img: /img/alipay.jpg</span></span><br><span class="line">    <span class="comment">#   link:</span></span><br><span class="line">    <span class="comment">#   text: alipay</span></span><br></pre></td></tr></table></figure><h3 id="文章版权信息"><a href="#文章版权信息" class="headerlink" title="文章版权信息"></a>文章版权信息</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_copyright:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">decode:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">CC</span> <span class="string">BY-NC-SA</span> <span class="number">4.0</span></span><br><span class="line">  <span class="attr">license_url:</span> <span class="string">https://creativecommons.org/licenses/by-nc-sa/4.0/</span></span><br></pre></td></tr></table></figure><h2 id="博客部署"><a href="#博客部署" class="headerlink" title="博客部署"></a>博客部署</h2><p>需要自己提前在代码托管网站建立好仓库</p><div class="note warning modern"><p>如果想要开启pages，须按规则命名仓库：</p><ul><li>Github：{username}.github.io.git</li><li>Gitee：{username}.git</li><li>其他请自行百度……</li></ul></div><div class="tabs" id="tab-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1-1">安装插件</button></li><li class="tab"><button type="button" data-href="#tab-1-2">填写仓库</button></li><li class="tab"><button type="button" data-href="#tab-1-3">hexo三连</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1-1"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install <span class="literal">--save</span> hexo<span class="literal">-deployer-git</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-2"><p>修改<code>_config.yml</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">    <span class="attr">repo:</span> <span class="string">git@github.com:flow2000/flow2000.github.io.git</span></span><br><span class="line">    <span class="attr">branch:</span> <span class="string">master</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">    <span class="attr">repo:</span> <span class="string">https://gitee.com/pgh1038/pgh1038.git</span></span><br><span class="line">    <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-1-3"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://butterfly.js.org/">Butterfly官方文档</a></p><p><a href="https://zhu-dongya.gitee.io/posts/hexo-butterfly-02/">https://zhu-dongya.gitee.io/posts/hexo-butterfly-02/</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
